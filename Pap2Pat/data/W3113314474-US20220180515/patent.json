{
    "id": "US20220180515",
    "authors": [
        "Renjie Zhou",
        "Xin Shu",
        "Rishikesh Pandey"
    ],
    "title": "ARTIFICIAL INTELLIGENCE ENABLED REAGENT-FREE IMAGING HEMATOLOGY ANALYZER",
    "date": "2021-12-09 00:00:00",
    "abstract": "The subject invention pertains to methods and systems for classifying leukocytes using artificial intelligence called AIRFIHA (artificial-intelligence enabled reagent-free imaging hematology analyzer) that can accurately classify subpopulations of leukocytes in a label-free manner. AIRFIHA can not only subtype lymphocytes into B and T cell but is capable of sorting different types of T cells subtypes. AIRFIHA is realized through training a two-step neural network using label-free images of separated leukocytes acquired from a custom-built quantitative phase microscope. Owing to its easy operation, low cost, and strong discerning capability of complex leukocyte subpopulations, AIRFIHA is clinically translatable and can also be deployed in resource-limited settings.",
    "sections": [
        {
            "title": "DESCRIPTION",
            "paragraphs": [],
            "subsections": [
                {
                    "title": "BACKGROUND OF THE INVENTION",
                    "paragraphs": [
                        "Leukocytes play an important role in maintaining the normal function of human immune systems and differ in structure and function1,2. For instance, B and T lymphocytes can produce antibodies to defend the body against foreign substances, such as bacteria and viruses. Abnormal leukocyte differential counts are indications of malfunctions of the immune system or infectious diseases. For instance, a sharp increase in neutrophil-to-lymphocyte ratio serves as an independent risk factor for SARS-CoV-2 infection4,5. To differentiate basic leukocyte types, volume and granularity parameters are often measured through electrical impedance and light scattering-based cytometry techniques6,7. For more complex leukocyte types with similar morphologies (e.g., B and T lymphocytes), fluorescent molecules bound with antibodies that specifically target the proteins expressed on the surface are typically used to activate fluorescence emission which can be captured by detectors for population counting. Although antibody labeling based flow cytometry methods are widely used in the clinical laboratories, there remain a few drawbacks. Firstly, only the labeled cellular structures are used for differentiating cell types, but not all the cellular structures. Secondly, an extensive list of expensive reagents is required for differentiating many cell types. Lastly, the labeled cells are not suitable for further testing as their original states have changed. Label-free imaging methods can potentially solve the aforementioned issues8-12. For instance, a hemogram based on Raman imaging has been proposed to discern leukocytes13. While this innovative approach leverages unique biochemical attributes for the classification, it is limited by the weak, spontaneous Raman signal, thus not suitable for high-throughput applications in a clinical setting. Quantitative phase microscopy (QPM) is a rapidly emerging imaging modality that is suitable for high-speed imaging of unlabeled specimens. In QPM, the exact optical path-length delay associated with the density and thickness at each point in the specimen is mapped, which has enabled label-free imaging of transparent structures (e.g., live cells) with high imaging contrast14-16. In recent years, QPM has been used for single-cell analysis by extracting quantitative biomarkers, e.g., measuring dry cell mass to quantify cell growth17,18, studying red blood cell rheologyl9,20, characterizing cell viability21, analyzing large cell populations22,23, and screening cancer24, etc. However, most studies have primarily relied on interpreting the QPM results in terms of a few principal morphological characteristics. Recently, a shift has been sought in the paradigm by utilizing machine learning (ML) and artificial intelligence (AI) for analyzing and interpreting QPM data25-27. As for the applications on hematology, QPM with ML/AL has been used to screen cancer cells in blood28-30, diagnose red blood cell related disorders31,32, detect activation states of leukocytes33, and classify various leukocytes34-38. The full field and fast imaging attributes of QPM enable availability of volumes of high-dimension imaging and therefore make QPM a unique modality for the application of ML/AI to those tasks involving cell classification and imaging. With recent developments in ML/AI, e.g., visual geometry group (VGG)39, inception40, and residual neural network (ResNet)41,42 abundant training data is available to train a model to extract important image features to classify targeted objects43,44. Compared with previous manual feature extraction analysis methods, the new approaches in ML/AI may offer features with statistically significant higher sensitivity and specificity. Among the recent ML/AI methods, ResNet tackles the gradient vanishing problem by creating shortcut paths to jump over layers. Conversion among different types of biomedical images and the segmentation of certain cell structures have been achieved by using ResNet building blocks45-47. With such exciting developments, ML/AI have been applied to label-free imaging cytometry systems to tackle complicated cell analysis problems. For instance, machine learning for the differentiation of lymphocytes has been achieved on a bright-field and dark-field microscopy platform48 and a QPM platform using fixed pathology slides34. To further improve the detection accuracy and specificity of leukocyte subtypes, 3D QPM techniques has been proposed and demonstrated35,49.",
                        "Accordingly, rapid, low-cost methods of using a system to classify complex leukocyte types are needed."
                    ],
                    "subsections": [],
                    "outline_long": [
                        "introduce leukocyte function",
                        "motivate abnormal leukocyte counts",
                        "describe cytometry techniques",
                        "limitations of antibody labeling",
                        "introduce label-free imaging methods",
                        "describe Raman imaging",
                        "introduce quantitative phase microscopy",
                        "summarize QPM applications",
                        "motivate AI-enabled QPM"
                    ],
                    "num_characters": 4592,
                    "outline_medium": [
                        "introduce leukocyte importance",
                        "motivate label-free imaging methods",
                        "summarize limitations of current methods",
                        "introduce machine learning applications"
                    ],
                    "outline_short": [
                        "motivate leukocyte classification",
                        "limitations of existing methods"
                    ]
                },
                {
                    "title": "BRIEF SUMMARY OF THE INVENTION",
                    "paragraphs": [
                        "The disclosure provides a system and methods of using the system to classify leukocytes. The system to classify leukocytes can be an AI-enabled reagent-free imaging hematology analyzer (AIRFIHA) that can classify complex leukocyte types in blood samples or other samples containing leukocytes. AIRFIHA is based on leveraging the morphological attributes of phase images from a QPM system and a cascaded-ResNet for leukocyte classification. The robustness and applicability of the subject methods can be confirmed by conducting cross-donor validation experiments. The methods and system can discern human CD4 and CD8 T cells, monocytes, granulocytes, and/or lymphocytes. The subject methods and system show a promising perspective when applying automated clinical blood testing applications, which is especially useful in resource-limited settings and during pandemic situations."
                    ],
                    "subsections": [],
                    "outline_long": [
                        "introduce AIRFIHA system"
                    ],
                    "num_characters": 878,
                    "outline_medium": [
                        "introduce AIRFIHA system"
                    ],
                    "outline_short": [
                        "introduce AIRFIHA system"
                    ]
                },
                {
                    "title": "DETAILED DISCLOSURE OF THE INVENTION",
                    "paragraphs": [
                        "Ranges provided herein are understood to be shorthand for all of the values within the range. For example, a range of 1 to 20 is understood to include any number, combination of numbers, or sub-range from the group consisting 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19 and 20, as well as all intervening decimal values between the aforementioned integers such as, for example, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, and 1.9. With respect to sub-ranges, \u201cnested sub-ranges\u201d that extend from either end point of the range are specifically contemplated. For example, a nested sub-range of an exemplary range of 1 to 50 may comprise 1 to 10, 1 to 20, 1 to 30, and 1 to 40 in one direction, or 50 to 40, 50 to 30, 50 to 20, and 50 to 10 in the other direction.",
                        "As used herein a \u201creduction\u201d means a negative alteration, and an \u201cincrease\u201d means a positive alteration, wherein the negative or positive alteration is at least 0.001%, 0.01%, 0.1%, 0.5%, 1%, 5%, 10%, 15%, 20%, 25%, 30%, 35%, 40%, 45%, 50%, 55%, 60%, 65%, 70%, 75%, 80%, 85%, 90%, 95% or 100%.",
                        "The transitional term \u201ccomprising,\u201d which is synonymous with \u201cincluding,\u201d or \u201ccontaining,\u201d is inclusive or open-ended and does not exclude additional, unrecited elements or method steps. By contrast, the transitional phrase \u201cconsisting of\u201d excludes any element, step, or ingredient not specified in the claim. The transitional phrase \u201cconsisting essentially of\u201d limits the scope of a claim to the specified materials or steps \u201cand those that do not materially affect the basic and novel characteristic(s)\u201d of the claimed invention. Use of the term \u201ccomprising\u201d contemplates other embodiments that \u201cconsist\u201d or \u201cconsist essentially of\u201d the recited component(s).",
                        "Unless specifically stated or obvious from context, as used herein, the term \u201cor\u201d is understood to be inclusive. Unless specifically stated or obvious from context, as used herein, the terms \u201ca,\u201d \u201cand\u201d and \u201cthe\u201d are understood to be singular or plural.",
                        "Unless specifically stated or obvious from context, as used herein, the term \u201cabout\u201d is understood as within a range of normal tolerance in the art, for example within 2 standard deviations of the mean. About can be understood as within 10%, 9%, 8%, 7%, 6%, 5%, 4%, 3%, 2%, 1%, 0.5%, 0.1%, 0.05%, or 0.01% of the stated value. Unless otherwise clear from context, all numerical values provided herein are modified by the term about.",
                        "In certain embodiments, a well-designed neural network model, high information-content quantitative phase images, and a considerable amount of data collected from leukocyte-containing samples, the subject methods and a system can be used to classify of granulocytes, monocytes, and B and T lymphocytes in a sample. The subject methods and system can further be used to differentiate CD4 and CD8 T cells that are normally difficult to distinguish with label-free methods.",
                        "Sample Preparation",
                        "In certain embodiments, a sample can be analyzed for the presence and/or classification of leukocytes. The sample can be blood from an organism, preferably a mammal, such as, for example, as dog, cat, human, mouse, rat, camel, lamb, sheep, cow, pig, monkey, or horse. The samples can be analyzed within about 1, about 2, about 4, about 8, about 12, about 16, about 20 or about 24 hours of blood extraction. The sample can further comprise anti-coagulants and/or preservatives, such as for example, citrate, oxalate, sodium citrate, acid-citrate-dextrose, and ethylenediaminetetraacetic acid (EDTA).",
                        "In some embodiments, the sample can be isolated leukocytes. The leukocytes can be isolated from a blood sample. Four types of leukocytes, namely monocytes, granulocytes, and B and T lymphocytes, can be isolated from fresh blood samples. To separate the leukocytes from other constituents of a blood sample, a variety of techniques known in the art can be employed such as, for example, immunomagnetic negative selection, electrokinetic mechanisms-based cell sorting, acoustophoresis-based cell sorting, optical manipulation-based cell sorting, magnetophoresis-based cell Sorting, and/or Ficoll-Paque\u2122 density gradient separation. Negative and/or positive selection and/or other leukocyte-isolating techniques can be used to isolate each specific leukocyte type from the whole blood sample such as, for example, monocytes, granulocytes, basophils, neutrophils, eosinophils, T Cells, B Cells, CD4+ T Cells, CD8+ T Cells, helper CD4+ T cells, regulatory CD4+ T cells, memory T cells, natural killer T cells, and/or gamma delta T cells. Phosphate-buffered saline, optionally free from Ca++ and Mg++; can be used for the suspension of isolated leukocytes.",
                        "In certain embodiments, flow cytometry can be performed on the isolated leukocytes to confirm the purity of the isolation. The viability of the leukocytes can be determine using a number of techniques known in the art such as, for example, Acridine Orange and Propidium Iodide (AO/PI) staining or Trypan blue exclusion. In some embodiments, the isolated leukocytes can be counted and, once counted, can be suspended in a solution, preferably PBS, at a density of about 1\u00d7103 cells/mi, about 1\u00d7104 cells/ml, about 1\u00d7105 cells/ml, about 1\u00d7106 cells/ml, about 1\u00d7107 cells/ml, about 1\u00d7108 cells/ml, or about 1\u00d7109 cells/ml. To measure the cells using flow cytometry, fluorophore-conjugated antibody can be added to cells such as, for example, Anti-CD-14-PerCP for monocytes, Anti-CD-66b-FITC for granulocytes, Anti-CD-19-APC for B lymphocytes, and Anti-CD3-PE; for T lymphocytes.",
                        "In certain embodiments, leukocytes can be prepared for quantitative phase imaging. Isolated leukocytes or any other sample containing leukocytes, such as, for example, a blood sample, can be suspended, preferably in a PBS solution, and diluted at least 2-times, 3-times, 4-times, 5-times, 6-times, 7-times, 8-times, 9-times, 10-times or more. Optionally, DNase can be added to the isolated cells to decrease the clumping and adsorption of protein fragments. The isolated leukocytes can then be prepared for imaging, preferably by being sandwiched between two coverslips, preferably quartz, and a secure seal spacer. Then, the sample can be imaged, preferably by being placed onto the sample-stage for quantitative phase imaging.",
                        "Diffraction Phase Microscopy and Image Processing",
                        "In certain embodiments, leukocytes can be imaged using a common-path quantitative phase microscopy (QPM) (or quantitative phase imaging) method that allows for highly sensitive measurement of cell morphology with nanometer-scale sensitivity. Alternatively, bright-field microscopy, dark-field microscopy, and/or fluorescence microscopy can be used. In certain embodiments, the quantitative phase microscopy is diffraction phase microscopy (DPM), portable quantitative phase microscopy50, spatial light interference microscopy51, or other common-path or non-common path QPM methods. In preferred embodiments, diffraction phase microscopy is used. The result of the leukocyte imaging produces at least 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 20, 25, 30, 50, 100, or more interferogram(s); however, only one interferogram is needed to obtain a wide-field phase map, high-speed image of the leukocytes. In some embodiments, the DPM system, as illustrated in FIG. 6, is used to measure the phase maps of the leukocytes. A laser can be used as the illumination source for the QPM system. The laser can have a wavelength anywhere between deep UV and NIR spectrum, preferably about 100 nm to about 2500 nm, about 100 nm to about 1000 nm, about 200 nm to about 800 nm, about 300 nm to about 700 nm, about 400 nm to about 650 nm, about 405 nm, about 532 nm, or about 633 nm. The collimated laser beam can first pass through the sample, and then the sample scattered field can then be collected by an objective lens, such as an oil immersion or, preferably, a water dipping (immersion) objective lens with numerical aperture (NA) of about 0.01 to about 10, about 0.025 to about 1.5, about 0.1 to about 1.25, about 0.12 to about 1, about 0.12 to about 0.87, about 1.33, or about 1.3. In certain embodiments, the sample beam goes through a tube lens and forms an intermediate image at its back focal plane. A diffraction grating, placed at the intermediate image plane, can produce multiple copies of the sample image. Two of the diffraction orders can be selected by a subsequent 4f system formed by lens 1 and lens 2. The 1st order beam is filtered down to a DC beam (or reference beam) through about a 5 \u03bcm to about 50 \u03bcm or about a 10 \u03bcm diameter pinhole filter, placed at the Fourier plane of lens 1. The 0th order beam passes the 4f system without any filtering as serves as the signal beam. At the final imaging plane after lens 2, these two beams interfere with each other and forms an interferogram which can then be captured by an imaging device, preferably a CCD/CMOS camera. The imaging system can have a total magnification of about 50\u00d7 to about 200\u00d7 or about 100\u00d7, a lateral resolution of about 200 nm to about 1 \u03bcm or, about 300 nm to about 800 nm, about 400 nm to about 600 nm, or preferably, about 590 nm according to the Rayleigh criterion, and a field of view of 61 \u03bcm\u00d749 \u03bcm, or up to a field of view of about 500 \u03bcm\u00d7500 \u03bcm.",
                        "In certain embodiments, the phase image processing can comprise of phase retrieval52 and segmentation, as shown in FIG. 7. A Fourier transform can first be performed over a raw interferogram (first column in FIG. 7), and then a bandpass filter can be used to select the +1 or \u22121 order signal. After that, the selected signal can be shifted back to the origin of the frequency spectrum. An inverse Fourier transform can be performed to obtain the complex sample field. Meanwhile, a separate interferogram taken in a sample-free region can be used as the calibration image and the same processing (Fourier transform, bandpass filtering, signal shift, and/or inverse Fourier transform) is conducted to obtain the complex calibration field. Then, the calibration complex field can be divided from the sample complex field to obtain the calibrated sample field, from which the sample phase map can be obtained. In certain embodiments, a phase unwrapping procedure can subsequently be added to unwrap the sample phase map. Finally, the phase map can be flattened and zeroed by removing the background tilt and subtracting the background phase value. Representative phase images for each major leukocyte type are shown in the second column in FIG. 7. After obtaining the phase images, individual cells can each be cropped with a segmentation algorithm53 (third column in FIG. 7). First, a threshold can be set to segment cells from the background. Then, a Gaussian filter can be used with the same size as the minimum cell diameter to detect the local maxima which serves as the seeds. Third, a watershed segmentation algorithm can be used to infer the contours of cells around the seeds obtained from the last step. Lastly, the contours can be expanded and affined according to the image gradient using an edge-based active contour method. In certain embodiments, to ensure the same size for all the cell phase maps, each cell phase map can be pasted on a fixed-size template.",
                        "In certain embodiments, each leukocyte image with size of about 50\u00d750 to about 500\u00d7500 pixels or about 300\u00d7300 pixels can be reshaped into about a 1\u00d72500 sequence to about a 1\u00d7250000 sequence or about a 1\u00d790000 sequence and then the principal component analysis (PCA)54 method and/or linear discriminant analysis (LDA) can be used to decrease the dimension from 90000 to about 256 to about 2048, or more (corresponding to 10-layer resnet, 56-layer resnet, and more). In certain embodiments, the t-distributed stochastic neighbor embedding (t-SNE) method,55 Variational Autoencoder (VAE), and/or Uniform Manifold Approximation and Projection (UMAP) can be used to visualize the PCA\\LDA extracted features in a 3-D plot.",
                        "Classification Model Training",
                        "In certain embodiments at least 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, or more artificial neural networks, including a residual neural network, visual geometry group, inception, AlexNet, fully connected neural network, convolutional neural network, or Generative adversarial network (GAN) can be constructed. In preferred embodiments, a neural network framework can be constructed by cascading at least 2, 3, 4, 5 or more residual neural networks (ResNets). This neural network framework can be designed to simultaneously or in series classify various types of leukocytes, specifically monocytes, granulocytes, and B and T lymphocytes using a multiple-step classification routine such as a classification routing having two classifiers. The leukocyte types in these two classifiers can be allotted in a way that each leukocyte type within one classifier share similar degrees of classification difficulties. A first ResNet can be used to classify monocytes, granulocytes, and lymphocytes. The predicted lymphocytes can then put into the second ResNet for further classification into B and T lymphocytes. Additional ResNets, for instance, one or more ResNets that classify granulocytes into neutrophils, eosinophils, basophils, mast cells, or some combination thereof, can be coupled to the two-step classification routine. Due to the similarity of these two classification tasks of the two-step classification routine, the second ResNet can be developed by fine-tuning the first ResNet. Moreover, ResNets of different depths having a plurality of layers can be used. In preferred embodiments, a 10-layer ResNet (ResNet-10) can be used that has, for example, around 1.5 million trainable parameters. The ResNet-10 may have ten layers including, for example, one input convolution layer, eight convolution layers from four building blocks (each building block has two convolution layers), and one final dense layer. Alternative ResNets that can be used include, for example, at least 2-layer, 18-layer, 20-layer, 34-layer, 56-layer, 152-layer, or more layers. A shortcut can connect the head and tail of each building block, which helps to restore the crucial shallower features for prediction. The layer size is halved, and the kernel quantity is doubled for every 1, 2, 1 building blocks. Furthermore, batch normalization (Batch Norm)56 can be applied for each mini-batch after each convolutional layer and Rectified Linear Unit (Relu)57 can be used as the nonlinear activation function. After the last building block, an average pool and a flatten layer can be applied to convert each two-dimensional feature map into one value. For example, for 256 feature maps, a 256\u00d71 vector is obtained to represent each of the input images. Probabilities of each type of leukocytes are produced based on this feature vector via a dense layer with the Softmax activation function58. For the classification tasks, probabilities for each leukocyte type determined can be produced. For the monocyte-granulocyte-lymphocyte classification task, probabilities of these three types are produced, while for B-T lymphocyte classification, two probability values are produced. For the neutrophils, eosinophils, basophils, and mast cells classification tasks, probabilities of these four types are produced. The type with the largest probability value can be used to make the final decision. In certain embodiments, to classify CD4 and CD8 T cells, a separate ResNet can be trained by fine-tuning the B-T lymphocyte classifier for the new classification task.",
                        "In certain embodiments, phase maps of the leukocytes can be cropped from the whole phase images retrieved from the measured interferograms. Each phase image, containing one leukocyte, can then be pasted onto about a 50\u00d750 to about 500\u00d7500 pixels or about 300\u00d7300 pixels template to be used as the input of the network. In the training process, a 2, 3, 4, 5, 6, 7, 8, 9, 10, 20, 25, 50, 100-fold cross-validation method was used to tune the hyper-parameters, including network depth, batch size, learning rate, dropout. During the training, to ensure all leukocyte types are trained under the same condition (i.e., each type has the same number of training samples), the datasets of unbalanced leukocyte types can be augmented by rotation, position shifting, and/or flipping. In certain embodiments, leukocytes can be classified as monocytes, granulocytes, or lymphocytes. In other embodiments, monocytes, granulocytes, or lymphocytes can be further distinguished. For example, B and T lymphocytes can be treated as one type, (i.e., lymphocytes) or B and T lymphocytes can be treated as distinct lymphocytes. Additionally, basophils, eosinophils, neutrophils, mast cells, natural killer cells can be treated and classified as distinct cell types. All leukocyte types, preferably granulocytes, monocytes and lymphocytes, can be used to train and test a classifier. In certain embodiments, morphological features are used during the training, including at least one selected from cell area, cell radius, cell height, cell shape, cell perimeter length, cell mass, and intracellular protein distributions. In certain embodiments, the types of leukocytes can be classified using a neural network created from donors whose leukocytes are not included in the training set. In certain embodiments, the types of leukocytes can be classified using a neural network created from donors whose leukocytes are included in the training set or from donors whose leukocytes are the only source of the training set.",
                        "In certain embodiments, after phase maps are obtained, data cleaning can be performed. To perform data cleaning, a leukocyte whose dry mass and area is more than, for example, one standard deviation, two standard deviations, or three standard deviations from the mean of its type is considered as outlier. Data cleaning can also or alternatively include removing leukocytes that are incorrectly segmented by, for example, removing cells with only half cell bodies and cell clusters. Other methods that can be used to detect the outlier include element 1.5 interquartile ranges above the upper quartile or below the lower quartile, or element more than three scaled median absolute deviation from the median. Data cleaning can occur after producing phase maps for each leukocyte and before network training.",
                        "In certain embodiments, the tuning of the neural network can be a function of at least one property of a precision-recall curve and/or F1 score representing leukocyte classifications of the known leukocytes generated by the neural network based on the digitally observed features.",
                        "In certain embodiments, to optimize the leukocyte classification models, various loss functions and various optimizers can be used. The loss functions can be based on mean squared error, likelihood loss, and/or cross-entropy loss. The various optimizers can be based on Adam, gradient descent (including stochastic gradient descent (SGD)), RMSprop, and Adagrad. In one preferred embodiment, categorical cross-entropy loss and the Adam optimizer (for example, learning rate=1\u00d710\u22121, 1\u00d710\u22122, 1\u00d710\u22123, 1\u00d710\u22124, 1\u00d710\u22125, 1\u00d710\u22126, 1\u00d710\u22127, 1\u00d710\u22128, or 1\u00d710\u22129; \u03b21=0.9, 0.99, 0.999, or 0.9999; \u03b22=0.9, 0.99, 0.999, or 0.9999; learning rate decay=0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, or 1)59 can be applied to optimize a leukocyte classification model. In certain embodiments, the model with the best average validation accuracy can be chosen as the final leukocyte classifier, preferably monocyte-granulocyte-lymphocyte classifier. For subsequent classifiers, such as for a B-T cell lymphocyte classifier or basophil-eosinophil-neutrophil-mast cells, the dense layer of the obtained monocyte-granulocyte-lymphocyte classifier can first be replaced with a new dense layer that has two, three, four or more outputs. In certain embodiments, the B and T lymphocytes or basophils, eosinophil, neutrophil, and mast cells can be used to fine-tune the entire network. In certain embodiments, the loss function based on categorical cross-entropy loss and the SGD optimizer (for example, learning rate=1\u00d710\u22121, 1\u00d710\u22122, 1\u00d710\u22123, 1\u00d710\u22124, 1\u00d710\u22125, 1\u00d710\u22126, 1\u00d710\u22127, 1\u00d710\u22128, or 1\u00d710\u22129; learning rate decay=1\u00d710\u22121, 1\u00d710\u22122, 1\u00d710\u22123, 1\u00d710\u22124, 1\u00d710\u22125, 1\u00d710\u22126, 1\u00d710\u22127, 1\u00d710\u22128, or 1\u00d710\u22129; momentum=0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, or 1)60 can be used. The network model with the best validation result can be chosen as the final B-T lymphocyte classifier. In certain embodiments, 2, 3, 4, 5, or more network models can be used to obtain the final cascaded network model. These frameworks can be implemented with Tensorflow backend Keras framework and Python running on the Microsoft Windows 10 operating system, or other suitable operating systems, software libraries, and programming languages operating on various processors for the subject system and methods. In some embodiments, the observed features and/or morphologies of leukocytes can be stored in a database. Additionally, known leukocytes morphological features can also be stored in the same database or another database. The operating system/processor can use the databases to train and tune a neural network in addition to classifying samples containing leukocytes.",
                        "Applications",
                        "The subject methods can be used as a fully automated, reagent-free, and high-throughput modality for differential diagnosis of leukocytes at point-of-care and in a clinical laboratory. Additional salient features of this platform include its single-shot measurement, small spatial footprint, and low cost. Of note, owing to its facile and simpler set-up, this platform can be combined with other modalities for blood cell investigation. For example, by combining it with microfluidic devices, the subject system and methods can conduct blood testing and analysis in a fully automated way. Importantly, the need for isolation kits is obviated and the leucocytes separated from blood using a routine centrifugation process can be directly subjected to the subject system and methods to provide percentage population of leukocyte subtypes. Another example can be its integration with Raman spectroscopy that has been proposed for B lymphocyte acute lymphoblastic leukemia identification and classification61. While Raman spectroscopy provides biomolecular specificity, spontaneous Raman measurements are not feasible for clinical workflow requiring rapid diagnosis. Importantly, given the potential of the subject system and methods in screening B cells from other leucocytes, this QPM-based strategy can be used to screen the B lymphocytes in which Raman measurements can be performed for B lymphocytes leukemia diagnosis. The combined QPM-Raman system obviates the need of any additional separation method to select B lymphocytes either from the blood or from the leucocyte mixtures for leukemia diagnosis in a label-free manner. Moreover, as the subject system and methods involve a low-cost system that requires minimal sample preparation or chemical consumables, the subject system and methods have great potential for their use in point-of-care applications, resource-limited settings, or pandemic situations, e.g., COVID-19 pandemic, in view of a portable and low-cost QPM system that we recently demonstrated62."
                    ],
                    "subsections": [
                        {
                            "title": "Materials and Methods",
                            "paragraphs": [
                                "Fresh blood sample procurement. The fresh blood samples from six anonymous healthy adult donors were purchased from StemCell Technologies (Vancouver, Canada) and all the experiments were conducted within 24 hours of blood extraction. The purchased blood samples contained ethylenediaminetetraacetic acid (EDTA) as the anti-coagulant.",
                                "Leukocyte isolation from fresh blood. Four types of leukocytes, namely monocytes, granulocytes, and B and T lymphocytes, were isolated from fresh blood samples using isolation kits from Stemcell Technologies (Vancouver, Canada). From each donor the amount of blood was in the 1-3 ml range, depending on the minimum volume requirement as per manufacturer's instruction for each leukocyte subpopulation. To isolate these four subpopulations, we used EasySep Direct Human Monocyte Isolation Kit, EasySep Direct Human Pan-Granulocyte Isolation Kit, EasySep Direct Human T Cell Isolation Kit, and EasySep Direct Human B Cell Isolation Kit (Stemcell Technologies Inc). These separation kits used immunomagnetic negative selection for isolating each specific leukocyte type from the whole blood sample. Two additional negative separation kits, i.e., EasySep Direct Human CD4+ T Cell Isolation Kit and EasySep Direct Human CD8+ T Cell Isolation Kit, were used for the isolation of CD4 and CD8 cells, respectively. Phosphate-buffered saline free from Ca++ and Mg++ (Gibco, Thermo Fisher Scientific, Waltham, Mass.) was used as the recommended medium for the EasySep Isolation kits. The isolation was carried out following the manufacturer's instructions with multiple cycles of mixing and incubation with the provided RapidSpheres and cocktail from the isolation kits. The final incubation yielded the isolated leukocytes in a 14 ml polystyrene round-bottom tube (Thermo Fischer Scientific), which were centrifuged at 400 g for 5 minutes. The cell pellet was resuspended in PBS before the cells were imaged.",
                                "Flow cytometry analysis. Flow cytometry was performed on the isolated leukocytes after the EasySep procedure to confirm the purity of the isolation. The viability of the leukocytes was checked with Acridine Orange and Propidium Iodide (AO/PI) staining (Invitrogen, Thermo Fischer Scientific) using a cell counter. The isolated leukocytes were counted and 50,000 of them were resuspended in cold PBS (Gibco, Thermo Fisher Scientific) at a density of 107 leukocytes/ml. 100 ml of this cell suspension was added to each well in a 96 well plate. 1 \u03bcl of the required fluorophore-conjugated antibody was added to each well and incubated in the refrigerator for 20 mins. Anti-CD-14-PerCP was used for monocytes, Anti-CD-66b-FITC was used for granulocytes, Anti-CD-19-APC was used for B lymphocytes, and Anti-CD3-PE was used for T lymphocytes. The leukocytes were washed thrice with cold PBS and resuspended in 100 \u03bcl of cold PBS. The leukocytes were used for the flow cytometry analysis (MACSQuant Analyzer) and the data were analyzed with FlowJo software.",
                                "Leukocyte sample preparation for quantitative phase imaging. After the isolation of the leukocytes, the leukocytes are suspended PBS solution and diluted five to ten times. DNase solution (1 mg/ml) (Stemcell Technologies, Inc.) was added to the isolated cells to decrease the clumping and adsorption of protein fragments. Typically, 10 \u03bcl of the isolated cell suspension was sandwiched between two quartz coverslips and a secure seal spacer. Then, the sample was placed onto the sample-stage of the home-built system for quantitative phase imaging. We repeated this sample preparation procedure for collecting all the required phase images of leukocytes from each donor.",
                                "Training of the classification model. Phase maps of the leukocytes were obtained by cropping the phase images retrieved from the measured interferograms. Each phase map, containing one leukocyte type, was then resized to 300\u00d7300 pixels to be used as the input of the network. In the training process, a 5-fold cross-validation method was used to tune the hyper-parameters, including network depth, batch size, etc. During the training, to ensure all leukocyte types were trained under the same condition (i.e., each type has the same number of training samples), the datasets of unbalanced leukocyte types were augmented by rotation, position shifting, and flipping of the phase maps. For the monocyte-granulocyte-lymphocyte classifier, B and T lymphocytes were treated as one type, i.e., lymphocytes, and then all granulocytes, monocytes and lymphocytes were used to train and test the classifier. The loss function based on categorical cross-entropy loss and the Adam optimizer (for example, learning rate=1\u00d710\u22123, \u03b21=0.9, \u03b22=0.999, learning rate decay=0)59 were applied to optimize the model. In the end, the model with the best average validation accuracy was chosen as the final monocyte-granulocyte-lymphocyte classifier. For the B-T lymphocyte classifier, the dense layer of the obtained monocyte-granulocyte-lymphocyte classifier was first replaced with a new dense layer that has two outputs. All the B and T lymphocytes were used to fine-tune the entire network. The loss function based on categorical cross-entropy loss and the SGD optimizer (for example, learning rate=1\u00d710\u22123, learning rate decay=1\u00d710\u22126, momentum=0.9)60 were used. The network model with the best validation result was chosen as the final B-T lymphocyte classifier. By connecting these two network models, the final cascaded network model was obtained, from which the testing was conducted. The CD4-CD8 classifier was fine-tuned from the B-T lymphocyte classifier and trained and tested within the same donor. These frameworks were implemented with Tensorflow backend Keras framework and Python running on the Microsoft Windows 10 operating system. The training was performed on a computer workstation, configured with an Intel i9-7900\u00d7CPU, 128 GB of RAM, and a Nvidia Titan XP GPU.",
                                "Diffraction Phase Microscopy System",
                                "Diffraction phase microscopy (DPM) is a common-path quantitative phase microscopy (QPM) method that allows for highly sensitive measurement of cell morphology with nanometer-scale sensitivity52. As only one interferogram is needed to obtain a wide-field phase map, high-speed image acquisition is possible with DPM. We have recently developed a portable DPM system with a low-cost to enable a broader adoption63. The DPM system, as illustrated in FIG. 6, is used to measure the phase maps of the leukocytes. A 532 nm laser (Gem 532, Laser Quantum) is used as the illumination source for the system. The collimated laser beam first passes through the sample, and then the sample scattered field is collected by a water dipping objective lens with numerical aperture (NA) of 1.1 (LUMFLN60W, Olympus). After that, the sample beam goes through a tube lens and forms an intermediate image at its back focal plane. A diffraction grating, placed at the intermediate image plane, produces multiple copies of the sample image. Two of the diffraction orders are selected by a subsequential 4f system formed by lens 1 and lens 2. The 1st order beam is filtered down to a DC beam (or reference beam) through a 10 \u03bcm diameter pinhole filter, placed at the Fourier plane of lens 1. The 0th order beam passes the 4f system without any filtering as serves as the signal beam. At the final imaging plane after lens 2, these two beams interfere with each other and form an interferogram which is then captured by a USB camera (FL3-U3-13Y3M-C, Pointgrey). The imaging system has a total magnification of around 100, a lateral resolution of around 590 nm according to the Rayleigh criterion, and a field of view of 61 \u03bcm\u00d749 \u03bcm.",
                                "Quantitative Phase Image Processing",
                                "The phase image processing mainly consists of phase retrieval52 and segmentation, as shown in FIG. 7. A Fourier transform is first performed over the raw interferogram (first column in FIG. 7), and then a bandpass filter is used to select the +1 or \u22121 order signal. After that, the selected signal is shifted back to the origin of the frequency spectrum. An inverse Fourier transform is performed to obtain the complex sample field. Meanwhile, another interferogram taken in the sample-free region is used as the calibration image and the same processing is conducted to obtain the complex calibration field. Then the calibration complex field is divided from the sample complex field to obtain the calibrated sample field, from which the sample phase map is obtained. Subsequently, a phase unwrapping procedure is added to unwrap the sample phase map. Finally, we flatten and zero the phase map by removing the background tilt and subtracting the background phase value. Representative phase images for each major leukocyte type are shown in the second column in FIG. 7. After obtaining the phase images, we select each individual cells with a segmentation algorithm53 and create cell phase maps (third column in FIG. 7). To ensure the same size for all the cell phase maps, we paste each cell phase map on a fixed-size template.",
                                "Principal Component Analysis (PCA)",
                                "We first reshape each image with size of 300\u00d7300 into a 1\u00d790000 sequence and then use the principal component analysis (PCA)54 method to decrease the dimension from 90000 to 256. At last, by using the t-distributed stochastic neighbor embedding (t-SNE) method55, we visualize the PCA extracted features in a 3-D plot.",
                                "To evaluate the differentiation capability of PCA, we used a support vector machine (SVM) to analyze the features extracted by PCA. We compared the differentiation accuracy between PCA and our neural network model with results presented in Table 7.",
                                "All patents, patent applications, provisional applications, and publications referred to or cited herein are incorporated by reference in their entirety, including all figures and tables, to the extent they are not inconsistent with the explicit teachings of this specification.",
                                "Following are examples that illustrate procedures for practicing the invention. These examples should not be construed as limiting. All percentages are by weight and all solvent mixture proportions are by volume unless otherwise noted."
                            ],
                            "subsections": [],
                            "outline_long": [
                                "procure fresh blood samples",
                                "isolate leukocytes from fresh blood",
                                "describe isolation kits used",
                                "outline immunomagnetic negative selection process",
                                "detail phosphate-buffered saline preparation",
                                "perform leukocyte isolation",
                                "resuspend isolated leukocytes in PBS",
                                "perform flow cytometry analysis",
                                "check leukocyte viability with AO/PI staining",
                                "count and resuspend leukocytes",
                                "add fluorophore-conjugated antibody to leukocytes",
                                "incubate and wash leukocytes",
                                "prepare leukocyte samples for quantitative phase imaging",
                                "add DNase solution to isolated cells",
                                "sandwich leukocyte suspension between quartz coverslips",
                                "train classification model",
                                "obtain phase maps of leukocytes",
                                "resize phase maps for network input",
                                "describe training process with 5-fold cross-validation",
                                "outline hyper-parameter tuning and model selection"
                            ],
                            "num_characters": 10156,
                            "outline_medium": [
                                "procure fresh blood samples",
                                "isolate leukocytes from fresh blood",
                                "perform flow cytometry analysis",
                                "prepare leukocyte samples for quantitative phase imaging",
                                "train classification model",
                                "describe diffraction phase microscopy system",
                                "process quantitative phase images",
                                "apply principal component analysis",
                                "evaluate differentiation capability",
                                "incorporate references"
                            ],
                            "outline_short": [
                                "procure fresh blood samples",
                                "isolate leukocytes from fresh blood",
                                "prepare leukocyte samples for quantitative phase imaging",
                                "train classification model using phase maps",
                                "describe diffraction phase microscopy system"
                            ]
                        },
                        {
                            "title": "EXAMPLES",
                            "paragraphs": [
                                "**Example 1\u2014Airfiha System**",
                                "In this work, the classification of human leukocyte types is achieved using a QPM system and a neural network, as conceptually illustrated in FIGS. 1A-1D. The exact configuration of the QPM system is based on a diffraction phase microscope (DPM)52,66,67 which can provide highly stable and accurate phase imaging of cells. The imaging resolution of the QPM system is 590 nm, while the field of view is around 61 \u03bcm\u00d749 \u03bcm. Compared with optical diffraction tomography35,49, QPM does not necessitate a complex imaging system and expensive computation requiring a large amount of data, and the system is relatively cost-effective with a smaller footprint. To get the data set for the neural network to learn from, the leukocyte samples were isolated from the fresh blood samples of six healthy donors within 24 hours of blood extraction. The blood sample used for the leukocyte separation for each donor was in 1-3 ml range, depending on the minimum volume requirement as per manufacturer's instruction for the leukocyte subpopulations. To minimize the influence of labelling on cell activity, the leukocytes were negatively isolated by using antibody labeled magnetic particles as illustrated in FIG. 1A. All the cells, other than the target cells, will combine with the magnetic particles to split from the whole blood, thus leaving the residuals as the target cells. Then, the isolated sample was diluted in PBS (phosphate buffer saline) and mounted between two glass coverslips before placing it onto a home-built QPM system as illustrated in FIG. 1B. Phase images of each leukocyte type were retrieved from the measured interferograms. Timely measurement and careful treatment ensure that the native nature of leukocyte samples was maintained. After thousands of phase images of labeled leukocytes of different types were measured, all the leukocytes in each phase image were cropped to construct the training and testing dataset53. A neural network was constructed, trained, and validated for classifying the leukocytes using the phase image dataset (FIG. 1C). A detailed description of the neural network is provided in the following section (Example 2). Finally, the AIRFIHA system was used to identify leukocyte types of new samples (FIG. 1D).",
                                "**Example 2\u2014Leukocyte Classification Method**",
                                "Phase maps of labeled leukocytes of four different types from multiple donors were measured to construct the main dataset, including 857 monocytes, 738 granulocytes, 700 B lymphocytes, and 821 T lymphocytes (i.e., 1521 lymphocytes in total). Additionally, we had a phase map dataset for two subtypes of T lymphocytes, containing 211 CD4 cells and 220 CD8 cells. Representative phase maps for each leukocyte subtype are shown in FIG. 2A. Based on these phase maps, area and dry mass distributions were generated for all the leukocyte types (FIGS. 2B and 2C). Note that cell dry mass quantifying the total protein content in a cell can be precisely determined from the phase map, and it has been well explored for cell phenotyping17,68. As shown in FIGS. 2B and 2C, monocytes and granulocytes have similar areas but very different dry masses (p-value <0.001), while they are well separated from all the other lymphocytes (B and T lymphocytes and CD4 and CD8 cells) through both area and dry mass distributions (p-value <0.001). For the main subtypes of lymphocytes, i.e., B and T lymphocytes, they are different in both cell area and dry mass (p-value <0.001), but the differences are small. The subtypes of T lymphocytes, i.e., CD4 and CD8 cells, have similar cell dry mass and slightly different cell area distributions (p-value <0.001).",
                                "To achieve a higher accuracy in classifying leukocytes (i.e., monocytes, granulocytes, and B and T lymphocytes), we developed a cascaded ResNet structure with a two-step classification design as shown in FIGS. 3A and 3B. This design has been inspired by the prior knowledge of leukocyte hierarchy classification structures1,2. The first ResNet (FIG. 3A) is used to classify monocytes, granulocytes, and lymphocytes. The predicted lymphocytes are then put into the second ResNet (FIG. 3B) for further classification into B and T lymphocytes. From this cascaded structure, we can achieve a much higher accuracy in differentiating B and T lymphocytes, compared with a single-step classifier (refer to Tables 1 and 2 for more comprehensive details on the comparison of two individual donors). ResNets of different depths were explored, while the highest validation accuracy was obtained on the ResNet-10 that had around 1.5 million trainable parameters. ResNet-10 has 10 layers, i.e., one input convolution layer, 8 convolution layers from 4 building blocks (each building block has 2 convolution layers), and one final dense layer. The shortcut connects the head and tail of each building block, which helps to restore the crucial shallower features for prediction. The layer size is halved, and the kernel quantity is doubled for every 1, 2, 1 building blocks. Batch normalization (Batch Norm)56 is applied for each mini-batch after each convolutional layer. Rectified Linear Unit (Relu)57 is used as the nonlinear activation function. After the last building block, an average pool and a flatten layer are applied to convert each two-dimensional feature map into one value, thus for 256 feature maps, a 256\u00d71 vector is obtained to represent each of the input images. Probabilities of each type are produced based on this feature vector via a dense layer with the Softmax activation function58. For the monocyte-granulocyte-lymphocyte classification task, probabilities of these three types are produced, while for B-T lymphocyte classification, two probability values are produced. The type with the largest probability value is used to make the final decision. To explore the differentiation capability of CD4 and CD8 cells, a separate ResNet was trained by fine-tuning the B-T lymphocyte classifier for the new classification task (FIG. 3C). Details on the training and validation of the classification model are provided in the Method section.",
                                "**Example 3\u2014Classification Results**",
                                "To test the classification capability of the AIRFIHA system, a test set was first constructed by randomly selecting 100 cells from four leukocytes, i.e., monocytes, granulocytes, and B and T lymphocytes. Notably, the test set was not contained in the training set. The classification results were evaluated using recall, precision, and F1 score69. F1 score, which is the harmonic mean of recall and precision, is used to characterize the final classification result. The F1 scores from the first classifier for monocytes, granulocytes, and lymphocytes are 94%, 95.4%, and 97.7%, respectively (detailed numerical values for recall, precision, and F1 are provided in Table 3). The F1 scores from the second classifier for B and T lymphocytes are 88.2% and 88.8%, respectively (detailed numerical values for recall, precision, and F1 are provided in Table 4). The overall detection results are summarized and visualized in FIG. 4A and Table 5. The precision-recall curves70 for each of the classifier in the cascaded-ResNet are plotted and shown in FIGS. 4B and 4C. The values of the area under the precision-recall curve (AUPRC) for lymphocytes, monocytes, and granulocytes in the first classifier are 1.00, 0.98 and 0.98, respectively. The values of AUPRC for B and T lymphocytes in the second classifier are 0.96 and 0.94, respectively. Our B/T cell classification accuracy is comparable with the method based on 3D quantitative phase imaging35 (note that leukocytes here were from one mice that could make a difference on the accuracy).",
                                "The prediction from the ResNets is based on the feature vectors which are placed at the end of convolutional layers. The model produces similar feature vectors for the same input types and very different feature vectors for different input types. To verify the efficacy of our trained ResNets, the t-distributed stochastic neighbor embedding (t-SNE) method55 was used, which has decreased the feature dimension from 256 to 3 for all the cell types. The features are plotted in the same coordinate space as shown in FIGS. 4D and 4E. ResNet extracted features could help to distinguish B and T lymphocytes. Compared with principal component analysis (PCA) method, those features have made the boundaries between monocytes, granulocytes, and lymphocytes clearer (FIGS. 8A-8C). As summarized in Table 7, the ResNet method shows increased classification accuracy by over 15% for B and T lymphocytes compared with the PCA method, as evaluated with a trained support vector machine (SVM) classifier. To understand what differences in the cell morphological features contributed to the discrimination in the neural network, we visualized the outputs of each convolutional layer after activation (refer to FIGS. 9A-9D). From the last layers of analyzed leukocytes, we observed that the output features are mainly focused on the nucleus, cytoplasm, and membrane characteristics, elucidating that these cellular features are important in classification. These observations are consistent with the knowledge that subtypes of leukocytes differ in their nuclear, cytoplasmic, and membrane attributes1,2. To explore the cause of classification errors, some mistakenly classified cells are listed out. Apart from the morphological similarities between different cell types, the error could be also caused by the mislabeling in the ground truth dataset (FIG. 10). To determine the optimum numbers of cells for achieving a stable and high detection accuracy, we have analyzed the detection accuracy vs. total number of cells used for training (refer to FIG. 11). It is found that the detection accuracy becomes stable when the training dataset is >800 cells (i.e., >200 cells per type). In this study, we have collected a total of \u02dc2,700 cells with >600 cells in each type for training, which was appropriate for achieving a reliable classification result.",
                                "CD4 and CD8 cells are subtypes of T lymphocytes and have very similar morphological features35. Routine monitoring of CD4/CD8 cell ratio with point-of-care systems helps monitor immunodeficiency related diseases, e.g., acquired immunodeficiency syndrome (AIDS)71,72. The AI-powered platform has the potential to offer a unique approach in which the T cells can be virtually isolated and subtyped while also preserving them for subsequent immunophenotypic analysis. Moreover, such a platform can be expanded to visualize the immunological synapse due to its label-free attributes. We had previously demonstrated the use of QPM in identifying the activation state of CD8 cells in a contrast-free manner33. Building up on our previous study, we conjectured that our QPM can be used for differentiating CD4 and CD8 cells in a label-free manner. To test our hypothesis, we employed our AIRFIHA system on CD4 and CD8 cells from the same blood donor for both training and testing. The classification result is summarized in FIGS. 4F-4H. F1-scores of 80.4% and 77.5% for CD4 and CD8 cells are achieved, respectively (detailed values for recall, precision, and F1 scores are provided in Table). Compared with the F1-scores of 85.7% and 88.8% for CD4 and CD8 cells obtained by using 3D refractive maps35, our preliminary results have a bit lower accuracy. The AUPRC values for CD4 and CD8 cells are 0.78 and 0.84, respectively. Using the t-SNE method, features are extracted from the CD4-CD8 classifier and plotted (FIG. 411) for visualizing the differentiation capability. Our preliminary results show that our method has a basic differentiation capability for these two subtypes of T lymphocytes. The accuracy can be increased by using high volume of data and further tuning of our neural network.",
                                "**Example 4\u2014Cross-Donor and Intra-Donor Validation**",
                                "As for real clinical applications, the blood test samples normally come from new individuals whose blood samples will not be known by our model. There could be variances in the morphological features of leukocytes of each type between different donors, depending on their age, health status, etc73,74. To verify whether such variances exist among our donors, the area and dry mass distributions were plotted for each donor (FIGS. 5A and 5B), from which it was found out that there were indeed distribution differences between donors for certain leukocyte types (note that for several donors the distributions for certain types of leukocytes were missing). Since QPM images were already acquired as a part of another work involving B cell leukemia, the B cells from all the donors were not measured. This partly helped in ensuring that the extraction and subsequent QPM measurement from all the other leukocytes were completed within 3-4 hours of receiving the samples. In any case, there are more than 3 different donors for every leukocytes sample, and this number is sufficient for this investigation. The effect of such differences on the generalization of our model to the new donor was explored. For this purpose, the leukocyte samples from five donors were used for training and the leukocyte samples from the remaining donor was used for testing (>200 cells per type). This experiment was repeated by rotating the testing donor in the same group. The classification result is plotted in FIG. 5C (detailed numerical values are provided in Table 8). The result obtained earlier using all six donors (refer to FIG. 4A) is set as the reference for comparison. As for monocyte and granulocyte, all variances of the 10 tests are less than 0.1. For B lymphocytes only 1 out of 3 tests has variances larger than 0.1, while for T lymphocytes only 1 out of 5 tests has a variance larger than 0.1. The over-all average F1-scores for monocytes, granulocytes, and B and T lymphocytes are 91.6%, 94.3%, 83.7%, and 81.4%, respectively. Notable, the average F1-scores for the B-T lymphocyte classifier of the cascaded-ResNet are 84.1% and 85.9%. This has demonstrated a better accuracy when compared with an earlier work on the classification of B and T lymphocytes, where average F1-scores of 79.4% and 75.7% were obtained, respectively, using bright-field and dark-field imaging cytometry systems48. To further understand the feasibility of our method, we also performed intra-donor analysis to reveal the variations among leukocytes within the same donor (refer to the F1-scores summarized in Table 11). The results show that there are variations within the same donor, albeit mostly small on average. The cross-donor and intra-donor validation results have shown that our method has a high potential for clinical applications.",
                                "**Example 5\u2014Examples of Misclassified Leukocytes**",
                                "It is important to note that our classification results rely on the accuracy of the separation kits used in this study to select the individual sets of leukocytes. We employed flow cytometry (refer to the details in \u201cMaterial and Methods\u201d) to measure the percentage population of the specific leukocytes after isolating them using the corresponding kits and the representative results from a donor are presented in FIG. 12. These negative isolation kits have inherent inaccuracy that can adversely affect the classification results. However, compared with positive selection kits, negative selection kits could better maintain the original cell morphology for our label-free imaging modality, where the morphological attributes form the basis for classification.",
                                "To explore the effect of mislabeled data on the accuracy, we performed data cleaning by removing outliers based on dry mass and area and repeated the above experiments. To perform data cleaning, a leukocyte whose dry mass and area is more than, for example, one standard deviation, two standard deviations, or three standard deviations from the mean of its type is considered as outlier. Data cleaning can also include removing leukocytes that are incorrectly segmented by, for example, removing cells with only half cell bodies and cell clusters. Other methods that can be used to detect the outlier include element 1.5 interquartile ranges above the upper quartile or below the lower quartile, or element more than three scaled median absolute deviation from the median. Data cleaning can occur after producing phase maps for each leukocyte and before network training.",
                                "The results are summarized in Tables 12-18. The accuracy for the experiment with a random chosen test dataset has increase by 2%. And the f1-scores for each type in cross-donor experiment increased by 5% on average. The misclassified samples after data cleaning are shown in FIG. 13. Obviously, the misclassification caused by mislabeling has reduced after data cleaning.",
                                "**Example 6\u2014Results Evaluation and Further Improvements**",
                                "We compared our result with other reported results using different detection/imaging principles, labeling methods, and experiment instruments, as shown in Table 19. AIRFIHA has a significantly improved accuracy when compared with the methods based on negative isolated leukocyte classification64. To a certain extent, the subject methods benefit from the subtle differences in the refractive index maps of intracellular structure as encoded in the quantitative phase maps. For the classification of monocytes, granulocytes, and lymphocytes, the detection accuracy is slightly lower than the methods using positive fluorescence sorting or complicated purification methods36,48,65. It is possible that the negative selection kits have intrinsic lower accuracies in isolating leukocytes when compared with using positive kits, therefore reducing the classification accuracy of the subject methods. If there is a way to sort the leukocytes with higher accuracies without affecting the original morphology states of cells, we expect to further increase the classification accuracy. For the classification of B and T lymphocytes, the subject methods are better than bright and dark field microscopy based methods for the cross-donor validation experiments48. The subject methods' classification accuracy is also comparable with 3D QPM based methods that explore expensive and complex instrumentations (note that no human blood test and cross-donor validation have been carried in such methods so far)35. Notably, both mentioned methods are based on using positive leukocytes extraction methods. As for the classification of CD4 and CD8 cells, the subject methods' classification accuracy is also compared with that obtained using 3D QPM methods35.",
                                "With the capability to differentiate very complex leukocyte types, AIRFIHA can provide more comprehensive information for potential disease diagnoses with simplified testing procedures. There are still ways to improve the detection accuracy of our system, such as improving the phase imaging resolution through synthetic aperture phase imaging method75, deconvolution76, and using 3D-resolved phase maps, preferably captured through a single image acquisition to avoid taking a large amount of data (such method has been recently made possible; a manuscript is under preparation by the authors). The other way to improve accuracy is to expand the dataset and upgrade the neural network model. With these improvements, the generalization capability of our method can also be increased.",
                                "It should be understood that the examples and embodiments described herein are for illustrative purposes only and that various modifications or changes in light thereof will be suggested to persons skilled in the art and are to be included within the spirit and purview of this application and the scope of the appended claims. In addition, any elements or limitations of any invention or embodiment thereof disclosed herein can be combined with any and/or all other elements or limitations (individually or in any combination) or any other invention or embodiment thereof disclosed herein, and all such combinations are contemplated with the scope of the invention without limitation thereto."
                            ],
                            "subsections": [],
                            "outline_long": [
                                "introduce AIRFIHA system",
                                "describe QPM system configuration",
                                "explain imaging resolution and field of view",
                                "describe leukocyte sample preparation",
                                "motivate neural network for classification",
                                "describe phase image dataset construction",
                                "illustrate AIRFIHA system workflow",
                                "describe neural network architecture",
                                "motivate cascaded ResNet structure",
                                "describe ResNet-10 architecture",
                                "explain batch normalization and activation functions",
                                "describe output layer and Softmax activation",
                                "motivate fine-tuning for CD4 and CD8 classification",
                                "describe training and validation of classification model",
                                "evaluate classification results using recall, precision, and F1 score",
                                "describe precision-recall curves",
                                "visualize feature vectors using t-SNE",
                                "compare ResNet with PCA method",
                                "visualize output features of convolutional layers",
                                "analyze classification errors",
                                "determine optimal number of cells for training",
                                "describe potential applications in immunodeficiency disease monitoring",
                                "motivate label-free differentiation of CD4 and CD8 cells",
                                "evaluate CD4 and CD8 classification results",
                                "visualize feature vectors using t-SNE for CD4 and CD8 cells",
                                "describe cross-donor and intra-donor validation experiments",
                                "analyze distribution differences between donors",
                                "evaluate classification results for cross-donor validation",
                                "evaluate classification results for intra-donor validation",
                                "describe importance of accurate separation kits",
                                "motivate data cleaning to remove outliers",
                                "describe data cleaning methods",
                                "evaluate classification results after data cleaning",
                                "compare results with other reported methods",
                                "describe potential improvements using synthetic aperture phase imaging",
                                "describe potential improvements using deconvolution",
                                "describe potential improvements using 3D-resolved phase maps",
                                "motivate expanding dataset and upgrading neural network model",
                                "describe potential applications in disease diagnosis",
                                "conclude with scope of invention"
                            ],
                            "num_characters": 20042,
                            "outline_medium": [
                                "introduce AIRFIHA system",
                                "describe QPM system configuration",
                                "explain leukocyte sample preparation",
                                "describe neural network construction",
                                "illustrate AIRFIHA system workflow",
                                "present phase maps of labeled leukocytes",
                                "analyze area and dry mass distributions",
                                "describe cascaded ResNet structure",
                                "explain two-step classification design",
                                "detail ResNet-10 architecture",
                                "describe training and validation process",
                                "present classification results",
                                "evaluate classification performance",
                                "visualize feature vectors using t-SNE",
                                "compare with PCA method",
                                "analyze classification errors",
                                "determine optimal training dataset size",
                                "describe CD4 and CD8 cell classification",
                                "evaluate cross-donor and intra-donor validation",
                                "discuss results evaluation and further improvements"
                            ],
                            "outline_short": [
                                "introduce AIRFIHA system",
                                "describe QPM system configuration",
                                "motivate neural network for leukocyte classification",
                                "describe ResNet structure for classification",
                                "present classification results",
                                "analyze feature vectors for classification",
                                "discuss limitations of classification accuracy",
                                "validate cross-donor and intra-donor classification",
                                "analyze misclassified leukocytes",
                                "evaluate results and suggest further improvements"
                            ]
                        }
                    ],
                    "outline_long": [
                        "define ranges",
                        "define \"reduction\" and \"increase\"",
                        "define \"comprising\", \"consisting of\", and \"consisting essentially of\"",
                        "define \"or\" and \"a\", \"and\", \"the\"",
                        "define \"about\"",
                        "introduce sample preparation",
                        "describe blood sample collection",
                        "describe sample preparation for leukocyte analysis",
                        "describe leukocyte isolation techniques",
                        "describe flow cytometry for purity confirmation",
                        "describe cell counting and suspension",
                        "describe fluorophore-conjugated antibody addition",
                        "prepare leukocytes for quantitative phase imaging",
                        "describe sample preparation for imaging",
                        "introduce diffraction phase microscopy",
                        "describe quantitative phase microscopy methods",
                        "describe diffraction phase microscopy system",
                        "describe laser illumination",
                        "describe objective lens selection",
                        "describe sample beam processing",
                        "describe diffraction grating and 4f system",
                        "describe interferogram formation",
                        "describe phase image processing",
                        "describe phase retrieval and segmentation",
                        "describe Fourier transform and bandpass filtering",
                        "describe signal shift and inverse Fourier transform",
                        "describe calibration and phase map calculation",
                        "describe phase unwrapping and flattening",
                        "describe cell segmentation algorithm",
                        "describe thresholding and Gaussian filtering",
                        "describe watershed segmentation and contour expansion",
                        "describe cell phase map resizing",
                        "introduce classification model training",
                        "describe artificial neural network construction",
                        "describe residual neural network framework",
                        "describe multiple-step classification routine",
                        "describe first ResNet for monocyte-granulocyte-lymphocyte classification",
                        "describe second ResNet for B-T lymphocyte classification",
                        "describe additional ResNets for granulocyte classification",
                        "describe batch normalization and Rectified Linear Unit activation",
                        "describe average pooling and flatten layer",
                        "describe dense layer and Softmax activation",
                        "describe probability calculation for leukocyte classification",
                        "describe data cleaning and outlier removal",
                        "describe tuning of neural network using precision-recall curve and F1 score",
                        "describe applications of the subject methods"
                    ],
                    "num_characters": 23243,
                    "outline_medium": [
                        "define ranges",
                        "define \"reduction\" and \"increase\"",
                        "define \"comprising\", \"consisting of\", and \"consisting essentially of\"",
                        "define \"or\" and \"a\", \"and\", \"the\"",
                        "define \"about\"",
                        "introduce sample preparation",
                        "describe blood sample collection",
                        "describe sample preparation for leukocyte isolation",
                        "describe leukocyte isolation techniques",
                        "describe flow cytometry for purity confirmation",
                        "describe cell counting and suspension",
                        "introduce quantitative phase imaging",
                        "describe sample preparation for imaging",
                        "describe diffraction phase microscopy",
                        "describe image processing",
                        "describe phase retrieval and segmentation",
                        "introduce classification model training",
                        "describe neural network construction",
                        "describe classification model training process",
                        "describe data cleaning",
                        "describe tuning of neural network",
                        "describe applications of the subject methods",
                        "describe potential integrations and uses of the subject system and methods"
                    ],
                    "outline_short": [
                        "define ranges and shorthand notation",
                        "define \"reduction\" and \"increase\"",
                        "explain transitional terms \"comprising\", \"consisting of\", and \"consisting essentially of\"",
                        "clarify use of \"or\", \"a\", \"and\", and \"the\"",
                        "define \"about\" and its usage",
                        "introduce sample preparation for leukocyte analysis",
                        "describe leukocyte preparation for quantitative phase imaging",
                        "outline diffraction phase microscopy and image processing",
                        "detail classification model training using neural networks",
                        "describe data cleaning and optimization of leukocyte classification models",
                        "discuss applications of the subject methods"
                    ]
                }
            ],
            "outline_long": [],
            "num_characters": 0,
            "outline_medium": [],
            "outline_short": []
        }
    ],
    "claims": [
        "1. A method of classifying information of leukocytes in a sample, the method comprising:\ntraining a neural network according to parameters derived from digitally observed features of known leukocytes;\ntuning the neural network as a function of at least one property of a precision-recall curve and F1 score representing leukocyte classifications of the known leukocytes generated by the neural network based on the digitally observed features;\nconfiguring an imaging device with the trained and tuned neural network to generate data of observed leukocytes;\nstoring the data of observed leukocytes relating to observed leukocytes features; and\nclassifying the data of observed leukocytes into the at least two classes by the trained and tuned neural network based on the observed leukocyte features.",
        "2. The method of claim 1, wherein the neural network is a residual neural network, visual geometry group, inception, AlexNet, fully connected neural network, convolutional neural network, or generative adversarial network (GAN).",
        "3. The method of claim 1, wherein the at least two leukocyte classes are selected from:\ngranulocytes, lymphocytes, monocytes, and subclasses thereof.",
        "4. The method of claim 3, further comprising classifying lymphocytes into at least two subclasses selected from: natural killer cells, B cells, T cells, and subclasses thereof.",
        "5. The method of claim 4, further comprising classifying T cells into at least two subclasses selected from: CD8+ T cells, helper CD4+ T cells, regulatory CD4+ T cells, memory T cells, natural killer T cells, and gamma delta T cells.",
        "6. The method of claim 3, further comprising classifying granulocytes into at least two subclasses selected from: neutrophils, eosinophils, basophils, and mast cells.",
        "7. The method of claim 3, further comprising classifying monocytes into subclasses selected from: dendritic cells and macrophages.",
        "8. The method of claim 1, wherein the trained and tuned neural network is a two-stage neural network.",
        "9. The method of claim 1, wherein the observed features are derived from quantitative phase imaging of the observed leukocytes.",
        "10. The method of claim 9, wherein the quantitative phase imaging is diffraction phase microscopy.",
        "11. The method of claim 1, further comprising generating the precision-recall curve and the F1 score from the known leukocyte types or from the observed leukocytes.",
        "12. The method of claim 1, wherein at least one of the observed features is/are selected from: cell area, cell mass, cell morphology, cell granules, nuclear characteristics, and intracellular protein distributions.",
        "13. The method of claim 1, wherein the neural network comprises 2, 3, or 4 connected networks.",
        "14. The method of claim 1, wherein the digitally observed features of known leukocytes are obtained using data cleaning, whereby outlier values are removed based on dry mass and area.",
        "15. A leukocyte classifying system, the system comprising:\na quantitative phase microscope,\na processor,\na memory coupled to the processor, wherein the memory stores computer-readable instructions that, when executed by the process cause the processor to perform operations comprising:\nidentifying a plurality of leukocyte morphologies; and\nclassifying types of leukocyte by one or more neural network(s) based on the plurality of computed leukocyte morphologies.",
        "16. The method of claim 15, wherein the one or more neural network(s) include a residual neural network, visual geometry group, inception, AlexNet, fully connected neural network, convolutional neural network, or generative adversarial network (GAN).",
        "17. The system of claim 15, wherein the processor further performs operations comprising producing a digital interferogram associated with at least one of target leukocyte.",
        "18. The system of claim 17, wherein the processor further performs operations comprising extracting leukocyte features from the digital interferogram.",
        "19. The system of claim 15, wherein the processor classifies the types of leukocytes according to known classes defined based on known leukocyte morphologies.",
        "20. The system of claim 15, wherein at least one of the leukocyte morphologies is selected from: cell area, cell mass, cell morphology, nucleus characteristics, and intracellular protein distribution.",
        "21. The system of claim 15, wherein the processor is coupled with a classification database storing known leukocyte features correlated with known leukocyte types.",
        "22. The system of claim 21, wherein the known leukocyte types comprise granulocytes, lymphocytes, monocytes, and subclasses thereof.",
        "23. The system of claim 22, wherein the subclasses of lymphocytes are natural killer cells, B cells, T cells, and subclasses thereof.",
        "24. The system of claim 23, wherein the subclasses of T cells are CD8+ T cells, helper CD4+ T cells, regulatory CD4+ T cells, memory T cells, natural killer T cells, and/or gamma delta T cells.",
        "25. The system of claim 22, wherein the subclasses of granulocytes are neutrophils, eosinophils, basophils, and mast cells.",
        "26. The system of claim 22, wherein the subclasses of monocytes are dendritic cells and macrophages.",
        "27. The system of claim 15, wherein the processor classifies the types of leukocytes by a neural network trained according to known leukocyte phase maps.",
        "28. The system of claim 15, wherein the processor classifies the types of leukocytes using a neural network from donors whose leukocytes are not included in the training set.",
        "29. The system of claim 15, wherein the processor classifies the types of leukocytes using a neural network from donors whose leukocytes are included in the training set or from donors whose leukocytes are the only source of the training set."
    ]
}