# INTRODUCTION

The year 2020 marks the Earth's warmest 10-year period with an average increase in global temperature of 1.3 °C above preindustrial levels. Extreme heat and related heat waves put tremendous stress on individuals' health and well-being and limits their ability to work, travel, and socialize in outdoor settings. Globally, extreme heat and associated heat wave events are occurring more frequently and longer (Masson-Delmotte et al., 2021). Future trends of urban warming indicate the need for adaption measures to promote resilience in the population. The outdoor urban environment is a complex arrangement of urban forms and materials that impact how heat is experienced by pedestrians at the microscale. In hot, dry cities pedestrian comfort is strongly dictated by the availability of shade (Middel et al., 2014;Colter et al., 2019). Pedestrian may respond to microscale outdoor conditions by changing their walking path from Sun to shade or vice versa based on their heat exposure.

The most common way to report urban heat is air temperature, which has been shown to be insufficient to quantify personal heat exposure (Harlan et al., 2006;Kuras et al., 2017). A more human-centric metric that emphasizes the heat load on the human body is the Mean Radiant Temperature (MRT). MRT objectively quantifies the total short-and longwave radiation the human body is exposed to at a given location and time (Kántor and Unger, 2011). This includes longwave radiation emitted from surrounding surfaces, such as asphalt parking lots or concrete walls, and shortwave radiation from the Sun. MRT roughly equals air temperature in the shade but can be 30 °C higher in the Sun, making a person feel much less comfortable when it is hot. In warm, dry climates such as the desert city of Phoenix, Arizona in the USA, MRT is the heat metric that best describes how people experience heat (Middel et al., 2016). MRT is also a crucial input parameter for calculating outdoor human thermal comfort indices such as PET (Höppe, 1999) and UTCI (Jendritzky et al., 2012).

MRT has been successfully used in urban climate and human biometeorology research to predict heat-related mortality and outperformed air temperature as predictor (Thorsson et al., 2014). Using computer simulations, MRT was estimated to assess the impact of tree planting strategies on human thermal exposure under climate change in Vancouver, Canada (Aminipouri et al., 2019) and to perform thermal comfort routing in Tempe, Arizona, USA (Middel et al., 2017). Observational studies have quantified the benefit of shade for thermal comfort of different shade types including trees, engineered structures, and urban form (Lee et al., 2018;Middel et al., 2021). Accurate, high resolution MRT measurements require expensive equipment, such as the biometeorological instrument platform MaRTy (Middel and Krayenhoff, 2019), but lower-cost alternatives such as the gray 38 mm globe thermometers and cylindrical thermometers have been developed (Thorsson et al., 2006;Brown, 2019;Vanos et al., 2021).

Active shade management in cities is important, especially in the Southwestern US, to provide shade where people work, travel, and socialize outdoors, because cooling benefits are hyperlocal.

While a large body of literature has investigated shade and microclimate in hot regions (Ali-Toudert and Mayer, 2007;Emmanuel et al., 2007;Shashua-Bar et al., 2009;Coutts et al., 2016), little information exists on how people use public spaces and when and where they are exposed to outdoor heat. We close this gap by developing a novel low-cost, portable, smart IoT weather station (MaRTiny) that can measure passively the local meteorological conditions, the heat exposure at the given location and count people in the shade and Sun. Connecting hyperlocal meteorological conditions with space use data captured by a camera reveals behavioral patterns of shade and Sun preferences that vary by time of day, location, and ambient conditions. MaRTiny, as a passive sensor package, designed for hot, dry climates, can provide local heat exposure, such as MRT, and space use data without using external database.

Our contributions can be summarized as follows:

1. MaRTiny Weather Station-A low-cost and compact IoT weather station that records air temperature, relative humidity, globe temperature, and wind speed at 1-min intervals. Globe temperature was converted to MRT using an empirical model in the literature and compared with highend MRT measurements, resulting in a root mean square error (RMSE) of 10.0 °C for observed 6-directional measurements vs globe temperature measurements. 2. MaRTiny Vision System-A low-cost, low-powered, compact and smart vision system driven by state-of-the-art AI algorithms. This system counts pedestrian and is also capable of identifying if a pedestrian is under the cooling effect of shade. From our observations, we calculate a precision of 95% for pedestrian detection and an accuracy of 80% for shade detection. 3. Machine Learning based MRT-We developed a novel machine learning model that relies only on a few meteorological parameters and is robust to changes in its surrounding environment. This model corrects errors introduced by the low-cost IoT sensor, such as slow response time, shape, color and material inconsistencies, etc., and predicts MRT with an accuracy of RMSE = 4 °C.

This research paper is focused on the engineering and development of a low-cost, portable IoT weather stations for MRT measurement. The study does not focus on a large-scale scientific study of human exposure in outdoor spaces, but rather the engineering and data science challenges of estimating MRT with a combined hardware-software system.

# BACKGROUND AND RELATED WORK

## Mean Radiant Temperature Sensing

MRT is typically determined with integral radiation measurements using the so-called 6-directional method (Höppe, 1992). Three net radiometers are orthogonally setup to measure the longwave and shortwave radiation in six directions. The radiative fluxes are then summarized into a temperature value using the Stefan-Boltzmann Law:

where K i and L i are the directional shortwave and longwave radiation fluxes, respectively; a k and a l are absorption coefficients for short-and long wave radiation fluxes, respectively; σ is the Stefan-Boltzmann constant; and W i are factors that weigh the directional fluxes to match the cylindrical shape of the human standing body (0.06 is used for sensors pointing up and down, 0.22 for lateral sensors). This method is limited by cost with three net radiometers that cost $5k each.

A more affordable but less accurate method to estimate MRT is using a black globe thermometer. Globe thermometers such as the Kestrel Heat Stress meter ($500) have been used to quantify the heat load of pedestrians, athletes, and outdoor workers in various studies (Johansson et al., 2014). Thorsson et al. (2006) developed a low-cost globe thermometer using a thermocouple in a gray ping pong ball ( < $100). The acrylic gray color of the globe almost matches the average albedo of the combination of the human skin and clothing to reliably estimate MRT (Olesen et al., 1989;Thorsson et al., 2006). Albedo variations based on clothing and skin color are large between people and cannot simply be represented by one color alone, hence this gray globe can provide an accurate estimate for the average combined albedo which can be used as a reference.

Various convection coefficients have been developed for globe thermometers to improve MRT estimations from globe temperature (Oliveira et al., 2019;Manavvi and Rajasekar, 2020;Acero et al., 2021;Alfano et al., 2021). Those coefficients are usually derived under specific outdoor conditions and cannot be generalized easily. Here, we will use an empirical model for acrylic gray globe temperature T g developed by Vanos et al. (2021) 

## Pedestrian Counting

Much research has been developed for pedestrian counting and crowd estimation. Sensor-based techniques (Zappi et al., 2010;Wahl et al., 2012;Raykov et al., 2016;Lau et al., 2018) (Chen et al., 2013(Chen et al., , 2012)), such as Haar cascade (Viola and Jones, 2001) and HOG (Histogram of Oriented Gradient) (Dalal and Triggs, 2005;Yao et al., 2020) combined with regression models like SVM (Support Vector Machine) (Yao et al., 2020) or detectors like AdaBoost (Viola and Snow, 2003). State-of-the-art methods leverage deep convolutional neural networks for crowd estimation using individual detection (Wu and Nevatia, 2005;Brostow and Cipolla, 2006;Wang and Wang, 2011;Stewart et al., 2016;Liu et al., 2019) and using perspective maps (Chan et al., 2008;Lempitsky and Zisserman, 2010;Zhang et al., 2015).

Further, there are works revolving around analysis of crowd behaviour in urban areas (Hoogendoorn and Bovy, 2004;Hashimoto et al., 2016;Lee, 2020) and their relation with thermal comfort (Arens and Bosselmann, 1989;Givoni et al., 2003;Eliasson et al., 2007;Eom and Nishihori, 2021). We do not aim to outperform any existing pedestrian counting techniques, but to combine them with a weather station as a single setup.

## Research Gaps

In summary, thermal exposure measurements in tandem with public space use assessments are crucial for active shade management in cities, but accurate MRT measurement setups are expensive and bulky. Low-cost systems such as gray globe thermometers have been developed but are not connected to the cloud for easy data storage and analysis. In addition, such low-cost sensors can suffer from overand under-estimation of MRT at various times of the day as noted in previous literature. None of the existing MRT sensing platforms have vision capabilities, and space use is often assessed through timeconsuming manual observations. Finally, physics-based MRT models require detailed 3D data of the urban environment to model radiation flux densities and sun-exposure. Our MaRTiny system aims to address all these gaps.

# SYSTEM OVERVIEW

The MaRTiny system is a compact, Internet-of-Things (IoT), low-cost sensing and vision/recording/surveying platform (see Figure 1). Its primary functionality is to measure MRT for a given sun-exposed location using off-the-shelf meteorological sensors and a custom-made globe thermometer. MaRTiny measures air temperature, relative humidity, wind speed, and globe temperature, which are used to calculate MRT (see Eq. ( 2)). In addition, MaRTiny is outfitted with a camera to detect and count people in the shade and Sun. This data helps analyze pedestrian behavior in public spaces (e.g. identifying the number of people who utilize shade, umbrella, bicycles and transportation etc). Privacy is preserved by only storing quantitative metrics (e.g. pedestrian count) and discarding the captured images after analysis.

The entire system transmits data to a cloud database via WiFi. It is powered by a single power source of 20 W which is split among different components according to their power ratings. MaRTiny was built under $200 using different micro-controllers and AI edge devices. MaRTiny is envisioned to be a useful scientific platform to capture MRT data and correlate it with pedestrian behavior in outdoor settings at a fraction of the size/ cost of existing solutions. No active human labor is needed for data collection which helps save funds, time, and heat exposure for researchers.

## MaRTiny Weather Station

MaRTiny has four types of sensors to collect meteorological data every minute-multiple temperature probes/thermometers, UV sensor, humidity sensor, and anemometer (wind speed sensor) (see Figure 2 and Table 1 and Table 2 for details). Two temperature probes are utilized for globe and air temperature respectively. Globe temperature is measured using a gray pingpong ball attached on top of its probe. The globe's gray color almost matches the albedo of the human skin. The globe thermometer and the derived MRT emulate the omnidirectional thermal exposure for a human body as a function of radiation, air temperature, and velocity, and thus are an accurate low-cost solution to net radiometers (Thorsson et al., 2006). Air temperature is measured using a downward hanging white cup that shades the attached temperature probe. The white cup reflects most of the solar radiation instead of absorbing it to provide an air temperature "free" from the influence of solar radiations. The UV sensor is used to measure the UV intensity and train the machine learning model to estimate MRT based on all measured parameters. MaRTiny is powered by a DC adapter of 5V/4A, which is shared by both systems (weather station and vision system). The anemometer is supplied with 9 V power by stepping up the primary voltage source. This setup can be easily scaled with more sensors without compromising on space and power. In practice, low-cost sensors are subject to noise and variation, which can yield errors in MRT estimation using Eq. ( 2) as we show later in Section 5. To solve this problem, we introduce a machine learning model to robustly estimate MRT despite these inaccuracies.

## MaRTiny Vision

Along with meteorological parameters, MaRTiny requires vision capabilities including object detection and identification as well as shade detection in outdoor areas. We leverage the NVIDIA Jetson Nano, a low-cost and low-powered edge device to run state-ofthe-art deep learning models. The Jetson Nano features an ARMbased micro-processor built with a Nvidia V100 GPU programmed through Nvidia's low level API TensorRT engine. It has configurable power consumption modes of 5W and 10 W. As we perform computationally heavy tasks, we have configured the Jetson Nano to 10 W mode. To capture video, we utilize a compact MIPI (Mobile Industry Processor Interface) camera and stream the data to the Jetson Nano using a gstreamer pipeline. Vision data is sent to AWS via an external USB WiFi on-board. In the next section, we describe in detail our deep learning networks to detect pedestrians in shade.

## Data Logging and Communication

To read meteorological sensor data, we use an Arduino Uno microcontroller. The Uno board communicates with a NodeMCU micro-controller featuring an ESP8266 architecture that has an inbuilt WiFi module, flash memory, and supports the PEM (Privacy Enhanced Mail) file system (see Figure 2). Sensor data are continuously read in a loop by the Uno with a small 1 ms delay to avoid overheating. Data are collected in a buffer, and an average is calculated for every minute, which is then transmitted to the NodeMCU board. The Uno acquires around 80 readings per minute. Both boards communicate via the serial communication protocol UART (universal Asynchronus Receiver/Transmitter).

The NodeMCU communicates securely with the online database. We utilize AWS DynamoDB, a NoSQL flexible database that can handle unstructured data. All the necessary security PEM files are stored in the NodeMCU's flash memory for authentication of MaRTiny. Using these files, NodeMCU establishes a communication path with AWS through the MQTT protocol, an extremely lightweight publish/subscribe messaging protocol designed for IoT. Once the communication is established, Node MCU waits for bytes of data to be received from the Uno board. Sensor data collected by Uno is sent to NodeMCU via serial communication every minute, which is then transmitted to DynamoDB using the MQTT protocol.

# MACHINE LEARNING ALGORITHM DEVELOPMENT 4.1 Machine Learning for Accurate MRT Estimation

As MaRTiny is a low-cost, compact alternative to the MaRTy sensing platform (Middel and Krayenhoff, 2019;Middel et al., 2020Middel et al., , 2021)), the replacement of highly accurate sensors has drawbacks including less accuracy and sensor lag (Häb et al., 2015). We noticed these inaccuracies caused serious errors in the calculated MRT values (Figure 7). In particular, MRT was sensitive to the positioning and orientation of the MaRTiny relative to MaRTy (e.g the MaRTiny was shaded in one of the  test, which resulted in lower MRT values, while MaRTy's net radiometers were partially sun-exposed).

To overcome this limitation, we formulate MRT estimation as a supervised learning problem. This requires labeled groundtruth MRT values to be provided in correspondence with our less robust meteorological sensor data. In Section 5, we discuss data collection consisting of paired MaRTy and MaRTiny measurements to create this labeled data. This allows us to train a machine learning model to estimate MRT accurately from MaRTiny sensor data. We explored both traditional machine learning methods using a support vector machine (SVM) as well as a deep learning-based artifical neural network. These two algorithms are versatile and well-known in machine learning as they satisfy universal approximation theorems (Cybenko, 1989;Hammer and Gersmann, 2002). In particular, we observed an SVM with RBF (Radial Basis Function) kernel achieved the highest accuracy on our evaluation dataset in Section 5. This method is also computationally lightweight and can be easily deployed on the Jetson Nano for performing inference, i.e. the process of using a trained machine learning algorithm to make a prediction.

## People and Shade Detection

### Shadow Detection

To perform shadow detection in an image, we use the deep learning model Bi-directional Feature Pyramid with Recurrent Attention Residual Modules (BDRAR) (Zhu et al., 2018), visualized in the upper branch of Figure 3. BDRAR network takes a single image as input and outputs a binary shadow map as output in an end-to-end manner. First, it leverages a convolutional neural network (CNN) to extract feature maps at different spatial resolutions. It then employs two series of recurrent attention residual modules to fully exploit global and local context for these feature maps. The features captured by shallow layers exploit shadow details in the local regions and the features captured by deep layers understands the overall shadow region of the image. Figure 4 provides an example of shadow maps produced by the network.

### Object Detection

For object detection, we utilize the state-of-the-art YOLOv3 network (AlexyAB, 2016) visualized in the lower branch of Figure 3. The model is trained on 80 different classes of the Microsoft COCO dataset. The YOLOv3 algorithm can be built using two different frameworks -DarkNet and MobileNet (Redmon et al., 2016). The MobileNet framework is computationally light but has low accuracy, hence we decided to use the Darknet framework. YOLOv3 has a mAP (mean Average purpose) of around 57 (Redmon and Farhadi, 2018) and has been proven to be efficient in crowd places (Hsu et al., 2020). Since the YOLOv3-darknet model is large and computationally expensive to run on the NVIDIA Jetson Nano, we converted it into a simple neural graph using Nvidia's TensorRT. This allowed the model to run successfully on the Nano with a application-sufficient frame-rate of 4fps.

### Pedestrian in Shade Detection

An image is a 2D representation of the 3D world, so it is difficult to determine the exact location of a pedestrian on the ground and their distance from the camera. We introduce a simple approach to identify pedestrians in shade without determining their position in 3D space. First, a binary shadow map from BDRAR indicating the presence of shade per pixel is computed periodically (in our case, every 15 min as shade does not vary significantly). For every MIPI camera frame, YOLOv3 outputs objects with their bounding boxes consisting of pixel coordinates for the corners. Our algorithm calculates the IOU (Intersection over Union) of the bounding box with the shade map. We consider a person to be in shade if 40% of the bounding box region is inside the shade map (i.e. IOU = 0.4).

Calculating IOU without considering the pedestrian's position with respect to shade can lead to errors. For example, in Figure 5, one person is sun-exposed and the other person is in the shade. The IOU of the bounding box with the shadow map equals 60% in the first case and 40% in the second case. The IOU for the first case is high due to background shade and shadow cast by the person's body. This is the most common type of error that occurs at different orientations of a person; therefore, it is necessary to distinguish between shade from a person and shade from the surroundings. Our algorithm first checks if the bounding box edge is in the shade. A person does not have to be completely in shade to feel the cooling effect, hence we consider only the bottom half i.e. 50% of the bounding box as a ROI (Region of Interest). We then calculate the IOU between this region and the shadow map. An IOU of 80% (which implies an IOU of 40% of the complete bounding box) is considered as the optimum value for a person to experience the cooling effects of shade. The ROI and IOU can change based on the environment and application. Pedestrian count under Sun and shade along with other relevant counts (umbrellas, pets, and bicycles) are reported to the online database, and the frame with identifying features is discarded. This allows our device to preserve the privacy of the individuals being observed which is necessary for public deployment.

# SYSTEM EVALUATION

## Data Collection

For evaluation, we collected a custom dataset of ground truth MRT values for two sun-exposed outdoor locations for 3 days in Tempe, Arizona, United States. For validation purposes, the MaRTy human-biometeorological platform (Middel and Krayenhoff, 2019) was paired with the MaRTiny system for simultaneous data logging. Figure 6 illustrates the paired setup, the top box corresponding to MaRTiny and the bottom setup corresponds to MaRTy. We can clearly see the difference in scale between both the setups. In addition, an image dataset was collected for evaluating object and shade detection. Images from the MIPI camera were stored at random intervals along with the bounding boxes of the interested objects. Ground truth bounding boxes were drawn manually using tools such as AlexyAB, (2016); Tosmonav, (2020) for 30 images consisting of around 50 different objects. Precision and Recall for each object were calculated and then used to calculate mAP (mean Average Precision). The same images were used to evaluate shade detection using IOU (Intersection Over Union) metrics. Small video snippets were stored at random intervals which helped to cross-verify the number of people in a given time frame. All the images and videos were stored in an AWS S3 bucket and were deleted after testing.

## MRT Estimation

We first evaluated the performance of MaRTiny in estimating MRT values. We utilize Eq. 2 with the sensor data on-board to calculate MRT. MaRTy logs data every 2 s, and MaRTiny stores data every minute, hence we calculated 1-min averages for comparison. Ground truth MRT was calculated using Eq. 1.

Figure 7 shows MaRTiny MRT results in green and MaRTy's ground truth calculation in red. A significant error in MaRTiny's estimation of MRT was found in the mornings with an MSE of around 10 °C. The error is due to the spatial offset between the two devices, which caused the gray globe thermometer of the MaRTiny sensor to be partially shaded by a nearby palm tree in the mornings while MaRTy's net radiometers were sunexposed. A palm tree has a narrow shadow pattern covering only portions of the whole MaRTy and MaRTiny setup (see  To overcome these issues, we utilized our supervised learning approach using both SVM and ANN. Machine learning models were trained on selected meteorological parameters -air temperature, globe temperature, humidity and UV intensity, which were comparatively more accurate and less prone to noise. We used around 12,000 data points for training and 3,000 for testing from a range of dates, times, and locations in the sensing period. These training points were fed as vectors into the scikit-learn package in Python for training SVMs and ANNs. 5-fold cross-validation was used to tune model hyperparameters such as learning rate. A separate dataset for evaluation consisted of around 700 data points from a single location collected in a day as is the usual application for this algorithm.

Since there is a non-linear relation of globe temperature and air temperature with MRT given in Eq. 2, machine learning models need to understand complex non-linear relations between these parameters. A SVM with RBF kernel and a neural network with ReLU (Rectified Linear Unit) activation function are example of such models. In Table 3, we present a comparison of SVMs with three different kernels and a traditional artificial neural network (ANN). We report the Root Mean Square Error (RMSE) for both the testing and evaluation datasets. Note that the results of linear and polynomial SVM kernels justify our earlier assumption and the results of SVM with RBF kernel as well as the ANN achieved the best performance in quantitative metrics. From Figure 8 we can see the performance of SVM with RBF kernel, which is almost linear with the ground truth.

We trained our ANN on a i7 CPU. We set our learning rate α to 0.001, which took around 5 min and 300 epochs to converge.  Although this model performs slightly better on the test dataset than the SVM-RBF model, performance is identical on the evaluation dataset. The SVM model is also computationally lighter and can be easily trained and deployed on edge devices such as Jetson Nano.

## Shade and Object Detection

For object detection, we leverage the YOLOv3 architecture (Redmon and Farhadi, 2018). While not a state-of-the-art object detector, this model is computationally lightweight in comparison to more modern object detection models. Further, the object detector needed to be compatible with both the TensorRT engine which we utilize on the NVIDIA Jetson board as well as the Python dependencies and packages necessary to run BDRAR as well as itself. Future research could investigate the optimal choice of object detector with shade detection (or a joint-model) for enhanced application performance. Although the model is out-of-box, we wanted to evaluate its performance in the environment suitable for the MaRTiny device and hence, we collected a small custom dataset and evaluated performance on these images. This evaluation on custom dataset should only be considered as a secondary evaluation while we still refer the reader to the main evaluation mentioned in the original study (Redmon and Farhadi, 2018) for the full performance of the object detector.

The standard evaluation metric used for any object detection is mAP (mean Average Precision). Bounding boxes were manually drawn using the tool for the dataset consisting of 30 images and IOU was calculated with the bounding boxes predicted by our model. Precision and recall is calculated for a series of different IOU thresholds ranging from 0.5 to 0.95. A precision-recall graph is constructed and the area under this graph provides us the mAP value of around 55%, which is close to the value reported in their study (Redmon and Farhadi, 2018). For our application IOU threshold of 0.5 gives us the optimal results. We also achieved an Average Precision of more than 85% for the class of Pedestrian, which is important for our application (Figure 9).

Evaluation of shadow detection is done on a per pixel basis, which is a binary evaluation method. A dataset consisting of 30 shade images was collected from different location and time. We manually annotated these images using the tool Tosmonav, (2020). We use the pre-trained BDRAR model to evaluate these images and calculated IOU of the shadow map with the ground truth and found a precision of 90%. This is not the most effective method to calculate model accuracy due to the irregular shapes, human error in annotation and small dataset and hence we also refer readers to the evaluation metrics of the original paper (Zhu et al., 2018). We evaluate our pedestrian in shade detection algorithm on a custom dataset of 50 images collected using MaRTiny. We have manually compared the detected values from our   algorithm with the ground truth and plotted a confusion matrix to obtain an accuracy of around 80%. Test data consisted of different shading effects and relative positions of pedestrian. Since this kind of testing has not been carried out before, our result can act as a baseline for future tests. The accuracy can be improved on edge cases where pedestrian is partially exposed to Sun at different orientations. 

# DISCUSSION AND LIMITATIONS

This systems engineering study introduced a novel low-cost device that combines meteorological sensing with computer vision to estimate MRT and space use. While previous work has mainly focused on assessing the accuracy and precision of various sensors and on advancing MRT simulation tools, our contribution focuses on developing a low-cost hardware and software setup that can be used by non-experts such as city staff and citizen scientists. We also explored the use of state-of-  the-art machine learning techniques to improve MRT estimation from low-cost sensors. This article introduces the setup of the novel MaRTiny system to monitor biometeorological conditions and people's use of public spaces with changing weather conditions. An empirical study must follow to collect robust data over a long period of time to systematically analyze the relationship between thermal conditions and space usage. In addition, the MaRTiny biometeorological setup must be fully calibrated against NIST certified sensors before deployment, as it is built using off-theshelf sensors with low accuracy (see Table 2).

While an RMSE of 10 °C between 6-directional MRT observations and globe temperature derived MRT may seem large, it is on the order of magnitude of errors reported by other authors and quite common for outdoor MRT measurements in heterogeneous built environments. Acero et al. (2021) found an RMSE of 7.4 °C for the standard ISO7726 coefficient between the 6-directional setup and a standard black globe. Vanos et al. (2021) found an average difference of -1.6 ± 7.2 °C between an acrylic gray globe and integral radiation measurements on a solar roof that was not subject to shading from the surrounding built environment. Most recently, Lee et al. (2022) reported a large mean difference of 13.2-21.6 °C on sunny days between globe thermometer MRT and traditional MRT measurements.

Globe thermometers have various shortcomings, mostly related to the indirect measurement of incident radiative fluxes, which is highly sensitive to globe size, shape, material properties/assumptions, color, and wind speed (Vanos et al., 2021). Guo et al. (2018) and Chen et al. (2014) found significant impacts of wind speed on MRT obtained from globe thermometers, and Teitelbaum et al. (2020) point to errors from free convection. Globe thermometers also have a long response time (Nikolopoulou et al., 1999) that grows with globe diameter. MaRTinies are operated in stationary settings, which reduces the error, but they will not be able to respond quickly to changing cloud conditions. Lastly, globe thermometers are known to overestimate MRT during high incoming solar radiation periods and an underestimate at low solar elevation (Thorsson et al., 2006;Acero and Herranz-Pascual, 2015;Vanos et al., 2021).

The presented machine learning model is a proof-of-concept and is not a reliable MRT predictor in its current state. Our work demonstrates the potential of SVM models for MRT estimation but requires future data collection with identical micrometeorological conditions for all sensors, ideally for a full year, to build a robust model. The RMSE we calculated for our two testing days is high due to a palm tree that shaded the globe thermometer during the morning hours. RMSE is < 4 °C when the morning hours are discarded. We included those hours in our proof-of-concept to illustrate that a SVM model can overcome errors that are introduced by sensor setup. However, for a robust SVM model that can be used in a scientific study, all sensors should be subject to the same micrometeorological (shading) conditions.

With respect to the vision system, the BDRAR network exhibits minor inaccuracies in the shadow map estimation and Yolov3. Although it performs well when detecting pedestrians in crowds, it struggles when an individual person occludes another person in the video feed. The shade detection works well but can misclassify a person as shaded or sun-exposed when intersecting the position of a person with the shadow mask, because the algorithm does not take into account the 3-dimensional nature of the shade and person in the scene.

# CONCLUSION

Advancements in sensor technology have led to smaller, more portable, and more affordable sensors that facilitate low-cost sensing for many applications. In the domain of urban climate, low-cost sensing has gained popularity for crowdsourcing and citizen science studies, but is also increasingly used to build IoT sensor networks, for example, to monitor air pollution (Xiaojun et al., 2015) or thermal conditions in occupational settings (Sulzer et al., 2022).

MaRTiny leverages edge devices that are low-cost, lowpowered, and yet computationally capable of running state-ofthe-art machine learning algorithms. Integrating a vision system and people detection into the biometeorological sensing system enables in-depth analyses of how weather and microclimate conditions impact people's walking behavior in public spaces, including the use of shaded and sun-exposed areas. Once calibrated, the system will be deployed in City of Tempe parks and at playgrounds to inform municipal decision-making on targeted investments for cooling infrastructure in public spaces. The MaRTiny system is an example of how the emerging field of Urban Climate Informatics can support heat mitigation efforts through non-traditional observational methodologies. 

# FUNDING

This research was funded by the National Science Foundation (NSF), grant number CMMI-1942805 (CAREER: Human

# DATA AVAILABILITY STATEMENT

The raw data supporting the conclusions of this article will be made available by the authors, without undue reservation.

# AUTHOR CONTRIBUTIONS

KK designed and built the system, designed the algorithms and software, analyzed data from experiments, and helped write and edit the manuscript. FS assisted with hardware prototyping and data collection for both the MaRTiny and MaRTy setups as well as writing/revising the paper. TG helped with initial project discussions/conception. SJ helped supervise the project especially with machine learning and computer vision algorithms and helped write and edit the paper. AM conceived of the project idea, supervised the project, and helped write and edit the paper.

# Conflict of Interest:

The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.

Publisher's Note: All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated organizations, or those of the publisher, the editors and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher.

Copyright © 2022 Kulkarni, Schneider, Gowda, Jayasuriya and Middel. This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.

