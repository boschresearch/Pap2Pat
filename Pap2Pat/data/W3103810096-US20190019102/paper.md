# I. INTRODUCTION

Universal and efficient simulation of physical systems [1] is among the most compelling applications of quantum computing. In particular, quantum simulation of molecular energies [2], which enables numerically exact prediction of chemical reaction rates, promises significant advances in our understanding of chemistry and could enable in silico design of new catalysts, pharmaceuticals, and materials. As scalable quantum hardware becomes increasingly viable [3][4][5][6][7], chemistry simulation has attracted significant attention , since classically intractable molecules require a relatively modest number of qubits and because solutions have commercial value associated with their chemical applications [29].

The fundamental challenge in building a quantum computer is realizing high-fidelity operations in a scalable architecture [30]. Superconducting qubits have made rapid progress in recent years [3][4][5][6] and can be fabricated in microchip foundries and manufactured at scale [31]. Recent experiments have shown logic gate fidelities at the threshold required for quantum error correction [3] and dynamical suppression of bit-flip errors [4]. Here, we use the device reported in Refs. [4,7,32] to implement and compare two quantum algorithms for chemistry. We have previously characterized our hardware using randomized benchmarking [4] but related metrics (e.g., fidelities) only loosely bound how well our devices can simulate molecular energies. Thus, studying the performance of hardware on small instances of real problems is an important way to measure progress towards viable quantum computing.

Our first experiment demonstrates the recently proposed variational quantum eigensolver (VQE), introduced in Ref. [19]. Our VQE experiment achieves chemical accuracy and is the first scalable quantum simulation of molecular energies performed on quantum hardware, in the sense that our algorithm is efficient and does not benefit from exponentially costly precompilation [33]. When implemented using a unitary coupled cluster (UCC) ansatz, VQE cannot be efficiently simulated classically, and empirical evidence suggests that answers are accurate enough to predict chemical rates [19][20][21][22][23]. Because VQE only requires short state preparation and measurement sequences, it has been suggested that classically intractable computations might be possible using VQE without the overhead of error correction [22,23]. Our experiments substantiate this notion; the robustness of the VQE to systematic device errors allows the experiment to achieve chemical accuracy.

Our second experiment realizes the original algorithm for the quantum simulation of chemistry, introduced in Ref. [2]. This approach involves Trotterized simulation [34] and the quantum phase estimation algorithm (PEA) [35]. We experimentally perform this entire algorithm, including both key components, for the first time. While PEA has asymptotically better scaling in terms of precision than VQE, long and coherent gate sequences are required for its accurate implementation.

The phase estimation component of the canonical quantum chemistry algorithm has been demonstrated in a photonic system [36], a nuclear magnetic resonance system [37], and a nitrogen-vacancy center system [38]. While all three experiments obtained molecular energies to incredibly high precision, none of the experiments implemented the propagator in a scalable fashion (e.g., using Trotterization), as doing so requires long coherent evolutions. Furthermore, none of these experiments used more than a single qubit or qutrit to represent the entire molecule. This was possible due to the use of the configuration basis, which is not scalable but renders the experimental challenge much easier. Furthermore, all of these implementations applied the logic gates with a single, totally controlled pulse, as opposed to compiling the algorithm to a universal set of gates as we do.

There have been two previous experimental demonstrations of VQE, first in a photonic system [19] and later in an ion trap [39]. Both experiments validated the variational approach, and the latter implemented an ansatz based on unitary coupled cluster. All prior experiments focused on either molecular hydrogen [36,37] or helium hydride [19,38,39], but none of these prior experiments employed a scalable qubit representation such as second quantization. Instead, all five prior experiments represent the Hamiltonian in a configuration basis that cannot be efficiently decomposed as a sum of local Hamiltonians, and then exponentiate this exponentially large matrix as a classical preprocessing step [19,[36][37][38][39].

Until this work, important aspects of scalable chemistry simulation such as the Jordan-Wigner transformation [40] or the Bravyi-Kitaev transformation [41,42] had never been used to represent a molecule in an experiment; however, prior experiments such as Ref. [7] have previously used the Jordan-Wigner representation to simulate fermions on a lattice. In both experiments presented here, we simulate the dissociation of molecular hydrogen in the minimal basis of Hartree-Fock orbitals, represented using the Bravyi-Kitaev transformation of the second quantized molecular Hamiltonian [17]. As shown in Appendix A, the molecular hydrogen Hamiltonian can be scalably written as

where fX i ; Z i ; Y i g denote Pauli matrices acting on the ith qubit and the real scalars fg γ g are efficiently computable functions of the hydrogen-hydrogen bond length R.

The ground-state energy of Eq. ( 1) as a function of R defines an energy surface. Such energy surfaces are used to compute chemical reaction rates which are exponentially sensitive to changes in energy. If accurate energy surfaces are obtained, one can use established methods such as classical Monte Carlo or molecular dynamics simulations to obtain accurate free energies, which provide the rates directly via the Erying equation [43]. At room temperature, a relative error in energy of 1.6 × 10 -3 hartree (1 kcal/mol or 0.043 eV) translates to a chemical rate that differs from the true value by an order of magnitude; therefore, 1.6 × 10 -3 hartree is known as "chemical accuracy" [43]. Our goal, then, is to compute the lowest energy eigenvalues of Eq. ( 1) as a function of R, to within chemical accuracy.

# II. VARIATIONAL QUANTUM EIGENSOLVER

Many popular classical approximation methods for the electronic structure problem involve optimizing a parametrized guess wave function (known as an "ansatz") according to the variational principle [43]. If we parametrize an ansatz jφð θÞi by the vector θ, then the variational principle holds that hφð θÞjHjφð θÞi

where E 0 is the smallest eigenvalue of the Hamiltonian H.

Accordingly, E 0 can be estimated by selecting the parameters θ that minimize the left-hand side of Eq. ( 2). While the ground-state wave function is likely to be in superposition over an exponential number of states in the basis of molecular orbitals, most classical approaches restrict the ansatz to the support of polynomially many basis elements due to memory limitations. However, quantum circuits can prepare entangled states, which are not known to be efficiently representable classically. In VQE, the state jφð θÞi is parametrized by the action of a quantum circuit Uð θÞ on an initial state jϕi; i.e., jφð θÞi ≡ Uð θÞjϕi. Even if jϕi is a simple product state and Uð θÞ is a very shallow circuit, jφð θÞi can contain complex many-body correlations and span an exponential number of standard basis states.

We can express the mapping Uð θÞ as a concatenation of parametrized quantum gates, U 1 ðθ 1 ÞU 2 ðθ 2 Þ…U n ðθ n Þ. In this work, we parametrize our circuit according to unitary coupled cluster theory [20,22,23]. As described in Appendix D, unitary coupled cluster theory predicts that the ground state of Eq. ( 1) can be expressed as

where jϕi ¼ j01i is the Hartree-Fock (mean-field) state of molecular hydrogen in the representation of Eq. (1). As discussed in Appendix D, unitary coupled cluster theory is widely believed to be classically intractable and is known to be strictly more powerful than the "gold standard" of classical electronic structure theory, coupled cluster theory [43][44][45][46]. The gate model circuit that performs this unitary mapping is shown in the software section of Fig. 1. VQE solves for the parameter vector θ with a classical optimization routine. One first prepares an initial ansatz jφð θ0 Þi and then estimates the ansatz energy Eð θ0 Þ by measuring the expectation values of each term in Eq. (1) and summing these values together as

where the g γ are scalars and the H γ are local Hamiltonians as in Eq. ( 1). The initial guess θ0 and the corresponding objective value Eð θ0 Þ are then fed to a classical greedy minimization routine (e.g., gradient descent), which then suggests a new setting of the parameters θ1 . The energy Eð θ1 Þ is then measured and returned to the classical outer loop. This continues for m iterations until the energy converges to a minimum value Eð θm Þ, which represents the VQE approximation to E 0 . Because our experiment requires only a single variational parameter, as in Eq. (3), we elect to scan 1000 different values of θ ∈ ½-π; πÞ in order to obtain expectation values that define the entire potential energy curve. We do this to simplify the classical feedback routine but at the cost of needing slightly more experimental trials. These expectation values are shown in Fig. 2(a) and the corresponding energy surfaces at different bond lengths are shown in Fig. 2(b). The energy surface in Fig. 2(b) is locally optimized at each bond length to emulate an on-thefly implementation.

Figure 3(a) shows the exact and experimentally determined energies of molecular hydrogen at different bond lengths. The minimum energy bond length (R ¼ 0.72 Å) corresponds to the equilibrium bond length, whereas the asymptote on the right-hand part of the curve corresponds to dissociation into two hydrogen atoms. The energy difference between these points is the dissociation energy, and the exponential of this quantity determines the chemical dissociation rate. Our VQE experiment correctly predicts this quantity with an error of ð8 AE 5Þ × 10 -4 hartree, which is below the chemical accuracy threshold. Error bars FIG. 1. Hardware and software schematic of the variational quantum eigensolver. (Hardware) micrograph shows two Xmon transmon qubits and microwave pulse sequences to perform single-qubit rotations (thick lines), dc pulses for two-qubit entangling gates (dashed lines), and microwave spectroscopy tones for qubit measurements (thin lines). (Software) quantum circuit diagram shows preparation of the Hartree-Fock state, followed by application of the unitary coupled cluster ansatz in Eq. ( 3) and efficient partial tomography (R t ) to measure the expectation values in Eq. (1). Finally, the total energy is computed according to Eq. ( 4) and provided to a classical optimizer which suggests new parameters. are computed with Gaussian process regression [47], which interpolates the energy surface based on local errors from the shot-noise-limited expectation value measurements in Fig. 2(a).

Errors in our simulation as a function of R are shown in Fig. 3(b). The curve in Fig. 3(b) becomes nearly flat past R ¼ 2.5 Å because the same angle is experimentally chosen for each R past this point. Note that the experimental energies are always greater than or equal to the exact energies due to the variational principle. Figure 3(b) shows that VQE has substantial robustness to systematic errors. While this possibility had been previously hypothesized [23], we report the first experimental signature of robustness and show that it allows for a successful computation of the dissociation energy. By performing (inefficient) classical simulations of the circuit in Fig. 1, we identify the theoretically optimal value of θ at each R. In fact, for this system, at every value of R there exists θ such that EðθÞ ¼ E 0 . However, due to experimental error, the theoretically optimal value of θ differs substantially from the experimentally optimal value of θ. This can be seen in Fig. 3(b) from the large discrepancy between the green diamonds (experimental energy errors at theoretically optimal θ) and the red dots (experimental energy errors at experimentally optimal θ). The experimental energy curve at theoretically optimal θ shows an error in the dissociation energy of 1.1 × 10 -2 hartree, which is more than an order of magnitude worse. One could anticipate this discrepancy by looking at the raw data in Fig. 2(a), which shows that the experimentally measured expectation values deviate considerably from the predictions of theory. In a sense, the green diamonds in Fig. 3(b) show the performance of a nonvariational algorithm, which in theory gives the exact answer, but in practice fails due to systematic errors.

# III. PHASE ESTIMATION ALGORITHM

We also report an experimental demonstration of the original quantum algorithm for chemistry [2]. Similar to VQE, the first step of this algorithm is to prepare the system register in a state having good overlap with the ground state of the Hamiltonian H. In our case, we begin with the Hartree-Fock state jϕi. We then evolve this state under H using a Trotterized approximation to the time-evolution operator. The execution of this unitary is controlled on an ancilla initialized in the superposition state ðj0i þ j1iÞ= ffiffi ffi 2 p . The time-evolution operator can be approximated using Trotterization [34] as

where the H γ are local Hamiltonians as in Eq. ( 1) and the error in this approximation depends linearly on the time step ρ -1 [34]. Application of the propagator induces a phase on the system register so that e -iHt jϕi ¼

where jni are eigenstates of the Hamiltonian such that Hjni ¼ E n jni and a n ¼ hnjϕi. By controlling this evolution on the ancilla superposition state, one entangles the system register with the ancilla. Accordingly, by measuring the phase between the j0i state and j1i state of the ancilla,  4). The white curve traces the theoretical minimum energy; the values of theoretical and experimental minima at each R are plotted in Fig. 3(a). Errors in this surface are given in Fig. 6.

one measures the phase E n t and collapses the system register to the state jni with probability ja n j 2 . Our PEA implementation is based on a modification of Kitaev's iterative phase estimation algorithm [8,35]. The circuit we use is shown in Fig. 4 and detailed descriptions of the subroutines we use to control U Trot ð2 k t 0 Þ on an ancilla are shown in Appendix C. The rotation Z ΦðkÞ in Fig. 4 feeds back classical information from the prior k -1 measurements using phase kickback as

With iterative phase estimation, one measures the phase accumulated on the system one bit at a time. Even when a 0 is very small, one can use iterative phase estimation to measure eigenvalues if the system register remains coherent throughout the entire phase determination. Since the Hartree-Fock state has strong overlap with the ground state of molecular hydrogen (i.e., jh0jϕij 2 > 0.5), we are able to measure each bit independently with a majority-voting scheme, reducing coherence requirements. For b bits, the ground-state energy is digitally computed as a binary expansion of the measurement outcomes,

Experimentally computed energies are plotted alongside VQE results in Fig. 3(a). Because energies are measured digitally in iterative phase estimation, the experimentally determined PEA energies in Fig. 3(a) agree exactly with theoretical simulations of Fig. 4, which differ from the exact energies due to the approximation of Eq. ( 5). The primary difficulty of the PEA experiment is that the controlled application of U Trot ð2 k t 0 Þ requires complex quantum circuitry and long coherent evolutions. Accordingly, we approximate the propagator in Eq. ( 5) using a single Trotter step (ρ ¼ 1), which is not sufficient for chemical accuracy. Our PEA experiment shows an error in the dissociation energy of ð1 AE 1Þ × 10 -2 hartree.

In addition to taking only one Trotter step, we perform classical simulations of the error in Eq. ( 5) under different orderings of the H γ in order to find the optimal Trotter sequences at each value of R. The Trotter sequences we use in our experiment as well as parameters such as t 0 are reported in Appendix C. Since this optimization is intractable for larger molecules, our PEA protocol benefits from inefficient classical preprocessing (unlike our VQE implementation). Nevertheless, this is the first time the canonical quantum algorithm for chemistry has been executed in its entirety and, as such, represents a significant step towards scalable implementations.

# IV. EXPERIMENTAL METHODS

Both algorithms are implemented with a superconducting quantum system based on the Xmon [48], a variant of the planar transmon qubit [49], in a dilution refrigerator with a base temperature of 20 mK. Each qubit consists of a superconducting quantum interference device Green diamonds show the error in the energies that would have been obtained experimentally by running the circuit at the theoretically optimal θ instead of the experimentally optimal θ. The discrepancy between blue and red dots provides experimental evidence for the robustness of VQE, which could not have been anticipated via numerical simulations. The gray band encloses the chemically accurate region relative to the experimental energy of the atomized molecule. The dissociation energy is relative to the equilibrium geometry, which falls within this envelope.

(SQUID), which provides a tunable nonlinear inductance, and a large X-shaped capacitor; qubit frequencies are tunable up to 6 GHz and have a nonlinearity of ðω 21 -ω 10 Þ ¼ -0.22 GHz. The qubits are capacitively coupled to their nearest neighbors in a linear chain pattern, with coupling strengths of 30 MHz. Single-qubit quantum gates are implemented with microwave pulses and tuned using closed-loop optimization with randomized benchmarking [50]. Qubit state measurement is performed in a dispersive readout scheme with capacitively coupled resonators at 6.6-6.8 GHz [4]. For details of the device fabrication and conventions for reporting qubit parameters, see Ref. [4].

Our entangling operation is a controlled-phase (CZ ϕ ) gate, accomplished by holding one of the qubits at a fixed frequency while adiabatically tuning the other close to an avoided level crossing of the j11i and j02i states [3]. To produce the correct phase change ϕ, the acquired phase is measured with quantum state tomography versus the amplitude of the trajectory, and the amplitude for any given ϕ is then determined via interpolation [7]. To minimize leakage out of the computation subspace during this operation, we increase the gate duration from the previously used 40 ns to 50 ns, and then shape the pulse trajectory. The CZ ϕ gate as implemented here has a range of approximately 0.25-5.0 rad; for smaller values of ϕ, parasitic interactions with other qubits become nontrivial, and for larger ϕ, leakage is significant. For ϕ outside this range, the total rotation is accomplished with two physical gates. For CZ ϕ gates with ϕ ¼ π, the amplitude and shape of the trajectory are further optimized with ORBIT [50]. CZ ϕ≠π is necessary only in the PEA experiment (see Appendix C).

The gates we use to implement both VQE and PEA are shown in Appendixes B and C. A single VQE sequence consists of 11 single-qubit gates and two CZ π gates. A PEA sequence has at least 51 single-qubit gates, four CZ ϕ≠π gates, and ten CZ π gates; more are required when not all ϕ values are within the range that could be performed with a single physical gate.

# V. CONCLUSION

We report the use of quantum hardware to experimentally compute the potential energy curve of molecular hydrogen using both PEA and VQE. We perform the first experimental implementation of the Trotterized molecular time-evolution operator and then measure energies using PEA. Because of the costly nature of Trotterization, we are able to implement only a single Trotter step, which is not enough to achieve chemical accuracy. By contrast, our VQE experiment achieves chemical accuracy and shows significant robustness to certain types of error. The comparison of these two approaches suggests that adaptive algorithms (e.g., VQE) may generally be more resilient for preerror corrected quantum computing than traditional gate model algorithms (e.g., PEA). FIG. 4. Hardware and software schematic of the Trotterized phase estimation algorithm. (Hardware) micrograph shows three Xmon transmon qubits and microwave pulse sequences, including (i) the variable amplitude CZ ϕ (not used in Fig. 1) and (ii) dynamical decoupling pulses not shown in logical circuit. (Software) state preparation includes putting the ancilla in a superposition state and compensating for previously measured bits of the phase using the gate Z Φ k (see text). The bulk of the circuit is the evolution of the system under a Trotterized Hamiltonian controlled by the ancilla. Bit j k is determined by a majority vote of the ancilla state over 1000 repetitions.

The robustness of VQE is partially a consequence of the adaptive nature of the algorithm; the classical outer loop of VQE helps to avoid systematic errors by acting similarly to the calibration loops used to tune individual quantum gates [50]. This minimization procedure treats the energy functional as a black box in that no assumptions are made about the actual circuit ansatz being implemented. Thus, VQE seeks to find the optimal parameters in a fashion that is blind to control errors, such as pulse imperfection, cross talk, and stray coupling in the device. We observe a remarkable increase in precision by using the experimentally optimal parameters rather than the theoretically optimal parameters. This finding inspires hope that VQE may provide solutions to classically intractable problems even without error correction. Additionally, these results motivate future experiments that take "sublogical" hardware calibration parameters, e.g., microwave pulse shapes, as variational parameters.

# APPENDIX A: ELECTRONIC STRUCTURE PROBLEM

The central problem of quantum chemistry is to compute the lowest energy eigenvalue of the molecular electronic structure Hamiltonian. The eigenstates of this Hamiltonian determine almost all of the properties of interest in a molecule or material, and as the gap between the ground and first electronically excited state is often much larger than the thermal energy at room temperature, the ground state is of particular interest. To arrive at the standard form of this Hamiltonian used in quantum computation, one begins from a collection of nuclear charges Z i and a number of electrons in the system N for which the corresponding Hamiltonian is written as

where the positions, masses, and charges of the nuclei are R i , M i , Z i , and the positions of the electrons are r i .

Here, the Hamiltonian is in atomic units of energy known as hartree. 1 hartree is ½ℏ 2 =ðm e e 2 a 2 0 Þ (630 kcal/mol or 27.2 eV), where m e , e, and a 0 denote the mass of an electron, charge of an electron, and Bohr radius, respectively.

This form of the Hamiltonian and its real-space discretization are often referred to as the first quantized formulation of quantum chemistry. Several approaches have been developed for treating this form of the problem on a quantum computer [9]; however, the focus of this work is the second quantized formulation. To reach the second quantized formulation, one typically first approximates the nuclei as fixed classical point charges under the Born-Oppenhemier approximation, chooses a basis ϕ i in which to represent the wave function, and enforces antisymmetry with the fermion creation and annihilation operators a † i and a j to give

where σ i is now a spatial and spin coordinate with σ i ¼ ðr i ; s i Þ, and the standard anticommutation relations that determine the action of a † i and a j are fa † i ; a j g ¼ δ ij and fa † i ; a † j g ¼ fa i ; a j g ¼ 0. Finally, the second quantized Hamiltonian must be mapped into qubits for implementation on a quantum device. The most common mappings used for this purpose are the Jordan-Wigner transformation [40] and the Bravyi-Kitaev transformation [17,41,42].

Using the Bravyi-Kitaev transformation, the spin Hamiltonian for molecular hydrogen in the minimal (STO-6G) basis, as reported in Ref. [42], is given by

where the values ff i g depend on the fixed bond length of the molecule. We notice that this Hamiltonian acts off diagonally on only two qubits (the ones having tensor factors of 0 and 2), those set in bold in Eq. (A5). Because we start our simulations in the Hartree-Fock state, a classical basis state, we see that the Hamiltonian stabilizes qubits 1 and 3 so that they are never flipped throughout the simulation. We can use this symmetry to scalably reduce the Hamiltonian of interest to the following effective Hamiltonian which acts only on two qubits:

where the values fg i g depend on the fixed bond length of the molecule. We further note that the term Z 0 Z 1 commutes with all other terms in the Hamiltonian. Since the ground state of the total Hamiltonian certainly has support on the Hartree-Fock state, we know the contribution to the total energy of Z 0 Z 1 (it is given by the expectation of those terms with the Hartree-Fock state).

Steps to prepare this Hamiltonian are summarized in the upper half of Fig. 5.

# APPENDIX B: EXPERIMENTAL METHODS FOR VQE

For the VQE experiment, we use the qubits q 0 and q 1 , at 4.49 and 5.53 GHz, respectively, while all the other qubits are detuned to 3 GHz and below. X π , Y π , AEX π=2 , and AEY π=2 gates are 25 ns long, and pulse amplitudes and detunings from f 10 are optimized with ORBIT; for these parameters, additional pulse shaping (e.g., DRAG) proves unnecessary (see Ref. [32] for details of pulse detuning and shaping). The amplitude, trajectory, and compensating single-qubit phases of the CZ π gate are optimized with ORBIT as well. The duration of the CZ π is 55 ns, during which the frequency of q 0 is fixed and q 1 is moved. The rotation Z θ [the adjustable parameter in Eq. ( 3)] is implemented as a phase shift on all subsequent gates. As operated here, q 0 and q 1 have energy relaxation times T 1 ¼ 62.8 and 21.4 μs, and Ramsey decay times T Ã 2 ¼ 1.1 and 1.9μs, respectively.

The expectation values we use to calculate the energy of the prepared state are measured with partial tomography; for example, X 1 X 0 is measured by applying Y π=2 gates to each qubit prior to measurement. We emphasize that for chemistry problems, the number of measurements scales polynomially [23]. The readout duration is set to 1000 ns for higher fidelity (compared to Ref. [4], where the odd-numbered "measurement" qubits used much shorter readout). In addition to discriminating between j0i and j1i, higher level qubit states are also measured (called j2i for simplicity). Readout fidelities are typically > 99% for j0i, and ∼95% for j1i and j2i, and measurement probabilities are corrected for readout error. After readout correction, experiments where one of the qubits is measured in j2i are dropped; any probability to be in j2i is set to zero and remaining probabilities are renormalized.

The circuit pulse sequence we use to implement the UCC sequence in Eq. ( 3) is shown in Fig. 1. The experiment is performed in different gauges of the Bravyi-Kitaev transform; these correspond to the j0i (j1i) state of q 0 representing the first orbital being unoccupied (occupied) or occupied (unoccupied), and similarly for q 1 representing the parity of the first two orbitals being even (odd) or odd (even). In practice, a gauge change means a flip of the value of one or both qubits in the Hartree-Fock input state, and a sign change on the relevant terms of the Hamiltonian. In the standard gauge, the Hartree-Fock state is j01i and is prepared with an X π gate on q 0 . Statistics from the experiment in these gauges are then averaged together. We also drop the first -Y π=2 on q 0 ; for an input state of either j0i or j1i, it has no effect given that X π=2 is the only gate preceding it.

The energy for a given nuclear separation R is computed by calculating the value of the Hamiltonian with the expectation values measured for each θ and choosing the smallest energy. This is done for all values of R to construct the energy surface. Figure 2(a) shows the raw expectation FIG. 5. A flow chart describing steps required to quantum compute molecular energies using both PEA and VQE. values (after readout correction), Fig. 2(b) shows the measured energy versus θ for each value of R, and Fig. 6 shows the errors in that surface. Error bars are computed from a Gaussian process regression [47] applied to the potential energy curve obtained from Fig. 2(b) using error estimates propagated from the shot-noise-limited measurements shown in Fig. 2(a).

# APPENDIX C: EXPERIMENTAL METHODS FOR PEA

The PEA experiment uses three qubits: q 0 for the ancilla, and q 1 and q 2 for the register. Operating frequencies are 4.56, 5.65, and 4.80 GHz for q 0 , q 1 , and q 2 , respectively. Pulse tune-up is the same as for the VQE experiment. For the entangling gates (CZ ϕ between q 0 and q 1 , and CZ π between q 1 and q 2 ), however, the adjacent noninteracting qubit must be decoupled from the interaction. For the CZ π , q 0 is decoupled with paired X π and -X π pulses; this has the effect of "echoing out" any acquired state-dependent phase on q 0 from q 1 and vice versa, while minimizing stray single-qubit phases on q 0 by keeping its frequency stationary. For the CZ ϕ , however, q 2 is detuned to frequencies significantly below the q 0q 1 interaction; while this makes single-qubit phases on q 2 harder to compensate, it is more effective at minimizing the impact of q 2 on the CZ ϕ gate. This combination of decoupling methods is found to be optimal to minimize error on the phase of q 0 , which is the critical parameter in the PEA experiment.

As the CZ ϕ gate varies the amplitude of q 1 's frequency trajectory over a wide range (approximately 200-950 MHz), particular values of ϕ can be more sensitive lossy parts of the q 1 's frequency spectrum that are rapidly swept past and easily compensated for in the standard case of only tuning up ϕ ¼ π. Therefore, for some values of ϕ it is necessary to individually tune in compensating phases on q 0 . This is implemented by executing the individual term of the Hamiltonian, varying the compensating phase on q 0 , and fitting for the value that minimizes the error of that term. After performing this careful compensation when necessary, the experiment produces the bit values (0 or 1) for each different Hamiltonian (i.e., each separation R) at each evolution time t that match those predicted by numerical simulation.

As operated in this experiment, q 0 , q 1 , and q 2 have T 1 values of 48.1, 23.7, and 43.0 μs, and T Ã 2 times of 1.3, 1.6, and 0.8 μs, respectively. Figure 4 shows the pulses for one iteration of the PEA experiment, and Fig. 7 shows an example of the measurement results for one value of R. The parameters at each R are given in Table I. For reference, in this section we include the implementations of all the terms of the Bravyi-Kitaev Hamiltonian for molecular hydrogen. In the following diagrams, α is the ancilla qubit (q 0 in the experiment) and 0 and 1 are the register qubits (q 1 and q 2 in the experiment). We must always be aware that representing our terms in terms of these gates, and then in terms of the actual basis, is not necessarily the most efficient approach.

# CNOT

CNOT is implemented as a CZ π and two rotations: FIG. 6. Errors in the VQE energy surface (in hartree) as a function of bond length and rotation angle. This plot looks somewhat like the derivative of Fig. 2(b) with respect to R and θ because errors are greatest where the energy is most sensitive to changes in system parameters. As in Fig. 2(b), the white curve traces the theoretical minimum energy, which is seen to be in good agreement with the data. Note that while errors in the energy surface are sometimes negative, all energies are bounded from below by the variational minimum.                 

# SWAP

SWAP is implemented as three consecutive CZ π gates with intermediate rotations:

3. Controlled evolution under Z 0 Z 0 is implemented as CZ ϕ and a z rotation on the control qubit:

4. Controlled evolution under Z 1 Z 1 is the same as Z 0 , but surrounded by SWAP gates so that the ancilla interacts with the other qubit: 5. Controlled evolution under X 0 X 1 For X 0 X 1 , we first change bases with Y π=2 gates, then compute the parity of the register qubits with a CNOT, then apply the controlled phase, and finally undo the parity computation and basis change. Note that the Y π=2 gates will cancel on the middle qubit with our CNOT implementation: 6. Controlled evolution under Y 0 Y 1 Y 0 Y 1 is the same as X 0 X 1 with a different basis change:

# APPENDIX D: UNITARY COUPLED CLUSTER

The application of VQE requires the choice of an ansatz, and in this work we focus on the unitary coupled cluster ansatz. This ansatz is a unitary variant of the method sometimes referred to as the "gold standard of quantum chemistry," namely, coupled cluster with single and double excitations with perturbative triples excitations [43]. The unitary variant has the advantage of satisfying a variational principle with respect to all possible parametrizations [44][45][46]. Furthermore, UCC can be easily applied to a multireference initial state, whereas one of the major shortcomings of traditional coupled cluster is that it can only be applied to a single Slater determinant [44][45][46]. While the unitary variant has no efficient preparation scheme on a classical computer, scalable methods of preparation for a fixed set of parameters on a quantum device have now been documented several times [19,20,22,23].

The UCC ansatz jφð θÞi is defined with respect to a reference state, which in this work we take to be the Hartree-Fock state jϕi, jφð θÞi ¼ Uð θÞjφi ¼ e Tð θÞ-Tð θÞ † jϕi; ðD1Þ

where Tð θÞ is the anti-Hermitian cluster operator: 

where the occ and virt spaces are defined as the occupied and unoccupied sites in the Hartree-Fock state and the definition of higher-order cluster operators ðkÞ T follows naturally. When only including up to the first two terms in the cluster expansion, we term the ansatz unitary coupled cluster with single and doubles excitations (UCCSD) [43].

The task within VQE is to determine the optimal values of the one-and two-body cluster amplitudes θ a 1 i 1 and θ a 1 ;a 2 i 1 ;i 2 , which are determined by the variational minimum of a nonlinear function. As with all nonlinear minimizations, the choice of starting parameters is key to algorithmic performance. As in classical coupled cluster, we can determine the starting amplitudes perturbatively through Möller-Plesset perturbation theory (MP2) [43]. For molecular hydrogen in the minimal basis, there is exactly one term in the UCCSD ansatz.

The MP2 guess amplitudes are given by the equations

where ϵ a refer to the one-electron occupied and virtual orbital energies from the Hartree-Fock calculation and the h ijab are computed as in Eq. (A3). In the MP2 guess, the vanishing of the singles amplitudes is a result of the fact that single excitations away from the Hartree-Fock reference do not couple through the Hamiltonian as a consequence of Brillouin's theorem [43]. As the solution of the classical coupled cluster equations is also efficient, it is possible to use amplitudes from a method like CCSD as starting values as well. We note in both cases, however, that the single-reference, perturbative nature of these constructions may lead to poor initial guesses for systems with strong multireference character or entanglement. In these cases the amplitudes may represent poor guesses, requiring more iterations for convergence. As such, a better initial guess in such problems may be a related optimization, such as a different molecular geometry of the same system. In cases where the perturbative estimates are accurate, one can discard operations related to very small amplitudes in the state preparation circuit, leading to computational savings.

# ACKNOWLEDGMENTS

The authors thank Cornelius Hempel for discussions regarding VQE. J. R. M. is supported by the Luis W. Alvarez fellowship in Computing Sciences at Lawrence Berkeley National Laboratory. J. R. acknowledges the Air Force Office of Scientific Research for support under Award No. FA9550-12-1-0046. A. A.-G. acknowledges the Army Research Office under Award No. W911NF-15-1-0256 and the Defense Security Science Engineering Fellowship managed by the Office of Naval Research under Award No. 00014-16-1-2008. P. J. L. acknowledges the support of the National Science Foundation under Grant No. PHY-0955518. Devices were made at the UCSB Nanofabrication Facility, a part of the NSF-funded National Nanotechnology Infrastructure Network, and at the NanoStructures Cleanroom Facility. R. Babbush, H. N., A.

A.-G., and J. M. M. designed the experiments. P. J. J. O. performed the experiments. J. K., R. Barends, and A. M. fabricated the device. I. D. K., J. R., J. R. M., A. T., N. D., P. V. C., and P. J. L. helped R. Babbush and P. J. J. O. compile quantum software and analyze data. R. Babbush, P. J. J. O., and J. M. M. co-wrote the manuscript. P. J. J. O. and R. Babbush contributed equally to this work. All other authors contributed to the fabrication process, experimental setup, and manuscript preparation.

