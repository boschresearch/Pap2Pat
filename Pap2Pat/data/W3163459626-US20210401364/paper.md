# Introduction

Obstructive sleep apnea (OSA) is a common disorder characterized by repetitive partial or complete episodes of airflow obstruction that can result in intermittent hypoxia, transient hypercapnia, and arousals from sleep. Commonly, the severity of OSA is mainly determined by the apnea/hypopnea index (AHI), which represents the number of apnea/hypopnea events per hour of sleep. Based on the AHI values for adults, the severity of OSA is categorized into no-OSA (AHI < 5), mild (5 ≤ AHI < 15), moderate (15 ≤ AHI < 30), and severe OSA (AHI ≥ 30) [1]. However, many other parameters are measured during overnight polysomnography (PSG), the gold standard of sleep apnea detection.

Approximately 1 billion of the world’s population between the ages of 30 and 69 years are estimated to have OSA [2]; yet, it is still underdiagnosed [3]. OSA diagnosis and recommending a treatment option using the gold-standard PSG are expensive, laborious, and time-consuming; also, PSG is not available in remote areas. There are portable PSG monitoring devices that can be lent to individuals to assess their OSA overnight at home. However, to recommend a treatment option, there is still a need for a full PSG study at a sleep center. There are questionnaires such as STOP-BANG or the Epworth sleepiness score for a quick OSA screening, but they lack objectivity and have very poor specificity (~20) [4,5], which can increase the waiting list and lead to unnecessary referrals to sleep centers for full PSG studies; hence, adding unnecessary costs to the health care system. On the other hand, undiagnosed OSA, in particular, increases the perioperative morbidity and mortality risks for OSA patients undergoing surgery requiring full anesthesia [6]. Therefore, there is a need for a quick, objective screening tool to aid fast and accurate results with high sensitivity and specificity of OSA detection.

Our previous studies [7,8] have shown the ability to predict the severity of OSA, based on AHI, by analyzing a few minutes of breathing sounds recorded during wakefulness. We also demonstrated the effects of anthropometric information on the classification process [7,9]. Our latest OSA screening algorithm, called AWakeOSA [8], resulted in a blind testing accuracy >81% with a balanced specificity and sensitivity with a threshold of AHI ≥ 15. The threshold of AHI ≥ 15 was used because it is the most clinically accepted threshold to identify individuals with OSA who might benefit from the treatment [10].

Currently, AHI is the primary PSG parameter for determining an individual’s OSA severity. However, other PSG parameters, such as total time of sleep (TST), total arousal index, and mean oxygen saturation (SpO2%) of TST, are also important for a full clinical diagnosis of OSA [11]. Using the AHI parameter alone neglects events’ duration, oxygen desaturation depth, the difference of impact between apneic and hypopnic events, etc. Nevertheless, knowing these parameters helps with understanding one’s OSA pathology and choosing the proper treatment [12].

The upper airway (UA) of OSA patients is characterized by a structural deformation, narrower cross-sectional area, and more regional stiffness compared to those of healthy individuals [13,14]. These changes of the UA affect breathing sounds as they are generated by the flow of air in the UA [15]. To the best of our knowledge, there is no published work predicting PSG parameters, other than AHI, using a screening tool conducted during wakefulness. Therefore, this study for the first time demonstrates the proof of concept of a technique to predict PSG parameters representing OSA severity without a sleep study and only using a few tracheal breathing sounds recorded during wakefulness and the person’s anthropometric information such as neck circumference (NC), body mass index (BMI), etc. Hence, we hypothesize that breathing sounds characteristics (features) would be representative of the OSA severity. More specifically, we hypothesize that tracheal breathing sounds have features capable of predicting PSG parameters such as total arousal index, mean SpO2%, etc. that are related to OSA severity.

# Materials And Methods

We attempted to solve a two-class classification problem to predict each PSG parameter separately. The data of each PSG parameter was divided into two severity classes/groups based on a threshold (see Section 2.3). One of the two groups represented the normal case, while the other represented the abnormal case. For each PSG parameter, a classification threshold was evaluated, distinctive features were selected, and a model was created using anthropomorphic parameters and breathing sound features. Then the model was used in a classification approach to predict the PSG parameter’s severity group (normal or abnormal); violating the threshold (in the abnormal group) implied a high risk of OSA severity; check Figure 1 for the general flow of the process.

## 1. Study Population

The data for this study were adopted from our previous study [8]. During wakefulness, about 1–2 h prior to conducting the PSG study at Sleep Disorders Center in Misericordia Health Centre (Winnipeg, Canada), breathing sound recording was performed. Patients diagnosed with any other respiratory diseases were excluded. We obtained the PSG study report of the participants after a sleep technician completed their overnight PSG assessment analysis. All study participants signed an informed consent approved by the Biomedical Research Ethics Board of the University of Manitoba (approved on 27 October 2011) prior to the breathing experiment. Out of the 199 individuals in our previous study, data of the 145 (60 females) participants who had a complete PSG report were considered in this study.

## 2. Procedure And Measurements

Prior to recording, we collected the height, weight, age, Mallampati score (MpS), neck circumference, and smoking history of each participant. For simplification, the AHI of 15 was used to represent the anthropometric parameters in the two severity groups. We checked whether the data followed the normal distribution for each anthropometric parameter by using the Lilliefors test. The two severity groups were only matched in terms of age, and a t-test was used.

All participants conducted a full overnight PSG study. The Sleep Centre used the Natus Sandman PSG collection system (Natus Canada, Oakville, ON, Canada), which recorded 6 channels of electroencephalogram signals, chin and leg electromyography signals, electrooculography signals, electrocardiogram signals, snoring sounds, thorax and abdomen efforts signals, air flow and pressure signals, pulse and SpO2 signals, transcutaneous oxygen pressure signals, and video image for body position detection. A full overnight PSG study reports 79 different parameters reflecting on one’s OSA severity; they are listed in Table A1 of the Appendix A. The data in these reports were used for verification of our predictive modeling outcomes.

### Tracheal Breathing Sounds

The tracheal breathing sounds were recorded using a Sony microphone (ECM77B—Advance Electronics, Winnipeg, MB, Canada) during wakefulness in a supine position. The microphone was placed over the suprasternal notch of the trachea using a double-sided adhesive ring tape. The acoustic signals were amplified, band-pass filtered (0.05–5000 Hz, Biopac DA100C—BIOPAC Systems Inc., Goleta, CA, USA), and sampled at 10,240 Hz. Participants were instructed to breathe five deep breaths through their nose, then another five cycles through their mouth; for more details on the recording protocol and the preprocessing stage, see [15]. The spectra and bi-spectra of the signals were estimated using the welsh method [16] and an indirect class conventional bispectrum estimator [17], respectively. The breathing sounds’ characteristic features, used to predict AHI in our previous study [8], were also used to predict the PSG parameters (other than AHI) in this study (see Table 1 for the list of features).

## 3. Threshold Determination, Data Preparation, And Feature Selection

Classification threshold determination for each PSG Parameter—80% of the data were used in the threshold determination process. In order to find a proper threshold for each PSG parameter, we scaled the PSG parameter’s values to be normally distributed with an absolute skewness less than 0.5. Basically, if the skewness was ≤−0.5, the PSG parameter was squared, and if the skewness was ≥0.5, the logarithm scale of the PSG parameter was used. Then, the overall range of a PSG parameter’s values was divided into 20 equal divisions to form threshold candidates for the classification process. For example, the TST range was between 0.5 and 7 h, and it had a skewness <0.5; thus, it did not require scaling. With the above 20 equal divisions, the potential classification thresholds were found as 0.825, 1.15, 1.475, … 6.675.

Classification threshold selection—For each threshold candidate of a PSG parameter, the power spectra of the sound signals of those with PSG parameter values less than the candidate threshold were grouped together, and the same was done for those with values higher than the candidate threshold. The average curve for each of these two groups was calculated with its 95% confidence interval. At some frequency bandwidths, there was no overlap between the curves of the two groups; see Figure 2 for the gaps (i.e., 150–300 Hz, 720–900 Hz, 1050–1120 Hz, and 1450–1700 Hz). Then, the average absolute difference between the 95% confidence intervals’ boundaries at the non-overlapped regions was evaluated. This process was repeated for each candidate threshold. Then, the threshold with the largest gap between the two groups and a balanced number of individuals (at least 20 individuals per group) was selected as an optimum candidate threshold. If there was more than one selected threshold for a PSG parameter, the one with a physiological meaning was selected. These three criteria to choose a threshold reduced the number of PSG parameters to be predicted from 78 to 51.

Figure 3 shows an example of the gap values for different thresholds for a PSG parameter (i.e., the mean SpO2% during total TST); thresholds <92% or >95% had high average gap values, but the number of individuals per group was less than 20. The physiological meanings for different PSG parameters were discussed in the literature, in particular, the percentage of stages III and REM of sleep [18], total arousal index [19], mean SpO2% [20], and oxygen desaturation (de-SpO2) index [21].

Dataset segmentation—The dataset was divided into five folds of blind testing datasets; one-fold consisted of 20% of the data above the PSG parameter threshold and 20% of the data below the threshold. Taking the 20% above and below the threshold guaranteed no significant difference between the testing and training datasets, and it also made the two datasets comparable with the same severity level. Each fold of testing (20% of the data) with its corresponding training and validation dataset (80% of the whole dataset) were separately analyzed. Herein, we call them the five data configurations.

Feature selection—The sound features were adopted from different anthropometric groups of features used in our previous work [8]; therefore, some features might be highly correlated with one another and need to be filtered. Thus, for a PSG parameter, the correlation coefficient (CC) between every pair of sound features was calculated; if the CC was ≥0.95, we calculated the CC between each of the two features and the PSG parameter, and the feature with the lowest CC was subsequently removed. This approach guarantees removing similar features. Then, each feature’s data were divided into two groups based on the selected PSG threshold. The outliers for each feature were identified in each PSG severity group and then removed [22]; this process is delineated in our previous work [8]. The significance between the two severity groups was calculated, and only features with a p-value ≤ 0.05 were selected. Therefore, each PSG parameter has its own significant set of features. These processes were separately applied to the five data configurations.

## 4. Bilinear Modeling And Correlation Analysis

A bilinear polynomial model of three variables (a three-feature combination of sound and anthropometric features) was generated for each PSG parameter; see Equation (1) for the polynomial model (X, Y, and Z are three features, and a is a constant). We did not use higher-order models to avoid overfitting due to the small sample size. For simplicity, we mentioned only the methodology using the three-feature combination, but the presented results are for three-, four-, and five-feature combinations. The model was created from each three-feature combination using the multiple linear regression function in MatlabTM2019 [23]. Each model produced a new array of values representing the PSG parameter. The correlation coefficient using Spearman [24] was evaluated between the predicted (model) and actual values (extracted from the PSG report). \(Predicted~PSG~parameter = a_{1}XY + a_{2}XZ + a_{3}YZ + a_{4}X + a_{5}Y + a_{6}Z + a_{7}\)

The number of models was then reduced based on their correlation with the actual PSG parameter and the percentage of overlap between different PSG parameter severity groups; the first 20 models with the highest correlation and the lowest overlap percentage were selected for the classification process; see [25] for more details on this step.

## 5. Classification And Prediction Of Psg Parameters

Breathing sound signals are stochastic signals in nature, and the OSA disorder has many confounding factors that affect breathing sounds, which increases the heterogeneity and complexity of data. Therefore, it is required to have a classification process with multiple thresholds for each feature to overcome the complexity and heterogeneity; such a classification approach is possible in the random-forest (RF) algorithm [26]. In addition, RF does not require a normality assumption. Therefore, a classification process was performed using a two-class RF classifier with 1200 iterations using the selected threshold and the selected models. For each iteration, the classifier used 65% of the training/validation data for training and the other 35% for validation. Then, the validated classifier was used to classify the blind testing dataset. The input for the classifier was the predicted PSG parameter using the evaluated bilinear model; thus, it was a one-feature RF classifier. The models (three-, four-, five-feature combinations) that provided the validation and testing accuracies ≥70% and validation and testing sensitivities and specificities ≥50% were selected as the best models. Then, we combined the classifier outcomes of three models to find the best combinations covering most of the dataset while providing the highest classification performance. The final classification was based on the majority voting of each individual classifier; see [25] for more details on this section. The classification process was separately applied on the five data configurations, and then their results were averaged for each PSG parameter separately.

# Results

The selected anthropometric (F1–F6) and sound features (F7–F79) for the analyses are listed in Table 1. The anthropometric characteristics of the study sample are presented in Table 2.

Table 3 shows the most significant and useful correlation coefficients (a maximum of 0.56) between the PSG parameters and anthropometric/sound features. Only those PSG parameters that resulted in high testing results are presented. Males had a higher number of apneic events than females. The increase in neck circumference and/or BMI was associated with an increase in the number of obstructive events and arousals. A high arousal index and apnea/hypopnea index were associated with an increase in the power of the high-frequency components of tracheal breathing sounds. Furthermore, a high oxygen desaturation index was associated with a high first resonance frequency in breathing sounds. Figure 4 shows the scatter plots of four PSG parameters with their correlated features.

Table 4 shows the bilinear model feature combinations with the highest overall correlation coefficients with the PSG parameters. Only the highest two model coefficients are represented in parentheses right to the relevant feature, and the bolded feature is the one with the highest contribution to the constructed model. Furthermore, F1 scores and testing classification accuracies of the blind testing dataset using the corresponding models to predict the PSG parameters are presented. The constructed models had correlation coefficients >0.8 with nine OSA severity parameters. The supine arousal index had a correlation coefficient of 0.8 with the F5-F6-F37-F46-F74 bilinear model, and the average power of high frequencies for the nose inspiratory signal was the main parameter in the bilinear model. The hypopnea index had a correlation coefficient of 0.82 with the F4-F5-F12-F26-F38 bilinear model, and neck circumference was the main parameter in the bilinear model. The testing classification accuracy and F1 score were 92% and 95%, respectively, for predicting AHI measured in the supine position with a threshold of 15. The scatter plots of the four previously mentioned PSG parameters with their highly correlated bilinear equation models are shown in Figure 5. These plots show the enhancement in correlation coefficients and linear relationships compared to those shown in Figure 4.

Figure 6 shows the average inspiratory/expiratory power spectra during mouth/nose breathing of four PSG parameter groups. The corresponding sound spectra to each PSG parameter are represented using two curves (i.e., blue and red) with their 95% confidence intervals (dotted lines). The blue curve represents the average curves of individuals with the PSG parameters less than the selected threshold, while the red curve represents the average curves of individuals with the PSG parameters more than the selected threshold. There is a big gap in the range of 100–300 Hz between the mouth inspiratory power spectra of patients with a supine arousal index of more than 30 and less than 30.

On average, a healthy adults’ sleep duration is 5% in stage 1, 50% in stage 2, 20% in stage 3, and 20–25% in REM [18]. We used thresholds of 10% for stage 3 sleep as an indicator of abnormal sleep duration. The total arousal index threshold depends on age; it is 10 for young, 15–20 for middle-aged, and 25 for elders [19]. We used 25 as the threshold for predicting the total arousal index, as it had more separability in the power spectra of the training dataset (80% of the data). Furthermore, it has been mentioned that a normal mean SpO2% is between 93% and98% [20]; thus, we used 93–94% as a threshold of the beginning of an abnormal percentage. Moreover, de-SPO2 index is a value usually between 0 to 135, and it is highly correlated with AHI [21]; thus, we used 15 as the threshold for de-SPO2 index similar to an AHI of 15.

Table 5 shows the selected thresholds for the PSG parameters. The presented PSG parameters are the ones with average classification accuracies of more than 70% and average classification sensitivities and specificities of more than 60%. Table 5 also shows the average validation and blind testing classification accuracies, sensitivities, specificities, and F1 scores using the outcomes of the bilinear equations for the five dataset configurations. The proposed method resulted in a blind testing classification accuracy of up to 88.8%. Predicting the obstructive hypopnea index measured on the supine position with a threshold of 15 resulted in 81.6% blind testing accuracy with 86.1% validation accuracy and comparable and high F1 scores for both the validation and blind testing processes. In addition, many PSG parameters were predicted with reasonable and comparable accuracies, sensitivities, and specificities.

# Discussion

The results of this study show the possibility to predict AHI and other OSA severity parameters with high precision during wakefulness by using only anthropometric information and five cycles of breathing sounds. Thus, the proposed methodology shows great potentials for a quick, informative, and highly reliable OSA screening tool.

Tracheal breathing sounds’ features showed significant correlations with some of the PSG parameters (Table 3). Feature 37 showed a high positive correlation with the total arousal index. This suggests that individuals with high arousal index have a high first frequency peak. The peaks at higher frequency represent stiffness, and that implies high UA dilator muscle activities [15]. Feature 47 was found to be high in individuals with a low average SpO2% during sleep. This indicates high power at low frequencies among those with high SpO2%; this is also congruent with our previous findings [15] as individuals with AHI < 15 have high power in the low-frequency components. Furthermore, this high power indicates a wide UA and, thus, low UA resistance.

As shown in Table 1, most of the selected sound features were extracted from inspiratory breathing; inspiration is an active process, hence, the UA muscles are active. This finding was expected because the UA muscle atrophy is one of the causes of the UA collapse leading to OSA. Thus, we expected the characteristic features of the breathing sounds in relation to OSA to be mostly selected during the inspiratory phase. This is also congruent with our previous studies [15,27], in which the characteristic breathing sounds in correlation with AHI were mostly selected from an inspiratory phase. Furthermore, PSG parameters were correlated with various sound features, which were extracted from linear and non-linear algorithms and from time and frequency domains. This indicates the complexity of the UA structure and the ability of breathing sound features to identify different UA characteristics.

Using models of bilinear equations resulted in better correlations with the PSG parameters than using only one-feature combinations (see Figure 5 and Table 4). Based on the selected thresholds and using the selected model combinations, we were able to reach up to 86.1% and 88.8% average validation and blind testing classification accuracy (VCA and TCA) with comparable sensitivities and specificities. Using five different data configurations and executing the entire process for each configuration ensured the unbiased reliability of the extracted models. The F1 scores, sensitivities, and specificities show the ability of the classifiers to have unbiased decisions. Therefore, the results demonstrate the ability to predict the PSG parameters with high confidence using combinations of anthropometric and breathing sounds features. The proposed method could be used as a fast-diagnosing tool that predicts several OSA severity parameters, and could benefit sleep physicians, anesthesiologists, and dentists.

Anthropometric parameters such as BMI, NC, age, etc. have shown their ability to screen for OSA; however, they provide low screening specificity. Nevertheless, as shown in this study, they had significant correlations with the attributes describing the OSA disorder evaluated by a PSG assessment. Sleep efficiency (TST/total time on bed) and stage 3 duration (representing deep sleeping) have been shown to decrease with age [18]. Additionally, average SpO2% and REM sleep duration were shown to decrease with obesity (increasing BMI) [28]. Our data (Table 3) are congruent with the above observations. In addition, our results showed that many event indices per hour during sleep, such as total arousal index, hypopnea index, total de-SaO2 index, etc., are positively correlated with NC. Furthermore, NC was selected as a significant feature in many models predicting several PSG parameters, which indicates its importance on the OSA screening process. Therefore, the outcomes confirm the relationships between OSA risk factors and the pathophysiology of the disorder.

In our previous works, as well as the work of other researchers [8,15,29,30,31], tracheal breathing sound features showed a high correlation with OSA severity in terms of AHI values. Investigating the power spectra for PSG threshold determination revealed some interesting observations. For example, the selected threshold for the apnea index in this study was 1, while it was 10 for the hypopnea index. This implies that an apneic event affects the UA much more significantly than a hypopnic event. Additionally, the selected supine arousal index threshold was 25, while it was 30 for the non-supine arousal index. The thresholds for hypopnea index and de-SPO2 index during non-REM sleep were lower than the threshold selected during REM sleep. Furthermore, the thresholds for obstruction indexes, in general, were higher when the patients were sleeping on their left side than those recorded when they were on their right side. These observations show a significant change in the UA structure in supine or right-side body positions and/or during non-REM sleep, and imply that the upper airway is at a higher risk if an obstruction event happens.

## Limitations And Future Work

The main limitation of this study was its sample size (n = 145), which, given the heterogeneity of the OSA population, is not enough to represent the whole OSA population. Future studies with a larger sample size are needed to replicate and validate the claims of this paper. The thresholds were mainly selected based on the separability between the two PSG parameter groups, while having a reasonable number of individuals in each group. Therefore, it is recommended to replace some of the selected thresholds with the ones that imply high health risks. The dataset could not be matched in terms of all of the mentioned anthropometric parameters due to the small sample size. Once we have a larger sample, we will investigate predicting each PSG parameter in different anthropometric groups, the same as the AWakeOSA analysis. Another limitation is that in this study, all the features were adopted from our previous study [8], and not extracted from visualizing the spectra of each PSG parameter. In future work, we will investigate the spectra for each PSG parameter separately to extract the most prominent features and assess whether those features would be much different from the current ones. Furthermore, the PSG reports did not have any information regarding average apnea or hypopnea events’ duration and average oxygen desaturation percentage duration during obstructive events. Once we resume our sleep studies in our sleep lab, we will consider recording them in our future studies, and investigate the possibility of their prediction.

# Conclusions

Some PSG parameters, such as AHI, sleep duration, number of arousals, etc., are crucial to understand the pathophysiology of the OSA disorder and choose an appropriate treatment. Evaluating the parameters using simple means during wakefulness in a short time is an essential step towards an expeditious treatment; moreover, it will significantly help anesthesiologists who need to know the OSA status of their patients prior to surgery. This study is the first to investigate the prediction of the PSG parameters other than AHI during wakefulness using individuals’ anthropometric information and a few minutes of breathing sound recording. The promising results of this study for predicting the PSG parameters with meaningful features may pave the way for reducing the waiting lines and providing sleep clinics with a quick and reliable OSA screening tool.

