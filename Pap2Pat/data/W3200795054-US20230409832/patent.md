# DESCRIPTION

## STATEMENT REGARDING PRIOR DISCLOSURES BY THE INVENTOR OR A JOINT INVENTOR (IF APPLICABLE)

The following disclosure(s) are submitted under 35 U.S.C. 102(b)(1)(A):

DISCLOSURE(S): CHEMMENGATH et al., “Let the CAT out of the bag: Contrastive Attributed explanations for Text”, arXiv:2109.07983v1 [cs.CL] 16 Sep. 2021, 15 pages.

## BACKGROUND OF THE INVENTION

The present invention relates generally to the field of natural language processing, and more particularly to altering text based on attribute classifications while ensuring semantical structure.

Perturbation is the act of altering values in a data set. For strings of text, a sentence that changes a word would be a perturbation of the original sting of text. In natural language processing and machine learning, classification model classifies the sting of text based on the subject matter and domains mentioned in the string. Other classification models may capture sentiment and other opinion classifications such as bias as well.

## SUMMARY

Embodiments of the present invention provide a method, computer program product and system to generate perturbed text. A processor receives a string of text from a user. A processor determines one or more classifications for at least one word in the string of text by a classification model. A processor determines a plurality of perturbations of the at least one word based on the one or more classifications, where the plurality of perturbations do not share the same one or more classifications as the least one word in the string of text. A processor selects a perturbation of the string of text based on (i) an edit distance between the string of text and the plurality of perturbations, and (ii) a fluency metric for each of the plurality of perturbations. A processor provides the perturbation of the string of text to the user.

## DETAILED DESCRIPTION

The present invention may be a system, a method, and/or a computer program product at any possible technical detail level of integration. The computer program product may include a computer readable storage medium (or media) having computer readable program instructions thereon for causing a processor to carry out aspects of the present invention.

The computer readable storage medium can be a tangible device that can retain and store instructions for use by an instruction execution device. The computer readable storage medium may be, for example, but is not limited to, an electronic storage device, a magnetic storage device, an optical storage device, an electromagnetic storage device, a semiconductor storage device, or any suitable combination of the foregoing. A non-exhaustive list of more specific examples of the computer readable storage medium includes the following: a portable computer diskette, a hard disk, a random access memory (RAM), a read-only memory (ROM), an erasable programmable read-only memory (EPROM or Flash memory), a static random access memory (SRAM), a portable compact disc read-only memory (CD-ROM), a digital versatile disk (DVD), a memory stick, a floppy disk, a mechanically encoded device such as punch-cards or raised structures in a groove having instructions recorded thereon, and any suitable combination of the foregoing. A computer readable storage medium, as used herein, is not to be construed as being transitory signals per se, such as radio waves or other freely propagating electromagnetic waves, electromagnetic waves propagating through a waveguide or other transmission media (e.g., light pulses passing through a fiber-optic cable), or electrical signals transmitted through a wire.

Computer readable program instructions described herein can be downloaded to respective computing/processing devices from a computer readable storage medium or to an external computer or external storage device via a network, for example, the Internet, a local area network, a wide area network and/or a wireless network. The network may comprise copper transmission cables, optical transmission fibers, wireless transmission, routers, firewalls, switches, gateway computers and/or edge servers. A network adapter card or network interface in each computing/processing device receives computer readable program instructions from the network and forwards the computer readable program instructions for storage in a computer readable storage medium within the respective computing/processing device.

Computer readable program instructions for carrying out operations of the present invention may be assembler instructions, instruction-set-architecture (ISA) instructions, machine instructions, machine dependent instructions, microcode, firmware instructions, state-setting data, configuration data for integrated circuitry, or either source code or object code written in any combination of one or more programming languages, including an object oriented programming language such as Smalltalk, C++, or the like, and procedural programming languages, such as the “C” programming language or similar programming languages. The computer readable program instructions may execute entirely on the user's computer, partly on the user's computer, as a stand-alone software package, partly on the user's computer and partly on a remote computer or entirely on the remote computer or server. In the latter scenario, the remote computer may be connected to the user's computer through any type of network, including a local area network (LAN) or a wide area network (WAN), or the connection may be made to an external computer (for example, through the Internet using an Internet Service Provider). In some embodiments, electronic circuitry including, for example, programmable logic circuitry, field-programmable gate arrays (FPGA), or programmable logic arrays (PLA) may execute the computer readable program instructions by utilizing state information of the computer readable program instructions to personalize the electronic circuitry, in order to perform aspects of the present invention.

Aspects of the present invention are described herein with reference to flowchart illustrations and/or block diagrams of methods, apparatus (systems), and computer program products according to embodiments of the invention. It will be understood that each block of the flowchart illustrations and/or block diagrams, and combinations of blocks in the flowchart illustrations and/or block diagrams, can be implemented by computer readable program instructions.

These computer readable program instructions may be provided to a processor of a computer, or other programmable data processing apparatus to produce a machine, such that the instructions, which execute via the processor of the computer or other programmable data processing apparatus, create means for implementing the functions/acts specified in the flowchart and/or block diagram block or blocks. These computer readable program instructions may also be stored in a computer readable storage medium that can direct a computer, a programmable data processing apparatus, and/or other devices to function in a particular manner, such that the computer readable storage medium having instructions stored therein comprises an article of manufacture including instructions which implement aspects of the function/act specified in the flowchart and/or block diagram block or blocks.

The computer readable program instructions may also be loaded onto a computer, other programmable data processing apparatus, or other device to cause a series of operational steps to be performed on the computer, other programmable apparatus or other device to produce a computer implemented process, such that the instructions which execute on the computer, other programmable apparatus, or other device implement the functions/acts specified in the flowchart and/or block diagram block or blocks.

The flowchart and block diagrams in the Figures illustrate the architecture, functionality, and operation of possible implementations of systems, methods, and computer program products according to various embodiments of the present invention. In this regard, each block in the flowchart or block diagrams may represent a module, segment, or portion of instructions, which comprises one or more executable instructions for implementing the specified logical function(s). In some alternative implementations, the functions noted in the blocks may occur out of the order noted in the Figures. For example, two blocks shown in succession may, in fact, be accomplished as one step, executed concurrently, substantially concurrently, in a partially or wholly temporally overlapping manner, or the blocks may sometimes be executed in the reverse order, depending upon the functionality involved. It will also be noted that each block of the block diagrams and/or flowchart illustration, and combinations of blocks in the block diagrams and/or flowchart illustration, can be implemented by special purpose hardware-based systems that perform the specified functions or acts or carry out combinations of special purpose hardware and computer instructions.

The present invention will now be described in detail with reference to the Figures. FIG. 1 is a functional block diagram illustrating computing environment, generally designated 100, in accordance with one embodiment of the present invention. Computing environment 100 includes computing device 110 connected to network 120. Computing device 110 includes contrastive attribute text (CAT) program 112, classifier model 113, mask module 114, language model 115, text data 116, perturbed text 118 and attribute data 119.

In various embodiments of the present invention, computing device 110 is a computing device that can be a standalone device, a server, a laptop computer, a tablet computer, a netbook computer, a personal computer (PC), or a desktop computer. In another embodiment, computing device 110 represents a computing system utilizing clustered computers and components to act as a single pool of seamless resources. In general, computing device 110 can be any computing device or a combination of devices with access to classifier model 113, mask module 114, language model 115, text data 116, perturbed text 118 and attribute data 119 and is capable of executing CAT program 112. Computing device 110 may include internal and external hardware components, as depicted and described in further detail with respect to FIG. 4.

In this exemplary embodiment, CAT program 112, classifier model 113, mask module 114, language model 115, text data 116, perturbed text 118 and attribute data 119 are stored on computing device 110. However, in other embodiments, program 112, classifier model 113, mask module 114, language model 115, text data 116, perturbed text 118 and attribute data 119 may be stored externally and accessed through a communication network, such as network 120. Network 120 can be, for example, a local area network (LAN), a wide area network (WAN) such as the Internet, or a combination of the two, and may include wired, wireless, fiber optic or any other connection known in the art. In general, network 120 can be any combination of connections and protocols that will support communications between other devices (not shown) connected to network 120, in accordance with a desired embodiment of the present invention.

In various embodiments, CAT program 112 receives string of text from a user as text data 116. As discussed herein, CAT program 112 generates a contrastive or perturbed string of text that alters a portion of the text, perturbed text 118, while maintaining some of the original string of text received from the user. For example, CAT program 112 perturbs the original sentence of “Global server sales on the rise” to create a contrasting or different sentence of “Global ticket sales on the rise” as well as attribute data 119 that were added to and deleted from the sentence when generating the perturbation. For example, in the sentence above, the attributes Travel and Sale were added and the attribute Computer was removed. Text data 116 is typically received as a natural language sentence. While the following will be discussed in regard to generating perturbed sentences, one of ordinary skill in the art will appreciate that text data 116 can be of any length and could be applied to larger blocks of text, such as paragraphs.

In various embodiments, CAT program 112 determines one or more classifiers for text data 116. The one or more classifiers identify subjects, domains and other components of the sentence in text data 116. Classifier model 113 includes a trained machine learning model for classifying components of text data 116. In some scenarios, classifier model 113 includes a Naive Bayes Classifier. A Naive Bayes Classifier takes each word, or a string of words, and determines a probability that the word or string is of a group and selecting the group that has the highest probability. For example, the word “game” would have a higher likelihood of belong to the classification of “Sports” than that of “Business”. One of ordinary skill in the art will appreciate that any classifier model to determine classification of words or stems in text data 116 without deviating from the invention. Example classifier models include, but are not limited to, decision trees, nearest neighbor cluster analysis, or classifier neural networks.

In various embodiments, mask module 114 of CAT program 112 inserts one or more masks for any important words in text data 116. Each mask indicates potential words for perturbation that can be altered when generating perturbed text 118. Mask module 114 determines important words based on a feature attribution model, which can be one of various embodiments. One example of a feature attribution model is integrated gradients. Integrated Gradient is a deep neural network model that measures the importance of each component of a data set, in this scenario the importance of words in a sentence. In natural language processing, an integrated gradient model assigns an attribution value to each word, which reflects how much contribution a word makes to a classification, such as by classifier model 113. The integrated gradient model starts with a baseline attribution value for each word then. Then for numerous iterations, the integrated gradient model modifies the baseline attribution values for each word until an influence for each word in the sentence is determined. This influence is a “gradient” showing informational flow or importance of a word over others in the sentence. One of ordinary skill in the art will appreciate that any methodology could be used to determine important words in text data 116 including, but not limited to, Parts-of-Speech (POS) tagging, semantic networks and the like.

In various embodiments, each important word is associated with an attribute of text data 116 and with a variety of candidate perturbations that are evaluated on both the difference to the original text but also for fluency to maintain grammatical and semantical structure. In various embodiments, CAT program 112 generates various candidate perturbations of text data 116. For the masked important words, CAT program 112 identifies the attribute assigned to each masked word and generates various candidate perturbations by changing the important words to words with different attributes, which is recorded as attribute data 119. For example, if an important word “PC” is assigned a “technology” attribute, CAT program 112 generates candidate perturbations that change “PC” to words not belonging to the “technology” attribute, such as words belonging to “cooking” or “finance”. Additionally, attribute data 119 includes the removed attributes caused by the perturbation. In the previous example, a removal of the “PC” word would be indicated as removal of the technology attribute by “-technology” and addition of the cooking attribute by “+cooking”.

In various embodiments, CAT program 112 determines an edit distance between the original text data 116 and each of the candidate perturbations. The edit distance is a numerical measure of the amount of edits or changes between text data 116 and the candidate perturbations. In some scenarios, edit distance is based on a letter-by-letter comparison of text. For example, the original text “Jack ran down the hill” that has a perturbed candidate that replaces “hill” to “Jack ran down the aisle” would have an edit distance of four (4) units since both words share the letter “i” in the same place, but differ for the four remaining letter of “aisle”. In other scenarios, edit distance is based on word-by word changes, where in the previous example the edit distance is one (1) unit since only one word was changed.

In various embodiments, language model 115 is a pre-trained neural network for masked-language modeling (MLM). Language model 115 includes a Bidirectional Encoder Representations from Transformers, or BERT model. A BERT transformer model digests sequential text from text data 116 (i.e., sentences or paragraphs) and generates word embeddings or phrase embeddings (e.g., more than one word of the document is represented by the embedding) representing the topics or concepts discussed in the text. The MLM-BERT language model 115 model masks or removes important words from the candidate perturbations and then predicts the most likely word for the masked word. In each evaluation of text data, an important word that is being perturbed is removed from text data 116. The MLM-BERT model then determines a loss function between the predicted word by the MLM-BERT and then processes the candidate perturbations with the BERT model loss score without masking.

In various embodiments, based on the edit distance and loss scores between text data 116 and the candidate perturbations, CAT program 112 selects the candidate perturbation which maximizes the following objective function:

\(\begin{matrix}
{{{{\max\left( {x^{\prime} \in X} \right)\left\{ {{❘{❘{{\vartheta\left( x^{\prime} \right)} - {\vartheta\left( x^{\prime} \right)}}❘}❘}_{\infty} - {\beta{\sum\limits_{i}{❘{{\vartheta_{i}\left( x^{\prime} \right)} - {\vartheta_{i}(x)}}}}}} \right.}\text{|>}}\tau} + {\lambda*\max\left( {j \in \frac{Y}{y}} \right)\left\{ {\left\lbrack {f\left( x^{\prime} \right)} \right\rbrack_{j} - \left\lbrack {f(x)} \right\rbrack_{y}} \right\}} + {n*{p_{LM}\left( x^{\prime} \right)}} - {v*{d_{Lev}\left( {x^{\prime},x} \right)}}} & \left\lbrack {E\text{.1}} \right\rbrack
\end{matrix}\)

In E.1 above, given an input text x∈X, and a text classification model f( ) which predicts y=f(x)∈Y, to create a perturbed instance x′ such that the predictions f(x)≠f(x′) and x′ is minimally different from x. CAT program 112 uses a set of m attribute classifiers ϑi: X →, i∈{1 . . . m}, which produce scores indicative of presence (higher scores) or absence (lower scores) of corresponding attributes in the text. If attribute i is added to the perturbed sentence if 119 |ϑi(x′)−ϑi(x)|>τ and removed when |ϑi(x′)−ϑi(x)|>−τ, for a fixed τ>0. Edit distance between original and perturbed instance is determined via a word level Levenstien dLev(x′, x), which is the minimum number of deletions, substitutions, or insertions required to transform x to x′ is used to keep the perturbed instance close to the original. The fluency of a generated sentence x′ is quantified by the likelihood of sentence x′ as measured by the language model used for generation; the likelihood is denoted by pLM(x′). For a predicate Φ, CAT program 112 denotes 1Φ the indicator of Φ, which takes the value 1 if Φ is true and 0 otherwise. ϑ(x) is a vector such that [ϑ(x)]i=ϑi(x), β, λ, n, v>0 are hyperparameters that trade-off different aspects, and ∥*∥∞ is the 1∞ norm. The first term in the objective function encourages to pick an x0 where at least one attribute is either added/removed from x. The second term minimizes the number of such attributes for ease of interpretation. The third term is the contrastive score, which encourages the perturbed instance to be predicted different than the original instance. Fourth and fifth terms ensure that the contrast is fluent and close to the original instance, respectively.

In various embodiments, CAT program 112 selects the candidate perturbation which maximizes E.1. Once the candidate perturbation is selected, the perturbed text is provided to the user as perturbed text 118. In various embodiments, CAT program 112 provides, to the classifier model 113, attribute data 119 regarding the attributes that were added and removed from input text data 116 to the selected perturbed text 118. In such scenarios, CAT program 112 can be used to detect bias of classifier model 113. Based on the difference in attribute data 119, and therefore changes in input text data 116, changes in classification of the classifier model 113 can be observed. The following table provides a few examples where input text data 116 (with original removed text indicated as strikethrough) has been perturbed (i.e., perturbed text 118, shown as underlines), with changes to attribute data 119 (removed attributes and added attributes) as well as initial and perturbed classifications of input text data 116 and perturbed text 118, respectively.

The above table shows the results of CAT program 112 when generating perturbed text 118 for five headlines found in news articles. In the first example, the classifier model 113 determines that the headline likely directed towards “sci-tech” because if the headline was more related to topics such as things for sale, baseball, hockey, and less about computer-related topics, it would have been predicted sports, which is achieved in the contrast by replacing “File” with “Salary”. In this example, classifier model 113 considers “Torrent” a sports team because of the change. The second example illustrate how the attribute changes relate to the perturbed classifier. In this example, CAT program 112 identifies what topics the classifier model 113 finds most relevant to the prediction, as opposed to only knowing the single word and needing to figure out why that caused the change. In the third example, adding politics and removing money leads to changing the input from business to sci-tech as “factory growth” has more relationship to money while “population growth” is related to politics. In the fourth example, CAT program 112 identifies the opposite, as adding money and removing politics changes the input from world to business. In this example, CAT program 112 illustrates that, for longer text, single perturbations are often insufficient to flip the label and multiple changes are needed. In the above examples, CAT program 112 reevaluates perturbed text 118 with classifier model 113. Given a different classification (i.e., Input Classifier is different from Perturbed Classifier in the above table), then CAT program 112 identifies changes in attribute data 119 to identify any biases of classifier model 113.

FIG. 2 illustrates operational processes, generally designated 200, of contrastive attribute text (CAT) program 112, on computing device 110 within the environment of FIG. 1. In process 202, CAT program 112 receives text input from a user as text data 116. In some scenarios, CAT program 112 is provided a sentence to perturb. In other scenarios, text data 116 includes more than one sentence to perturb. In such scenarios, CAT program 112 repeats processes 204-216 for each sentence in text data. In further scenarios, CAT program 112 perturbs larger blocks of text, such as a paragraph or an entire article of text.

In process 204, CAT program 112 determines classifiers for text data 116. Classifier model 113 includes a trained machine learning model for classifying components of text data 116. For each word, a classification regarding the domain or features of the text is determined. For example, CAT program 112 determines a subject matter domain for each subject or object referenced in text data 116. In process 206, CAT program 112 inserts masks for important words. Important words are identified via an integrated gradients model applied to each word of text data 116.

In process 208, CAT program 112 generates candidate perturbations from input text 116. Candidate perturbations change one or more important words of text data. Based on the classification of the important words, CAT program 112 identifies words that do not possess attributes associated with the classification. For example, if an important word is classified as related to “Sports” then candidate perturbations generated by CAT program 112 are any words that do not possess attributes or can be classified as related to “Sports”.

In process 210, CAT program 112 determines the edit distance between each of the candidate perturbations to text data 116. Edit distance correlates to the number of changes made to text data 116. In some instances, CAT program 112 determines edit distance based on the number of words that have been changed. In other instances, CAT program 112 determines edit distance based on the number of characters that have been changed. In process 212, CAT program 112 determines the fluency of the candidate perturbations. CAT program 112 deploys language model 115 which includes a MLM-BERT model that utilizes a mask-based approach that removes words from text and predicts the missing word. The perturbation that is closest to the prediction is determined to be more fluent.

In process 214, CAT program 112 selects the candidate that maximizes the objective function E.1. As stated in processes 210 and 212, the closest candidate in terms of edit distance and fluency which maximizes the value of E.1 is selected as perturbed text 118. In process 216, CAT program 112 provides the user with perturbed text 118. Additionally, CAT program 112 provides attribute data 119 which indicates the attributes that were removed from text data 116 and added to perturbed text 118.

FIG. 3 depicts a block diagram of the system architecture 300 utilized by a CAT program 112. As discussed herein, text data 116 is provided to CAT program 112 as well as a classifier model 113. Via an integrated gradients neural network, CAT program 112 identifies important words 312 in text data 116. For at least one important word in important words 312, CAT program 112 perturbs or changes the word to generate one or more candidate perturbations. Based on the evaluation of language model 115, the perturbation that is most fluent is selected as perturbed text 118. Any changes the text data are recorded based on the attributes of text data 116 that are removed or added to perturbed text 118 as perturbed classification 314.

In various embodiments, CAT program 112 reclassifies perturbed text 118 to evaluate classifier model 113 for any bias present in the model. If classifier model 113 generates a classifier that is determined to show bias, the CAT program 112 monitors that changes in classification caused by perturbed text 118. If the additional or removal of an attribute indicates bias by classifier model 113, then CAT program 112 identities that words classified with the attribute or attributes that indicated the bias and provides the results for review to retrain or update classifier model 113.

FIG. 4 depicts a block diagram, 400, of components of computing device 110, in accordance with an illustrative embodiment of the present invention. It should be appreciated that FIG. 4 provides only an illustration of one implementation and does not imply any limitations with regard to the environments in which different embodiments may be implemented. Many modifications to the depicted environment may be made.

Computing device 110 includes communications fabric 402, which provides communications between computer processor(s) 404, memory 406, persistent storage 408, communications unit 410, and input/output (I/O) interface(s) 412. Communications fabric 402 can be implemented with any architecture designed for passing data and/or control information between processors (such as microprocessors, communications and network processors, etc.), system memory, peripheral devices, and any other hardware components within a system. For example, communications fabric 402 can be implemented with one or more buses.

Memory 406 and persistent storage 408 are computer-readable storage media. In this embodiment, memory 406 includes random access memory (RAM) 414 and cache memory 416. In general, memory 406 can include any suitable volatile or non-volatile computer-readable storage media.

CAT program 112, classifier model 113, mask module 114, language model 115, text data 116, perturbed text 118 and attribute data 119 are stored in persistent storage 408 for execution and/or access by one or more of the respective computer processors 404 via one or more memories of memory 406. In this embodiment, persistent storage 408 includes a magnetic hard disk drive. Alternatively, or in addition to a magnetic hard disk drive, persistent storage 408 can include a solid state hard drive, a semiconductor storage device, read-only memory (ROM), erasable programmable read-only memory (EPROM), flash memory, or any other computer-readable storage media that is capable of storing program instructions or digital information.

The media used by persistent storage 408 may also be removable. For example, a removable hard drive may be used for persistent storage 408. Other examples include optical and magnetic disks, thumb drives, and smart cards that are inserted into a drive for transfer onto another computer-readable storage medium that is also part of persistent storage 408.

Communications unit 410, in these examples, provides for communications with other data processing systems or devices, including resources of network 120. In these examples, communications unit 410 includes one or more network interface cards. Communications unit 410 may provide communications through the use of either or both physical and wireless communications links. CAT program 112, classifier model 113, mask module 114, language model 115, text data 116, perturbed text 118 and attribute data 119 may be downloaded to persistent storage 408 through communications unit 410.

I/O interface(s) 412 allows for input and output of data with other devices that may be connected to computing device 110. For example, I/O interface 412 may provide a connection to external devices 418 such as a keyboard, keypad, a touch screen, and/or some other suitable input device. External devices 418 can also include portable computer-readable storage media such as, for example, thumb drives, portable optical or magnetic disks, and memory cards. Software and data used to practice embodiments of the present invention, e.g., CAT program 112, classifier model 113, mask module 114, language model 115, text data 116, perturbed text 118 and attribute data 119, can be stored on such portable computer-readable storage media and can be loaded onto persistent storage 408 via I/O interface(s) 412. I/O interface(s) 412 also connect to a display 420.

Display 420 provides a mechanism to display data to a user and may be, for example, a computer monitor, or a television screen.

The programs described herein are identified based upon the application for which they are implemented in a specific embodiment of the invention. However, it should be appreciated that any particular program nomenclature herein is used merely for convenience, and thus the invention should not be limited to use solely in any specific application identified and/or implied by such nomenclature.

