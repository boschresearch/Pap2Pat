{
    "id": "https://semopenalex.org/work/W3111561052",
    "authors": [
        "John Preskill",
        "Oskar Painter",
        "Liang Jiang",
        "Earl T. Campbell",
        "Gil Refael",
        "Fernando G. S. L. Brand\u00e3o",
        "Steven T. Flammia",
        "Amir H. Safavi-Naeini",
        "Andrew J. Keller",
        "Christopher Chamberland",
        "Kyungjoo Noh",
        "Joseph Iverson",
        "Thomas C. Bohdanowicz",
        "Patricio Arrangoiz-Arriola",
        "Connor T. Hann",
        "Harald Putterman"
    ],
    "title": "Building a Fault-Tolerant Quantum Computer Using Concatenated Cat Codes",
    "date": "2022-02-23",
    "abstract": "We present a comprehensive architectural analysis for a proposed fault-tolerant quantum computer based on cat codes concatenated with outer quantum error-correcting codes. For the physical hardware, we propose a system of acoustic resonators coupled to superconducting circuits with a two-dimensional layout. Using estimated physical parameters for the hardware, we perform a detailed error analysis of measurements and gates, including CNOT and Toffoli gates. Having built a realistic noise model, we numerically simulate quantum error correction when the outer code is either a repetition code or a thin rectangular surface code. Our next step toward universal fault-tolerant quantum computation is a protocol for fault-tolerant Toffoli magic state preparation that significantly improves upon the fidelity of physical Toffoli gates at very low qubit cost. To achieve even lower overheads, we devise a new magic-state distillation protocol for Toffoli states. Combining these results together, we obtain realistic full-resource estimates of the physical error rates and overheads needed to run useful fault-tolerant quantum algorithms. We find that with around 1,000 superconducting circuit components, one could construct a fault-tolerant quantum computer that can run circuits which are currently intractable for classical computers. Hardware with 18,000 superconducting circuit components, in turn, could simulate the Hubbard model in a regime beyond the reach of classical computing.",
    "sections": [
        {
            "title": "I. INTRODUCTION",
            "paragraphs": [
                "Building a fault-tolerant quantum computer is one of the great scientific and engineering challenges of the 21st century. A successful quantum-computing architecture must meet many conflicting demands: it must have an errorcorrection threshold that is achievable by hardware on a large scale, a convenient physical layout, and implement arbitrary quantum algorithms with low resource overhead requirements. All proposed quantum architectures require trade-offs among these objectives. For example, the most popular proposed architecture, the surface code [1], has a convenient two-dimensional physical layout and relatively high threshold error rates, but the overhead for running useful algorithms remains daunting [2][3][4][5][6][7], even after years of optimization.",
                "Recent work has shown that qubits with highly biased noise are a promising route to fault tolerance [8][9][10][11], at least when gates that preserve the noise bias can be easily implemented in the architecture [12][13][14][15]. One possible route to realizing such qubits is via a two-component cat code [16][17][18], a bosonic qubit encoded in an oscillator mode [19][20][21], subjected to engineered two-photon dissipation [16,22,23] or an engineered Kerr nonlinearity [17,[24][25][26][27]. The engineered interaction heavily suppresses population transfer between the two constituent coherent states of the cat qubit, causing an effective noise bias towards phase-flip errors on the cat qubits [16,17]. Experiments suggest that it is possible to engineer highly biased noise with this approach [28]. Furthermore, biaspreserving CNOT and Toffoli (TOF) gates can be performed for these cat codes [13,14].",
                "The performance of dissipative cat qubits is influenced by three key parameters. The average number of excitations in each cat is |\u03b1| 2 , which determines the level of noise bias as bit flips are exponentially suppressed with |\u03b1| 2 . The rate of phase-flip errors is determined by the competition between two processes: \u03ba 1 is the single-excitation loss rate (per time) that is the main cause of phase errors; and \u03ba 2 is the engineered two-excitation dissipation rate (per time) stabilizing the cat-code subspace and suppressing errors. The ratio of these processes \u03ba 1 /\u03ba 2 is a dimensionless quantity primarily determining the phase-flip error rate. Calculating accurate predictions for \u03ba 1 /\u03ba 2 is crucial for estimating the performance of cat-qubit architectures.",
                "Concatenating the (inner) cat code with another (outer) quantum error-correcting code can reduce qubit requirements by tailoring the outer code to suppress the dominant phase-flip errors. We call these coding schemes concatenated cat codes. While this idea has been explored previously for the case where the outer code is a repetition code [14,15], these proposals are completely reliant on increasing |\u03b1| 2 to suppress bit-flip errors. As |\u03b1| 2 increases, phase errors become more frequent and other physical mechanisms start to become important, so a fully scalable architecture must allow for some bit-flip protection from the outer code. Furthermore, these previous proposals [14,15] did not study the rate of bit-flip processes during CNOT gates and did not propose a two-dimensional (2D) layout capable of implementing fault-tolerant logic. The lack of such an analysis has left open several urgent questions, such as how a 2D architecture with dissipative cats concatenated with the surface code would perform in practice, and how parameters at the hardware level (such as \u03ba 1 /\u03ba 2 ) relate to the needs of the larger architecture.",
                "In this paper, we give a full-stack analysis of a faulttolerant quantum architecture based on dissipative cat codes concatenated with outer quantum error-correcting codes. We propose a blueprint for a possible practical implementation based on hybrid electroacoustic systems consisting of acoustic resonators coupled to superconducting circuits. These systems are a promising platform for realizing concatenated cat codes due to their small footprint [29], potential for ultrahigh coherence times [30], and easy integration with superconducting circuits for control and readout [31,32].",
                "We give a comprehensive error analysis of this approach that provides a detailed picture of the physically achievable hardware parameters (including \u03ba 1 , \u03ba 2 , and |\u03b1| 2 ) and error rates for gates and measurements based on estimated parameters for coupling strengths and phonon loss and dephasing rates. Using the obtained values of the hardware parameters, we then explicitly analyze quantum error correction when the outer code is either a repetition code or a thin rectangular surface code [33,34]. We then show how to build a fault-tolerant quantum computer in our architecture, combining lattice surgery and magic state distillation for Toffoli states. Finally, we provide a resource overhead estimate as a function of physical error rates required to fault-tolerantly run quantum algorithms.",
                "Our analysis can be broadly classified into three categories: (1) a hardware proposal; (2) a physical-layer analysis of gate and measurements errors; and (3) a logical-level analysis of memory and computation failure rates. More specifically, in Sec. II we describe our hardware proposal for using phononic band-gap resonators and superconducting circuits to store and process quantum information at the physical level. This section provides a range for what hardware parameters are feasible. Then in Sec. III we give a complete analysis of gate and measurement errors for phononic qubits using realistic noise parameters that we expect from the hardware proposal. In Secs. IV, VI, and VII we give a gate-level analysis of universal faulttolerant quantum computation that looks at logical error rates across a physically relevant parameter regime."
            ],
            "subsections": []
        },
        {
            "title": "A. Overview of main results",
            "paragraphs": [
                "We frame our main results in terms of regimes for the hardware parameters, which we denote REGIME 1, REGIME 2, and REGIME 3, and which we summarize in Table I. All regimes assume the same number of excitations per cat (|\u03b1| 2 = 8) but each regime corresponds to a different order of magnitude in the crucial \u03ba 1 /\u03ba 2 parameter. In REGIME 1, the physical cat-qubit CNOT gate fails with probability 3.6 \u00d7 10 -2 , which is well above the TABLE I. The three regimes studied in this work. The dimensionless loss \u03ba 1 /\u03ba 2 is a key figure of merit of the cat code, as the Z-type error rates of the bias-preserving CNOT and Toffoli gates scale as \u221a \u03ba 1 /\u03ba 2 . Therefore, as we move from REGIME 1 to REGIME 3, the overall performance of the system improves, but the requirements imposed on the storage loss \u03ba 1 become progressively more challenging. These requirements are shown in the table, in the more intuitive form of an energy decay time T 1,i = 1/\u03ba 1,i . We also show the required values of the nonlinear interaction strength g 2 and the buffer decay rate \u03ba b , from which we calculate \u03ba 2 = 4|g 2 | 2 /\u03ba b (see Sec. II for definitions of g 2 and \u03ba b , and a derivation of the expression for \u03ba 2 ).",
                "threshold for the surface-code error correction. However, concatenating cat and repetition codes, REGIME 1 is just below the repetition-code phase-flip threshold and so is a suitable regime to demonstrate quantum error correction. In REGIME 2, it is possible to demonstrate small proof-of-principle algorithms with the cat and repetition code. However, while bit-flip errors are rare with |\u03b1| 2 = 8, without additional bit-flip protection a quantum computer would decohere before it is able to demonstrate a useful algorithm. In REGIME 2, CNOT gates fail with probability 1.2 \u00d7 10 -2 , which is above the usually reported surfacecode error-correction threshold with depolarizing noise. Nevertheless, due to noise bias and other aspects of the noise processes, REGIME 2 would allow a demonstration of fully scalable quantum error correction and computation. However, the surface-code overhead remains high in REGIME 2. In REGIME 3, CNOT gates fail with probability 3 \u00d7 10 -3 and we estimate the resource overhead costs for the task of estimating the ground-state energy density of the Hubbard model. For this algorithm, we find 6\u00d7 fewer qubits are needed than for hardware assuming an unbiased, depolarizing noise model with CNOT gate infidelities of 10 -3 as considered in Ref. [6]. We now summarize in more detail how these conclusions were reached and the technical innovations needed along the way.",
                "In Sec. II we describe our hardware proposal for using phononic-crystal-defect resonators (PCDRs), of the type reported in Ref. [32], as the storage elements. These are periodically patterned suspended nanostructures that support localized acoustic resonances in the gigahertz range. They are fabricated from a piezoelectric material such as LiNbO 3 , which allows us to couple these resonances to superconducting circuits with nearly the same strength as ordinary electromagnetic cavities. Following a recent demonstration [28], we propose implementing the twophonon dissipation by engineering an interaction through which the storage mode exchanges excitations with an ancillary \"buffer\" mode in pairs. This buffer is strongly coupled to a bath, so these excitations decay rapidly. We compute \u03ba 2 for a bath consisting of a multipole bandpass filter connected to a semi-infinite transmission line, or waveguide. The filter allows us to control the density of states of the bath, causing it to vanish at all frequencies except those within the filter passband [in this work this is modeled by connecting a dissipative circuit with an appropriate admittance function Y(\u03c9) to the buffer resonator]. The filter is useful not only to protect the storage mode from radiative decay, but also plays a crucial role in suppressing correlated phase-flip errors while stabilizing multiple storage modes simultaneously with the same buffer mode.",
                "Given the stringent requirement for \u03ba 1 /\u03ba 2 , it is ideal to maximize \u03ba 2 . In our architecture, however, \u03ba 2 is ultimately limited by crosstalk. Indeed, we find that stronger engineered dissipation can simultaneously lead to increased crosstalk, such that there comes a point where further increasing \u03ba 2 is no longer beneficial. Specifically, by quantifying crosstalk error rates and calculating their impacts on logical lifetimes, we find that the optimal value is \u03ba 2 /2\u03c0 \u2248 280 kHz at |\u03b1| 2 = 8. This constraint on \u03ba 2 is discussed further in this section under the Sec. III summary, and in more detail in Sec. C. In turn, this imposes the requirement (shown in Table I) that the intrinsic relaxation time of the storage modes be at least T 1,i \u2248 57 ms to reach REGIME 3, where it is possible to perform useful quantum algorithms. At present, piezoelectric PCDRs made of LiNbO 3 can only reach T 1,i \u2248 1 \u03bcs [35].",
                "The engineered dissipation needed to stabilize each cat code is provided by coupling each phononic resonator to nonlinear circuit elements. Specifically, we follow the approach of Ref. [28], where the nonlinearity is provided by a circuit element variant of a superconducting quantum interference device (SQUID) called an asymmetrically threaded SQUID (ATS). While Ref. [28] demonstrated an ATS can be used to stabilize a single mode into a cat code, our hardware layout necessitates that each ATS couple to and stabilize multiple resonators simultaneously. We present a simple scheme for this multiplexed stabilization, and provide a detailed analysis of the crosstalk that arises from coupling multiple modes to the same ATS. Moreover, we show that by employing a bandpass filter and carefully optimizing the phonon-mode frequencies, we are able to largely suppress the dominant sources of crosstalk in our system, though some residual crosstalk remains and we return to discuss this later.",
                "In Sec. III, we then analyze the errors in our gates and measurements. To do this, we introduce a method that we call the shifted Fock-basis method. This method allows us to efficiently perform a perturbative analysis of the dominant Z-error rates of the cat-qubit gates and improve the efficiency of numerical simulation of large cat qubits compared to the usual Fock-basis method. The shifted Fockbasis method allows us to compute the Z-error rates of various cat-qubit gates using a small Hilbert-space dimension that is independent of the average excitation number |\u03b1| 2 of the cat qubit.",
                "Using this method, we go on to show that the optimal Z-error rates (per gate) of the cat-qubit gates at the optimal gate time scale as \u221a \u03ba 1 /\u03ba 2 . The optimal Z-error rates of the CNOT and TOF gates are in fact independent of the size of the cat qubit, whereas those of Z and CZ rotations decrease linearly in 1/|\u03b1|. We also study the effects of bosonic dephasing and thermal excitations on various cat-qubit gates. Provided these additional effects are small, they do not disturb the noise bias or our main conclusion.",
                "We then develop and analyze schemes for readout in both the X and Z bases, enabling fast and hardwareefficient stabilizer measurements. For X -basis readout we propose to use an additional dedicated mode in each unit cell of our architecture. By exchanging the ancilla information with this mode and performing repeated quantum nondemolition (QND) parity measurements in parallel with the gates of the subsequent error-correction cycle, we can suppress the infidelity mechanisms associated with the transmon while having minimal impact on the syndrome measurement cycle time. We present a fast and high-fidelity Z-basis readout using the storage and buffer modes; the resulting error probability decays exponentially as a function of |\u03b1| 2 . In the Z-basis readout scheme, excitations are swapped to the buffer mode where they leak to the transmission line and are detected via a homodyne measurement.",
                "With a clear understanding of gate and measurement error rates, we proceed in Sec. IV to analyze the logical failure rates for a quantum memory based on concatenating the cat code with one of two codes: a repetition code and a thin rectangular surface code. We compute logical Z failure rates for both the repetition code and the surface code. In the case of the surface code, we compute explicit leading-order failure rates for logical X errors as a function of the Z distance of the code. Our thresholds are computed using a full circuit-level simulation and a minimum-weight perfect-matching (MWPM) decoder. These main simulation results, which inform the conclusions of Table I, neglected any crosstalk errors. While filters can suppress a wide class of crosstalk errors, there are still residual crosstalk errors that cannot be eliminated by the filters. To investigate this, we perform additional simulations using the detailed information about the residual crosstalk errors from the hardware analysis (Appendix B) and address these errors by adding extra edges in the matching graphs of the surface-code decoder. These extra edges are constructed such that they can detect unique syndrome patterns created by the residual crosstalk errors. We find that the performance of the surface code is largely unchanged in the presence of crosstalk, provided that the strength of the engineered coupling between the storage and buffer modes is less than a few MHz (this informs our choice of g 2 /2\u03c0 = 2 MHz in Table I). Were it not for crosstalk, however, the architecture could tolerate stronger engineered couplings and engineered dissipation, which would ease demands on the storage-mode coherence. Crosstalk is thus ultimately a limiting factor for our architecture, so we also describe several future research directions that would allow us to further mitigate its effects in future designs.",
                "Using the thin surface code, we consider lattice surgery as a means of performing logical Clifford operations in Sec. V. By extending our full circuit-level simulation to model timelike errors during lattice surgery, we obtain logical error probabilities for Clifford operations.",
                "To fault-tolerantly simulate universal quantum computation [36] with Toffoli gates, we introduce in Sec. VI a new protocol to fault-tolerantly prepare TOF magic states encoded in the repetition code. Due to the fault-tolerant properties of our protocol, all gates required in our circuits can be implemented at the physical level. Hence we refer to such an approach as a bottom-up approach for preparing TOF magic states. The main insight is that a TOF state can be prepared by measuring a single Clifford observable, which can be achieved using a sequence of physical CNOT and TOF gates. To ensure fault tolerance, this Clifford measurement has to be repeated a fixed number of times, but due to suppressed bit-flip noise the state does not significantly decohere during this measurement process. Using the full circuit-level noise model of Sec. III and assuming \u03ba 1 /\u03ba 2 = 10 -5 , we show that TOF magic states can be prepared with total logical Z failure rates as low as 6 \u00d7 10 -6 , which is several orders of magnitude lower than what could be achieved using non-fault-tolerant methods to prepare TOF states. Furthermore, the noise on the prepared TOF state is dominated by one specific Pauli error, which is a feature we can further exploit.",
                "In Sec. VII, we show how TOF magic states probabilistically prepared using our bottom-up approach can be injected in a new magic state distillation scheme. This protocol distills two higher-fidelity TOF states from eight lower-fidelity TOF states with high success probability. For generic noise, the protocol achieves quadratic error reduction. In the relevant case where a single Pauli error dominates, we can achieve cubic error reduction. The protocol is compiled down to architecture-level lattice-surgery operations performed at the encoded level using repetition and surface codes. Hence we refer to such an approach as being top down. Our top-down approach allows us to distill TOF magic states with low enough logical error rates for use in quantum algorithms of practical interest. Further, we note that given the low error rates achieved using our bottom-up approach, only one round of distillation is required in our top-down approach to prepare TOF states with the desired logical error rates.",
                "Finally, in Sec. VIII we analyze the overhead required for running quantum algorithms in our architecture, based on our estimated gate error rates for REGIME 3. We consider running circuits on 100 qubits with up to 1000 Toffoli gates, which are comfortably beyond the reach of classical simulability using the best currently known simulation algorithms. For circuits of this size, and for our estimated gate error rates, bit-flip errors are sufficiently rare that it suffices to concatenate the cat code with a repetition code. We find that a device with 1000-2000 ATSs could execute the circuit reliably. This number of hardware components is compatible with next generation cryogenic dilution refrigerators, indicating that our proposal holds promise for early implementations of fault-tolerant quantum computation.",
                "For known applications of quantum computing with potential commercial value, substantially larger circuits are needed. Again assuming REGIME 3 parameters, we find that for these larger circuits the cat code should be concatenated with a thin surface code, which protects against bit flips as well as phase errors, and the overhead cost is correspondingly higher. As a representative application, we consider the task of estimating the ground-state energy density of the Hubbard model. A quantum computer with about 100 logical qubits executing about 1 million Toffoli gates could perform this task in a parameter regime that is very challenging for classical computers running the best currently known classical algorithms. For this purpose we estimate that our architecture could be implemented using 18 000 ATS components and that the quantum algorithm could be executed in 32-89 min depending on the physical parameters of the Hubbard model.",
                "Notably, for this problem the magic state factory uses at most 9.5% of the total resources and is never a bottleneck on algorithm execution time. This low factory overhead is due to a combination of factors. Firstly, the bottom-up procedure gives initial TOF states with a cost that is not much more than a physical TOF but with orders of magnitude lower error rates. Secondly, at the required TOF-error rate it suffices to implement one round of the top-down protocol using a mixture of repetition codes and surface codes, which dramatically reduces the factory footprint. In contrast, the best performing T-state factories (in architectures without biased noise) rely completely on surface codes and either require multiple rounds of distillation to achieve the same error suppression [37][38][39] or only produce one T state at a time so that eight rounds are needed to realize two TOF gates [40]."
            ],
            "subsections": []
        },
        {
            "title": "II. HARDWARE IMPLEMENTATION AND STABILIZATION SCHEMES",
            "paragraphs": [
                "In our proposal, the lowest-level protection from errors occurs directly at the hardware level and is based on the idea of autonomous quantum error correction (QEC) [41], where rather than correcting errors at the \"software level,\" one instead engineers a system whose unitary evolution and dissipation is sufficient to protect the encoded information from Markovian errors. One can think of this process as the continuous analog of the standard, discrete QEC cycle consisting of syndrome measurements and correcting unitaries. The value of autonomous QEC is that it eliminates the need for active measurements and classical feedback.",
                "Historically, proposals for the implementation of autonomous QEC have been formulated in the language of coherent feedback control [42] or reservoir engineering [43,44], where the evolution is described via a stochastic master equation or a Lindblad master equation, respectively. Here we specifically adopt a bosonic autonomous QEC technique that more neatly fits into the latter category. It was first introduced by Mirrahimi et al. in 2014 [16] and demonstrated for individual qubits in recent experiments [22,23,28]. We summarize the most relevant pieces here for convenience."
            ],
            "subsections": []
        },
        {
            "title": "A. Overview of cat codes and driven-dissipative stabilization",
            "paragraphs": [
                "The basic idea is to encode a qubit in a two-dimensional subspace S = span{| -\u03b1 , | + \u03b1 } of a harmonic oscillator, spanned by the two quasiorthogonal coherent states | \u00b1 \u03b1 [45,46]. The qubit states can be defined in the X basis as the following two-component Schr\u00f6dinger cat states (see also Fig. 1):",
                "( 1 )",
                "These states are eigenstates of the parity operator P = exp (i\u03c0 \u00e2 \u2020 \u00e2) with eigenvalues \u00b11, and N \u00b1 = 1/ 2(1 \u00b1 e -|2\u03b1| 2 ). The codewords of this code are",
                "Note that |0 \u2248 | + \u03b1 and |1 \u2248 | -\u03b1 is a very good approximation for |\u03b1| 2  1, as is typically assumed throughout this paper. The notation |0 and |1 is reserved for these cat-qubit computational states throughout, and to avoid ambiguity we use |n = 0 and |n = 1 for the vacuum and single-phonon (or photon in some alternative architectures) Fock states.",
                "The usual error channels that affect real oscillators, such as energy relaxation and dephasing, will eventually corrupt the information encoded in this manner. To protect against these common errors, one can engineer an artificial coupling to a bath such that the oscillator emits and absorbs only excitations to and from this bath in pairs. Such dynamics can be modeled by a Lindblad master equation of the form",
                "where D[ L] \u03c1 := L \u03c1 L \u2020 -(1/2)( L \u2020 L \u03c1 + \u03c1 L \u2020 L), \u03ba 1 is the usual single-phonon (or photon) dissipation rate, \u03ba \u03c6 is the pure dephasing rate, and \u03ba 2 is a two-phonon (or twophoton) dissipation rate. In the case where \u03ba 1 = \u03ba \u03c6 = 0, any linear combination of the codewords |0 , |1 is a steady state of Eq. ( 4). This is straightforward to see, as any state for which \u00e22 |\u03c8 = \u03b1 2 |\u03c8 is stationary under this master equation, and this includes both the even-and oddparity cats. Furthermore, outside this subspace, there are no further steady states of the Lindblad master equation. Therefore, any initial state will eventually evolve to a mixture of states within this subspace. We refer to the rate at which this decay happens as the confinement rate, \u03ba conf ; using the displaced Fock basis (see Appendix C) one can show that \u03ba conf = 4|\u03b1| 2 \u03ba 2 . For finite \u03ba 1 , \u03ba \u03c6 , this description of the dynamics no longer holds true exactly. In particular, the stationary solutions of Eq. ( 4) are no longer pure states. However, if \u03ba conf > \u03ba err , where \u03ba err is the effective error rate, then the codewords are still metastable states.",
                "The threshold \u03ba err depends on the error channel in question: \u03ba err = \u03ba 1 for phonon (or photon) loss, and \u03ba err = \u03ba \u03c6 for dephasing [47].",
                "The key feature of this code is that, above the threshold \u03ba conf > \u03ba err , the bit-flip rate (or rate of X -type errors) 0\u21941 decays exponentially with the \"code distance\" |\u03b1| 2 as 0\u21941 \u223c |\u03b1| 2 e -c|\u03b1| 2 \u03ba err , ( 5 ) where 2 \u2264 c \u2264 4 for phonon (or photon) loss [15] and c = 2 for dephasing [16]. On the other hand, the phase-flip rate (or rate of Z-type errors) +\u2194-increases linearly as",
                "For sufficiently small values of the dimensionless loss parameter \u03ba err /\u03ba 2 , and sufficiently large |\u03b1| 2 , this translates to a large noise bias, i.e., a large discrepancy between the X -and Z-error rates. As alluded to earlier, this bias is a key feature of our proposal and will be exploited when designing the outer error-correcting codes.",
                "The driven-dissipative dynamics of Eq. ( 4) can be physically realized by using a cleverly designed nonlinear element to couple the storage mode \u00e2 to an engineered environment, or reservoir. Following Refs. [22,28], the idea is to generate a nonlinear interaction of the form g * 2 \u00e22 b \u2020 + h.c. between the storage mode and an ancillary mode b, which here we refer to as the \"buffer mode\" in keeping with existing terminology. The buffer mode is in turn strongly coupled to a bath-it is designed to have a large energy relaxation rate \u03ba b so that it rapidly and irreversibly emits the photons it contains into the environment. If \u03ba b g 2 , the b mode is in the vacuum state | b \u2020 b = 0 most of the time, and its excited states can be adiabatically eliminated from the Hamiltonian [22,48]. In this picture, there exists an effective Markovian description of the \u00e2mode dynamics where the b mode is considered as part of the environment and where the emission of excitations via g * 2 \u00e22 b \u2020 can be accurately modeled as a dissipative process acting on the \u00e2 mode alone. To stimulate the absorption process g 2 \u00e2 \u20202 b a linear drive * d be -i\u03c9 d t + h.c. on the buffer mode is added to supply the required energy. With this drive tuned on resonance with the buffer (\u03c9 d = \u03c9 b ), the evolution of the combined system is described by",
                "where \u03b1 2 :=d /g * 2 . After adiabatically eliminating the b mode, this master equation becomes Eq. ( 4), with \u03ba 2 = 4|g 2 | 2 /\u03ba b ."
            ],
            "subsections": []
        },
        {
            "title": "B. Physical implementation of buffer and storage resonators",
            "paragraphs": [
                "To realize the dynamics described by Eq. ( 7) in practice, previous demonstrations of two-phonon dissipation have relied on Josephson junctions [22,23] or an \"ATS\" [28] as the source of nonlinearity. Other variations of the nonlinear elements exist, for instance the \"SNAIL\" [27,49], but in this proposal we adopt the ATS due to the advantages it has over other nonlinear elements. These advantages are outlined in Ref. [28].",
                "The potential energy of an ATS has the form sin( \u03c6), where \u03c6 = \u03d5 a \u00e2 + \u03d5 b b + h.c. is the superconducting phase difference across the ATS and \u03d5 a , \u03d5 b are vacuum fluctuation amplitudes that quantify the contribution of the \u00e2 and b modes to the phase \u03c6. It is important to emphasize that here \u00e2, b are the normal modes of the combined storage and buffer resonators. Because these resonators are far detuned, there is little mixing between them, so \u00e2 is \"storagelike\" and b is \"bufferlike.\" Terms of cubic and higher orders in the power-series expansion of sin( \u03c6) generate nonlinear couplings between the modes, provided that the required energy is injected with pumps tuned to the appropriate frequencies. The desired interaction g * 2 \u00e22 b \u2020 + h.c. can be resonantly activated by modulating the magnetic flux that threads the ATS at frequency \u03c9 p = 2\u03c9 a -\u03c9 b . This modulation, which from now on we refer to as the \"pump,\" provides the missing energy in the conversion process-two storage phonons get converted to a buffer photon and pump photon. To stimulate the reverse process-the conversion of a buffer and a pump photon to two storage phonons-a linear drive * d be -i\u03c9 d t + h.c. at frequency \u03c9 d is applied to the buffer. From now on we refer to this simply as the \"drive.\" For further details on the implementation and the calculation of g 2 , see Appendix A and Ref. [28].",
                "For the storage oscillator, the three cited experiments have used either superconducting three-dimensional (3D) microwave cavities [22,23] or on-chip coplanarwaveguide (CPW) resonators [28], and recent theoretical proposals have focused on similar implementations [14,15]. Here we study the possibility of using nanomechanical resonators instead, and tailor our calculations specifically to the case of one-dimensional PCDRs made of lithium niobate, a crystalline piezoelectric material. These devices support resonances at gigahertz frequencies, with modes that are localized inside a volume < 1 \u03bcm 3 of a suspended nanostructure. They have been coupled to transmon qubits in recent experiments [32,50] and may offer a number of advantages over electromagnetic resonators.",
                "First, a PCDR is a micron-scale nanostructured device, with an on-chip footprint (area) that is at least 3 orders of magnitude smaller than that of planar superconducting resonators, including lumped-element structures. This is not a significant advantage today, with the largest quantum computers only having a few dozen physical qubits, but it may become important in the future.",
                "A second consideration is that, unlike electromagnetic resonators, appropriately designed acoustic devices do not experience direct crosstalk (unwanted couplings) because acoustic waves do not propagate through vacuum. They can still couple through the circuitry that mediates interactions between them, but this can be mitigated with approaches such as filtering and a carefully chosen connectivity, both of which are important features of our proposal.",
                "The third and most important consideration is that there is recent experimental evidence that phononic-crystalbased devices can have very long coherence times as a result of the high degree of confinement of their modes and the quality of their materials. For example, devices fabricated from silicon and operating at a frequency of 5 GHz have been shown to have energy relaxation and pure dephasing times of T 1 \u2248 1.5 s and T \u03c6 \u2248 130 \u03bcs, respectively [30]. These silicon devices cannot be easily coupled to superconducting circuits, but they offer insight into the decoherence mechanisms affecting nanomechanical resonators and suggest a roadmap for achieving similar levels of coherence with piezoelectric devices. For example, similar studies with lithium niobate PCDRs are already under way [35], and although their coherence times are currently limited to approximately 1 \u03bcs, it is possible their performance could approach that of the silicon devices after sufficient advances in materials and surface science.",
                "We remark that although we have tailored our calculations to the case of PCDRs, the results of this proposal are still applicable to a setting where the storage modes are electromagnetic."
            ],
            "subsections": []
        },
        {
            "title": "C. Wiring and layout",
            "paragraphs": [
                "We now describe a way to combine all of these building blocks to build a two-dimensional grid of cat qubits that form the basis for an outer code, such as the repetition code or the surface code. First, following Ref. [28] we form a buffer resonator with frequency \u03c9 b by shunting an ATS with a capacitor. This buffer mode is then coupled to the input of a bandpass filter that passes frequencies within a bandwidth 4J centered at \u03c9 b and attenuates frequencies outside this range. The output of the filter is connected to an open waveguide (which can be accurately modeled as a resistive termination). This filter configuration stands in contrast to the implementation in Ref. [28], where a bandstop filter (that instead attenuates frequencies within some band and passes all others) was used to protect the storage mode from radiatively decaying into the waveguide. In our proposal, the bandpass filter also serves this role, but it also plays a more fundamental role as a means of suppressing crosstalk mechanisms that arise as a result of our frequency-multiplexed scheme to stabilize (and perform gates between) multiple modes with a single ATS. From this point on, we refer to the combination of the buffer, filter, and waveguide as the \"reservoir.\"",
                "We arrange reservoirs in a two-dimensional grid, as shown in Fig. 2, and connect neighboring reservoirs with a PCDR using each of the two terminals of the resonator. The reservoirs provide the connectivity between resonators and are located above, below, to the left, and to the right of each resonator. These four resonators serve as data and ancilla qubits in either the repetition or the surface code. In addition, one more resonator coupled to each reservoir serves the purpose of an ancillary readout mode, which is used to measure the cat qubits in the X basis with the aid of an ordinary transmon. Alternatively, it is possible to omit this resonator altogether and perform the X readout directly via the buffer-see Appendix H for further details.",
                "There are two important considerations that motivate this architecture. The first is that present PCDR designs only have two available terminals, so each of them can be connected to at most two different reservoir circuits. This is simply a design choice-it may be possible to add more terminals without a significant degradation of performance, and this would enable other variations of the 2D layout. The second consideration comes from our analysis of correlated errors in the frequency-multiplexed stabilization scheme, which we overview below and provide details of in Appendix B. Our results show that the correlated error rates increase rapidly with the number of modes connected In the 2D grid on the right, yellow circles represent data qubits where the logical information is encoded, and gray circles represent ancilla qubits, which are used to measure the stabilizers and extract error syndromes. Both data and ancilla qubits are encoded as Schr\u00f6dinger cat states of localized acoustic modes of PCDRs, and are stabilized through a driven-dissipative two-phonon interaction with an engineered reservoir. This stabilization strongly biases the noise, suppressing X errors and increasing Z errors. The letter R in each plaquette represents the reservoir, which is implemented with a capacitively shunted ATS (the \"buffer\" resonator), a bandpass filter, and an open waveguide. This circuit is shown inside the \"RESVR\" box in the left panel and has a single nongrounded terminal, marked with a white circle on the edge of the box. All resonators surrounding each reservoir in the layout diagram in the center panel connect to this one physical terminal. The green circles represent an additional acoustic mode used to measure the cat qubits in the X basis with the aid of a transmon, which is represented by a white square. Altogether, five PCDRs are connected to each reservoir: four as active qubits, and one for readout.",
                "to an ATS, and the error rates that come with choosing five modes per ATS are the largest that can be tolerated by the outer error-correcting codes."
            ],
            "subsections": []
        },
        {
            "title": "D. Estimation of dissipation rates \u03ba 1 and \u03ba 2",
            "paragraphs": [
                "The dissipation rates \u03ba 1 and \u03ba 2 are crucial parameters: they set the error rates of the gates, as well as the error rates during idling, state preparation, and measurement. Two-phonon loss is an engineered process, so the twophonon loss rate \u03ba 2 is a parameter that we can calculate. On the other hand, the single-phonon loss rate \u03ba 1 is largely determined by intrinsic properties of the hardware. To construct the error model we use in this proposal, then, the starting points are to (1) calculate a prediction for the maximum achievable value of \u03ba 2 , and (2) infer the values of \u03ba 1 that are required to reach various regimes of interest. We consider three distinct regimes in this proposal, characterized by the magnitude of the \"dimensionless loss\" parameter \u03ba 1 /\u03ba 2 : 10 -3 (REGIME 1), 10 -4 (REGIME 2), and 10 -5 (REGIME 3). This parameter is particularly important because the Z-type error rates scale as approximately \u221a \u03ba 1 /\u03ba 2 for both the CNOT and Toffoli gates (see Sec. III and Table II for further details). These regimes are summarized in Table I.",
                "A summary of our \u03ba 2 calculation is presented next, with further details contained in Appendix A. As described previously, the way the two-phonon loss is engineered is by inducing a nonlinear coupling g * 2 \u00e22 b \u2020 + h.c. between the storage mode \u00e2 and a buffer mode b, which decays into the environment at rate \u03ba b . A key requirement is that \u03ba b 2|\u03b1|g 2 , so that the excited states of the buffer can be adiabatically eliminated to yield an effective description where the storage directly experiences two-phonon loss. In this adiabatic regime, \u03ba 2 \u2248 4|g 2 | 2 /\u03ba b . We may write the adiabaticity constraint as g 2 = \u03b7\u03ba b /2|\u03b1| for some \u03b7 1. We have observed numerically that \u03b7 = 1/5 is sufficient to stabilize high-fidelity cat states. Putting this together, we find that the maximum achievable two-phonon dissipation rate scales linearly with the buffer decay rate \u03ba b and inversely with the mean phonon number |\u03b1| 2 (the \"distance\" of the cat code):",
                "We note that the maximum achievable \u03ba b is upper bounded by the filter bandwidth, 4J (see Appendix A for details). In this work, we fix 4J /2\u03c0 = 100 MHz, which is sufficient to satisfy \u03ba b \u2264 4J for the values of \u03ba b we consider. We now move on to estimating the required values of the single-phonon loss rate \u03ba 1 . Before doing so, we first recall that \u00e2 and b are the normal-or hybridized-modes of the system, and therefore \u03ba 1 is given by  I. The noise model is pure loss with rate \u03ba 1 and no gain or dephasing noise. \u03b1 is the cat-code parameter and \u03ba 2 is the rate of two-phonon dissipation. The rightmost column gives the formula in terms of \u03b1, \u03ba 1 , and \u03ba 2 . The Toffoli optimal gate time is similar to the CNOT optimal gate time (see Appendix E). For simplicity and because the CNOT gate time sets the time scale of error correction, the Toffoli gate error rates are shown for a gate time equal to the CNOT optimal gate time. In the error probability formulas for Idling, T is the length of time that the system idles. The error probabilities for idle for the three regimes are calculated using the CNOT optimal gate time. ",
                "Here g is the linear coupling rate between the bare storage and buffer resonators, \u03b4 = \u03c9 b -\u03c9 a is their detuning, and \u03ba b,i is the intrinsic decay rate of the bare buffer resonator. The first contribution \u03ba 1,i is the intrinsic loss rate of the bare storage mode, an empirical quantity that depends, for example, on the quality of the resonator materials. The second contribution \u03ba 1,rad is due to direct radiative decay into the buffer bath, which we make negligibly small by ensuring the storage frequency \u03c9 a lies far outside of the filter passband, or in other words by ensuring the bath has a vanishing density of states at \u03c9 a . The third contribution (g/\u03b4) 2 \u03ba b,i is due to the intrinsic loss of the bare buffer resonator, which the storage inherits due to their hybridization and which the filter cannot protect against. Usually |g/\u03b4| \u223c 10 -2 , so this last contribution is important when \u03ba 1,i \u03ba b,i . Summing up, \u03ba 1 \u2248 \u03ba 1,i + (g/\u03b4) 2 \u03ba b,i when the buffer bath has a vanishing density of states at \u03c9 a . A key result of our analysis is that (g/\u03b4) 2 \u03ba b,i can be strongly suppressed by using a buffer resonator with a large characteristic impedance Z b . This can be accomplished by increasing |\u03b4| until (g/\u03b4) 2 \u03ba b,i is suppressed to a value comparable to or smaller than \u03ba 1,i . This comes at the cost of reducing the nonlinear interaction rate g 2 , which also scales with the detuning as g 2 \u223c 1/\u03b4 2 . But one can offset this penalty by increasing Z b , because g 2 \u223c Z 5/2 b as we show in Appendix A. We show that under certain assumptions of \u03ba b,i and \u03ba 1,i , once Z b \u223c 1 k we can access a regime where \u03ba 1 \u2248 \u03ba 1,i and therefore",
                "This is a useful result, as it addresses the problems that arise when coupling a highly coherent, linear storage element to a much lossier superconducting circuit. In Fig. 3, we plot this simple expression for \u03ba 1 /\u03ba 2 as a function of \u03ba 1,i and \u03ba b . We assume |\u03b1| 2 = 8, which is large enough to result in good performance of the outer codes.",
                "In later sections, we analyze the performance of our architecture and find that there is an upper limit on \u03ba b , beyond which crosstalk begins to inhibit the performance of the architecture. Specifically, in Sec. IV C, we show that the nonlinear coupling strength must satisfy g 2 /2\u03c0 \u2264 2 MHz, lest crosstalk degrade the logical lifetimes. As a result, we have the restriction that \u03ba b = 2|\u03b1|g 2 /\u03b7 \u2264 2\u03c0 \u00d7 57 MHz. At this maximal value, the \u03ba 1,i values needed to reach the three different regimes we study in this paper are indicated in Fig. 3 (see also Table I). Because crosstalk is thus a limiting factor for our architecture, we remark that there are several ways crosstalk could be mitigated in future designs. For example, in Appendix H, we describe an alternative version of our architecture with four modes per unit cell as opposed to five; this modification reduces crosstalk, thereby enabling larger \u03ba 2 and easing the \u03ba 1,i requirements. Future approaches could reduce the number of modes per unit cell even further by increasing the number of terminals of each PCDR.",
                "It is important to note that the value \u03ba 2 \u2248 4|g 2 | 2 /\u03ba b \u223c 2\u03c0 \u00d7 280 kHz that we derive in this analysis, while theoretically possible, would require a larger values of g 2 (about 5 times larger) than those previously reported [28]. Because \u03b1 2 =d /g * 2 (see Sec. II A), this would require a larger drive amplitude on the buffer mode in order to maintain a fixed \u03b1, which may cause unforeseen problems such as instabilities [51] or the excitation of spurious transitions [52,53]. Furthermore, the large buffer impedance Z b required increases the size of the vacuum fluctuations of the superconducting phase \u03c6, making the system more prone to instabilities. A detailed analysis of the powerhandling capacity of our system is beyond the scope of this work. This is an area of active research, with promising advances such as the use of inductive shunts to suppress instabilities [54]."
            ],
            "subsections": []
        },
        {
            "title": "E. Multiplexed stabilization",
            "paragraphs": [
                "In our architecture, each reservoir is responsible for stabilizing multiple storage modes simultaneously, in contrast to prior proposals [14,16]. This multiplexed stabilization is both beneficial and necessary in the context of our architecture. Stabilizing multiple storage modes with a single reservoir is clearly beneficial from the perspective of hardware efficiency, as the required number of ATSs and control lines is reduced. Moreover, the use of PCDRs (as opposed to, e.g., electromagnetic resonators) actually necessitates multiplexed stabilization. Current PCDR designs have only two terminals, meaning that a PCDR can couple to at most two different reservoir circuits, yet each reservoir must couple to at least four storage modes in order to achieve the required 2D-grid connectivity. Each reservoir must necessarily stabilize multiple storage modes as a result.",
                "Conveniently, we find that multiplexed stabilization can be implemented via a simple extension of the singlemode stabilization scheme demonstrated in Ref. [28]. The main idea is to use frequency-division multiplexing to stabilize different modes independently. Here, multiplexing refers to the fact that different regions of the filter passband are allocated to the stabilization of different modes. When the bandwidth allocated to each stabilization process is sufficiently large, multiple modes can be stabilized simultaneously and independently, as we now show.",
                "To stabilize the nth mode coupled to a given reservoir, we apply a pump frequency \u03c9 (n)  p = 2\u03c9 a -\u03c9 b + n , and drive the buffer mode at frequency \u03c9 (n)  d = \u03c9 bn , where n denotes a detuning. To stabilize multiple modes simultaneously, we apply multiple such pumps and drives. Analogously to the single-mode stabilization case, the nonlinear mixing of the ATS then gives rise to an interaction Hamiltonian of the form",
                "see Appendix B for derivation. Note that the sum does not run over all modes coupled to the ATS, but rather only over the modes stabilized by that ATS. In our architecture, though five modes couple to each ATS, only two must be stabilized simultaneously, so the sum contains only two terms. By adiabatically eliminating the lossy buffer mode, and assuming the detunings are chosen such that | nm | 4|\u03b1| 2 \u03ba 2 for all m = n, one obtains an effective master equation describing the evolution of the storage modes, The dynamics, Eq. ( 12), stabilize cat states in different modes independently and simultaneously. Thus, by simply applying additional pumps and drives with appropriately chosen detunings, multiple modes can be simultaneously stabilized by a single ATS. The efficacy of this multiplexed stabilization scheme can be understood intuitively by considering the frequencies of photons that leak from the buffer mode to the filtered bath. In the case of n = 0, a pump applied at frequency 2\u03c9 a -\u03c9 b facilitates the conversion of two phonons of frequency \u03c9 a to a single photon of frequency \u03c9 b (note that acoustic phonons are converted into buffer photons via piezoelectricity in our proposal). As a result, photons that leak from the buffer to the bath have frequency \u03c9 b . If instead the pump is detuned by an amount n = 0, it follows from energy conservation that the corresponding emitted buffer-mode photons have frequency \u03c9 b + n . When the differences in these emitted-photon frequencies, nm , are chosen to be much larger than the emitted photon linewidths, 4|\u03b1| 2 \u03ba 2 (see Appendix C), emitted photons associated with different storage modes are spectrally resolvable by the environment. Therefore, when the stabilization of mode n causes a buffer-mode photon to leak to the environment, there is no back action on modes m = n. These ideas are illustrated pictorially in Fig. 4(a)."
            ],
            "subsections": []
        },
        {
            "title": "F. Crosstalk",
            "paragraphs": [
                "Our multiplexed stabilization scheme can induce undesired crosstalk among the cat qubits, and this crosstalk must be quantified in order to provide realistic performance estimates for our architecture. We now enumerate the different sources of crosstalk and show that the dominant sources can be largely suppressed through a combination of filtering and phonon-mode frequency optimization. Later on, in Sec. IV, we incorporate the residual crosstalk errors into calculations of the logical error rates for our architecture, finding that these small correlated errors can nevertheless be a limiting factor for overall performance.",
                "In acting as a nonlinear mixing element, the ATS not only mediates the desired (g 2 \u00e22 n b \u2020 + H.c.) interactions, but it also mediates spurious interactions between different storage modes. While most spurious interactions are far detuned and can be safely neglected in the rotating-wave approximation, there are others that cannot be neglected. b \u2020 e i i t + H.c.) are detuned by different amounts, photons lost to the environment via the buffer have different frequencies. When the corresponding emitted buffer-mode photons (green lines) are spectrally well resolved, | nm | 4|\u03b1| 2 \u03ba 2 , the modes are stabilized independently. Dissipation associated with photon emissions at frequencies inside the filter passband (the yellow box, with bandwidth 4J /2\u03c0 = 100 MHz) is strong, while dissipation associated with emission at frequencies outside the passband is suppressed. (b),(c) Crosstalk suppression. Red lines in (b) denote photon-emission frequencies associated with various correlated errors, calculated for the specific storage-mode frequencies plotted in (c). The mode frequencies are deliberately chosen so that all emissions associated with correlated errors occur at frequencies outside the filter passband (no red lines fall in the yellow box). In other words, Eqs. ( 18) and ( 19) are simultaneously satisfied for any choices of the indices that lead to nontrivial errors in the cat qubits. See Appendix B for further details.",
                "Most concerning among these are interactions of the form",
                "for j = k, where \u03b4 ijk = \u03c9 (i) p -\u03c9 j -\u03c9 k + \u03c9 b . This interaction converts two phonons from different modes, j and k, into a single buffer-mode photon, facilitated by the pump that stabilizes mode i. These interactions cannot be neglected in general because they have the same coupling strength as the desired interactions, Eq. ( 11), and they can potentially be resonant or near resonant, depending on the frequencies of the storage modes involved.",
                "There are three different mechanisms through which the interactions, Eq. ( 13), can induce crosstalk among the cat qubits. These mechanisms are described in detail in Appendix B, and we summarize them here. First, analogously to how the desired interactions, Eq. ( 11), lead to two-phonon losses, the undesired interactions, Eq. ( 13), lead to correlated, single-phonon losses",
                "where the rate \u03ba eff is discussed shortly, and \u1e90i is the logical Pauli-\u1e90 operator for the cat qubit in mode i. The arrow denotes projection onto the code space, illustrating that these correlated losses manifest as stochastic, correlated phase errors in the cat qubits.",
                "Second, the interplay between different interactions of the form, Eq. ( 13), gives rise to new effective dynamics [48,55,56] generated by Hamiltonians of the form",
                "\u2192\u03c7 |\u03b1| 4  \u1e90i \u1e90j \u1e90k \u1e90l e i(\u03b4 mn -\u03b4 ijk )t + H.c., (16) where the coupling rate \u03c7 is defined in Appendix B. The projection onto the code space in the second line reveals that \u0124eff can induce undesired, coherent evolution within the code space. Third, \u0124eff can also evolve the system out of the code space, changing the phonon-number parity of one or more modes in the process. Though the engineered dissipation subsequently returns the system to the code space, it does not correct changes to the phonon-number parity. The net result is that \u0124eff also induces stochastic, correlated phase errors in the cat qubits,",
                "where the rate \u03b3 eff is discussed shortly. Remarkably, all of the stochastic crosstalk errors, Eqs.( 14) and (17), can be suppressed to negligible levels through a combination of filtering and phonon-mode frequency optimization. In Appendix B, we show that both \u03ba eff \u2248 0 and \u03b3 eff \u2248 0, provided",
                "respectively. This suppression can be understood as follows. The decoherence associated with \u03ba eff and \u03b3 eff results from the emission of buffer-mode photons at frequencies \u03c9 b + \u03b4 ijk and \u03c9 b \u00b1 (\u03b4 ijk -\u03b4 mn ), respectively. When the frequencies of these emitted photons lie outside the filter passband, their emission (and the associated decoherence) is suppressed. Crucially, we can arrange for all such errors to be suppressed simultaneously by carefully choosing the frequencies of the storage modes, as shown in Figs. 4(b) and 4(c). We note that the configuration of mode frequencies in Fig. 4(c) was found via a numerical optimization procedure described in Appendix B and is robust to realistic frequency fluctuations. The coherent crosstalk errors, Eq. ( 16), can also be suppressed through phonon-mode frequency optimization, though the suppression is not sufficient to render them negligible. To suppress these errors, the phonon-mode frequencies have been chosen to maximize the detunings \u03b4 ijk -\u03b4 mn , such that \u0124eff is rapidly rotating and its damaging effects are mitigated to a large extent (see Appendix B for details). Even so, the residual crosstalk errors are not negligible and they must be accounted for when estimating the overall performance of the architecture. To this end, in Appendix B we precisely quantify the magnitude of these residual crosstalk errors, and the impact of these errors on logical failure rates is calculated in Sec. IV. As described in that section, we must have g 2 2\u03c0 * 2 MHz, lest these coherent errors degrade logical lifetimes. At the hardware level, this restriction limits the achievable \u03ba 2 (see Sec. D), meaning that longer storage-mode coherence times are required to reach a given \u03ba 1 /\u03ba 2 because of these coherent crosstalk errors.",
                "Crosstalk also imposes another limitation on our architecture: though increasing the number of modes per unit cell would improve hardware efficiency and connectivity, crosstalk forces us to minimize the number of modes per unit cell. Indeed, as more modes are added to a unit cell, frequencies become increasingly crowded [57][58][59], and magnitude of crosstalk errors increases. Accordingly, we have chosen four modes (plus one additional mode for readout) per unit cell because this is the minimum number consistent with our 2D square-grid layout. In Appendix H, we describe an alternative architecture that uses only four modes per unit cell, but requires a different approach to X measurements that may be more challenging to implement.",
                "Broadly speaking, these limitations illustrate the importance of accounting for crosstalk when designing and analyzing fault-tolerant quantum-computing architectures. More specifically, these limitations reveal that finding further ways to mitigate crosstalk is an important direction for future research on dissipative cat qubits. In future designs, resonators with additional terminals, or tunable couplers [60,61], could be employed to further mitigate the effects of crosstalk, for example. Additionally, in Appendix H, we describe an alternate version of our architecture that employs a different X -basis readout scheme in order to reduce the number of modes per unit cell and hence reduce crosstalk."
            ],
            "subsections": []
        },
        {
            "title": "III. GATES AND MEASUREMENTS",
            "paragraphs": [
                "In this section, we discuss the gates and measurements of the cat qubits. We first discuss the implementation of the X gate via a rotating two-phonon dissipation; this will be helpful for understanding the CNOT and Toffoli gates.",
                "We then review the fundamentals of the bias-preserving CNOT and Toffoli gates acting on cat qubits [14] and present several new analytical and numerical results. In particular, we explicitly characterize the extra geometric phase (Z or CZ rotations), which must be taken into account in the implementation of the CNOT and Toffoli gates if the average excitation number |\u03b1| 2 is not an even integer. Moreover, we introduce the shifted Fock-basis method and demonstrate that it is useful for the perturbative analysis of the Z-error rates of various cat-qubit gates. We then illustrate that the shifted Fock-basis method also allows more efficient numerical simulation of large cat qubits (up to |\u03b1| 2 = 10) than the usual Fock-basis method. The numerical results on gate error rates are summarized in Table II and detailed descriptions of the methods are given in Appendices C to E. These results are fed into the simulations of the concatenated cat codes in Sec. IV and VI.",
                "We also describe schemes for X -and Z-basis readout. Our scheme for X -basis readout has only a small impact on the length of an error-correction cycle, thanks to the use of an additional readout mode that is interrogated by a transmon in parallel with the next error-correction cycle. We also present a fast Z-basis readout scheme, which uses a coupling between the storage mode and buffer mediated by the ATS. This achieves measurement error rates, which improve exponentially as |\u03b1| 2 increases. Having hardware native X -and Z-basis readout schemes allows for higherfidelity surface-code stabilizer measurements as explained in Sec. B. A more detailed analysis of the readout schemes can be found in Appendix G. Additionally, in Appendix H we present an alternative X -basis readout scheme where the readout is performed directly using the ATS, obviating the need for the extra readout mode and transmon."
            ],
            "subsections": []
        },
        {
            "title": "A. X gate",
            "paragraphs": [
                "The X gate interchanges the cat-code computational basis states |0 and |1 . For large values of \u03b1 these catcode states are approximately equal to the coherent states |\u03b1 and | -\u03b1 , so the X gate acts by rotating the coherent states by \u03c0 in the phase-space representation. The value of \u03b1 for the stabilized cat state is given by \u03b1 2 =d /g * 2 (c.f. Sec. II A), so that the phase of \u03b1 is determined by the phase of the drive. Therefore, modulating the phase of the drive on the storage cavity such that the stabilized value of \u03b1 rotates by \u03c0 over a time T realizes an X gate. The code state evolves according to",
                "This gives an adiabatic implementation of the X gate. Furthermore, we can apply a compensating Hamiltonian given by",
                "so that the code state rotates along with the fixed point of the dissipator. With this compensating Hamiltonian, the gate need not be adiabatic and will succeed for any T.",
                "When the X gate is corrupted by phonon loss, gain, or by dephasing, the logical error rates during the X gate are identical to the noise during idle. This is because in the rotating frame of the compensating Hamiltonian \u0124X , the noise and the dissipator are identical to the case of idle.",
                "The error rates for idle are summarized in Table II."
            ],
            "subsections": []
        },
        {
            "title": "B. CNOT",
            "paragraphs": [
                "We can realize the bias-preserving CNOT gate from Ref. [14] using an ATS coupled to a pair of acoustic modes. The CNOT gate rotates the cat-code states of the target mode just as for the X gate, except that now the rotation is conditioned on the state of the control mode. Cavity mode 1 will be the control and cavity mode 2 the target. A time-dependent dissipator that realizes this rotation is given by the Lindblad jump operator",
                "When cavity mode 1 is in the |1 cat-code state, which is approximately equal to the | -\u03b1 coherent state, the corresponding dissipator reduces approximately to the rotating dissipator for the X gate on the second cavity mode. On the other hand, when cavity mode 1 is in the |0 cat state, the operator L 2 reduces to the usual time-independent Lindblad operator. The control cavity mode is always stabilized by the usual time-independent Lindblad operator:",
                "When a cat-code state \u03c1(t) evolves according to",
                "the encoded state undergoes a CNOT gate (up to an extra Z rotation on the control qubit; see below), assuming the gate time T is long compared to the stabilization rate \u03ba 2 |\u03b1| 2 . This gate preserves the bias in the noise because the two cat-code states remain distantly separated during the conditional rotation. Just as for the X gate the CNOT gate can be performed much faster with the help of a compensating Hamiltonian. In this case, an ideal compensating Hamiltonian would be -(\u03c0/T)| -\u03b1 -\u03b1| 1 \u00e2 \u2020 2 \u00e22 . This Hamiltonian rotates the state of mode 2 conditioned on the state of mode 1, so that the two-mode system remains in the subspace stabilized by the static dissipator D[ L1 ] and the rotating dissipator D[ L2 (t)]. However, such a compensating Hamiltonian is highly nonlinear and would be hard to implement in practice. Hence, as in Ref. [14], we consider an approximate version of the above Hamiltonian, which requires only at most third-order nonlinearities: in this case the compensating Hamiltonian has the following form:",
                "This Hamiltonian rotates the state of mode 2 conditioned on the state of mode 1, so that the two-mode system remains in the subspace stabilized by the dissipator ",
                "in the T 1/(\u03ba 2 \u03b1 2 ) limit, which differs from the desired CNOT gate CNOT 1\u21922 by an extra Z rotation on the control qubit \u1e901 (-\u03c0\u03b1 2 ) (see Appendix D for more details). Here, \u1e90(\u03b8 ) is defined as \u1e90(\u03b8 ) \u2261 exp[i\u03b8|1 1|] and |1 is a computational basis state, the -1 eigenstate of the Pauli Z operator. The extra Z rotation is trivial if the average excitation number |\u03b1| 2 is an even integer. We also remark that the extra Z rotation is not present if an ideal compensating Hamiltonian -(\u03c0/T)| -\u03b1 -\u03b1| 1 \u00e2 \u2020 2 \u00e22 is used. Since the compensating Hamiltonian in Eq. ( 25) is only an approximation of an ideal compensating Hamiltonian, e.g., [i.e., -",
                "] it introduces a residual nonadiabatic error that scales like 1/T, where T is the gate time. Phonon loss, gain, and dephasing noise during the CNOT gate give rise to a Z-error rate on both cavities that is proportional to T. The balance between the nonadiabatic errors and the noise gives rise to an optimal gate time that maximizes the fidelity.",
                "In Ref. [14], it was noticed that the residual nonadiabatic error scales as c/(\u03ba 2 \u03b1 2 T) and found that the constant coefficient is given by c 1/(2\u03c0) via a numerical fit. In Appendix D, we provide a first-principles perturbative analysis of the Z-error rates of the CNOT gate by using the shifted Fock basis as a main tool. The key idea of the shifted Fock basis is to use the displaced Fock states D(\u00b1\u03b1)|n = n as the (unorthonormalized) basis states, where n = \u00e2 \u2020 \u00e2 is the mode occupation number. In particular, for the perturbative analysis of the Z-error rates, it suffices to consider only the ground-state manifold consisting of the coherent states D(\u00b1\u03b1)|n = 0 = | \u00b1 \u03b1 and the first-excited-state manifold consisting of the displaced single-phonon Fock states D(\u00b1\u03b1)|n = 1 . See Appendix C for a detailed description of the shifted Fock basis, including orthonormalization and matrix elements of the annihilation operator \u00e2 in the shifted Fock basis. By taking the ground and the first-excited-state manifolds in the shifted Fock basis and using perturbation theory, we find that the Z-error rates (per gate) of the implemented CX gate are given by",
                "Here, \u03ba 1 is the single-phonon loss rate (per time) and we assume no dephasing and gain for the moment. We use p for error rates predicted by the perturbation theory and p for numerical results. Note that the coefficient \u03c0 2 /64 = 0.154 in the nonadiabatic error term is close to the coefficient 1/(2\u03c0) = 0.159, which was found earlier via a numerical fit [14]. Hence, the optimal gate time that minimizes the total gate infidelity is given by",
                "and at the optimal gate time, the Z-error rates are given by",
                "These agree well with the numerical results (see Table II)",
                "within a relative error of 10% (see Appendix D for the reasons for the discrepancy). Note that the perturbation theory predicts that the optimal Z-error rates of the CX gate (or the CNOT gate for even |\u03b1| 2 ) are independent of the size of the cat code |\u03b1| 2 . We simulated the CNOT gate using the effective dissipators and Hamiltonian acting on two cavities. Our method was to use the shifted Fock basis as described in Appendix C to find the optimal gate time and perform tomography at the optimal gate. This allowed us to compute all of the two-qubit Pauli error rates. The shifted Fock-basis approach allowed us to compute the Z-error rates with a small Hilbert-space dimension that does not depend on \u03b1. In the standard Fock basis the required Hilbert-space dimension increases rapidly with \u03b1. In contrast to the Z-error rates, to accurately resolve the full set of Pauli error rates a large dimension that increases with \u03b1 is required even for the shifted Fock basis. However, even for the full set of Pauli error rates, our simulations are several times faster when we use the shifted Fock basis rather than the standard Fock space, because good accuracy can be attained using a smaller Hilbert-space dimension.",
                "Our code was written in Python using the QuTIP package to solve the master equation including the dissipaters and Hamiltonian terms. We ran the simulations using AWS EC2 C5.18xlarge instances with 72 virtual CPUs, and the total time required for the CNOT simulations was about 150 h."
            ],
            "subsections": []
        },
        {
            "title": "C. Toffoli",
            "paragraphs": [
                "The bias-preserving Toffoli or CCX gate is directly analogous to the CNOT gate. The two control modes are stabilized by the usual jump operator L1 = \u00e22",
                "1 -\u03b1 2 and L2 = \u00e22",
                "2 -\u03b1 2 , while the third mode is stabilized by a jump operator that couples the three modes and rotates the third conditioned on the state of the two controls,",
                "When both modes 1 and 2 are in the |1 | -\u03b1 catcode state, this jump operator reduces to approximately \u00e22",
                "3 -\u03b1 2 e 2i(\u03c0/T)t , which is the rotating jump operator that realizes the X gate on the third mode. When one of the control modes is in the |0 |\u03b1 cat-code state, the jump operator is approximately equal to the usual \u00e22 3 -\u03b1 2 jump operator that stabilizes the cat-code states. In this way the jump operators L1 , L2 , and L3 (t) implement the Toffoli gate (up to a controlled-Z rotation on the two control qubits). Also like the CNOT gate we can apply a Hamiltonian to drive the desired evolution and perform the gate much faster while canceling part of the nonadiabatic errors. For the Toffoli gate this Hamiltonian is given by",
                "This Hamiltonian is the natural extension of Eq. (25). It does not cancel all nonadiabatic noise, and like the CNOT in the presence of noise, the trade-off between nonadiabatic errors and noise from loss or dephasing gives rise to an optimal gate time for each value of \u03b1 and the noise parameters.",
                "Similarly, as in the case of the CNOT gate, we emphasize that the dissipators D[ L1 ], D[ L2 ], and D[ L3 (t)] combined with the compensating Hamiltonian \u0124TOF in Eq. ( 32) realize a gate",
                "which differs from the desired Toffoli gate TOF ",
                "We simulated the Toffoli gate subject to phonon loss, gain, and dephasing at different rates by solving the master equation given by the Hamiltonian \u0124TOF , the dissipator on each mode, and the Lindblad operators for the noise. These simulations were carried out using AWS EC2 c5.18xlarge instances and took about 170 h running on instances with 72 virtual CPUs. Because we simulated three modes for the Toffoli gate, we were able to resolve only the dominant Z-type error rates and not the other Pauli error rates that are exponentially small in \u03b1 2 . These simulations used the shifted Fock-basis approach. With this method we are able to use a Hilbert-space dimension of 8 for each of the three modes and simulate all of the Z Pauli error rates with high precision. The numerical results for the optimal gate time and the seven Z-type Pauli error rates under a pureloss noise model are summarized in Table II. The results including gain and dephasing can be found in Table VIII. Our simulations match our perturbation theory calculations for the Z-error rates.",
                "Similarly as in the case of the CNOT gate, we can use the ground and the first-excited-state manifolds in the shifted Fock basis and perform a perturbative analysis. Our perturbation theory yields the following Z-error rates of the CCX gate, or the Toffoli gate when |\u03b1| 2 is an even integer (see Appendix D):",
                "Note that, the optimal gate time that minimizes the total gate infidelity is given by",
                "which is identical to the optimal gate time of the CX gate (or the CNOT gate for even |\u03b1| 2 ) predicted by the perturbation theory. At the optimal gate time, the Z-error rates (per gate) are given by",
                "which agree well with the numerical results (see Table II)",
                "up to a relative error of 5%. Thus, as in the case of the CNOT gate, the perturbation theory predicts that the optimal Z-error rates of the CCX gate (or the Toffoli gate for even |\u03b1| 2 ) are independent of the size |\u03b1| 2 of the cat code."
            ],
            "subsections": []
        },
        {
            "title": "D. X measurement",
            "paragraphs": [
                "X -basis readout entails determining the parity of a bosonic mode. Specifically this is readout in the basis of even and odd cat states, i.e., |\u00b1 \u221d |\u03b1 \u00b1 | -\u03b1 . Here we describe our approach to X -basis readout. In our scheme, we use an additional phononic readout mode in every unit cell that we do not stabilize with two-phonon dissipation. This readout mode is interrogated by a transmon qubit in parallel with the gates of the next error-correction cycle. This allows us to achieve high measurement fidelity and minimal idling time for the data qubits. The additional readout mode (colored green) and transmon are pictured in Fig. 2.",
                "Here we outline the steps for the readout of an ancilla qubit in the X basis. First we \"deflate\" the ancilla mode (\u00e2 1 ), which maps the even parity cat state to the Fock state |n = 0 and the odd cat state to the Fock state |n = 1 [27]. This can be achieved by abruptly changing the engineered dissipation from D[\u00e2 2  1 -\u03b1 2 ] to D[\u00e2 2  1 ]. Pairs of phonons will be dissipated mapping the system to the |n = 0 and |n = 1 manifold while preserving parity. The purpose of the deflation is to reduce susceptibility to single-phonon loss events, which change the parity of the cat qubit. After this deflation we turn off the two-phonon dissipation. Subsequent to the deflation the ancilla mode and readout mode (\u00e2 2 ) evolve under the Hamiltonian \u0124 = g(\u00e2",
                "), which transfers the excitation [53,62,63] between the ancilla mode and readout mode in a time \u03c0/2g.",
                "With the excitation in the readout mode, we perform repeated QND measurements of the readout mode [64][65][66] and take a majority vote to get our final measurement outcome. The individual measurements are standard QND bosonic parity measurements, which are performed using a dispersive coupling between the readout mode and a transmon qubit (q) described by \u0124dispersive = \u03c7 \u00e22 \u2020 \u00e22 q \u2020 q. Evolution under the Hamiltonian for a time \u03c0/\u03c7 yields the controlled parity gate U = I \u2297 |g g| + e i\u00e2 \u2020 2 \u00e22 \u03c0 |e e|. Combined with transmon state preparation and measurement this interaction can be used to realize parity measurements of the readout mode [64]. While this repeated parity measurement is taking place, the CNOT gates of the next error-correction cycle can occur in parallel. This enables us to reach high readout fidelity without affecting the length of an error-correction cycle. For our repetition-code and surface-code simulations we use up to three or five parity measurements, respectively, during the error-correction gates of the next cycle.",
                "We simulated this measurement scheme to get a rough sense of the expected measurement fidelities. The misassignment probabilities and measurement idling times can be found in Table III for the three regimes considered in the paper."
            ],
            "subsections": []
        },
        {
            "title": "E. Z measurement",
            "paragraphs": [
                "In Z-basis measurement the goal is to distinguish |0 and |1 , which are approximately the coherent states |\u03b1 and | -\u03b1 . We achieve this readout by engineering a coupling between the storage model \u00e2 and the buffer mode b described by the \"beam-splitter\" Hamiltonian \u0124 = g(\u00e2 \u2020 b + b \u2020 \u00e2). The physical realization of this Hamiltonian is explained in Appendix G.",
                "If the state of the storage mode is | \u00b1 \u03b1 , this coupling drives the buffer mode to a coherent state | \u00b1 \u03b3 whose phase is aligned with the initial phase of the storage mode. Hence a homodyne measurement of the buffer mode distinguishes the states | \u00b1 \u03b1 of the storage mode, as desired.",
                "In Appendix G we find that the SNR for this readout scheme at time \u03c4 is",
                "in good agreement with numerics. Here \u03ba b is the singlephonon loss rate of the buffer mode, and",
                "The measurement SNR scales as \u03b1, which means there is an exponential improvement of the measurement fidelity with |\u03b1| 2 . This measurement process is not QND and at long times the measurement SNR goes as 1/ \u221a \u03c4 because the storage mode is emptied. From the measurement SNR, the measurement separation error, which is the dominant contribution to the total measurement error (|\u03b1| 2 ), can be computed using sep (\u03c4 )",
                "For the values of |\u03b1| 2 considered in our Z-basis measurement simulations, we found that the optimal measurement time is T measure \u2248 850 ns, and that a conservative relation for the numerical probability of an incorrect readout as a function of |\u03b1| 2 is",
                "For \u03b1 2 = 8, used in much of our analysis of error correction, we have \u2248 2 \u00d7 10 -4 . In contrast to gates, whose optimal fidelities depend only on the dimensionless ratio \u03ba 1 /\u03ba 2 , readout fidelities and durations depend on additional parameter assumptions discussed in Appendix G."
            ],
            "subsections": []
        },
        {
            "title": "F. Gain and dephasing errors",
            "paragraphs": [
                "Here we summarize the impact of additional noise sources investigated in Appendices D and E. Adding phonon gain to the storage mode in addition to loss only slightly enhances the error rates of all operations. If the thermal population is given by n th = 0.01, then the error rates of the CZ gate are increased by about 1%, for example. On the other hand, we expect that pure dephasing noise in the form of a Lindblad jump operator a \u2020 a on the storage mode will substantially increase the X -error rate but only slightly increase the Z rate. We numerically find that although the Z-error rates of the Z and CZ gates are not measurably affected by pure dephasing noise, those of the CNOT and TOF gates are adversely affected. This is surprising given that pure dephasing consists of random rotations on the storage-mode state and does not change the parity of the cat qubit. We provide a perturbative analysis to explain this behavior and attribute the enhanced Z-error rates of the CNOT and TOF gates to the fact that the stabilizing jump operators for the target cat qubits are not static and instead rotate conditioned on the state of the control qubits. Our perturbative analysis agrees well with our numerical results, and they predict that the optimal Zerror rates of the CNOT and TOF gates scale as \u03ba \u03c6 /\u03ba 2 , where \u03ba \u03c6 is the dephasing rate. These calculations can be found in Appendix D. Our simulations of gate error rates in the presence of gain and dephasing noise can be found in Appendix E."
            ],
            "subsections": []
        },
        {
            "title": "IV. LOGICAL FAILURE RATES FOR QUANTUM MEMORY",
            "paragraphs": [
                "Equipped with the noise model in Sec. III for performing gates and measurements on stabilized cat qubits, we now transition to describing the outer-level error-correcting codes used to protect encoded logical qubits against phaseflip and bit-flip errors. Errors can be identified by measuring a codes' stabilizer generators g i \u2208 S where S forms an abelian group, and the stabilizers act trivially on the encoded state. Detectable errors anticommute with a subset of the stabilizers in S and can be identified by their error syndrome. More details on the stabilizer formalism can be found in Ref. [68].",
                "The two codes that we use in our architecture for implementing quantum algorithms are the repetition code and the rotated surface code [69]. Illustrations for such codes, along with their corresponding syndrome extraction circuits (which measure the codes' stabilizer generators), are given in Fig. 5. As described in Secs. VI and VII, the repetition code is used for preparing |TOF magic states, which will allow us to implement logical Toffoli gates. However, the repetition code alone is insufficient for universal quantum computation since, without the ability to correct at least one bit-flip error, the logical X -failure rates would be too high during the implementation of most quantum algorithms of interest for reasonable values of \u03b1 2 (see Fig. 7). As such, apart from the preparation of |TOF states (which will be converted to |TOF states encoded in the surface code using lattice surgery), all logical gates of quantum algorithms are performed in a d x = 3 by d z rotated surfacecode lattice. Here d x and d z denote the minimum weight of the X -and Z-type logical operators of the rotated surface code. We fix d x = 3 since as seen, we need only to correct one bit-flip error at the surface-code level to get the desired logical X failure rates for the implementation of quantum algorithms of practical interest such as those considered in Sec. VIII.",
                "In this section, we provide logical Z failure rates for the repetition code and rotated surface code in the context of quantum memories using a MWPM decoding algorithm with weighted edges described in Appendix N and the noise model described in Sec. III. We also provide general logical X failure-rate polynomials of the rotated surface code as a function of the d z distance."
            ],
            "subsections": []
        },
        {
            "title": "A. Repetition-code logical failure rates",
            "paragraphs": [
                "The logical Z failure rates of the repetition code for distance 3 \u2264 d \u2264 19 are provided in Fig. 6. All results were obtained from a Monte Carlo simulation based on the circuit-level noise model where each gate, state preparation, idling qubits and measurements fail with probabilities given in Tables II andIII.",
                "In error correction there are two settings of interest: where the logical information needs to be stored for some fixed period of time; and where there is flexibility to adapt the number of rounds before proceeding to the next stage of the computation. Here we introduce the STOP algorithm, which is an adaptive policy for deciding how many rounds  2, the yellow vertices correspond to the data qubits and the gray vertices to the ancillas, whereas green circles are readout modes and the white squares are transmon qubits, which we use for X -basis measurements (see Appendix G and Fig. 40 for more details). The pink semicircles are used to illustrate the X i X i+1 stabilizer of the repetition code. We also label each CNOT gate by the corresponding time step in which it is applied. (b) Circuit illustration of a d x = 3 by d z = 5 thin rotated surface code. The pink and blue plaquettes correspond to the X -and Z-type stabilizers, respectively, with the numbers indicating the time steps in which the CNOT gates are applied. Measurements of X -type stabilizers detect Z errors whereas measurements of Z-type stabilizers detect X errors. (c) Key illustrating the different components of the repetition-and surface-code lattices. CNOT gates are used to couple qubits connected to the same ATS.",
                "to repeat the syndrome measurements. In the limit of large code distances, STOP terminates (with high probability) in the same number of rounds as an algorithm using fixed d rounds. For smaller code distances and low-noise regimes, STOP provides an advantage over a fixed round decoder as it requires (d + 1)/2 rounds. Full details for the implementation of the STOP algorithm are provided in Appendix I. We now give two important remarks.",
                "Remark one: Consider first the setting where the logical information is stored for a fixed period of time. The FIG. 6. Logical Z failure rates for the repetition code, for a variety of values of the code distance d. We use the circuitlevel noise model described in Sec. III with \u03ba \u03c6 = 0 and n th = 0. The X -basis measurement error rates are obtained from Table III with three parity measurements. The number of syndrome measurement rounds r for each distance is obtained using the STOP algorithm described in Appendix I. The dashed green line is used as a stand-in for comparison with the logical memory error rates and corresponds to the function 0.3025 \u221a \u03ba 1 /\u03ba 2 , which is a quarter of the total Z failure rate of a physical CNOT gate (see Table II). standard approach that is followed in the literature when obtaining numerical results for decoding such codes is to perform d rounds of noisy syndrome measurements followed by one round of perfect syndrome measurement (where no additional errors are introduced). Errors are then corrected using the full syndrome history. The round of perfect syndrome measurement is added to ensure that the final error after correction is either in the stabilizer group or corresponds to a logical operator (i.e., we must ensure that we project to the code space to declare success or failure). Furthermore, if the error syndrome was decoded based only on d noisy syndrome measurement rounds (i.e., without the round of perfect error correction), a single measurement error occurring in the dth round could result in a logical failure (a fact that is often not fully appreciated). However, for many models of universal quantum computation, the data qubits are measured directly as part of the quantum algorithm or during the implementation of state injection for performing non-Clifford gates (see Refs. [70][71][72] and Fig. 42). As illustrated in Fig. 42 of Appendix I, the direct measurement of the data qubits can be viewed as a round of perfect error correction since measurement errors in such a process are equivalent to data qubit errors occurring immediately prior to the measurement of the data. However for our purposes, the repetition code will be used during the preparation of |TOF magic states where the circuits used in the preparation protocol contain non-Clifford gate locations (see Fig. 14). Prior to the application of these non-Clifford gates, errors on the encoded code blocks need to be corrected without having access to a round of perfect syndrome measurements (since the data qubits cannot be measured directly prior to applying the non-Clifford gates). Hence, it is important to have a decoder that is robust to measurement errors occurring in the last round when rounds of perfect syndrome measurements cannot effectively be applied in the hardware. A solution is that instead of repeating the syndrome measurement d times, one can repeat the syndrome r times where r is computed using the STOP algorithm mentioned above. Note that in this case, r is not fixed but instead is a function of the observed syndrome history. For all logical Z failure rates plotted in Fig. 6, the simulations were performed using the STOP algorithm for determining when to stop measuring the error syndrome. To ensure projection onto the code space, we add one round of ideal syndrome measurements after the last round given by the STOP algorithm and implement MWPM over the full syndrome history.",
                "Remark two: The x axis in Fig. 6 is plotted as a function of \u03ba 1 /\u03ba 2 . It is important to note that some components of the hardware fail with probabilities proportional to \u03ba 1 /\u03ba 2 whereas other components (such as the CNOT gates) fail with probabilities proportional to \u221a \u03ba 1 /\u03ba 2 (see Table II). In particular, in REGIME 3, the noise is dominated by CNOT gates, whereas in REGIME 1, some idling qubits during CNOT gate times are afflicted by errors with probabilities comparable with the CNOT failure rates, hence changing the slope of the logical failure rate curves. To be clear, in our simulations we took into account all different types of idling locations; for this reason, and also because we use the STOP algorithm for determining the number of syndrome measurement rounds instead of repeating a fixed d times, our numerics should not be directly compared with previous works such as in [15]. Note further that for comparisons with other works (such as in Ref. [15]), the x axis of our plots would need to be rescaled as a function of",
                "Given two strips of neighboring repetition codes, a logical CNOT gate can be implemented transversally between the two strips, and the failure probability of such a gate is approximately 4 times the values showed in Fig. 6. One possible interesting quantum error-correction experiment would be to demonstrate a logical CNOT gate with lower failure probability compared to a physical CNOT gate. As such, in Fig. 6, we also plotted a dashed green curve, which corresponds to the function 0.3025 ",
                "The justifications for the chosen scaling of p (Z) L (d) and the scaling of the logical failure rates for the rotated surface code in Sec. IV B are given in Appendix M.",
                "Lastly, in Fig. 7 we compute the total logical failure rate per code cycle (which includes contributions from logical X and Y failures) of the repetition code for distances in the range 3 \u2264 d \u2264 19 in REGIME 3 with \u03ba \u03c6 = 0 and n th = 0. For |\u03b1| 2 = 8, it can be seen that above d = 9, contributions from bit-flip errors are the dominant factor in the total logical failure rate. As such, going to larger repetition-code distances results in higher logical failure rates. Such features demonstrate the importance of taking into account contributions from bit-flip errors, even though they are exponentially suppressed. Further, such results demonstrate that the logical X -error rate when implementing a logical Toffoli gate using the piecewise fault-tolerant FIG. 7. Total logical failure rate per code cycle for various repetition-code distances and values of |\u03b1| 2 with fixed \u03ba 1 /\u03ba 2 = 10 -5 , \u03ba \u03c6 = 0, and n th = 0. Therefore, the |\u03b1| 2 = 8 data points correspond to REGIME 3. The logical X and Y failure rates were computed analytically (to leading order) using the noise model presented in Sec. III while taking into account all malignant and benign fault locations. For |\u03b1| 2 = 8, the lowest achievable total logical error rate is 2.7 \u00d7 10 -8 per code cycle using d = 9. construction of Refs. [14,15] would be too high for the algorithms considered in Sec. VIII unless |\u03b1 2 | 8."
            ],
            "subsections": []
        },
        {
            "title": "B. Rotated surface-code logical failure rates",
            "paragraphs": [
                "Using the circuit-level noise model described in Tables II and III and Eq. ( 38), the logical Z failure rates for the rotated surface code with d x = 3 and varying d z are given in Fig. 8. Note that the logical X operator has minimum support on d x qubits along each column of the lattice. The logical Z operator has minimum support on d z qubits along each row of the lattice. Contrary to our repetitioncode simulation methodology, the simulation results were obtained by performing d z rounds of noisy syndrome measurements followed by one round of perfect syndrome measurement in order to guarantee projection onto the code space. Throughout this paper, we use the surface code with only a fixed number of error-correction rounds. Furthermore, in our proposal we never perform physical non-Clifford gates directly on surface-code patches, rather non-Clifford gates are always achieved by gate teleportation using a magic state. As such, all simulations are performed for d z rounds followed by one ideal round to project onto the code space.",
                "We also point out that all Z stabilizers are measured in the Z basis by using CNOT gates (as shown in Fig. 5) rather than measured in the X basis using CZ gates. The reason is that, in addition to Z-basis measurements being more reliable, only X or Y errors (which are exponentially suppressed) on the target qubits of the CNOTs can result in measurement errors. If CZ gates were used, a CZ failure resulting in a Z error on an ancilla qubit would FIG. 8. Logical Z failure rates for the rotated surface code with d x = 3 and varying d z . We use the circuit-level noise model described in Sec. III with \u03ba \u03c6 = 0 and n th = 0. The X -basis measurement error rates are obtained from Table III with five parity measurements. We point out that \u03ba 1 /\u03ba 2 = 10 -5 , \u03ba 1 /\u03ba 2 = 10 -4 , and \u03ba 1 /\u03ba 2 = 10 -3 correspond to CNOT failure rates of 3.8 \u00d7 10 -3 , 1.2 \u00d7 10 -2 , and 3.8 \u00d7 10 -2 . The simulations were done by performing d z rounds of noisy syndrome measurements followed by one round of perfect syndrome measurement.",
                "flip the measurement outcomes. Hence if CZ gates paired with X -basis measurements were used instead of CNOT gates paired with Z-basis measurements, syndrome measurement errors in Z-type stabilizer measurements would be much more likely.",
                "Using the stabilizer measurement schedule of Fig. 5 and detailed further in Fig. 39, the duration of each round of stabilizer measurements has three contributions: the optimal time for four CNOT gates; the time to deflate the cat qubit and the time to swap the ancilla qubit into the readout mode. For example, for REGIME 3 this takes 31 \u03bcs.",
                "As can be seen from Fig. 8, in order to obtain low logical Z failure rates without requiring a very large d z distance (say d z > 40), it is required that \u03ba 1 /\u03ba 2 \u2264 5 \u00d7 10 -5 . Hence the hardware parameters must be in REGIME 3. Put another way, the total CNOT gate Z failure rate should be less than 7.6 \u00d7 10 -3 to achieve very low logical failure rates with reasonably small surface-code distances.",
                "Comparing the logical Z-error rates in Figs. 6 and8, one sees that the surface code significantly underperforms the repetition code. This is mainly because a distance-d repetition code requires a total of 2d -1 data and ancilla qubits compared to the rotated surface code, which requires 2d x d z -1 data and ancilla qubits. Further, the surface code requires weight-four stabilizer measurements compared to weight-two stabilizers for the repetition code and thus the syndrome measurement circuit has larger depth.",
                "The logical Z and X failure rate polynomials for fixed d x = 3 and arbitrary d z distances (with d z rounds of stabilizer measurements) were found numerically to be given by",
                "See Appendix M for further details on the fitting procedure and additional results on errors during lattice surgery.",
                "For the algorithms considered in Sec. VIII, a detailed resource cost analysis shows that we require p (X ) L (d z ) \u2264 10 -10 . As can be seen from Eq. ( 41), if |\u03b1| 2 = 6, \u03ba 1 /\u03ba 2 = 10 -5 (which requires d z = 31), the logical X -error rate is approximately 1.3 \u00d7 10 -9 , which is an order of magnitude worse than the minimum requirements. However, setting |\u03b1| 2 = 8, we obtain p (X ) L (d z ) = 4.2 \u00d7 10 -13 . Given the above, the algorithms considered in Sec. VIII require |\u03b1| 2 \u2265 8 or d x > 3.",
                "From the results obtained in this section and Sec. A, we can make the following observations. In REGIME 1, the total logical failure rate of an idling qubit using the repetition code can be smaller than that of a physical qubit using a large enough repetition code since the parameters are below threshold. In order to obtain a logical CNOT gate with failure probability less than a physical CNOT, the hardware parameters must be in REGIME 2. Lastly, to implement the algorithms considered in Sec. VIII using thin stripped surface codes, the hardware parameters must be in REGIME 3. Note that our scheme for performing universal fault-tolerant quantum computing is described in Secs. V, VI, and VII.",
                "We conclude this section by comparing the performance of our architecture (in REGIME 3) with square surface codes subject to an unbiased, depolarizing noise model with CNOT gate infidelity of p = 10 -3 . In an algorithm example discussed further in Sec. VIII (the L = 8 and u = 4 example), we require d x = 3 and d z = 25 to suppress p (Z)  L + p (X ) L to 1.9 \u00d7 10 -11 . This requires d x d z = 75 ATS and 3d x d z = 225 qubits (PCDRs) per surface-code patch. For depolarizing noise, the square surface code has been simulated [75] and fitted to a logical error rate p L \u2248 d 2 (100p) (d+1)/2 and so d = 26 suffices to achieve a similar logical error rate (p L = 2.1 \u00d7 10 -11 ). Most conventional architectures use 2d 2 qubits per surface-code patch (because they do not use readout qubits). Therefore, our architecture requires approximately 6\u00d7 fewer qubits per surface-code patch."
            ],
            "subsections": []
        },
        {
            "title": "C. Surface-code logical failure rates in the presence of crosstalk errors",
            "paragraphs": [
                "Recall that in our architecture proposal, each ATS stabilizes multiple phononic modes. Since the ATS mediates various spurious interactions as well as desired interactions, phononic modes that are connected by the same ATS undergo crosstalk errors. While stochastic crosstalk errors can be strongly suppressed by filtering and careful choice of the frequencies of the phononic modes (see Appendix B 4), coherent micro-oscillation errors cannot be eliminated by the filters (see Appendix B 5). In particular, such residual crosstalk errors result in two nontrivial noise processes: every pair of data qubits that are connected by a shared ATS (hence aligned vertically) experiences a correlated Z error with probability p double and every triple of two data qubits and an ancilla qubit that measures an X stabilizer of the surface code experiences a correlated Z error with probability p triple . In particular, the Z error on the ancilla qubit is realized in the form of a flipped measurement outcome of the corresponding X -type stabilizer (see Fig. 9).",
                "In Appendix B 5, we optimize the frequencies of the five phononic modes coupled to a shared ATS to minimize p double and p triple , assuming that the maximum frequency difference between different phononic modes is 2\u03c0 \u00d7 1 GHz. With the optimal choice of phononic mode frequencies, we find that the correlated error rates p double FIG. 9. Crosstalk errors due to multiplexed stabilization. Phononic modes that are connected via a shared ATS experience correlated Pauli Z errors due to micro-oscillation (see Appendix B 5). Every pair of two data qubits that are shared by the same ATS (hence aligned vertically) undergoes a correlated Z error with a probability p double . Also, every triple of two data qubits and an ancilla qubit that measures an X -type surfacecode stabilizer undergoes a correlated Z error with a probability p triple , where the Z error on the ancilla qubit manifests as a flipped outcome of the corresponding X -type stabilizer. ",
                "Here, g 2 is the strength of the desired interaction \u00e22 b \u2020 needed for the engineered two-phonon dissipation. See Appendix B 5 for more details on why p double and p triple scale as g 4 2 . Note that p triple is 35 times smaller than p double . For g 2 /(2\u03c0) = 1 MHz and |\u03b1| 2 = 8, p double is given by p double = 7.5 \u00d7 10 -5 , which is negligible compared to the total error rate of the physical CNOT gate between two cat qubits. However, since p double scales as p double \u221d g 4  2 , it increases rapidly as we use larger coupling strengths. For instance, p double is given by p double = 1.2 \u00d7 10 -3 at g 2 /(2\u03c0) = 2 MHz and p double = 1.9 \u00d7 10 -2 at g 2 /(2\u03c0) = 4 MHz.",
                "In Fig. 10 we provide logical Z failure rates of the thin surface code under the presence of the crosstalk errors described above for various values of g 2 . We note that in the presence of crosstalk errors with probabilities p double and p triple [which are given in Eq. (42)], extra edges need FIG. 10. Logical Z failure rates for a d x = 3 and d z = 11 thin surface code in the presence of the residual crosstalk errors [given in Eq. ( 42)] arising from the coherent micro-oscillations and the circuit-level noise model of Sec. III. The X -basis measurement error rates are obtained from Table III with five parity measurements. We compute the logical Z-error rates for different values of g 2 shown in the legend, and compare such results to the case where the crosstalk errors are not present.",
                "to be added to the matching graphs of the surface code. Details of the modified graphs in addition to the edge weight calculations are provided in Appendix N 3.",
                "As can be seen from Fig. 10, when g 2 /(2\u03c0) = 1 MHz, the effects from crosstalk errors are negligible (the logical error rate curves with and without crosstalk almost perfectly overlap). When g 2 /(2\u03c0) = 2 MHz, the effects are very small. However, if g 2 /(2\u03c0) \u2265 3 MHz, the difference between logical Z-error rates of the surface code with and without crosstalk errors is large enough such that one would need to use larger code distances to achieve the target logical failure rates for the algorithms considered in Sec. VIII. Hence, to maintain the overhead results obtained in Sec. VIII, it would be preferable to use values of g 2 /2\u03c0 \u2264 2 MHz, since in that case effects from crosstalk errors are very small. This bound on g 2 imposes a corresponding bound on \u03ba 2 = 4|g 2 | 2 /\u03ba b and hence dictates the maximum tolerable \u03ba 1 to achieve a given ratio \u03ba 1 /\u03ba 2 (see Table I, as well as further discussion in Sec. II D). Thus, crosstalk errors are currently a limiting factor for our architecture because suppressing their impacts at the logical level has required us to demand higher coherence at the physical level.",
                "Ways to further mitigate crosstalk errors therefore represent an important direction for future research on dissipative cat qubits. One potential solution to this problem is described in Appendix H. There, we consider an alternative version of our architecture where the limitations imposed by crosstalk errors are less severe. The alternative architecture employs a modified scheme for X -basis readout that allows us to reduce the number of modes per unit cell from five to four, which, in turn, reduces crosstalk. With these modifications, we find the effects of crosstalk are negligible for g 2 /2\u03c0 \u2264 4 MHz, as opposed to g 2 /2\u03c0 \u2264 2 MHz for the five-mode case. This increase in the allowable range in g 2 would enable stronger engineered dissipation and hence ease requirements on the storage-mode coherence times. See Appendix H for details."
            ],
            "subsections": []
        },
        {
            "title": "V. COMPUTATION BY LATTICE SURGERY AND TIMELIKE ERRORS",
            "paragraphs": [
                "In both repetition and surface codes, the logical CNOT gate is transversal, which means CNOT L = CNOT \u2297n . Therefore, a logical CNOT can be fault-tolerantly implemented whenever the hardware supports physical CNOTs between corresponding qubits in the code blocks. For the repetition code, we can realize a transversal CNOT gate in a 2D layout between two repetition codes. However, for the surface code, a logical CNOT cannot be realized in a way that is both transversal and uses physical CNOT gates in a 2D hardware geometry. A well-known solution is to use lattice surgery between blocks of surface codes [76][77][78][79]. The simplest example of lattice surgery realizes a logical X L \u2297 X L or Z L \u2297 Z L measurement between two surfacecode patches separated by a distance . The two code blocks are merged into a single code block for d m rounds of surface-code stabilizer measurement and then split apart. We illustrate this in Fig. 11 with more fine-grained details in Fig. 52 of Appendix M.",
                "During lattice surgery, certain types of logical errors can occur resulting in the wrong measurement outcome of multiqubit logical Pauli operators. We call these timelike errors since in the space-time picture they correspond to strings of errors in the time direction (see Fig. 11). As shown in Appendix M, such logical failure modes are exponentially suppressed by increasing d m , which comes at the price of increasing the execution time for this logical operation. A seemingly natural choice is to set d m = d x = d z , but since our noise model is highly biased this leads to an asymmetry in the optimal choices. We discuss timelike errors in more detail in Appendix M and present simulation results showing that for our noise model, the rate of timelike errors is comparable to (even slightly lower than) logical Z-error rates. A detailed decoding scheme used for such simulations is described in Appendix N 4.",
                "Lattice-surgery measurements combined with logical |0 and |+ preparations, and logical single-qubit X and Z measurements, can be used to perform logical CNOT, Hadamard and CZ gates [76]. Furthermore, the two codeblock lattice surgery sketched in Fig. 11 can be generalized to act on multiple code blocks to enable measurements of any tensor product of logical Z and X operators. By making use of lattice twists, domain walls, and lattice deformations, any logical multiqubit Pauli operator can be measured by lattice surgery [78]. We show examples of Z strings: when traveling in a spatial direction they represent physical Z errors and when traveling in the vertical time direction, they represent errors on X stabilizer measurements. We show only Z strings that are closed loops or terminate on suitable boundaries. These can be regarded as the final Z strings (after matching) including physical and measurement errors combined with recovery operations. In the case of memory, a logical Z error occurs whenever a Z string propagates between two topologically disconnected red boundaries. When performing lattice surgery to measure the X L1 \u2297 X L2 logical operator between two patches, an additional failure mechanism is possible. If a Z string propagates between two red boundaries disconnected in the time direction then we have a timelike Z error. Computationally, this flips the outcome of the X L1 \u2297 X L2 measurement. Such processes are exponentially suppressed by increasing the measurement distance d m .",
                "However, all these operations are either Clifford group gates or Pauli measurements, so some non-Clifford operation is required to complete a universal gate set. The model of Pauli-based computation [80] shows that it is possible to perform universal quantum computation using just multiqubit Pauli measurements and access to suitable magic states and performing gate teleportation. We denote the magic state for a Toffoli gate injection as",
                "where a \u2227 b is the AND of bits a and b. The |TOF state is stabilized by the Abelian group S TOF = g A , g B , g C where",
                "To simplify the notation used in Sec. VII, we label the three qubits involved in a Toffoli gate by A, B, and C instead of 1, 2, and 3. Given one copy of a |TOF state, Toffoli gate teleportation is performed using the circuit in Fig. 12 to realize a logical Toffoli gate. Notice that the circuit requires a Clifford correction g a A g b B g b C for the binary measurement outcome (a, b, c) of the single-qubit Pauli measurements.",
                "In a purely Pauli-based computation, rather than using lattice surgery to simulate the CNOT circuit for magic state injection, the CNOTs can be completely eliminated using the circuit identities shown in Fig. 12. Furthermore, the Clifford corrections and Clifford gates in an algorithm do not necessarily need to be performed. Rather we can keep a record of the accumulated Clifford gates so far into a Clifford frame (see, for instance, Ref. [71]). When we need to measure a Pauli P, we instead measure the Pauli CPC \u2020 whenever the Clifford frame records C. In such a Pauli-based computational model, Clifford gates do not contribute to an algorithms runtime. Rather the runtime is determined by two factors: how fast we can prepare high-fidelity TOF states; and how fast they can be teleported into the algorithm. The rate of gate teleportation depends on how much routing space between qubits is budgeted for in the device. Using a fast data access structure [79], it is known that lattice surgery can perform a single arbitrary multiqubit Pauli operator with approximately 2\u00d7 overhead in routing costs. Such a space overhead cost is pessimistic since not all qubits need to be involved in every lattice-surgery operation, so considerable compression is possible. Reference [81] assumed an approximately 1.5\u00d7 overhead suffices and Refs. [2,6,82] assumed this cost could be made negligible, so approximately 1\u00d7. Furthermore, it has been shown that for biased noise architecture the routing overhead is lower than for depolarizing noise [7]. In our later analysis of overheads, we assume an approximately 1.3\u00d7 routing overhead cost (roughly midway between the commonly used approximately 1.5\u00d7 and approximately 1\u00d7 overheads) suffices to maintain this pace of teleportation. The routing overhead estimates are justified more rigorously in Ref. [83]. One can also inject at a considerably faster pace than sequentially injecting magic states, up to the limit of timeoptimal quantum computation [84], though this approach incurs significantly higher routing overhead costs and is not practical for modest size quantum computers. In the next two sections, we consider the pace and fidelity with which we can prepare TOF magic states. In what follows, we use |TOF and TOF interchangeably when referring to the state in Eq. (43)."
            ],
            "subsections": []
        },
        {
            "title": "VI. TOFFOLI DISTILLATION: BOTTOM-UP SCHEME",
            "paragraphs": [
                "In magic state distillation schemes, the goal is to distill magic states with circuits that require only stabilizer operations [37,38,40]. The circuits used to distill such magic states are typically not fault tolerant to all Clifford gate errors and thus must be implemented using a sufficiently large error-correcting code. Recently, with the advent of flag qubits and redundant ancilla encoding, scalable approaches to fault-tolerantly preparing magic states have been devised such that all stabilizer operations can be implemented directly at the physical level [85,86]. We refer to such methods as a bottom-up approach to preparing magic states.",
                "In this section, we provide a protocol to faulttolerantly prepare TOF magic states encoded in the repetition code using a bottom-up approach (herein BUTOF). In Sec. VII, we show how the scheme presented in this section can be supplemented by using a top-down approach to prepare TOF states with the very high fidelities required to implement the algorithms considered in Sec. VIII.",
                "We now describe how to fault-tolerantly prepare the |TOF state. First, note that the state",
                ") is stabilized by g B and g C . Such a state can straightforwardly be prepared using the circuit in the dashed blue box of Fig. 13. In what follows, physical Toffoli gates will need to be applied between ancilla qubits and |\u03c8 1 prior to measuring the data. As such it is very important that the states |0 L and |1 L in the circuit of Fig. 13 (which are encoded in the repetition code) be prepared using the STOP algorithm since otherwise measurement errors in the last ancilla measurement round could lead to logical failures [87]. An alternative to avoid using the STOP algorithm would be to prepare |0 L and |1 L using postselection. However, such an approach would reduce the acceptance probability of our scheme (see below) thus increasing its space-time overhead cost. Once |+ L = |+ \u2297n , |1 L and |0 L have been prepared, the CNOT gate in the dashed blue box of Fig. 13 is applied transversally. Now, given a copy of |\u03c8 1 , we can prepare |TOF by measuring g A using the circuit in the dashed red box of Fig. 13 resulting in the state |\u03c8 out . If the measurement outcome is +1, then |\u03c8 out = |TOF , and if it is -1, then |\u03c8 out = Z A |TOF . Hence we apply a Z A correction given a -1 measurement outcome. Note that neither error detection nor error correction is applied to any of the data blocks at this stage. The reason is that it is not necessary for ensuring the fault tolerance of our scheme. Further, we found numerically that adding error correction at this stage results in higher logical failure rates when preparing |TOF . Furthermore, adding unnecessary error-detection units would lower the acceptance probability of our scheme. We provide a more detailed implementation of the controlled-g A gate in Fig. 14 below. A measurement error on the ancilla results in a logical Z A failure and so the measurement of g A needs to be repeated (similar repetitions are needed for the preparation",
                "13. Circuit for our entire BUTOF protocol. The first step (shown in the dashed blue box) consists of preparing the state",
                "). The preparation of the states |0 L and |1 L are described in Appendix J 1. The next step consists of measuring g A = X A CNOT B,C . If the measurement outcome on the ancilla is -1, a Z A correction is applied to the output state. Note that at this stage, error correction is not applied to the data block. The first two steps are enclosed within the dashed red box. We label the output state of the first two steps as |\u03c8 out . Lastly, the measurement of g A is repeated (d -1)/2 times for a distance d repetition code. The ED blocks correspond to one round of stabilizer measurements of the repetition code. If any of the measurement outcomes of error detection (ED) or ancillas are nontrivial, the protocol is aborted and begins anew.",
                "of logical computational basis states, see Appendix J). This can be done using the STOP algorithm. However, due to the increasing circuit depth with increasing repetition-code distance in addition to the high cost of the controlled-g A gate, such a scheme does not have a threshold and results in relatively high logical failure rates. As in Refs. [85,86], an alternative approach is to use an error-detection scheme by repeating the measurement of g A exactly (d -1)/2 times for a distance d repetition code. In between each measurement of g A , one round of error detection is applied to the data qubits by measuring the stabilizers of the repetition code (see Fig. 13). If any of the measurement outcomes are nontrivial, the BUTOF protocol is aborted and reinitialized. In Fig. 14(a), we provide an example of the two-dimensional layout and sequence of operations for measuring g A , which is compatible with our ATS architecture for a distance-5 repetition code. To realize the protocol with local operations, we replace the |+ ancilla in Fig. 13 with five qubits that we prepare in a Greenberger-Horne-Zeilinger (GHZ) state. Subsequently, the required Toffoli and CNOT gates are applied, followed by a disentangling of the GHZ states and measurement of the |+ state ancilla. The equivalent circuit implementing the g A measurement for a d = 5 repetition code is shown in Fig. 14(b).",
                "As a remark, we point out that in general, it is possible to use one fewer ancilla in the circuit of Fig. 14(a) with a lattice that is no longer translationally invariant with respect to yellow and gray vertices. However, such a layout could not straightforwardly be used with our lattice-surgery implementation of Appendix O. In Fig. 15(a), we provide the total Z failure probability of our BUTOF protocol for various repetition-code distances ranging from d = 3 to d = 9. We note that given the increasing circuit depth of BUTOF with the As can be seen, from all seven possible combinations of logical Z errors, a logical Z error on block A is more likely by several orders of magnitude. All numerical simulations were performed by setting n th = 0, \u03ba \u03c6 = 0, and using the circuit-level noise model described in Sec. III with |\u03b1 2 | = 8. repetition-code distance d, our scheme does not have a threshold even though it is fault tolerant. Further, as can be seen from Fig. 15(b), the acceptance probability for preparing such states (i.e., the probability that all measurement outcomes in Fig. 13 are trivial) decreases exponentially with increasing code distances. Hence, large repetitioncode distances should be avoided. However in REGIME 3 where \u03ba 1 /\u03ba 2 \u2248 10 -5 , we can still obtain |TOF states with total failure probabilities on the order of 6 \u00d7 10 -6 , which is orders of magnitude better than the failure probabilities that would be obtained by preparing |TOF states using non-fault-tolerant methods. This drastically reduces the overhead requirements of the top-down approach of Sec. VII. Also, as can be seen from Fig. 15(c), logical Z errors are highly concentrated on block A. The reason is that while the error detection units on each block can detect up to d -1 physical Z errors, (d -1)/2 measurement errors on the GHZ ancilla will lead to a logical Z error on block A.",
                "We note that the GHZ circuit in Fig. 14(b), which is used to measure g A , is not fault tolerant to X or Y errors [88]. However, since we are assuming that X and Y errors are exponentially suppressed, flag qubits for detecting X -type error propagation are unnecessary as long as X -or Y-error rates multiplied by the total number of fault locations are below the target levels for algorithms of interest. Indeed as is shown in Secs. VII and VIII and for the parameters chosen in this work, X error rates are low enough such that the desired failure rates can be achieved for implementing the quantum algorithms with over a million Toffoli gates (see Table V).",
                "We also remark that all simulations for our BUTOF protocol were performed by setting |\u03b1 2 | = 8. As can be seen in Fig. 7, when setting |\u03b1 2 | = 6, the total logical failure probability of a repetition-code strip is roughly 2 orders of magnitude higher than the |\u03b1 2 | = 8 results. Given such features and the fact that the GHZ circuit used to measure g A is not fault tolerant to bit-flip errors, we thus require that |\u03b1 2 | \u2265 8. Smaller values of |\u03b1 2 | would not be suitable for implementing our BUTOF protocol with only one round of magic state distillation (described in Sec. VII) since bit-flip failure probabilities would be too high. Therefore, in settings where |\u03b1 2 | \u2264 6, a different approach would be needed to prepare high-fidelity |TOF magic states.",
                "Lastly, we note that simulating the circuit in Fig. 14 can be challenging given the presence of physical Toffoli gates. In Appendix L, we provide a method for performing a near exact simulation of such circuits (the simulation is exact if there are less than d Z-type errors on block C prior to applying the physical Toffoli gates). Also, when using the STOP algorithm to simulate the preparation of |0 L and |1 L prior to applying the physical Toffoli gates, we do not add one round of perfect error correction (since projecting to the code space is not necessary at this stage). Residual errors at the output of the preparation of |0 L and |1 L using the STOP algorithm are propagated to the next stage of the protocol."
            ],
            "subsections": []
        },
        {
            "title": "VII. TOP-DOWN SCHEME FOR HIGHER-FIDELITY TOFFOLI GATES",
            "paragraphs": [
                "Previous sections established that surface codes and REGIME 3 are necessary to reach logical memory error rates needed for large-scale quantum computation. Section V reviewed lattice surgery and how it provided reliable Clifford operations through the Pauli-based model of computation. For large-scale, universal quantum computation we also need a very high-fidelity non-Clifford gate, such as the Toffoli gate. At the cat-qubit level, we proposed using an adiabatic bias-preserving Toffoli gate (see Sec. III C). We then proposed using the adiabatic Toffoli in the BUTOF protocol to prepare TOF states (see Sec. VI). The lowest infidelity we reported for the BUTOF protocol was 6 \u00d7 10 -6 , which is insufficient for quantum algorithms using over a million Toffoli gates.",
                "This section completes our proposal for performing a very high-fidelity Toffoli gate via the preparation of TOF states. We propose a magic state distillation protocol that utilizes the output of BUTOF. We use thin surface-code qubits wherever a potential bit flip would lead to an error on the output TOF state. We call this the top-down Toffoli protocol (herein TDTOF) because it assumes access to high-fidelity logical Clifford gates, so we are attacking the problem with a view from the top of the stack. Later, in Sec. VIII, we show that using one round of BUTOF concatenated with one round of TDTOF, achieves high enough fidelities to implement some quantum algorithms of interest.",
                "This section makes three significant contributions to the theory of magic state distillation. Our first main contribution is a new set of quantum error-correction codes that can be used for TOF-to-TOF magic state distillation more efficiently than all previous proposals. In the main text, we describe only the specific codes used in TDTOF, but Appendix O 2 presents a general framework for code design and TOF state distillation, of which TDTOF is just one example. Our second main contribution is the idea of using Clifford symmetries of magic states to perform noise tailoring that enables us to exploit noise bias. Again, Appendix O 6 explores Clifford symmetries at a general level, and here we discuss the consequences to TDTOF. In summary, at high noise bias, exploiting Clifford symmetries enables cubic error reduction instead of quadratic error suppression. Our third main contribution is numerical, we calculate the performance of TDTOF in our proposed hardware using REGIME 3 noise parameters.",
                "The Toffoli gate is equivalent, up to conjugation of the target qubit by a Hadamard transformation, to the controlled-controlled-Z (CCZ) gate, and for technical reasons we prefer to work with CCZ gates. Throughout this section we work at an encoded level, so whenever we say qubit, we mean surface-code qubit. Our starting point for design of TDTOF is identifying a trio of n-qubit codes each encoding k logical qubits, which have a transversal, logical CCZ gate. By transversal, we mean that if CCZ j denotes a CCZ gate acting on the j th qubit in each of three code blocks, then CCZ \u2297n = n j =1 CCZ j realizes the logical CCZ \u2297k acting on 3k logical qubits. The error-correction codes we use for TDTOF are shown in Fig. 16 and each block uses n = 8 to encode k = 2 logical qubits. Figure 16 also illustrates what we mean by CCZ transversality, with the transversality proof postponed until Appendix O 2.",
                "Given such a code, a standard recipe for magic state distillation protocols goes as follows [40]: prepare |+ \u22973k L encoded in the relevant codes; perform imperfect CCZ \u2297n by gate teleportation using noisy TOF states; measure the X stabilizers and postselect on \"+1\" outcomes; and decode. This would require 3n = 24 qubits plus workspace for Cliffords and routing. However, one can make a spacetime trade-off [79,89,90] so that the full 24-qubit code is never prepared; rather we work with nine qubits that we herein call the factory qubits. We label these nine factory qubits with (j , D) where D \u2208 {A, B, C} denotes the code block and j \u2208 {1, 2, 3} specifies the qubit within the code block. To achieve the space-time trade-off, we can define an encoding Clifford V such that for D \u2208 {A, B, C} we have",
                "The logical operators X L1D and X L2D are shown in Fig. 16."
            ],
            "subsections": []
        },
        {
            "title": "Instead of encoding |+ \u22973k",
            "paragraphs": [
                "L and performing CCZ \u2297n , we prepare |+ \u22979 and perform V(CCZ \u2297n )V \u2020 . At the end of the protocol, instead of measuring the X stabilizers we need only measure the three check qubits labeled X 3,D .",
                "It is important that V(CCZ \u2297n )V \u2020 acts nontrivially on only the nine qubits identified and error-correction properties of the protocol are unaffected (see Appendix O 3 or Refs. [79,89,90] for details). In a Pauli-based computation, each noisy gate VCCZ j V \u2020 can be realized using a single noisy TOF state (produced by BUTOF) followed by a sequence of multiqubit Pauli measurements implemented through lattice surgery (recall Sec. V and see also Appendix O 4). An explicit factory layout is given in Fig. 62 of Appendix O 7 that provides ample routing space for lattice surgery to be executed rapidly, with four Toffoli gate teleportations happening in parallel.",
                "To describe the fault-tolerance properties of TDTOF, let us first assume the underlying memory and lattice-surgery operations are implemented perfectly. Since the protocol is based on a trio of codes, each of which can detect a single error, we can detect any fault affecting a single noisy TOF",
                "X correction codes each using n = 8 qubits to encode k = 2 logical qubits. The top circuit shows the 3n = 16 qubits and labels the X stabilizers and logical operators for these codes. Each of the 3k = 6 qubits is actually encoded again into a thin surface code. The bottom circuit shows the 3k logical qubits encoded by this code. The crucial and exotic property of these codes is that they have a transversal a CCZ gate: applying the eight CCZ gates as shown in the top circuit, results in the two logical CCZ gates shown in the bottom circuit. See Appendix O 2 for proof details.",
                "state. Even if an error affects multiple qubits within a single TOF state (e.g., a Z \u2297 Z \u2297 Z error) we still call it a single fault-location error because it leads to no more than one error in each code block, and so is detectable. Therefore, if the noisy input TOF states have infidelity , then after postselection the output TOF states will have infidelity O(2 ). In Appendix O 5, we show exactly how the output fidelity depends on the noise model of the input TOF states. As a toy example, in Appendix O 5 we show that for depolarizing noise the output infidelity is 1.878 2 + O( 3 ) per TOF state output.",
                "However, we saw in Fig. 15 that BUTOF outputs states with errors heavily dominated by Z \u2297 1 \u2297 1. Let us consider the case when the TOF states are generated by BUTOF with d BU = 7 and assume REGIME 3 parameters; we refer to this throughout as our benchmark example. Assuming an ideal implementation of TDTOF (without any further optimization to the noise profile) gives an output error of 8 \u00d7 10 -10 \u223c 2 2 , so the noise correlations slightly degrade performance relative to a depolarizing noise model with the same total error.",
                "If C is a Clifford transformation such that C|TOF = |TOF , we say that C is a Clifford symmetry of the (errorfree) TOF state. For example, the group of Clifford symmetries includes {g A , g B , g C } of Eqs. ( 44) to (46). Using these symmetries, we can improve the fidelity of the output TOF states by tailoring the distillation protocol, exploiting the property that the noise on input TOF states is dominated by Z errors on the first qubit. In the tailored protocol we apply a different Clifford symmetry to each of the eight input TOF states. The Clifford transformation C modifies the noise model, mapping an error E to CEC \u2020 .",
                "We prove in Appendix O 6 the existence of a set of Clifford symmetries with the following property: given an initial noise model dominated by a Pauli Z \u2297 1 \u2297 1 error occurring with probability 1 = p Z A and rarer Z errors occurring with total probability 2 = E =Z A p E , the tailored protocol outputs TOF states with infidelity O( 31 ) + O( 1 2 ) + O( 22 ). Furthermore, performing the Clifford symmetries adds a mere two CNOT gates to the protocol's gate complexity because most of the Clifford symmetries can be chosen as permutations of qubit labels. Having accounted for both space-time trade-offs and noise tailoring, the full final protocol is described in Table XIII ",
                "Returning to the previously discussed benchmark example, then 1 = 2 \u00d7 10 -5 and 2 = 7.5 \u00d7 10 -9 so 2 TABLE IV. Resource costs for TDTOF generation of TOF states using as input eight noisy states produced by BUTOF using distance d BU . The protocol outputs two TOF states with infidelity 2 TD and acceptance probability P ACC rounded to nearest integer. We give the expected runtime per Toffoli as T TD . The whole factory (including BUTOF modules) has a footprint given in terms of the number of ATS components, or equivalently in terms of PCDRs (qubits), which is approximately 3 times the ATS count. Further details are provided in Table XV can exponentially suppress memory and lattice-surgery errors by increasing the code distance, though this comes at increased resource cost. The tuning of these code distances is one of the most important aspects of optimal factory design. Following an approach similar to prior work on code-distance tuning [90], we present our analysis of Clifford noise in Appendix O 8. We present a sample of our numerical results from Appendix O 8 in Table IV.",
                "As we discuss in Sec. VIII, the error rates in Table IV are sufficiently low for reliable implementation of quantum algorithms with up to 10 8 Toffoli gates, at a quite low overhead cost. Note that the lowest error rate reported in the table is 2.4 \u00d7 10 -9 ; this error rate is dominated by bit-flip errors in repetition-code blocks, and could be surpassed by more extensive use of surface codes (see Appendix O 9).",
                "Let us compare to the factory of Gidney and Fowler [91] that concatenates T-state distillation with a protocol that distills a single TOF state from a supply of T states. Using a square surface-code distance d, the factory requires 12d \u00d7 6d qubits and takes 5.5d surface-code cycles. They assume a superconducting transmon architecture with p SC = 10 -3 CNOT gate infidelity that can execute one cycle of surfacecode error correction 1 \u03bcs. For sample algorithms with approximately 1-100 million Toffoli gates, they considered a d = 31 surface code, which gives a 6.9 \u00d7 10 4 qubit footprint generating one TOF state every 170 \u03bcs. This is a considerably larger size than our factory, mainly because we exploit BUTOF, thin surface codes, and where possible we use repetition codes. Note that Table IV assumed hardware parameters leading to surface-code cycles of 31 \u03bcs rather than 1.1 \u03bcs, so while our factory typically needs far fewer surface-code cycles per TOF state, our slower physical gate times mean that the overall factory runtime (per TOF state) are an order of magnitude slower."
            ],
            "subsections": []
        },
        {
            "title": "VIII. OVERHEAD ESTIMATES",
            "paragraphs": [
                "Here we consider how our architecture could be used to fault-tolerantly implement a quantum algorithm beyond the reach of classical computers. Throughout this section, we assume REGIME 3 hardware parameters and find competitive performance compared to other architectures. Since REGIME 1 and REGIME 2 incur much higher resource overhead costs and/or cannot reach the required fidelities, a key conclusion is that REGIME 3 or better should be the long-term goal for the proposed architecture. Using a Pauli-based computation (recall Sec. V), the complexity is mainly determined by the number of qubits and Toffoli gates required for the algorithm. Simulations of 100-qubit circuits are substantially beyond the reach of current classical methods unless they have low depth or are near-Clifford circuits. Currently, the best-known classical simulation algorithm of near-Clifford circuits [94] for an n-qubit circuit with a total of N TOF Toffoli gates has a runtime O[poly(n, N TOF )2 0.83N TOF ]. Without substantial improvement of existing classical simulation algorithms, for N TOF = 1000 the exponential component of the runtime is comfortably in the classically intractable regime.",
                "Let us consider a computation with n = 100 and N TOF = 1000. A computation of this size could be executed reliably using only the repetition code; the protection against bit flips provided by thin-stripped surface codes is not needed. Using d rep = 9 repetition codes for BUTOF, error rates of 6 \u00d7 10 -6 per TOF gate can be achieved and therefore an error probability of 0.6% for the full algorithm arising from errors in TOF gates alone. However, logical failure rates for data qubits stored in memory must also be considered. For data qubits encoded in the repetition code, the lowest achievable logical error rate is 2.7 \u00d7 10 -8 using a d rep = 9 repetition code (Fig. 7). With 1000 \u00d7 d rep = 9000 repetition-code cycles and n = 100 logical qubits, the total probability of a memory error is approximately 2.4%. Hence the total failure probability of the algorithm due to the combination of memory TOF errors is approximately 3%. Since BUTOF is probabilistic, we can boost the success probability to near unity and produce Toffoli states effectively on demand by simply making many parallel attempts at BUTOF. The whole computation is therefore achievable with 900 ATS components for memory and several hundred ATS components to parallelize BUTOF.",
                "Additional resources are needed for routing and performing Clifford operations, so the entire device would require between 1 and 2 thousand ATS components, depending on routing and Clifford requirements.",
                "While algorithms using a thousand Toffoli gates are classically intractable with known methods, there are no known algorithms of this scale that offer a quantum advantage for useful problems. As a representative example of a problem where quantum advantage is reachable with a relatively modest quantum circuit, we consider the task of estimating the ground-state energy density of the Hubbard model with Hamiltonian [6,95] (48) which describes fermions hopping on an L \u00d7 L square lattice with periodic boundary conditions; t is the coefficient of the hopping term in H [N (i) denotes the set of lattice sites that are neighbors of site i], and u is the coefficient of an on-site repulsive term. The fermion creation and annihilation operators a \u2020 , a can be encoded using qubits by various methods. The ratio u/t quantifies the interaction strength. We consider u/t = 4 to enable an easier comparison with Ref. [6]. However, a classical simulation of such a model is most difficult in the regime near u/t = 8 [96] and so we also consider this choice.",
                "We use the plaquette Trotterization scheme and analysis of Ref. [95] to count the non-Clifford gates for estimating the ground-state energy density. Overall, the gate complexity scales as O(L 3 / 3/2 ) where is the allowed error in the total energy. Since we are interested in the energy density, we can consider a multiplicative (extensive) error of 5% of the ground-state energy. Since the allowed energy error grows with the system size L 2 , the overall runtime complexity is upper bounded by a constant [97]. We also require the algorithm to succeed with probability at least 90%. From Table V, we see this algorithm requires over 1 million Toffoli gates and over 100 logical qubits [6]. While simulating the Hubbard model is not feasible using just the repetition code to protect the logical data qubits, only very little bit-flip protection suffices, and so we can use a d x = 3 thin surface code as our primary storage and the TDTOF protocol for Toffoli states. Table V separately presents the number of logical TOF gates (N TOF ) and logical T gates (N T ) required by the algorithm. We can catalyze one TOF state into two T states [93], so that the algorithm consumes a total of",
                "TOF states.",
                "Caveats in architectural comparisons: Our results for u/t = 4 in Table V can be compared with the transmon architecture resource estimates of Table I of Ref. [6], though subject to several caveats that we list first. Direct comparisons are difficult because the noise models are very different. Transmon architectures are typically considered with CNOT error probabilities of p SC = 10 -3 or p SC = 10 -4 and a depolarizing noise model. In contrast, for our TABLE V. Column \"No. ATS\" refers to the total number of ATS components used. The total number of ATS count includes the following: 2L 2 logical qubits to represent the Hubbard model fermions; ancilla qubits for phase estimation, ancilla-assisted circuit synthesis [92], Hamming weight phasing and catalysis [93]; and the ATS space for one TDTOF factory (%fac counts the percentage of this contribution rounded up to nearest integer); and we also include a generous +30% space overhead for routing and lattice-surgery costs. REGIME 3 hardware parameters the CNOT infidelity is 3.6 \u00d7 10 -3 , but with highly biased noise. To perform a CNOT with infidelity of 10 -4 we would need \u03ba 1 /\u03ba 2 \u223c 10 -8 (see caption of Fig. 8 for further discussions). So although we benefit greatly from bit-flip suppression due to cat codes, our current projections for Z-error rates are far less optimistic than typically assumed for transmon qubits. Furthermore, transmon-architecture resource estimates are based on a toy depolarizing noise model, whereas our noise model has been derived from detailed modeling of the hardware. An additional important caveat is that we exploit the Hubbard model simulation analysis of Ref. [95], which provides a 5.5\u00d7 reduction in gate count for L = 8 and a larger improvement for larger L (compared to Ref. [6]). These gate-count reductions lead to a comparable 5.5\u00d7 reduction in runtime, but below we factor out these algorithmic improvements when making architectural comparisons with Ref. [6].",
                "Qubit cost discussion: Table V includes a column reporting the number of ATSs required. For an L = 8 and u = 4 Hubbard model, we estimate the cost at 18 000 ATSs, which corresponds to the headline figure in our abstract. We need to triple this number to obtain the number of PCDRs (qubits). Comparing to a superconducting transmon-qubit architecture [6] with a CNOT infidelity p, we find that for p = 10 -3 we need approximately 6\u00d7 fewer qubits; and for p = 10 -4 we use a comparable number of qubits. At the end of Sec. IV B, we made a comparison of surface-code overheads with a p = 10 -3 depolarizing noise model and found we needed approximately 6\u00d7 fewer qubits, similar to the approximately 6\u00d7 improvement found here. Given better \u03ba 1 /\u03ba 2 than assumed by REGIME 3, there would be additional resource savings. One loose assumption in our qubit counting is that we multiply our resource overhead costs by a factor of 1.3\u00d7 to account for routing and lattice-surgery costs (see discussion of Sec. V and Ref. [7]) whereas we do not know what routing overhead was assumed in Ref. [6] but believe this was neglected.",
                "Runtime discussion: The total runtime of our architecture is in the practically reasonable range of 23-89 min for a classically challenging task. There are two important factors in the runtime analysis: (1) the time it takes to prepare \u03c4 TOF states, which is T a = \u03c4 T TD (see Table IV for examples of values of T TD ); (2) the time required to inject magic states and perform Toffoli uncomputations via lattice surgery T b = (4N TOF + N T )(d m + 1)T surf (see Ref. [7] for further discussion), where T surf is the time per surfacecode cycle and d m is the number of surface-code cycles per lattice-surgery operation (recall Fig. 11). Note that we use d m + 1 instead of d m to allow for ancilla qubits to be reinitialized between consecutive lattice-surgery protocols. We take the runtime to be RT = max[T a , T b ]. We say the architecture is Clifford bottlenecked if RT = T b and magic state bottlenecked if RT = T a .",
                "Note that our estimate of T a assumes that we can only teleport one magic state qubit at a time, since faster injection rates could incur higher routing or Clifford gate costs. For our hardware and factory design, we are Clifford bottlenecked as the TDTOF factory is producing Toffoli states at about the same pace as they can be transported into the main algorithm. In contrast, estimates for superconducting transmon architectures [6] have assumed a single factory leading to them being significantly magic state bottlenecked (with the algorithm often idle and waiting for the factory). Let us consider the instance with u/t = 4 and L = 8, for which we estimate a runtime of 32 min. For a transmon architecture with p SC = 10 -3 , one obtains a runtime estimate of 3 min, by reducing the results of Ref. [6] by a factor 5.5 to account for recent algorithmic improvements [95]. A similar runtime estimate (2.6 min) is obtained for the transmon architecture by assuming it generates one TOF state per 170 \u03bcs using the factory of Ref. [91]. Overall, the transmon architecture runs about 11\u00d7 faster than our architecture, primarily due to 28\u00d7 faster execution of each surface-code cycle."
            ],
            "subsections": []
        },
        {
            "title": "IX. CONCLUSION",
            "paragraphs": [
                "In this paper, we presented a comprehensive analysis of an architecture for a fault-tolerant quantum computer. At the lowest level, it is based on hybrid electroacoustic devices to implement a stabilized cat code with highly biased noise, dominated by phase flips. This cat code is then concatenated with an outer code that focuses mostly on correcting the phase-flip errors. Our estimated overheads for performing fault-tolerant quantum algorithms showcase the promise of this approach if the appropriate parameter regime can be reached. There are several interesting directions for future work to improve on our current proposal.",
                "On the hardware side, we would like to explore ways to increase the value of \u03ba 2 , which would allow us to achieve the desired ratio of \u03ba 1 /\u03ba 2 with a less stringent constraint on T 1 = 1/\u03ba 1 of the acoustic oscillators. Currently the value of \u03ba 2 is upper bounded by the crosstalk error and the bandwidth of the filter. We believe similar set ups with tunable couplers, multiport resonators, and multiple buffer modes are promising for increasing substantially the attainable value of \u03ba 2 . Higher \u03ba 2 would also give faster gates, allowing for a larger quantum advantage over classical computing.",
                "As was shown in this work, the magic state factory accounts only for at most 9.5% of the total resource overhead requirements. The other 90.5% of the overhead is largely dominated by the performance of the thin rotated surface code. Recently, an XZZX -type surface code, which takes advantage of the noise bias for phase-flip errors was introduced and shown to have better thresholds compared to the rotated surface code [11]. An interesting avenue for future work would be to consider the implementation of the XZZX surface code (or other topological codes, which take advantage of the noise bias) in our architecture to determine if further reductions in overhead costs can be achieved. Further, one could use compass codes [98][99][100][101], which potentially require fewer resources compared to surface codes given the low-weight gauge operator measurements. However, details for implementing such codes in a lattice-surgery scheme such as the one presented in this work remain to be addressed. We also note that better thresholds and lower logical failure rates for a given code distance does not necessarily correspond to lower resource costs for running algorithms. For instance, a more careful analysis of the XZZX surface code shows that although it achieves lower logical failure rates than a thin-stripped surface code for the same d x and d z distances, the XZZX code requires roughly double the amount of data and ancilla qubits compared to thin-stripped surface codes. As such, for desired target logical error rates required to implement certain algorithms, there are noise parameter regimes where the overall resource costs for running the algorithm using a thin-stripped surface code is less than using the XZZX code.",
                "In this work we considered a standard model of Paulibased computation with multiqubit Pauli operators measured via lattice surgery in order to inject magic states. This approach comes with an additional qubit cost for data access and routing, and the choice of routing solution yields a lower bound on runtime. In previous resource analyses, these considerations were not especially important because algorithms were bottlenecked by the pace at which they could produce magic states. In contrast, data routing emerged as a bottleneck in our architecture, and so a more careful optimization of routing costs and speed of gate teleportation might improve the runtime substantially. Indeed, a rapid runtime is especially important in an architecture where bit flips are rare because it is desirable to execute the algorithm fast enough such that we can avoid needing a code with a higher d x distance."
            ],
            "subsections": []
        },
        {
            "title": "Implementation of the required Josephson nonlinearity",
            "paragraphs": [
                "In Sec. II in the main text, we described at a high level how the two-phonon dissipation can be generated by engineering a nonlinear interaction g * 2 \u00e22 b \u2020 + h.c. between the storage mode \u00e2 and a very lossy \"buffer\" mode b. Here we describe in detail how this interaction can be engineered and calculate estimates of g 2 specifically for the hardware in this proposal. Following the method introduced in Ref. [28], we propose implementing the required nonlinearity using an \"ATS\" device, which consists of an ordinary SQUID that is split in the middle by a linear inductor-see Fig. 17. We reproduce some of the results of Ref. [28] here for convenience.",
                "In its most general form, the ATS potential is given by",
                "where \u03c6 is the phase difference across the ATS, \u03c6 :=",
                ") is the magnetic flux threading the left (right) loop, in units of the reduced flux quantum 0 = /2e. Here",
                ")/2 is the junction asymmetry. This ATS potential can be further simplified by tuning \u03c6 and \u03c6 with two"
            ],
            "subsections": []
        },
        {
            "title": "FIG. 17. Schematic diagram of an ATS. Two junctions with",
            "paragraphs": [
                "Josephson energies E J ,1 , E J ,2 are connected in parallel, forming a SQUID. The SQUID loop in turn is \"split\" in the middle by a linear inductor with inductance L b , effectively forming two loops on either side of the inductor. The magnetic fluxes \u03c6 ext,1 and \u03c6 ext,2 threading the left and right loops, respectively, are controlled via externally applied, time-dependent currents I 1 (t), I 2 (t) that are buffered to ground in the vicinity of the loops using on-chip fluxlines.",
                "separate fluxlines, setting them to",
                "where p (t) = p,0 cos(\u03c9 p t) is a small ac component added on top of the dc bias. At this bias point, and assuming that | p (t)| 1, Eq. (A1) reduces to",
                "(A4)"
            ],
            "subsections": []
        },
        {
            "title": "Calculation of nonlinear interaction rate g 2",
            "paragraphs": [
                "To make further progress, it is necessary to represent the nanomechanical element as an equivalent circuit that accurately captures its linear response. This can be done straightforwardly using the method of Foster synthesis, provided we know the admittance Y m (\u03c9) seen from the terminals of the mechanical resonator. This admittance can be accurately computed using modern FEM solvers. For further details on the piezoelectrics simulations, see Ref. [29].",
                "The equivalent circuit (or \"Foster network\") is shown in Fig. 18(a) and in its simplest form consists of a \"dc capacitance\" in series with an LC block, with an additional resistor (not shown) inserted to include the effects of loss in the resonator. We note that this \"lossy Foster\" method is not exact but is accurate enough for our purposes provided that losses are sufficiently small [102]. The linear part of the buffer resonator (including the inductor that splits the ATS) can also be represented as an LC block. In this representation the buffer and storage resonators are two linear circuits with a linear coupling and can therefore be diagonalized by a simple transformation of coordinates. The resulting \"storagelike\" (\u00e2) and \"bufferlike\" ( b) eigenmodes both contribute to the total phase difference across the ATS, \u03c6 = \u03d5 a (\u00e2 + \u00e2 \u2020 ) + \u03d5 b ( b + b \u2020 ). These modes therefore mix via the ATS potential, which we redefine as",
                "\u03c62 /2 because we already absorbed the inductor into the linear network. The vacuum fluctuation amplitudes of each mode mode are given by",
                "where C is the Maxwell capacitance matrix of the circuit, U is the orthogonal matrix that diagonalizes C -1/2 L -1 C -1/2 , and L -1 is the inverse inductance matrix [103]. The index k \u2208 {a, b} labels the mode and j labels the node in question.",
                "Note that generally we omit the j index in our notation because the node of interest is clear from context (it is the one where the ATS is located). The way in which the ATS mixes the modes is now explicitly clear: the third-order term in the Taylor series expansion of the sin( \u03c6) function in Eq. (A4) contains terms of the form \u00e22 b \u2020 + h.c., which is precisely the required coupling. This is the key reason for using an ATS as opposed to an ordinary junction, which has a potential approximately cos( \u03c6). Note also that a finite junction asymmetry | E J | > 1 partially eliminates the benefit of using an ATS, as this introduces additional self-and cross-Kerr terms. For the remainder of this analysis we assume we are operating in the ideal case E J = 0, noting that with state-of-the-art fabrication one can reliably achieve E J /E J \u223c 10 -2 [104].",
                "In order to select the desired terms one must set the pump frequency to \u03c9 p = 2\u03c9 a -\u03c9 b [28]. This brings the term g * 2 \u00e22 b \u2020 + h.c. into resonance and allows us to drop the other terms using a rotating-wave approximation (RWA). The coupling rate is given by g 2 = (E J / ) p,0 \u03d5 2 a \u03d5 b /2. Additionally, a linear drive * d b + h.c. at frequency \u03c9 d = \u03c9 b is added to supply the required energy for the twophonon drive.",
                "We now explicitly calculate g 2 assuming that the storage resonator is a one-dimensional lithium niobate PCDR as reported in Ref. [32]. We use for its Foster network parameters the values C g = 0.385 fF, C a = 1.682 fF, and L a = 2.614 \u03bcH, which in previous work have produced accurate estimates of the linear coupling rate between the phononic mode and other electrical circuits [32,35]. These parameters set \u03c9 a /2\u03c0 \u2248 2.17 GHz as the storage-mode frequency, which will remain fixed for the remainder of this Appendix. We further take E J /h = 90 GHz and p,0 = \u03c0/80 as representative values that are experimentally realistic [28]. We note that Ref. [28] did not explicitly report a value for p,0 , but we inferred it by reproducing their reported value of g 2 . In some instances we will set p,0 to an even smaller value, which we will indicate accordingly. In Fig. 18(b) we show g 2 plotted as a function of the buffer mode's frequency",
                "The two parameters \u03c9 b and Z b completely specify the properties of the buffer resonator for the purposes of this work. One salient feature is that g 2 scales as",
                "which is due to the fact that \u03d5 b \u223c \u221a Z b and \u03d5 a \u223c Z b . This rapid scaling will prove useful later on, when we explore how to configure the system to minimize the dimensionless loss \u03ba 1 /\u03ba 2 ."
            ],
            "subsections": []
        },
        {
            "title": "Classical filter theory and derivation of dissipation rates",
            "paragraphs": [
                "The above calculation of g 2 is only half the story, since we are ultimately interested in making accurate predictions of \u03ba 1 /\u03ba 2 . Indeed \u03ba 2 = 4g 2  2 /\u03ba b in the simple two-mode model with the pump tuned perfectly on resonance \u03c9 p = 2\u03c9 a -\u03c9 b . However, as we show in Appendix B, in order to stabilize multiple modes with a single ATS (which is necessary to achieve the required connectivity for the surface code), it is a critical requirement to utilize a bandpass filter between the buffer resonator and the open 50 port in order to protect the storage modes from radiative decay and to suppress unwanted correlated decay processes-see Fig. 19(a) for a sketch of the device. We therefore need a more general expression for the two-phonon dissipation rate \u03ba 2 in the case where the bath that the b mode couples to is described by a general admittance function Y(\u03c9). We begin with the Hamiltonian of the closed system comprising the storage mode a and the buffer mode b, neglecting dissipation:",
                "is the node flux at node j (with the voltage V j defined with respect to the ground node), and",
                "We are also using the notation \u03c6 j := j / 0 for the dimensionless flux, where 0 = /2e is the reduced flux quantum. The equations of motion (EOMs) are",
                "where we defined I J := E J / 0 . Note that the charge EOM in Eq. ( A9) is simply Kirchhoff's current law (KCL). To include the effect of the external admittance Y(\u03c9), which describes both the filter and the 50 output line, we add an additional source of current I s (t) flowing into node 2:",
                "where \u02d9 F,2 (\u03c9) is the Fourier transform of the voltage \u02d9 2 (t). Combining the EOMs Eq. (A9) and adding the source term, we find",
                "where F(t) is defined as",
                "Here both integrals run from -\u221e to +\u221e. We use this convention for the remainder of this section for notational simplicity, unless otherwise stated. Let = C 1/2 . Then Eq. (A13) becomes",
                "We now diagonalize the matrix",
                "where = diag(\u03c9 a , \u03c9 b ) is a diagonal matrix containing the normal-mode frequencies and U is an orthogonal matrix. The normal modes are",
                "In terms of , the flux EOM Eq. ( A15) is given by",
                "where we have used the fact that C (and therefore C -1/2 ) is symmetric. If we define a := (C -1/2 U) 21 1 and b := (C -1/2 U) 22 2 , Eq. (A18) can be written more neatly as",
                "where",
                "are the effective capacitances of the a and b normal modes. Equation (A18) is KCL for a different network-one where two LC stages, one for each of the normal modes, are placed in series with each other. The series combination is in turn connected to the filtered environment Y(\u03c9) and the ATS potential U( ) [see Fig. 19(b)]. Note that this diagonalization procedure is completely equivalent to synthesizing a Foster network representing the coupled storage and buffer resonators, for example as done in black-box quantization [102].",
                "Note that = C -1/2 U , and in particular",
                "In terms of these normal-mode amplitudes, F(t) is given by",
                "We now define the following dimensionless, time-varying mode amplitudes:",
                "Defining \u03d5 j = -1 0 /2\u03c9 j Cj , where j \u2208 {a, b}, we have",
                "Here the \u2020 symbol indicates complex conjugation. We identify \u03d5 j as the amplitude of the vacuum fluctuations of the phase at node 2 due to mode j .",
                "It is straightforward to show that the EOMs of these \"annihilation variables\" are",
                "In terms of a and b, the source term F(t) is given by",
                "We now invoke the RWA and neglect terms that are fast rotating, namely a \u2020 (t ) and b \u2020 (t ) in both EOMs and a(t ) and b(t ) in the EOMs for b and a, respectively. This is well justified in the regime where \u03c9 a , \u03c9 b , and |\u03c9 a -\u03c9 b | are all much larger than the dissipation rates Re[Y]/2 Cj , j \u2208 {a, b}. We see shortly that indeed these quantities emerge . The coupling capacitance C \u03ba between the buffer resonator and the first filter cell is defined separately for generality. (d) Top: coupling capacitances plotted as a function of cell index i for tapered [(N , N t ) = (10, 3)] and uniform [(N , N t ) = (13, 0)] filters. The tapered structure, found automatically by a Nelder-Mead optimizer, is characterized by a rapid increase in C c near the end of the structure. Bottom: typical filter response, here shown as the real part of Y(\u03c9) for tapered and uniform filters. The response of the uniform structure shows multiple sharp peaks, each corresponding to a standing-wave resonance of the structure, whereas the tapered response is relatively flat throughout the filter passband. In effect, the taper allows propagating waves to be transmitted to the open waveguide over a broad bandwidth.",
                "as dissipation rates from our analysis, so this assumption is self-consistent. The EOMs, Eq. (A28), then become",
                "We now go to an \"interaction frame\" (or rotating frame) defined by the transformations",
                "and explicitly add the flux pump",
                "which was introduced in Appendix A 1. We have also added a detuning to keep the analysis general and also because finite is a key requirement for multiplexed stabilization-see Appendix B. Expanding the cosine term to second order and keeping only the resonant terms, we find",
                "where ",
                "which describes an \"ideal\" filter with bandwidth J . We note this is not a physical admittance function and we are using this simply as an example-in particular, it does not satisfy certain basic properties such as causality. Its Fourier transform is",
                "Therefore, assuming b(t ) evolves much more slowly compared to the time scale 1/J , the following approximation holds:",
                "where in the last line we used Y(-\u03b4) = Y * (\u03b4). We verify shortly that this slowness assumption is self-consistent. For now, this approximation transforms the EOMs, Eq. (A34), to the following form:",
                "Here",
                "are the effective linear dissipation rates of the a and b modes, respectively. We have also added an additional drive term d (which rotates at frequency \u03c9 b + in the lab frame and therefore here it is static), and defined \u02dc := -Im [Y * (\u03c9 b + )] /2 Cb , which now includes the frequency shift of the b mode due to its coupling to the filter. Note we have also neglected the corresponding shift -Im [Y * (\u03c9 a )] /2 Ca of the a mode, since this is negligibly small for the purposes of this analysis.",
                "Let us now find an effective description of the a mode alone, valid in a regime where the linear dissipation rate \u03ba b,eff is large (in a sense that will be made rigorous shortly). This procedure is the classical analog of the formal adiabatic elimination procedure used in Appendix B 1. Let us assume that \u1e03(t) = 0, i.e., the b mode is evolving sufficiently slowly that the time derivative can be neglected. Then Eq. (A43) becomes",
                "and",
                "where",
                "and",
                "As a final step, let us linearize the EOMs around the static solutions a = \u00b1\u03b1 given by setting \u0227(t) = 0. Assuming 4\u03ba 2 |\u03b1| 2 \u03ba 1 , the solutions are \u03b1 = \u00b1 \u221a d /g 2 . Defining d := a -\u03b1 as the \"fluctuations\" around these fixed points, the linearized equation of motion for d(t) becomes",
                "where \u03ba conf := 4|\u03b1| 2 \u03ba 2 . We call this rate the confinement rate in keeping with existing terminology [28]. Applying this linearization to Eq. (A44), we find",
                "The rate \u03ba 2 we previously defined is now manifestly the two-phonon dissipation rate that we wanted to find, as it sets the rate \u03ba conf at which fluctuations away from the fixed points a = \u00b1\u03b1 decay back into the \"code space.\" It reduces to the familiar form \u03ba 2 = 4g 2 2 /\u03ba b,eff in the case of a perfectly resonant pump \u02dc = 0, and to the form \u03ba 2 = (g 2 / \u02dc ) 2 \u03ba b,eff in the far off-resonant limit | \u02dc | \u03ba b,eff . This latter form is indeed equivalent to the expressions for \u03ba 2 derived in Appendix B, where the filter is modeled as a linear chain of oscillators with nearest-neighbor linear couplings. Here, the function \u03ba b,eff ( ) contains all the information about the filtered environment, capturing effects such as the exponential suppression of \u03ba 2 when lies outside of the filter passband. Finally, we note that the straightforward linearization procedure above is the classical analog of the shifted Fock-basis technique described in Appendix C.",
                "Let us go back and re-examine the two main assumptions that we have made so far: (1) that b(t ) evolves much more slowly compared to the filter response time scale 1/J , and (2) the adiabatic assumption that \u1e03(t) = 0 in Eq. (A43).",
                "First, by inspecting equation Eq. (A48) we can extract the effective time scale of the dynamics of d mode. We see that d evolves on a time scale 1/|\u03b1| 2 \u03ba 2 (assuming |\u03b1| 2 \u03ba 2 \u03ba 1 , which is the regime we are interested in). Therefore, from the solution for b(t) in Eq. (A49) we infer that the b mode also evolves on this time scale. The slowness assumption that led to Eq. ( A43) is therefore self-consistent as long as |\u03b1| 2 \u03ba 2 J . Furthermore, even though we used a \"toy model\" for Y(\u03c9) to illustrate the required hierarchy of time scales, we verified numerically using the simulations in Appendix A 4 that this exact logic remains valid even when Y(\u03c9) describes a real, appropriately designed filter.",
                "Second, under which conditions is the adiabatic elimination \u1e03(t) = 0 valid? The solution for b(t) in Eq. (A49), obtained by assuming \u1e03(t) = 0, evolves on the same time scale 1/|\u03b1| 2 \u03ba 2 as d(t). Therefore, the adiabatic elimination step is self-consistent so long as |\u03b1| 2 \u03ba 2 \u03ba b , because 1/\u03ba b is the time scale in which b(t), as described by the full EOM, Eq. (A43), converges to its steady state. Since \u03ba 2 ( ) \u2264 \u03ba 2 (0), this condition is equivalent to 2|\u03b1|g 2 \u03ba b :",
                "For the purposes of this work we assume that 2|\u03b1|g 2 = \u03b7\u03ba b is sufficient, for some small number \u03b7 < 1. Using timedomain master-equation simulations (not shown) we have verified that using \u03b7 = 1/5 is sufficient to stabilize the storage mode."
            ],
            "subsections": []
        },
        {
            "title": "Filter design",
            "paragraphs": [
                "Here we turn to the problem of filter design. What should we use as the physical embodiment of the filtered environment described by Y(\u03c9)? We can start by outlining some general design principles based on the preceding analysis. First, recall that the effective dissipation rate of the b mode is \u03ba b,eff ( ) = Re [Y * (\u03c9 b + )] / Cb , and second, note that the two-phonon dissipation rate is given by Eq. (A46), which we repeat here for convenience:",
                ". As discussed in Appendix B, different values of are required to stabilize multiple modes with a single ATS-one value for each mode. Therefore, the function \u03ba 2 ( ) should be constant-and as large as possible-over a certain band of frequencies B = [\u03c9 bmax , \u03c9 b + max ]. In effect, there should be a finite density of states that the b mode can radiate into within this band. Outside of this band, however, the density of states should vanish in order to suppress correlated phase-flip errors resulting from the multiplexed stabilization (see Appendix B). These requirements translate to a simple design principle: the function Re [Y(\u03c9)] should ideally be a constant in the band \u03c9 \u2208 B, and zero elsewhere, much like in the toy model discussed in Appendix A 3 where we took max = 2J . This is akin to a resistor that absorbs only radiation at certain frequencies."
            ],
            "subsections": []
        },
        {
            "title": "a. General properties",
            "paragraphs": [
                "One of the simplest possible networks with these properties is a linear chain of N LC resonators with capacitive couplings, as shown in Fig. 19(c). This resonator chain has a well-defined band with dispersion [105] ",
                "Here J is the coupling rate between neighboring resonators and is approximately given by",
                "where \u03c9 f is the resonance frequency of each LC block, C c is the coupling capacitance, and C f is the shunt capacitance. This rate is directly tied to the filter bandwidth,",
                "and is controllable via C c . Note also that we usually specify the frequency \u03c9 f and impedance Z f of each LC block of the filter, which together with C c uniquely specify the shunt inductance",
                "This means that for fixed values of \u03c9 f and C c , the filter bandwidth is directly proportional to Z f . This formula will be useful shortly.",
                "Normally the N filter modes with dispersion relation, Eq. (A51), are standing waves that span the entire chain. These modes would therefore hybridize with the b mode, effectively forming a \"multimode buffer\" with N + 1 sharp resonances that the a mode interacts with via the ATS. This is not the behavior we are interested in. Instead of a structure supporting standing resonances, we ideally seek a medium that is perfectly transparent to photons with frequency \u03c9 \u2208 B and perfectly reflective otherwise. One way to achieve this is to add a small number of additional resonators at the end of the chain and rapidly ramp up the values of the coupling capacitances C (i,i+1)   c between neighboring cells [see Fig. 19(d)]. We refer to this region as the \"taper\" in keeping with existing terminology [105]. The shunt capacitances are also adjusted in order to keep the frequency of each cell constant across the filter, including the taper cells. The effect of the taper is to significantly broaden the resonances of the structure so that the entire B band is filled by their overlapping lineshapes, or alternatively, it allows the waves that propagate along the chain to be transmitted to the outside environment with negligible reflections.",
                "We show in Fig. 19(d) the typical response of such a filter. The taper parameters (coupling capacitances and shunt capacitances) have been chosen to minimize the cost function C = -\u03c9\u2208B log Re[Y(\u03c9)], producing a relatively flat response over the band of interest B. We note that this choice of cost function is only a design heuristic that approximately produces the desired response."
            ],
            "subsections": []
        },
        {
            "title": "b. Optimizing the filter",
            "paragraphs": [
                "Given fixed properties \u03c9 a , \u03c9 b , Z b , etc. of the coupled storage-buffer system, what is the optimal choice of filter parameters? By now it should be self-evident what we mean by \"optimal\": those which maximize the two-phonon dissipation rate \u03ba 2 ( ) across the filter band {\u03c9 b + \u2208 B} and make it as flat (constant) as possible within B. There are many parameters that describe the filter: C \u03ba , C c , \u03c9 f , Z f , N (the number of \"unit cells\"), N t (the number of \"taper cells\"), and the set of coupling capacitances {C (i,i+1) c } in the taper region. For fixed values of these first six parameters, the set {C (i,i+1) c } is automatically optimized using the method described in the preceding paragraph, leaving six free parameters. What we show next is how to choose these parameters in order to optimize the function of interest \u03ba 2 ( ) while simultaneously respecting the following constraints:",
                "(1) 4J /2\u03c0 = 100 MHz. ( 2)",
                "Constraint (1) is to ensure that photons created as a result of correlated decay of multiple storage modes during multiplexed stabilization have frequencies \u03c9 corr. decay \u2208 B outside of the passband. This prevents these photons from radiating into the environment and suppresses correlated phase-flip errors. The value 4J /2\u03c0 = 100 MHz is approximately the largest possible bandwidth the filter can have while still satisfying this requirement-for further detail see Appendix B. Constraint (2) sets the b-mode frequency exactly in the middle of the passband, making the functions \u03ba b,eff ( ) and \u03ba 2 ( ) symmetric. This is not absolutely necessary but is rather a matter of convenience. Constraint (3) is to ensure that the system is in a regime where adiabatic elimination is valid, as found at the end of Appendix A 3.",
                "Here we fix \u03b1 = \u221a 8 and \u03b7 = 1/5. Finally, we comment on what are reasonable values for N and N t . The number of taper cells N t depends on Z f and Z 0 (= 50 ), with N t needing to be larger the farther Z f deviates from Z 0 . This agrees with the intuition that the taper is acting as an impedancematching network. Once Z f and N t are chosen, we observe numerically that it is sufficient to choose a number of unit cells N N t /2. Anything larger than this is unnecessary and does not change the results-the chain being longer does not affect the dissipation rates we are interested in calculating.",
                "In Fig. 20(a) we show the effect of varying the capacitance C \u03ba , which sets the strength of coupling between the b mode and the first resonator in the chain. Here C c = 3.0 fF is fixed, as well as Z f = 500 . We observe two \"regimes\": a weak-coupling regime defined by C \u03ba C c , where \u03ba b is small and \u03ba 2 ( ) is sharply peaked near = 0. This peak indicates that the b mode is filtering the conversion process g * 2 a 2 b \u2020 + h.c., only allowing the emission of photons with frequencies inside its narrow bandwidth. Conversely, in the \"overcoupled\" regime C \u03ba C c the b mode decays rapidly, but interestingly \u03ba 2 ( ) saturates and becomes asymmetric about = 0. The optimal coupling C \u03ba = C c , in between these two regimes, is where \u03ba 2 ( ) is nearly perfectly symmetric and flat, and practically saturated. We remark that although \u03ba b saturates to a value of around approximately 4J , it is possible to set C \u03ba to a small enough value so that \u03ba b is much smaller than this saturation value, assuming a flat \u03ba 2 ( ) were not needed (which is not the case here).",
                "Next, we show in Fig. 20(b) the effect of varying the characteristic filter impedance Z f . Because of Eq. (A54), in order to keep J constant as Z f is varied we must adjust C c as well. Furthermore, we observe that \u03ba b decreases with Z f , and so in order to respect the adiabatic threshold g 2 < \u03b7\u03ba b /2\u03b1 introduced earlier we reduce g 2 by increasing \u03c9 b (= \u03c9 f -2J ) to further detune the a and b modes. The key observation is that the optimal value of Z f , for which",
                "Together, these observations constrain C \u03ba = C c and Z f = Z b /2, and through Eq. (A54), C c is constrained to the value C c \u2248 4J /\u03c9 2 f Z b . Once a value of Z b is chosen, the only remaining free parameter is \u03c9 f . But as we did in ",
                "0 fF, and (N , N t ) = (10, 3). As C \u03ba increases, we observe two regimes: an \"undercoupled\" regime C \u03ba C c characterized by a sharply peaked \u03ba 2 ( ), where the narrow b mode filters the dissipation process, and an \"overcoupled\" regime C \u03ba C c where \u03ba 2 saturates and becomes asymmetric. In this latter regime, the b mode strongly hybridizes with the first filter cell. For large enough C \u03ba , their normal-mode frequencies shift outside of the filter passband, forming bound resonances that are visible as sharp peaks to the left of the passband in some of the curves. The optimal value is C \u03ba = C c = 3.0 fF, where \u03ba 2 ( ) is maximized and flat, is shown in red. Note that at this optimal coupling, \u03ba b,eff = 4J (gray dashed line). Note also that the adiabatic condition g 2 < \u03b7\u03ba b /2\u03b1 is not respected for several of the plots shown, as g 2 is fixed. (b) Dependence of \u03ba b,eff ( ) and \u03ba 2 ( ) on the characteristic filter impedance Z f . In order to keep the filter bandwidth 4J constant, increasing Z f requires decreasing C c , and to keep g 2 < \u03b7\u03ba b /2\u03b1 (adiabatic threshold), increasing Z f requires increasing \u03c9 f (which decreases g 2 due to the larger detuning between the a and b modes). The values used for the plotted curves are \u03c9 f /2\u03c0 = 2.4, 2.5, 2.55, 2.6, 2.7 GHz, C c = 10, 4.5, 2.7, 1.7, 1.2 fF, \u03c9 b = \u03c9 f -2J , and (N , N t ) = (10, 3), (10, 3), (10, 3), (14,6), (14,6). Larger values of Z f required larger N t to compensate for the larger impedance mismatch to the 50 line. We also fix Z b = 1 k here. The optimal value is Z f = Z b /2 = 500 , which produces a flat \u03ba 2 ( ) curve (shown in red). Also note that at this optimal value, \u03ba b,eff = 4J (gray dashed line). Inset: g 2 and \u03b7\u03ba b /2\u03b1 corresponding to each of the simulations for the different values of Z f , plotted as a function of \u03c9 b , showing the adiabatic constraint g 2 < \u03b7\u03ba b /2\u03b1 is satisfied (here \u03b1 = \u221a 8 and \u03b7 = 1/5).",
                "the preceding exercise, in what follows we again use \u03c9 f (= \u03c9 b + 2J ) to fine tune g 2 in order to satisfy the adiabaticity constraint. Therefore, with this design methodology, all of the (optimal) filter parameters are dictated by the properties of the storage and buffer resonators, with the exception of N and N t \u223c N /2."
            ],
            "subsections": []
        },
        {
            "title": "Optimization of the dimensionless loss \u03ba 1 /\u03ba 2",
            "paragraphs": [
                "We finally address the problem of optimizing the loss parameter \u03ba 1 /\u03ba 2 . For this we turn our attention back to Eq. (A6), which we repeat here:",
                ", the obvious question is, can we exploit this scaling to maximize \u03ba 2 ? The answer is yes, but surprisingly this is not because of the obvious reason one would expect. In fact, as Z b increases, all of the filter parameters must be adjusted accordingly as described in Appendix A 4. We observe numerically that as this procedure is carefully repeated with different values of Z b , the dissipation rate \u03ba 2 remains practically constant and is independent of Z b . A semiquantitative explanation is as follows: (1) because C \u03ba = C c and Z f = Z b /2 as found in the preceding section, the \"b\" resonator is hardly distinguishable from any other resonator in the main section of the filter chain. Its effective decay rate is therefore \u03ba b,eff \u223c J , because the hopping rate J is the rate that determines how quickly an excitation is transferred to the filter and out of the b mode. Indeed, we observe numerically that this decay precisely matches the filter bandwidth, \u03ba b,eff = 4J , as we increase Z b while reoptimizing all of the filter parameters every time Z b changes. (2) Since g 2 = \u03b7\u03ba b /2\u03b1 = 2\u03b7J /\u03b1 (to satisfy the adiabaticity constraint), \u03ba 2,max = 4g 2  2 /\u03ba b \u2248 4\u03b7 2 J /\u03b1 2 \u2248 4J /25\u03b1 2 . Therefore, \u03ba 2 depends only on the filter bandwidth, which is upper bounded by the crosstalk analysis of Appendix B, and the mean phonon number |\u03b1| 2 . This result has important implications for our proposal and, as we see shortly, imposes a lower bound on the phonon relaxation rate \u03ba 1 required to reach the low values of \u03ba 1 /\u03ba 2 that are necessary for our architecture.",
                "Even though \u03ba 2 depends solely on J and |\u03b1| 2 , there is still something to be gained by increasing Z b . In Fig. 21 we show the \"loss spectrum\" \u03ba 1 /\u03ba 2 ( ) for different values of Z b . We observe that this loss does indeed decrease as Z b increases, but only relatively slowly and eventually asymptotes to a fixed value. This is because as Z b increases, g 2 increases as well, so the optimization procedure pushes \u03c9 b We observe that all of these rates remain practically constant, in particular, \u03ba b = 4J . Top right panel: singlephonon relaxation rate \u03ba 1 plotted as a function of Z b and \u03b4. This relaxation rate \u03ba 1 = \u03ba 1,i + \u03ba 1,p includes two contributions: the intrinsic loss \u03ba 1,i of the resonator, which here we assume has a fixed intrinsic quality factor Q a,i = \u03c9 a /\u03ba 1,i = 10 9 , and the Purcell loss \u03ba 1,p due to its coupling to the buffer resonator. This latter rate has a contribution due to radiation into the waveguide (which is vanishingly small due to the strong filter suppression), and an important contribution \u223c (g/\u03b4) 2 \u03ba b,i due to the intrinsic decay of the buffer resonator itself, which we assume has Q b,i = 10 6 . This loss channel is not suppressed by the filter. However, it can be mitigated by increasing the detuning \u03b4. Indeed, at large values of \u03b4, \u03ba 1 asymptotes to \u03ba 1,i (gray dashed line). We also show the loss parameter \u03ba 1 /\u03ba 2 plotted in red, where \u03ba 2 is averaged over the filter band, which also asymptotes to a lower bound as Z b and \u03b4 become large. Bottom panels: loss spectra \u03ba 1 /\u03ba 2 ( ) shown for a few selected values of Z b . The gray shading indicates the regions where the adiabatic condition g 2 < \u03b7\u03ba b /2\u03b1 is not satisfied. These regions roughly correspond to the frequencies outside of the passband. Here \u03b1 = \u221a 8 and \u03b7 = 1/5.",
                "further away from \u03c9 a = \u03c9 b + \u03b4 to compensate and keep g 2 below the adiabatic threshold \u03b7\u03ba b /2\u03b1. In doing so, the loss approximately (g/\u03b4) 2 \u03ba b,i that originates from the hybridization of the buffer and storage modes (here g is the linear coupling between them) decreases as well. Note that only the intrinsic loss \u03ba b,i of the buffer resonator enters this formula, because the radiative contribution is strongly suppressed since \u03c9 a lies far outside the filter passband. Nevertheless this intrinsic contribution is still important, because in this proposal we operate under the assumption that the intrinsic decay rate \u03ba b,i of the buffer mode (which is a superconducting circuit that suffers from several loss channels including two-level systems, quasiparticles, etc.) is at least 2 orders of magnitude larger than that of the storage mode, \u03ba 1,i . In the limit g/\u03b4 1, this contribution becomes negligibly small, and the phonon relaxation rate is purely intrinsic: \u03ba 1 \u2248 \u03ba 1,i . This causes the loss \u03ba 1 /\u03ba 2 to asymptote to",
                "This is of course only a theoretical exercise: one cannot build a device with arbitrarily large Z b , and \u03c9 b cannot be arbitrarily large. In particular, increasing the impedance will increase the size of the vacuum phase fluctuations, making the system more prone to instabilities, and a detailed analysis of this physics is left for future work. However, as we show in Fig. 21, there is a feasible range of values of Z b with which we could begin to approach the limiting value of loss in Eq. (A55), depending on what assumptions we make for the intrinsic losses of the buffer and storage modes. These limiting values are plotted in Fig. 3 in the main text as a function of \u03ba 1,i and for different filter bandwidths. It is important to emphasize that it maybe be possible to increase J beyond its presently constrained value 4J /2\u03c0 = 100 MHz through further innovations in the stabilization protocols, or by reducing the number of resonators coupled to each ATS. This is why we plot these curves for different bandwidths."
            ],
            "subsections": []
        },
        {
            "title": "APPENDIX B: MULTIPLEXED STABILIZATION AND CROSSTALK",
            "paragraphs": [
                "In this Appendix, we show how multiple storage resonators coupled to a common ATS can be stabilized simultaneously. Coupling to a common ATS leads to crosstalk, and we discuss how this crosstalk can be quantified and mitigated. The main result of this Appendix is that the predominant sources of crosstalk can be effectively mitigated when up to five modes are coupled to a common ATS, so that the five-mode unit cells of our architecture are largely free of crosstalk.",
                "In Appendix B 1, we begin by reviewing the effective operator formalism described in Ref. [48], which is the main tool we employ to analyze the dynamics of these multimode systems. In Appendix B 2, we describe our procedure for stabilizing multiple modes with a single ATS, and in Appendix B 3 we discuss the resulting sources of crosstalk. Finally, in Appendices B 4 and B 5 we show how this crosstalk can be effectively mitigated through a combination of filtering and storage-mode frequency optimization. Throughout this Appendix, we take = 1 to simplify notation."
            ],
            "subsections": []
        },
        {
            "title": "Effective operator formalism",
            "paragraphs": [
                "In this Appendix, we frequently employ adiabatic elimination as a tool to extract the effective dynamics of an open quantum system within some stable subspace. The purpose of this subsection is to describe the effective operator formalism that we employ in order to perform this adiabatic elimination. While adiabatic elimination has been described in a variety of prior works (see, e.g., Refs. [48,106,107]), we privilege the treatment in Ref. [48] due to its simplicity and ease of application. We briefly review the relevant results.",
                "Consider an open quantum system evolving according to the master equation",
                "with Hamiltonian \u0124 , jump operators Li , and where",
                "We suppose that the system can be divided into two subspaces: a stable ground subspace, and a rapidly decaying excited subspace, defined by the projectors Pg and Pe , respectively. The Hamiltonian can be written in block form with respect to these subspaces as",
                "where \u0124g,e = Pg,e \u0124 Pg,e , and V+,-= Pe,g \u0124 Pg,e . We also suppose that the jump operators take the system from the excited to the ground subspace, i.e., Li = Pg Li Pe , and we define the non-Hermitian Hamiltonian",
                "\u0124NH describes the evolution within the excited subspace; unitary evolution is generated by \u0124e , while the remaining term describes the nonunitary, deterministic \"no jump\" evolution induced by the dissipators D [ Li ].",
                "The authors of Ref. [48] consider the case where the evolution between the subspaces induced by V+,is perturbatively weak relative to the evolution induced by \u01240 \u2261 \u0124g + \u0124NH . Because the excited subspace is barely populated due to the rapid decays, the dynamics of the system are well approximated by those within the ground subspace, governed by the effective master equation",
                "where",
                "and",
                "These expressions apply for time-independent Hamiltonians. However, we are also interested in situations where the perturbations V+,are time dependent and take the form",
                "V-",
                "In this case, the effective Hamiltonian and jump operators are given by",
                "and",
                "where \u0124NH,n = \u0124NH + \u03b4 n ."
            ],
            "subsections": []
        },
        {
            "title": "Simultaneous stabilization of multiple cat qubits with a single ATS",
            "paragraphs": [
                "We consider a collection of N storage modes mutually coupled to a common reservoir. For the moment, we take reservoir to be a capacitively shunted ATS (buffer resonator) with a large decay rate. The Hamiltonian of the system is",
                "where \u0124d is a driving term (defined below), \u00e2n ( b) is the annihilation operator for the nth storage mode (buffer mode) with frequency \u03c9 n (\u03c9 b ), and \u03c6n = \u03d5 n (\u00e2 n + \u00e2 \u2020 n ) is the phase across the ATS due to mode n, with vacuum fluctuation amplitudes \u03d5 n . To stabilize multiple storage modes simultaneously, we apply separate pump and drive tones for each mode. Explicitly,",
                "and",
                "We choose the frequencies of the nth pump and drive tones, respectively, as",
                ")",
                "where n denote detunings whose importance is made clear shortly. Note that, in the architecture proposed in the main text, only a subset of the modes coupled to a given reservoir are stabilized by that reservoir. Accordingly, only the corresponding subset of the drives and pumps above need actually be applied.",
                "To proceed, we expand the sine to third order and move to the frame where each mode rotates at its respective frequency. The resultant Hamiltonian is",
                "This Hamiltonian contains terms that lead to the required two-phonon dissipators for each storage mode,",
                "with",
                "However, the Hamiltonian (B16) contains numerous other terms. While many of these other terms are fast rotating and can be neglected in the RWA, others can have nontrivial effects. For example, the interplay between the terms in the second and third lines of Eq. (B16) gives rise to effective frequency shifts (ac Stark shifts) of the buffer and storage modes, which modify the resonance conditions (B14) and (B15). One can calculate the magnitudes of these shifts (and hence compensate for them) by applying the effective operator approach of Refs. [55,56], in which case the Stark shifts are given by the coefficients of the b \u2020 b and \u00e2 \u2020 \u00e2 terms that arise in the effective Hamiltonian. Alternatively, the shifts can be calculated by moving to a displaced frame with respect to the linear terms on the second line of Eq. (B16), as is done in Ref. [28].",
                "The Hamiltonian (B16) also contains terms that lead to crosstalk, but we defer the discussion of these terms to the next section. For now, we keep only the desired terms (B17). We proceed by adiabatically eliminating the lossy buffer mode b, following the approach described in Appendix B 1. Specifically, we designate the the ground subspace as the subspace where the buffer mode is in the vacuum state, and the excited subspace as the subspace where the buffer mode contains at least one excitation. We find that the effective dynamics of the storage modes within the ground subspace are described by the master equation",
                "where",
                "To understand these dynamics, let us first consider the simple case where n = 0. The above master equation reduces to",
                "where \u03ba 2 = 4|g 2 | 2 /\u03ba b . Any product of coherent states",
                "n is a steady state of Eq. (B22). The subspace of steady states includes states in the code space, for which \u03b2 2 n = \u03b1 2 n , but it also includes states outside of the code space. Because a strictly larger space is stabilized, when noise pushes the system outside of the code space, the stabilization is not guaranteed to return the system to the code space. The coherent dissipation in Eq. (B22) is thus not sufficient for our purposes.",
                "Consider instead the case where the detunings are chosen to be distinct, satisfying | nm | 4|\u03b1| 2 \u03ba 2 . In this limit, we can drop the now fast-rotating cross terms in the dissipator in Eq. (B20), and the effective master equation becomes",
                "where",
                "The incoherent dissipator Eq. (B24) stabilizes cat states in each mode, as desired. Thus, by simply detuning the pumps and drives used to stabilize each mode, multiple modes can be stabilized simultaneously and independently by a single ATS. Two remarks about the approximation of Eq. (B22) by Eq. (B24) are necessary. First, the condition | nm | 4|\u03b1| 2 \u03ba 2 can be derived by expressing the operators in Eq. (B22) in the displaced Fock basis (Appendix C). Roughly speaking, the condition dictates that | nm | be much larger than the rate at which photons are lost from the stabilized modes. Second, we have neglected \u0124eff ; the rotating terms in \u0124eff can be dropped in the RWA in the considered limit, and the nonrotating terms provide an additional source of stabilization [17] that we neglect for simplicity. It is also worth noting that the two-phonon dissipation rate, \u03ba 2,n , decreases monotonically with n . To avoid significant suppression of this engineered dissipation, one can choose n \u03ba b so that \u03ba 2,n remains comparable to \u03ba 2 , or alternatively one can exploit the filtering procedure described in Appendix A and further analyzed in Appendix B 4, which enables strong effective dissipation even for n > \u03ba b .",
                "We demonstrate our scheme for multiplexed stabilization numerically in Fig. 22. Through master-equation simulations, we observe good stabilization for | 1 -2 | 4|\u03b1| 2 \u03ba 2 , but not 1,2 = 0, as expected. Moreover, we also quantify the validity of approximating Eq. (B22) by Eq. (B24). Strictly speaking, the approximation is valid only in the regime | nm | 4|\u03b1| 2 \u03ba 2 , but we find that even for | nm | \u223c 4|\u03b1| 2 \u03ba 2 the stabilization works reasonably well, by which we mean that the population that leaks out of the code space is comparable for the two dissipators, Eqs. (B22) and (B24), see Fig. 22(b). The approximation breaks down beyond this point, and accounting for the additional terms in Eq. (B22) becomes increasingly important. We conclude this subsection by providing some physical intuition as to why detuning the pumps and drives allows one to stabilize multiple cat qubits simultaneously. When n = 0, excitations lost from different storage modes via the buffer cannot be distinguished by the environment. As a result, we obtain a single coherent dissipator L \u221d n (\u00e2 2 n -\u03b1 2 n ). When distinct detunings are chosen for each mode, however, excitations lost from different modes via the buffer are emitted at different frequencies. When these buffer-mode photons are spectrally resolvable, the environment can distinguish them, resulting in a collection of independent, incoherent dissipators Ln \u221d (\u00e2 2 n -\u03b1 2 n ) instead. The emitted photon linewidth is 4|\u03b1| 2 \u03ba 2 , which can be seen by expressing \u03ba 2 D[\u00e2 2 -\u03b1 2 ] in the displaced Fock basis (Appendix C). Thus, the emitted photons are well resolved when | nm | 4|\u03b1| 2 \u03ba 2 , which is the same condition assumed in the derivation of Eq. (B24). We illustrate this idea pictorially in Fig. 4(a) of the main text."
            ],
            "subsections": []
        },
        {
            "title": "Sources of crosstalk",
            "paragraphs": [
                "In this subsection we describe how undesired terms in the Hamiltonian (B16) lead to crosstalk among modes coupled to the same ATS. In particular, we show that these undesired terms lead to effective dissipators and effective Hamiltonians that can cause correlated phase errors in the cat qubits.",
                "The predominant sources of crosstalk are undesired terms in the Hamiltonian (B16) of the form",
                "where",
                "and we have neglected the dependence of g 2 on the indices i, j for simplicity. In contrast to the other undesired terms in Eq. (B16), these terms have the potential to induce large crosstalk errors because they both (i) have coupling strengths comparable to the desired terms, Eq. (B17), and (ii) can be resonant or near resonant. In particular, the undesired term is resonant (\u03b4 ijk = 0) for 2\u03c9 k + k = \u03c9 i + \u03c9 j . This resonance condition can be satisfied, for example, when the storage modes have near uniformly spaced frequencies. These unwanted terms may not be exactly resonant in practice, but we cannot generally guarantee that they will be rotating fast enough to be neglected in the RWA either. In contrast, all other undesired terms in Eq. (B16) are detuned by at least min n |\u03c9 n -\u03c9 b |, which is on the order of approximately 2\u03c0 \u00d7 1 GHz for the parameters considered in this work. We therefore focus on crosstalk errors induced by the terms, Eq. (B26).",
                "The terms, Eq. (B26), can lead to three different types of correlated errors: We describe each type of error in turn. Without mitigation (see Appendices 4 and5), these correlated phase errors could be a significant impediment to performing high-fidelity operations."
            ],
            "subsections": []
        },
        {
            "title": "a. Type I: stochastic errors induced by effective dissipators",
            "paragraphs": [
                "The terms, Eq. (B26), can lead to correlated phonon losses at rates comparable to \u03ba 2 , resulting in significant correlated phase errors in the cat qubits. These deleterious effects manifest when one adiabatically eliminates the buffer mode. Explicitly, we apply the effective operator formalism described in Sec. 1 to the operators",
                "and obtain the effective operators",
                "The effective Hamiltonian preserves phonon-number parity and thus does not induce phase flips. The effective jump operator Leff describes correlated single-phonon losses in modes i and j at a rate",
                "which is comparable to \u03ba 2 for \u03b4 ijk \u03ba b . These correlated single-phonon losses induce correlated phase flips in the cat qubits, which can be seen by projecting Leff into the code space,",
                "\u1e90i \u1e90j e i\u03b4 ijk t . (B33)"
            ],
            "subsections": []
        },
        {
            "title": "b. Type II: stochastic errors induced by effective Hamiltonians",
            "paragraphs": [
                "The interplay between different terms of the form, Eq. (B26), can lead to further correlated errors. As an example, consider the operators",
                "b \u2020 e i\u03b4 ijk t + g 2 \u00e2 \u00e2m b \u2020 e i\u03b4 mn t + H.c., (B34)",
                "Adiabatically eliminating the buffer mode yields,",
                "where",
                "and \". . .\" denotes additional terms in the effective Hamiltonian that preserve phonon-number parity. Note that the effective dissipator L (2) eff leads to type I correlated phase errors. Indeed, for sufficiently large |\u03b4 ijk -\u03b4 mn |, the action of L (2) eff can be approximated by replacing it with two independent dissipators of the form, Eq. (B31).",
                "What is different about this example is that the effective Hamiltonian \u0124 (2) eff contains terms \u221d (\u00e2 i \u00e2j ) \u2020 (\u00e2 \u00e2m ) that generally do not preserve phonon-number parity. Such terms can unitarily evolve the system out of the code space, changing the parity in the process. In turn, the engineered dissipation returns the system to the code space, but it does so without changing the parity. Therefore, the net effect of such excursions out of the code space and back is to induce stochastic parity flips in the storage modes, which manifest as correlated phase errors on the cat qubits. The errors are stochastic even though the evolution generated by \u0124 (2) eff is unitary because the stabilization itself is stochastic. Specifically, the errors are of the form D[ \u1e90i \u1e90j \u1e90 \u1e90m ], which one can show by adiabatically eliminating the excited states of the storage modes (see Appendix C)."
            ],
            "subsections": []
        },
        {
            "title": "c. Type III: coherent errors induced by effective Hamiltonians",
            "paragraphs": [
                "The parity-non-preserving effective Hamiltonian \u0124 (2) eff also induces nontrivial coherent evolution within the code space. This can be seen by projecting \u0124 (2) eff into the code space",
                "This undesired evolution does not decohere the system but can nevertheless degrade the fidelity of operations. See further discussion in Appendix B 5."
            ],
            "subsections": []
        },
        {
            "title": "Crosstalk mitigation: filtering",
            "paragraphs": [
                "In this subsection, we show how type I and type II crosstalk errors can be suppressed by placing a bandpass filter at the output port of the buffer mode (see Appendix A 3 for additional discussion of filtering). The purpose of the filter is to allow photons of only certain frequencies to leak out of the buffer, such that the desired engineered dissipation remains strong but spurious dissipative processes are suppressed. A crucial requirement of this approach is that the desired dissipative processes be spectrally resolvable from the undesired ones, and we show that adequate spectral resolution is achievable in the next section (Appendix B 5).",
                "We begin by providing a quantum-mechanical model of a bandpass filter [105,108]. While a detailed classical analysis of the filter is given in Appendix A 3, here we employ a complementary quantum model. The quantum model not only allows us to study the filter's effects numerically via master-equation simulations, but it is also sufficiently simple so as to enable a straightforward analytical treatment via the effective operator formalism described in Appendix B 1.",
                "Motivated by the filter designs described in Appendix A 4, we employ a tight-binding model where the filter consists of a linear chain of M bosonic modes with annihilation operators \u0109i , and each with the same frequency \u03c9 b . Modes in the chain are resonantly coupled to their nearest neighbors with strength J . The first mode in the chain couples to the buffer mode b, which is no longer coupled directly to the open waveguide. Instead, the M th mode is now the one which couples strongly to the waveguide, such that its single-photon loss rate is given by \u03ba c . The buffer-filter system is described by the Hamiltonian (in the rotating frame)",
                "together with the dissipator \u03ba c D[\u0109 M ]. We show below that these additional modes act as a bandpass filter, with center frequency \u03c9 b and bandwidth 4J , and they suppresses the emission of photons with frequencies outside of this passband."
            ],
            "subsections": []
        },
        {
            "title": "a. Suppression of type I errors",
            "paragraphs": [
                "To illustrate the suppression of type I errors, we consider the operators",
                "b \u2020 e i\u03b4 ijk t + H.c. + \u0124buffer+filter , (B40)",
                "where the first term in \u0124 (3) is the same as the unwanted term \u0124 (1) from Appendix B 3. We adiabatically eliminate both the buffer and filter modes in order to obtain an effective dynamics for only the storage modes. We note that adiabatically eliminating the buffer and filter modes together is not fundamentally different from adiabatically eliminating the buffer; both calculations are straightforward applications of the methods in Sec. 1. We obtain the effective dissipator",
                "where the rates for the first few values of M are",
                "where the approximations assume that \u03b4 ijk J , \u03ba c . In this regime, \u03ba eff (M ) is exponentially suppressed with increasing M via the factor (J /\u03b4 ijk ) 2M .",
                "We plot these rates as a function of \u03b4 ijk in Fig. 23(a), where the exponential suppression of the decoherence rates outside the filter band is evident. Figure 23(a) should be understood as analogous to Fig. 20 in Appendix A, though we emphasize that here the rates are derived from a fully quantum model of the filter. We also remark that unlike in Appendix A, where the emphasis was on detailed classical filter design, here we do not taper the filter. This explains the \"ripples\" in \u03ba eff within the filter passband. Figure 23(b) shows the results of analogous master-equation simulations; good quantitative agreement with the analytical expressions is observed. Thus we conclude that type I errors are indeed suppressed by the filter, provided |\u03b4 ijk | > 2J ."
            ],
            "subsections": []
        },
        {
            "title": "b. Suppression of type II errors",
            "paragraphs": [
                "To illustrate the suppression of type II errors, we construct a simple toy model that both captures the relevant physics and is easy to study numerically. Consider the operators",
                "where \u00e2 is the annihilation operator for the single storage mode that we consider in this model. In this toy model, the first line of \u0124 (4) should be understood as analogous to \u0124 (2) . Indeed we obtain the former from the latter by replacing \u00e2i \u00e2j \u2192 \u00e2 and \u00e2 \u00e2m \u2192 1.",
                "Adiabatically eliminating the buffer and filter modes yields the effective operators",
                "Here, \". . .\" denotes a parity-preserving term (\u221d \u00e2 \u2020 \u00e2) that we neglect, \u03ba (\u03b4)  eff (M ) denotes the effective loss rate [Eqs. (B43) to (B45)] with the replacement \u03b4 ijk \u2192 \u03b4, and",
                "is independent of M in the limit \u03b4 1,2 J , \u03ba b . The first term in L (4) eff gives rise to the type I errors that are suppressed by the filter, as already discussed. Our present interest is the type II errors induced by the interplay of \u0124 (4) eff , the stabilization, and the filter.",
                "Unfortunately, the effective operators \u0124 (4) eff and L(4) eff do not properly capture this interplay. In particular, it follows from energy conservation that type II errors induced by",
                "eff result in photon emissions at frequency \u03c9 b + \u03b4 2 -\u03b4 1 . Intuitively, such emissions should be exponentially suppressed when this frequency lies outside the filter band. However, this suppression is not apparent in the operators \u0124 (4) eff , L(4) eff because, in the course of deriving \u0124 (4) eff , we already eliminated the filter. After adiabatic elimination the only vestige of the filter is the term \u03ba (0)  eff (M )(\u00e2 2 -\u03b1 2 ), which embodies the behavior of the filter at frequency \u03c9 b , but not at frequency \u03c9 b + \u03b4 2 -\u03b4 1 . As such, proceeding to calculate the type II error rate from these operators is not valid, and an alternate approach is required.",
                "In order to properly capture the subtle interplay between the effective Hamiltonian, the stabilization, and filter, we defer adiabatic elimination and instead begin by calculating an effective Hamiltonian that describes the timeaveraged dynamics generated by \u0124 (4) . We restrict our attention to a regime where the terms on the first line of Eq. (B46) are rapidly rotating, so that evolution generated by \u0124 (4) is well approximated by its time average. We calculate the time-averaged effective Hamiltonian \u0124 (4) following the approach described in Refs. [55,56],",
                "where we have neglected a parity-preserving term (\u221d \u00e2 \u2020 \u00e2), and terms rotating at the fast frequencies \u03b4 1,2 . Notice that",
                "where the approximation is obtained by pre-emptively replacing b \u2020 b with its expected value of 0. Doing so reveals that \u0124 (4) eff can be understood as arising from the timeaveraged dynamics of the the unwanted terms in \u0124 (4) in the limit of large \u03b4 1,2 . In effect, time averaging provides a way of introducing \u0124 (4) eff into the dynamics without having to eliminate the filter, thereby allowing us to study the interplay of the filter and effective Hamiltonian.",
                "We proceed by taking the operators \u0124 (4) and L(4) and adiabatically eliminating the buffer, the filter, and all excited states of the storage mode, i.e., all states that do not lie in the code space. Adiabatically eliminating the storage-mode excited states is valid in the regime where the engineered dissipation is strong relative to couplings that excite the storage mode ( \u0124 (4) eff in this case), such that these excited states are barely populated. See Appendix C for further details. We obtain",
                "The rates for the first few values of M are",
                "where we have used the shorthand \u03b4 12 \u2261 \u03b4 1 -\u03b4 2 to simplify the expressions, and the approximations are obtained in the in the limit of large |\u03b4 1 -\u03b4 2 |. In this limit, we find that the phase-flip rate is exponentially suppressed by the filter,",
                "as expected.",
                "We plot the rates \u03b3 eff (M ) as a function of \u03b4 1 -\u03b4 2 in Fig. 24(a), where the exponential suppression of the decoherence rates outside the filter band is again evident. that type II errors are also suppressed by the filter, provided the effective Hamiltonian detuning lies outside the filter passband."
            ],
            "subsections": []
        },
        {
            "title": "Crosstalk mitigation: mode frequency optimization",
            "paragraphs": [
                "We have shown that stochastic correlated phase errors (types I and II) can be suppressed by a filter if the corresponding emitted buffer-mode photons have frequencies outside the filter passband. We now show that it is possible to suppress all such errors simultaneously by carefully choosing the frequencies of the storage modes. In doing so, the effects of type III errors can also be simultaneously minimized. Importantly, the storage-mode frequencies are chosen to be compatible with error correction in the surface code, and we begin this section by describing how the surface-code architecture constrains the choice of storage-mode frequencies.",
                "We consider the surface-code architecture and optimize the storage-mode frequencies such that they are compatible with the surface-code stabilizer measurement. To understand the constraints imposed by the implementation of the surface code, recall that each ATS is coupled to five phononic modes in our proposal (see Fig. 2). Among the five modes, four modes (two data and two ancilla modes for the surface code) are stabilized in the cat-code manifold by an ATS. Another mode (readout mode) is dedicated to measuring cat qubits in the X basis and is not stabilized by any ATS. Since every data or ancilla mode couples to two ATSs, each ATS is only responsible for stabilizing two of the five phononic modes to which it couples. Thus, for each given ATS, we must determine which two phononic modes should be stabilized.",
                "An important consideration in deciding which phononic modes should be stabilized by a given ATS is that each ATS is used to realize four CNOT gates (performed in four different time steps) to measure the stabilizers of the surface code. While a CNOT gate is being performed, the target mode of the CNOT gate is stabilized by a rotating jump operator",
                "that acts nontrivially both on the target mode (\u00e2 2 ) and the control mode (\u00e2 1 ). Thus, while a CNOT gate is being performed, the target mode must be stabilized by the ATS that also couples to the control mode.",
                "In Fig. 25 we show how these stabilization constraints can be satisfied. In the top panel of the figure, we show four (out of six, state preparation and measurement not shown) time steps of the surface-code stabilizer measurement. During each time step, different CNOT gates between data and ancilla cat qubits are applied. We label data modes as \u03b1 and \u03b3 and ancilla modes as \u03b2 and \u03b4. Ancilla modes labeled as \u03b2 (\u03b4) are used to measure the X -type (Z-type) stabilizers of the surface code. We use black arrows to indicate which phononic modes are stabilized by each ATS at each time step; each phononic mode at the tip of a black arrow is stabilized by the ATS at the arrow's tail. Importantly, every target mode of a CNOT gate is stabilized by an ATS that also couples to the corresponding control mode at all time steps. Note, however, that a given ATS stabilizes different modes at different time steps, as summarized in the bottom panel of Fig. 25. In particular, there are two stabilization configurations: in configuration 1 (2) modes \u03b1, \u03b2 (\u03b3 , \u03b4) are stabilized by the given ATS, and the remaining modes \u03b3 , \u03b4 (\u03b1, \u03b2) are stabilized by some other neighboring ATSs.",
                "Now, our goal is to choose the frequencies of the storage modes and detunings of the pumps in order to minimize crosstalk. In order to ensure that the choice of mode frequencies is compatible with the surface-code stabilizer measurement, we assign modes with the same label in Fig. 25 to have the same frequency. Thus, there are only five mode frequencies that must be chosen: the frequencies \u03c9 \u03b1 , \u03c9 \u03b2 , \u03c9 \u03b3 , \u03c9 \u03b4 corresponding to the four labels in Fig. 25, plus the frequency of the readout mode (not shown in Fig. 25), which we take to be the same in each unit cell and denote by \u03c9 \u03c1 . Similarly, there are four pump detunings, \u03b1 , \u03b2 , \u03b3 , \u03b4 , that must be chosen. Here, as above, i denotes the detuning of the pump (and buffer drive) used to stabilize mode i. In the following, we construct a cost function C that quantifies crosstalk as a function of these nine parameters (five mode frequencies and four pump detunings). Numerically minimizing C allows us to find the choices of the frequencies and detunings that minimize crosstalk.",
                "First, C should be large if any emitted buffer-mode photons associated with type I and II errors lie inside the filter's bandwidth 4J . We thus take C = 1 if any of the following conditions are met for either of the two stabilization configurations shown in Fig. 25 In other words, we set C = 1 if any type I or II errors are not suppressed by the filter, or if any of the desired engineered dissipation is suppressed by the filter. We emphasize that these conditions must be checked for both stabilization configurations in Fig. 25; checking both configurations is necessary in order to ensure that type I and II crosstalk is suppressed by the filter at all time steps.",
                "Second, C should be large if the coherent type III errors have significant damaging effects, and we now quantify these effects in the context of the surface code. Recall that these errors are generated by effective Hamiltonian terms of the form, Eq. (B38), which we repeat for convenience, |\u03b1| 4 \u03c7 \u1e90i \u1e90j \u1e90 \u1e90m e i(\u03b4 mn -\u03b4 ijk )t + H.c.",
                "(B59) FIG. 25. Cat-qubit stabilization in the surface-code architecture. Each ATS is coupled to two data modes \u03b1, \u03b3 and two ancilla modes \u03b2, \u03b4. In practice, ATSs are also coupled to a fifth readout mode (not shown here because it is not stabilized by any ATS). Each ATS is responsible for performing four CNOT gates (at different time steps) and stabilizing two phononic modes in the cat-code manifold during each time step. In the top panel, we show configurations of the cat-qubit stabilization, which respect the constraint discussed in the main text: at each time step, a CNOT's target mode must be stabilized by an ATS that also couples to its control mode. Each phononic mode, pointed by a black arrow, is stabilized by an ATS where the black arrow originates from. In the bottom panel, we show two stabilization configurations in the perspective of each host ATS. In configuration 1 (2), modes \u03b1, \u03b2 (\u03b3 , \u03b4) are stabilized by the host ATS and the remaining modes \u03b3 , \u03b4 (\u03b1, \u03b2) are stabilized by some other neighboring ATSs.",
                "When these terms are rapidly rotating, i.e., when |\u03b1 4 \u03c7 | |\u03b4 ijk -\u03b4 mn |, their effects are suppressed. Indeed, these terms effectively induce detuned Rabi oscillations between states of different parity, and the magnitude of these oscillations is small in the far-detuned limit. To quantify this suppression, note that these micro-oscillation errors remain coherent during gates but can be converted to incoherent, correlated \u1e90 errors when the X -type stabilizers are measured. The probability p ijk mn of inducing a correlated phase error upon a such a measurement scales quadratically in the ratio of the coupling strength and detuning,",
                "(B60)",
                "Among the various type III errors, we focus on those that induce phase errors in both of the data modes \u03b1 and \u03b3 since such errors are specific to our architecture and not taken into account in the standard surface-code analysis ",
                "where D and T denote sets of indices that give rise to errors \u221d \u1e90\u03b1 \u1e90\u03b3 \u00ce\u03b2 and \u221d \u1e90\u03b1 \u1e90\u03b3 \u1e90\u03b2 , respectively, see Fig. 26.",
                "Note that the \u1e90 error on the ancilla mode \u03b2 manifests as a flipped X -basis measurement outcome. On the other hand, \u1e90 errors on the other ancilla mode \u03b4 do not flip the measurement outcomes. This is because the mode \u03b4 is measured in the Z basis, and Z-basis measurements commute with \u1e90 errors. We incorporate these type III errors into the cost function as follows. We take C = 1 if type I or II errors are not suppressed by the filter (see aforementioned conditions on the \u03b4 ijk ), and otherwise we take",
                "p (1)  double + p (1)  triple + p (2)  double + p (2)  triple , (B63)",
                "where p (i) double and p (i)  triple denote the values of p double and p triple for the ith stabilization configuration. Equation (B63) thus represents the average probability of a type III error occurring during one time step. Costs C 1 are thus achieved only when both the probability of type III errors is small, and all type I and II errors are suppressed by the filter. Having defined the cost function C, we perform a numerical search for the values of the mode frequencies and pump detunings which minimize the cost. In performing this optimization, we place two additional restrictions on allowed frequencies and detunings. First, we restrict the mode frequencies to lie within a 1-GHz bandwidth. This is done because the modes are supported by PCDRs, and as such all mode frequencies must lie within the phononic band gap, or at least within the union of two separate band gaps each associated with different PCDRs. These band gaps are typically not more than 500 MHz wide for the devices we consider [32]. Second, we restrict the values of the detunings to = \u00b1J . This is done to maximize use of the filter bandwidth; emitted buffer-mode photons are detuned from one another by 2J and from the nearest band edge by J , see Fig. 4(a). Additionally, we choose 4J /2\u03c0 = 100 MHz because this value is both small enough to ensure that all stochastic crosstalk errors are suppressed by the filter, and large enough so that the TABLE VI. Frequency optimization results. The parameters 4J and \u03c9 are given in units of 2\u03c0 \u00d7 MHz. The type III error probabilities and the cost C are expressed in terms of \u03b1 and g 2 . For realistic choices of |\u03b1| = \u221a 8 and g 2 /2\u03c0 = 2 MHz, the cost function evaluates to C = 1.23 \u00d7 10 -3 . We fix (1)  double + p (2)  double )  27. For the optimal configurations, all type I and type II errors are simultaneously suppressed by the filter. Note also that all emitted photon frequencies associated with type I or II errors lie at least 10 MHz outside the filter passband. As a result, the optimized configuration is robust to deviations in the mode frequencies of the same order, and larger deviations can be tolerated by decreasing the filter bandwidth. Moreover, for realistic values of |\u03b1| and g 2 , we have C 1, indicating that type III errors are strongly suppressed. Therefore, all dominant sources of crosstalk are strongly suppressed."
            ],
            "subsections": []
        },
        {
            "title": "APPENDIX C: SHIFTED FOCK BASIS",
            "paragraphs": [
                "Simulating a large cat qubit (with large |\u03b1| 2 1) by using the usual Fock basis becomes quickly inefficient. Here, we introduce a shifted Fock-basis method, which can describe large cat states in a more efficient way (i.e., using a smaller Hilbert-space dimension) than the usual Fock basis. Specifically, we explain how to construct the annihilation operator \u00e2 in the shifted Fock basis.",
                "Recall that a cat state is composed of two coherent state components | \u00b1 \u03b1 , which can be understood as displaced vacuum states D(\u00b1\u03b1)|n = 0 , where D(\u03b1) \u2261 exp[\u03b1 \u00e2 \u2020\u03b1 * \u00e2] is the displacement operator. In the shifted Fock basis, we use 2d displaced Fock states D(\u00b1\u03b1)|n = n as basis states, where n \u2208 {0, . . . , d -1}. Note that while displaced Fock states in each \u00b1\u03b1 branch are orthonormalized, displaced Fock states in different branches are not necessarily orthogonal to each other. We thus need to orthonormalize the displaced Fock states.",
                "We first define the nonorthonormalized basis states as follows:",
                "where |\u03c6 n,+ and |\u03c6 n,-have even and odd excitation number parity, respectively. Note that we grouped the nonorthonormalized states into the even and odd branches instead of the \u00b1\u03b1 branches. As a result, in the groundstate manifold (n = 0), the normalized basis states |\u03c6 0,\u00b1 are equivalent to the complementary basis states of the cat qubit |\u00b1 , not the computational basis states |0/1 , i.e.,",
                "We use the even and odd branching convention so that any two basis states in different branches are orthogonal to each other and hence the orthonormalization can be done separately in each parity sector. Note that",
                "where D m,n (\u03b1) \u2261 n = m| D(\u03b1)|n = n are the matrix elements of the displacement operator D(\u03b1) in the usual Fock basis:",
                "Here,",
                "In this regime, the basis states |\u03c6 n,\u00b1 are almost orthonormal. For the purpose of estimating the phase-flip (or Z) error rates within a small multiplicative error, it is often permissible to neglect the nonorthogonality of the states |\u03c6 n,\u00b1 . However, this is generally not the case if we want to evaluate the Z-error rates with a very high precision or if we want to estimate the bit-flip (or X ) error rates because the bit-flip error rates decrease exponentially in |\u03b1| 2 . In these cases, taking into account the nonorthogonality of the states |\u03c6 n,\u00b1 is essential.",
                "We orthonormalize the basis states |\u03c6 n,\u00b1 by applying the Gram-Schmidt orthonormalization procedure. Specifically, given the nonorthonormalized basis states |\u03c6 n,\u00b1 , we construct d orthonormalized basis states in each parity sector starting from the ground state |\u03c6 0,\u00b1 :",
                "The coefficients c \u00b1 m,n (0 \u2264 m, n \u2264 d -1) are determined inductively. In the base case (k = 0),",
                "and thus the logical |\u00b1 states of the cat qubit are given by",
                ". (C7)",
                "In the general case with 1 \u2264 k \u2264 d -1, suppose we are given with c \u00b1 mn for all 0 \u2264 m \u2264 d -1 and 0 \u2264 n \u2264 k -1. Thus, at this point, the first k columns of c \u00b1 are known. Let c \u00b1 :,0:k-1 be the d \u00d7 k matrix, which is obtained by taking the first k columns of the matrix c \u00b1 . Given c \u00b1 :,0:k-1 , we assign the k + 1 th column of c \u00b1 as follows:",
                "and c \u00b1 m,k = 0 for all m > k. Having constructed the 2d orthonormalized shifted Fock-basis states |\u03c8 n,\u00b1 , we now need to find the matrix elements of an operator \u00d4 (e.g., \u00d4 = \u00e2) in the orthonormalized basis. Let |\u03c6 n = |\u03c6 n,+ and |\u03c6 n+d = |\u03c6 n,-for n \u2208 {0, . . . , d -1} and also define |\u03c8 n and |\u03c8 n+d similarly. Suppose that the operator \u00d4 transforms the nonorthonormalized basis states |\u03c6 n as follows:",
                "We call O m,n the matrix elements of the operator \u00d4 in the nonorthonormalized basis |\u03c6 n . Then, in the orthonormalized basis, the matrix elements of the operator \u00d4 are given by",
                "where and c are 2d \u00d7 2d matrices, which are defined as",
                "The matrix elements of the d \u00d7 d matrices \u00b1 and c \u00b1 are given in Eqs. (C3), (C6), (C8), and (C9). Consider the annihilation operator \u00d4 = \u00e2 and note that it transforms the nonorthonormalized basis states |\u03c6 n,\u00b1 as follows:",
                "Note that the annihilation operator \u00e2 flips the \u00b1 parity to the \u2213 parity. Thus, in the nonorthonormalized basis, the matrix elements of the annihilation operator are given by",
                "where X is the Pauli X operator and b is the truncated annihilation operator of size d \u00d7 d. Then, the matrix elements of the annihilation operator in the orthonormalized basis |\u03c8 n,\u00b1 can be obtained via the transformation given in Eq. (C11).",
                "Recall that |\u03c8 n,\u00b1 are complementary basis states. To find the matrix elements of an operator in the computational basis states, we should conjugate the matrix by the Hadamard operator \u0124 . Thus, in the orthonormalized computational basis, the annihilation operator is given by",
                "The approximate expression \u00e2 \u1e90 \u2297 ( b + \u03b1) is useful for analyzing the Z-error rates of large cat qubits (with |\u03b1| 1) in the perturbative regime where the cat-qubit states may sometimes be excited to the first-excited-state manifold (n = 1) but quickly decay back to the ground-state manifold (n = 0). In particular, the engineered two-phonon dissipator \u03ba 2 D[\u00e2 2 -\u03b1 2 ] is given by",
                "by using the approximate expression \u00e2 \u1e90 \u2297 ( b + \u03b1) and disregarding higher than second excited states (i.e., b2 = 0). Hence, the linewidth of the engineered two-phonon dissipation is approximately given by 4\u03ba 2 \u03b1 2 , which from now on we refer to as the confinement rate \u03ba conf . For numerical simulations (Appendix E), we thoroughly take into account the orthonormalization and use the orthonormalized shifted Fock basis obtained by the Gram-Schmidt process. We lastly remark that the parity operator e i \u03c0 \u00e2 \u2020 \u00e2 is exactly given by X \u2297 \u00ce in the shifted Fock basis (with the orthonormalization accounted for) because of the way we define the basis states, i.e., |\u03c8 n,+ (|\u03c8 n,-) has an even (odd) excitation number parity."
            ],
            "subsections": []
        },
        {
            "title": "APPENDIX D: PERTURBATIVE ANALYSIS OF THE Z ERROR RATES OF THE CAT-QUBIT GATES",
            "paragraphs": [
                "Here, we analyze the Z-error rates of the cat-qubit gates (idling, Z rotations, CZ rotations, CNOT, and Toffoli) by using the shifted Fock basis (Appendix C) and adiabatic elimination or effective operator formalism (Appendix B 1)."
            ],
            "subsections": []
        },
        {
            "title": "Idling",
            "paragraphs": [
                "Consider an idling single cat qubit, which is stabilized by the two-phonon dissipation \u03ba 2 D[\u00e2 2 -\u03b1 2 ] and is subject to single-phonon loss \u03ba 1 D[\u00e2]:",
                "Assuming |\u03b1| 1, the above master equation is given by",
                "in the shifted Fock basis, where we used the mapping \u00e2 \u2192 \u1e90 \u2297 ( b + \u03b1). Suppose that the system is initially in the catqubit manifold, i.e., \u03c1(0) = \u03c1g (0) \u2297 |0 0| , where \u03c1g (0) is a density operator of size 2 \u00d7 2 and |0 \u2261 | b \u2020 b = 0 (not to be confused with the computational basis state |0 ).",
                "When the system is idling, the states are never excited to the excited-state manifold and thus \u03c1(t) = \u03c1g (t) \u2297 |0 0| .",
                "Projecting the master equation in Eq. (D2) to the groundstate manifold, we find",
                "and hence",
                "provided that the idling Z-error rate (per gate) pZ \u2261 \u03ba 1 \u03b1 2 T is small (i.e., pZ 1) where T is the idling time. Note that we used the notation p with a bar to indicate that the presented expression is obtained via a perturbative analysis. We use p without bar to refer to numerical results."
            ],
            "subsections": []
        },
        {
            "title": "Z rotations",
            "paragraphs": [
                "Assume that \u03b1 is real and positive. To implement a Z rotation Z(\u03b8 ) \u2261 exp[i\u03b8|1 1|] on a cat qubit (where |1 | -\u03b1 is a cat-code computational basis state), we need to apply a linear drive Z (\u00e2 + \u00e2 \u2020 ):",
                "In the shifted Fock basis, the linear drive Z (\u00e2 + \u00e2 \u2020 ) is given by Z \u1e90 \u2297 ( b + b \u2020 + 2\u03b1). Thus, in the ground-state manifold, it induces a Z rotation via the term 2 Z \u03b1 \u1e90. At the same time, the term Z \u1e90 \u2297 b \u2020 excites the cat qubit to its first excited state, which then quickly decays back to the ground-state manifold due to the engineered dissipation",
                ". Thus, to capture the first-order effects, we consider only the groundstate manifold and the first-excited-state manifold (n = 0, 1), hence ignoring b2 in \u03ba 2 D[ \u00ce \u2297 ( b2 + 2\u03b1 b)]. Also, assuming \u03ba 2 \u03ba 1 , we ignore the intrinsic decay due to the single-phonon loss in the excited-state manifold, i.e.,",
                "Then, the master equation is given by",
                "The second term on the right-hand side of this master equation describes a Z error acting on the encoded cat qubit due to single-phonon loss, occurring at the rate (per time) \u03ba 1 \u03b1 2 . The third term rotates the cat qubit about the Z axis.",
                "The fourth term excites the cat qubit from its ground-state manifold to its first-excited-state manifold, with a coupling strength g = Z , and at the same time inflicts a Z error on the cat qubit. This excitation decays back to the cat-code ground-state manifold with a decay rate \u03ba = 4\u03ba 2 \u03b1 2 due to the engineered dissipation described by the first term. Assuming \u03ba g the creation and decay of this excitation results in an additional Z error in the ground-state manifold with an effective error rate (per time) 4g 2 /\u03ba = 2 Z /(\u03ba 2 \u03b1 2 ), augmenting the Z-error rate due to single-phonon loss. The effective master equation therefore becomes",
                "where we have used the subscript g to indicate that \u03c1g (t) is the density operator in the ground-state manifold of the cat state.",
                "Given this effective master equation, we can analyze the effective Hamiltonian and the effective phase-flip error separately because they commute with each other. The effective Hamiltonian \u0124eff = 2 Z \u03b1 \u1e90 induces a Z rotation \u1e90(\u03b8 ) with \u03b8 = 4 Z \u03b1T after the gate time T, i.e., Z = \u03b8/(4\u03b1T). Then, the Z-error rate (per gate) due to the effective phase flip is given by",
                "provided that pZ 1. This Z-error rate is minimized at the optimal gate time",
                "and the corresponding optimal Z-error rate is given by"
            ],
            "subsections": []
        },
        {
            "title": "CZ rotations",
            "paragraphs": [
                "A ZZ interaction between two cat qubits can be implemented by using a beam-splitter coupling ZZ (\u00e2",
                "), which is given by 2 ZZ \u03b1 2 \u1e901 \u1e902 in the ground-state manifold of the cat qubits. To implement a controlled Z rotation CZ(\u03b8 ) \u2261 exp[i\u03b8|11 11|], we should add singlequbit Z rotations so that only the state |11 accumulates a nontrivial phase. More specifically, we need",
                "and the master equation is given by",
                "Similarly as in the case of single-qubit Z rotations, the engineered dissipation induces a strong decay from the first-excited-state manifold to the cat-qubit manifold with a decay rate (per time) \u03ba = 4\u03ba 2 \u03b1 2 . Also, the single-phonon loss causes local phase-flip errors in each cat-qubit manifold with an error rate \u03ba 1 \u03b1 2 . In the shifted Fock basis, the Hamiltonian \u0124 is given by",
                "The first term generates an effective Hamiltonian \u0124eff = 8 ZZ \u03b1 2 |11 11| in the ground-state manifold. Due to the second (third) term, the first (second) cat qubit is excited to its first-excited-state manifold with a coupling strength g = ZZ \u03b1 while the encoded cat qubits are subjected to a \u1e901 \u1e902 -\u1e901 ( \u1e901 \u1e902 -\u1e902 ) error. The excited state decays back to the ground-state manifold at the rate \u03ba = 4\u03ba 2 \u03b1 2 due to the engineered dissipation; as a result the cat qubits experience effective \u1e901 \u1e902 -\u1e901 and \u1e901 \u1e902 -\u1e902 errors, each with rate (per time) 4g 2 /\u03ba = 2 ZZ /\u03ba 2 . Note that the last term in the effective Hamiltonian can, in principle, induce excitation exchange between the two modes but we may neglect this effect because the excited states decay very quickly back to the ground-state manifold (i.e., ZZ 4\u03ba 2 \u03b1 2 , which is indeed the case in the parameter regime we focus on). Putting all this together, we find the following effective master equation in the ground-state manifold of two cat qubits:",
                "The effective Hamiltonian (which commutes with the Ztype effective jump operators) generates a CZ rotation CZ(\u03b8 ) with \u03b8 = -8 ZZ \u03b1 2 T where T is the gate time.",
                "Hence, ZZ = -\u03b8/(8\u03b1 2 T). The remaining effective jump operators induce an error channel",
                "provided that the error rates (per gate) \u03ba 1 \u03b1 2 T and \u03b8 2 /(64\u03ba 2 \u03b1 4 T) are much smaller than unity. Ignoring the off-diagonal terms like \u1e901 \u1e902 \u03c1 \u1e901 , we get Pauli Z-error rates",
                "The total gate infidelity 1 -pZ 1 -pZ 2 -pZ 1 Z 2 is minimized at the optimal gate time",
                "and the Z-error rates (per gate) at this optimal gate time are given by",
                "Note that the optimal Z-error rates for Z and CZ rotations decrease as \u03b1 increases. Below, we show that this is not the case for the CNOT and Toffoli gates."
            ],
            "subsections": []
        },
        {
            "title": "CNOT",
            "paragraphs": [
                "The CNOT gate between two cat qubits can be realized by",
                "where \u00e21 and \u00e22 are the annihilation operators of the control and the target modes, respectively, and L2 (t) and \u0124 are given by",
                "How and whether this master equation can be physically implemented is discussed in Appendix F. Here, we focus on analyzing the effective Z-error rates on the cat qubits under this master equation. Note that the time-dependent engineered jump operator L2 (t) stabilizes the target mode in the | \u00b1 \u03b1 (or",
                "As a result, the target cat qubit is rotated by 180 \u2022 at time t = T only if the control qubit is in the |1 state. That is, an X gate is applied to the target cat qubit (i.e., | \u00b1 \u03b1 \u2192 | \u2213 \u03b1 ) conditioned on the control cat qubit being in the |1 state, hence the desired CNOT gate. Note that for this conditional stabilization to work, the engineered jump operator L2 should be modulated adiabatically [i.e., T 1/(\u03ba 2 \u03b1 2 )] such that the target mode does not leak out of the | \u00b1 \u03b1e i(\u03c0/T)t manifold if the control qubit is in the |1 state. Adverse effects due to the nonadiabaticity can be partially (but not fully) compensated for by the compensating Hamiltonian \u0124 . See more on this below.",
                "To analyze this master equation, we first use a hybrid basis where the control and the target modes are described by the shifted and usual Fock basis, respectively. In the hybrid basis, assuming |\u03b1| 1 and using an approximate expression \u00e2 \u1e90 \u2297 ( b + \u03b1), the compensating Hamiltonian is given by",
                "Since we are using the shifted Fock basis for the control mode and the usual Fock basis for the target mode at this point, b1 is a d \u00d7 d matrix whereas \u00e22 is a 2d \u00d7 2d matrix, where d is defined in Appendix C. Note that the first term in Eq. (D21), which is a desired term, rotates the target mode conditioned on the control mode being in the |1 state branch. Hence, this term actively brings the target mode to the | \u00b1 \u03b1e i(\u03c0/T)t manifold (if the control qubit is in the |1 state) and thus makes it unnecessary for the system to adiabatically relax under the engineered jump operator L2 . In particular, conditioned on the control qubit being in the |1 state, this term makes the target mode rotate by 180 \u2022 at t = T, implementing an X gate (i.e., | \u00b1 \u03b1 \u2192 | \u2213 \u03b1 ) to the target cat qubit.",
                "While the first term compensates for the adverse effects of the nonadiabaticity, the second term induces an undesirable back action to the control mode, which, as we show below, turns out to be a significant error source for the CNOT gate. Intuitively, the reason why the second term is detrimental is because the cat states in the target mode are not eigenstates of the excitation number operator \u00e2 \u2020 2 \u00e22 and rather follow a Poissonian-like distribution with mean excitation number \u03b1 2 . Due to such fluctuations in the excitation number of the target mode, the undesired second term makes the control mode leak out of its ground-state manifold and at the same time causes a Z error on the control qubit space. How this undesired term degrades the CNOT gate fidelity can be best described in a rotating frame and in the full shifted Fock basis, which we describe below. Now, we go to a rotating frame with respect to the desired compensating Hamiltonian",
                "that is, we consider the time evolution of \u03c1I (t) \u2261 e i \u0124 t \u03c1(t)e -i \u0124 t , which should ideally be idling. In the rotating frame (assuming |\u03b1| 1), the annihilation operator of the control mode \u1e901 \u2297 ( b1 + \u03b1) is unchanged since \u1e901 commutes with |1 1| 1 in \u0124 (this is not the case when the orthonormalization is taken into account as there are exponentially small time-dependent corrections to \u00e21 in the rotating frame). On the other hand, \u00e22 is transformed as",
                "where we define \u1e90k (\u03b8 ) as \u1e90k (\u03b8 ) \u2261 exp[i\u03b8|1 1| k ]. Having moved to the rotating frame, we finally use the shifted Fock basis for the target mode and replace \u00e22 by \u1e902 \u2297 ( b2 + \u03b1).",
                "In the rotating frame (and in the full shifted Fock basis), the master equation is given by",
                "where the jump operator L 2 (t) \u2261 e i \u0124 t L2 (t)e -i \u0124 t in the rotating frame is given by",
                "Similarly as in the case of Z and CZ rotations, we consider only the first excited state in each mode ( b2 1 = b2 2 = 0) and ignore weak internal couplings and dissipations within the excited-state manifold assuming that the engineered dissipation rate \u03ba 2 dominates. Lastly, we ignore the second term in the jump operator L2 (t) to not complicate the analysis and convey the main idea more easily. This approximation can have a minor quantitative impact as the second term in L2 (t) is only 4 times weaker than the first term in the worst case (t = T/2). However, the key qualitative features (e.g., scaling) are not affected by this simplification.",
                "With the above simplifications, the master equation is given by ",
                ", not to be confused with the computational basis state |11 ) eventually decays back to the code space through either |11 \u2192 |01 \u2192 |00 or |11 \u2192 |10 \u2192 |00 with a total decay rate (per time) \u03ba = 8\u03ba 2 \u03b1 2 . Note that whichever way the excited state decays, the decay is accompanied by a Z rotation on the control mode, i.e., \u1e901 [(2\u03c0/T)t]. Thus, after adiabatically eliminating the excited states, we get an effective jump operator \u1e901 \u1e901 [(2\u03c0/T)t] with a decay rate (per time) 4g 2 /\u03ba = \u03c0 2 /(32\u03ba 2 \u03b1 2 T 2 ) in the ground-state manifold. Thus, we have the following master equation:",
                "where the dissipators in the first line are due to the singlephonon loss projected to the ground-state manifold. By integrating and ignoring higher-order terms, we find \u03c1I,g (T) \u03c1g (0)",
                "at the gate time T.",
                "To go back to the original frame [i.e., \u03c1(T) = e -i \u0124 T \u03c1I (T)e i \u0124 T ], note that e -i \u0124 T is given by",
                "in the hybrid basis. In the shifted Fock basis, e i\u03c0 \u00e2 \u2020 \u00e2 is exactly given by X \u2297 \u00ce and thus we have",
                "in the full shifted Fock basis. Thus, projecting e -i \u0124 T to the ground-state manifold of the cat qubits, we find \u03c1g (T) = CX \u03c1I,g (T)CX \u2020 where CX \u2261 \u1e901 (-\u03c0\u03b1 2 ) \u2022 CNOT 1\u21922 . Therefore, we can understand \u03c1g (T) as a state that results from applying a unitary operation CX to the input state \u03c1g (0), which is then corrupted by an error channel",
                "where we used the fact that \u1e902 is transformed via CNOT 1\u21922 into \u1e901 \u1e902 . Performing the integration explicitly and ignoring off-diagonal terms similarly as in the analysis of the controlled Z rotations, we find that the Z-error rates (per gate) of the CX gate are given by",
                "Hence, the optimal gate time that minimizes the total gate infidelity is given by",
                "and at the optimal gate time, the Z-error rates (per gate) of the CX gate are given by",
                "Note that the Z errors (per gate) due to the single-phonon loss account only for half the total CX gate error rate at the optimal gate time. The remaining half comes from the Z error due to the undesired term in the compensating Hamiltonian [see the discussion below Eq. (D21)]. Numerically, we find that the optimal Z-error rates (per gate) of the CNOT gate are given by (see Table II)",
                "which agree well with the perturbative prediction in Eq. (D34) within a relative error of 10%. Note that the quantitative differences are mostly due to the fact that we neglected the second term in Eq. (D25) to make the analysis simpler and also that we consider only the first-excited-state manifold in each mode.",
                "We emphasize that to really implement the desired CNOT 1\u21922 gate, one should apply a Z rotation \u1e901 (\u03c0 \u03b1 2 ) to the control cat qubit to compensate for the extra Z rotation in the CX gate and such an extra operation will result in additional Z errors (see Appendix D 2). However, if the average excitation number \u03b1 2 is an even integer, the extra Z rotation is not needed and thus the Z-error rates of the CNOT gate are simply given by the ones in Eq. (D34).",
                "It is often said that bosonic dephasing \u03ba \u03c6 D[\u00e2 \u2020 \u00e2] does not cause any Z errors on cat qubits because it preserves the parity. While this is true for idling, Z, and CZ rotations, this is not the case for the CNOT and Toffoli gates. To see why this is the case, note that \u03ba \u03c6 D[\u00e2 \u2020 \u00e2] is given by",
                "in the shifted Fock basis, where we assumed |\u03b1| 1 and used the fact that D[ \u00d4 + c \u00ce ] = D[ \u00d4] for all hermitian operators \u00d4 \u2020 = \u00d4 and a scalar c. If the cat qubit is in its ground-state manifold, b \u2020 b + \u03b1 b acts trivially and thus the dominant effect due to the dephasing is the heating caused by the term \u03b1 b \u2020 , i.e.,",
                "Such heating, however, does not induce any Z errors on the qubit space, as indicated by the identity operator in the first slot of the tensor product; this is consistent with the fact that the bosonic dephasing alone cannot change the excitation number parity.",
                "In the case of the CNOT gate, dephasing in each mode independently causes heating, resulting in direct population transfer from the ground-state manifold associated with |00 to the excited-state manifolds with |10 and |01 . As shown in the first line of Eq. (D26), the excited states |10 and |01 decay back to the code space via the engineered dissipation 4\u03ba 2 \u03b1 2 D[ \u00ce1,2 \u2297 b1 ] and 4\u03ba 2 \u03b1 2 D{ \u1e901 [(2\u03c0/T)t] \u2297 b2 }, respectively. While the former engineered dissipation (corresponding to the control mode) is parity preserving, the latter (corresponding to the target mode) induces a Z rotation of the control mode, i.e., \u1e901 [(2\u03c0/T)t]. This is because the engineered jump operator on the target mode L2 (t) rotates conditioned on the state of the control mode. Consequently, while the process |10 \u2192 |00 is parity preserving in overall, the other process |01 \u2192 |00 induces Z errors on the qubit degree of freedom. More explicitly, the heating followed by the fast relaxation in the target mode induces a new noise process",
                "in addition to the noise processes described in the righthand side of Eq. (D27). Integrating over the time window t \u2208 [0, T] and ignoring off-diagonal terms, such a noise process adds an error rate (per gate) \u03ba \u03c6 \u03b1 2 T/2 to p Z 1 , i.e.,",
                "That is, even in the lossless case (i.e., \u03ba 1 = 0), the CNOT gate is not free from Z errors and is instead limited by p Z 1 \u221d \u03ba \u03c6 /\u03ba 2 at the optimal gate time. In contrast, dephasing does not induce any additional Z errors in the case of idling, Z rotations, and CZ rotations because in these cases the engineered dissipation is always static (i.e., \u03ba 2 D[\u00e2 2 -\u03b1 2 ] in the usual Fock basis or approximately 4\u03ba 2 \u03b1 2 D[ \u00ce \u2297 b] in the shifted Fock basis) and thus preserves the parity when it brings the excited states back to the cat-code manifold. We also remark that in the presence of nonzero thermal population n th , we simply need to replace \u03ba 1 by \u03ba 1 (1 + 2n th ).",
                "We reinforce that the above perturbative approach based on an approximate expression \u00e2 \u1e90 \u2297 ( b + \u03b1) is not capable of capturing non-Z-type errors, which decrease exponentially in |\u03b1| 2 . Numerically, however, we simulate the master equation in the shifted Fock basis without making any approximations to capture the exponentially small error rates and get accurate Z-error rates. In particular, we use an exact expression of the annihilation operator in the shifted Fock basis (obtained via the procedure described in Appendix C) and perform the frame transformations similarly as in this section (i.e., hybrid basis, rotating frame, and then full shifted Fock basis) but in a way that takes into account exponentially small corrections in |\u03b1| 2 . See Appendix E for numerical results."
            ],
            "subsections": []
        },
        {
            "title": "Toffoli",
            "paragraphs": [
                "A Toffoli gate among three cat qubits can be implemented by",
                "where the engineered dissipation L3 (t) and the compensating Hamiltonian \u0124 are given by",
                "Similarly as in the case of the CNOT gate, the timedependent engineered jump operator L3 (t) stabilizes the target mode \u00e23 in the | \u00b1 \u03b1e i(\u03c0/T)t manifold if the control modes \u00e21 and \u00e22 are in the \"trigger\" state |11 | -\u03b1, -\u03b1 or in the usual cat code manifold | \u00b1 \u03b1 otherwise. Hence, the target mode is rotated by 180 \u2022 (i.e., X gate on the cat qubit) at the gate time t = T only if the control qubits are in the trigger state |11 , realizing the controlled-controlled-X gate, or the Toffoli gate on the three cat qubits. Moreover, the compensating Hamiltonian \u0124 mitigates the adverse effects due to the nonadiabaticity by actively bringing the target mode in the desired manifold | \u00b1 \u03b1e i(\u03c0/T)t when the control qubits are in the trigger state |11 | -\u03b1, -\u03b1 . To analyze the Z-error rates of the Toffoli gate perturbatively, we first use the hybrid basis system where the control modes are described by the shifted Fock basis and the target mode is described by the usual Fock basis. In the hybrid basis, the compensating Hamiltonian is given by",
                "where we used \u00e2k \u1e90k \u2297 ( bk + \u03b1) for k \u2208 {1, 2}. Note that the first term is a desired term that rotates the target mode by 180 \u2022 over the gate time T only if the two control qubits are in the trigger state. The fourth term acts trivially if the system is in the ground-state manifold. The second and the third terms, on the other hand, make the system excited and leak out of the ground-state manifold.",
                "Similarly as in the case of the CNOT gate, we go to a rotating frame with respect to the desired compensating Hamiltonian",
                "i.e., \u03c1I (t) \u2261 e i \u0124 t \u03c1(t)e -i \u0124 t . In this frame, the annihilation operators of the control modes \u00e21 and \u00e22 are unchanged but the annihilation operator of the target mode \u00e23 is transformed as",
                "where",
                ". Lastly, by using the shifted Fock basis for the target mode as well [i.e., \u00e23 \u1e903 \u2297 ( b3 + \u03b1)], we find the following equation of motion for \u03c1I (t):",
                "Here, L 3 (t) \u2261 e i \u0124 t L3 (t)e -i \u0124 t is given by",
                "We neglect all the other terms than the first term in the right-hand side because they are much smaller than the first term. Also, we consider only the first excited states and set b2 1 = b2 2 = b2 3 = 0. In the full shifted Fock basis, \u0124 -\u0124 is given by",
                "As explained above, the third term acts trivially on the code space and thus we focus on the first two terms. In particular, we consider only the dominant driving effects due to the first two terms and approximate \u0124 -\u0124 as",
                "Putting everything together, we find the following master equation:",
                "The undesired terms of the compensating Hamiltonian in Eq. (D48) make the system excited to the manifold associated with",
                "3 ) and at the same time cause an error \u1e901 -\u1e901 \u1e902 ( \u1e902 -\u1e901 \u1e902 ) on the qubit space at a rate (per time) g = \u03c0/(8T). These excited states decay back to the code space via the engineered dissipation. For instance, |101 decays back to the code space through either |101 \u2192 |001 \u2192 |000 or |101 \u2192 |100 \u2192 |000 with a total decay rate (per time) \u03ba = 8\u03ba 2 \u03b1 2 . In both decay routes, the annihilation of the excitation in the target mode (i.e., b3 ) is accompanied by an additional error CZ 1,2 [(2\u03c0/T)t] on the control qubits. The same is true for the other excited state |011 , which decays back to the code space either via |011 \u2192 |001 \u2192 |000 or |011 \u2192 |010 \u2192 |000 . Consequently, by using adiabatic elimination, we find that these driven-dissipative processes induce two independent decay processes with jump operators ( \u1e901 -\u1e901 \u1e902 )CZ 1,2 [(2\u03c0/T)t] and ( \u1e902 -\u1e901 \u1e902 )CZ 1,2 [(2\u03c0/T)t] with an effective decay rate (per time) 4g 2 /\u03ba = \u03c0 2 /(128\u03ba 2 \u03b1 2 T 2 ). Hence, the effective master equation in the ground-state manifold is given by",
                "where \u03c1I,g (t) \u2261 000| \u03c1I |000 is the projected density matrix (of size 2 3 \u00d7 2 3 ) to the ground-state manifold of the three cat qubits.",
                "To go back to the original frame [i.e., \u03c1(T) = e -i \u0124 T \u03c1I (T)e i \u0124 T ], note that e -i \u0124 T is given by",
                "in the hybrid basis, and since e i\u03c0 \u00e2 \u2020 \u00e2 is given by X \u2297 \u00ce in the shifted Fock basis, we have",
                "in the full shifted Fock basis, where TOF 1,2\u21923 is the desired Toffoli gate. Thus, projecting e -i \u0124 T to the groundstate manifold, we find \u03c1g (T) = CCX \u03c1I,g (T)CCX \u2020 where CCX \u2261 CZ 1,2 (-\u03c0\u03b1 2 ) \u2022 TOF 1,2\u21923 . Therefore, we can understand \u03c1g (T) as a state that results from applying a unitary operation CCX to the input state \u03c1g (0), which is then corrupted by an error channel",
                "Here, we used the fact that \u1e903 is transformed via TOF 1,2\u21923 into CZ 1,2 \u1e903 . Evaluating the integral explicitly and ignoring off-diagonal Pauli errors, we find the following Z-error rates (per gate) of the CCX gate:",
                "Hence, the optimal gate time that minimizes the total gate infidelity is given by",
                "and at the optimal gate time, the Z-error rates (per gate) of the CCX gate are given by",
                "Numerically, we find that the optimal Z-error rates (per gate) are given by (see Table II)",
                "which agree well with the perturbative prediction in Eq. (D56).",
                "Similarly as in the case of the CNOT gate, we remark that the implemented gate CCX differs from the desired Toffoli gate TOF 1,2\u21923 by a CZ rotation CZ 1,2 (-\u03c0\u03b1 2 ). Thus, unless the average excitation number \u03b1 2 is given by an even integer, one should apply CZ 1,2 (\u03c0 \u03b1 2 ) to compensate for the extra phase shift. Lastly, note that dephasing can induce direct heating in each mode with a heating rate (per time) \u03ba \u03c6 \u03b1 2 [see Eq. (D37)]. The excited states due to the heating decay back to the code space via the engineered dissipation. The engineered jump operators in the control modes are static and thus the excitations in the control modes decay back to the code space in a parity-preserving way, i.e., 4\u03ba 2 \u03b1 2 D[ \u00ce1,2,3 \u2297 b1 ] and 4\u03ba 2 \u03b1 2 D[ \u00ce1,2,3 \u2297 b2 ]. On the other hand, the engineered jump operator on the target mode is time dependent and thus the relaxation of the excitation in the target mode is accompanied by a CZ rotation in the control qubits, i.e., 4\u03ba 2 \u03b1 2 D{CZ 1,2 [(2\u03c0/T)t] \u2297 b1 }. Consequently, such a heating-relaxation process in the target mode generates a new noise process",
                "in addition to the noise processes described in the righthand side of Eq. (D50) and adds \u03ba \u03c6 \u03b1 2 T/8 to p Z 1 , p Z 2 , and p Z 1 Z 2 , i.e.,",
                "Hence, even in the lossless case (i.e., \u03ba 1 = 0), the Toffoli gate has nonzero Z-error rates, which scale as p *",
                "at the optimal gate time. Lastly, in the presence of nonzero thermal population n th , we simply need to replace \u03ba 1 by \u03ba 1 (1 + 2n th )."
            ],
            "subsections": []
        },
        {
            "title": "CNOT",
            "paragraphs": [
                "We simulated the CNOT gate as described in Appendix D 4 using the shifted Fock-basis approach on AWS EC2 instances. Our code is written in Python using the QuTiP package. The results presented here took approximately 150 h to run on an AWS EC2 C5.18xlarge instance with 72 virtual CPUs. To compute the Pauli error rates for the CNOT gate, we use two types of simulation. One set of simulations is aimed at the Z-type Pauli error rates and also determined the optimal gate time. These simulations require only a small dimension in the shifted Fock basis. The second type of simulation uses a much larger Hilbertspace dimension to perform full tomography of the CNOT gate at the optimal gate time for relatively small values of the cat-code size \u03b1.",
                "We consider four noise models: first pure phonon loss at a number of different rates. We are most interested in the range of loss (\u03ba 1 /\u03ba 2 ) from 10 -4 to 10 -5 . Next, we consider phonon loss at rate \u03ba 1 , phonon gain at a rate such that the thermal occupation is given by n th = 1/100, and dephasing noise at three different rates \u03ba \u03c6 = 1, 2.5, and 10 times \u03ba 1 . This value of the thermal occupation number is larger than what we expect in acoustic cavities. We chose n th = 1/100 so that we could resolve the contribution of phonon gain on the gate error rates. With n th = 1/100 the gate error rates are enhanced by a factor of about 1.01 relative to the error rates with no phonon gain. Dephasing noise is more significant; it increases the dominant error rate, Z error on the control qubit and decreases the optimal gate time. The CNOT error rates including different values of dephasing are shown in Table VII. While idling, the bosonic dephasing term \u03ba \u03c6 D[\u00e2 \u2020 \u00e2] in the master equation does not induce any additional Z errors since dephasing preserves the excitation number parity. Thus, one might be tempted to conclude that dephasing affects only non-Z-type error rates of the CNOT gate and leaves the Z-error rates unchanged. However, surprisingly, we numerically find that this is not the case. In particular, as shown in Table VII, we observe that the optimal gate time decreases noticeably and the total optimal Z-error rate (per gate) of the CNOT gate increases as the dephasing rate (per time) \u03ba \u03c6 increases. In Appendix D, we show that the enhanced Z error rates of the CNOT gate due to dephasing are attributed to the fact that the target stabilization operator L2 (t) is not static and instead rotates conditioned on the state of the control mode. More specifically, dephasing in each mode causes direct population transfer from optimal gate time and error rates for nonzero thermal gain (n th ) and dephasing (\u03ba \u03c6 ) along with loss (\u03ba 1 ). In each case phonon gain is with n th = 1/100, while the rate of dephasing noise relative to loss varies across the three columns.",
                "CNOT",
                "the ground-state manifold of a cat qubit to its first-excitedstate manifold. While such a heating itself does not cause a phase-flip error since dephasing preserves the excitation number parity, the rotating target stabilization operator L2 does cause a Z error on the control qubit when it brings the excited states of the target mode back to the ground-state manifold.",
                "The Z-error rates for the CNOT gate are well captured by the shifted Fock basis with small dimension, indicating that the Z-error rates are dominated by dephasing resulting from the excitation of the cat qubit to the lowest energy excited states. The results plotted in Figs. 28 to 30 were obtained with d = 7, or a total Hilbert-space dimension of 14. The simulations converge rapidly as the dimension increases. The relative difference in the error rates shown in Fig. 28 between the simulations with d = 6 and d = 7 is about 10 -6 , and this gives a bound on how closely these simulations reflect the true error rates in an infinitedimensional cavity. We call the control cavity 1 and the",
                "Error rate",
                "CNOT Z-error rates",
                "28. Log-log plot of Pauli Z-type error rates for the CNOT gate at optimal gate time with mean phonon number n = 8 in the presence of pure loss at rate \u03ba 1 . The fits are performed over the range \u03ba 1 /\u03ba 2 from 10 -4 to 10 -5 . The error rates Z 2 and Z 1 Z 2 differ by no more than 10 -5 . target 2. As described in Appendix D 4, the nonadiabatic error contribution to the Z 1 -error rate of the CNOT gate scales with 1/T, where T is the gate time, while the error due to single-phonon loss scales with T. As a result of the trade-off between nonadiabatic error, the optimal gate time scales like 1/ \u221a T. As shown in Fig. 29, around the optimal gate time the Z 1 -error rate is decreasing with T, whereas the Z 2 -and Z 1 Z 2 -error rates are increasing. This is because the nonadiabatic errors affect only the control cavity, i.e., Z 1 . We find an optimal gate time that differs only slightly from the prediction in Appendix D 4. In Fig. 28  The noise model is at rate \u03ba 1 = 10 -5 \u03ba 2 , dephasing at a rate \u03ba \u03c6 = \u03ba 1 , and gain with n th = 1/100. The gate time is plotted relative to the optimal gate time for these parameters. The optimal gate time minimizes the total error. The dotted curves are a linear fit for the Z 2 -error rate and a sum of a linear term and a 1/T term for the Z 1 and total error rates, representing the contributions of loss and nonadiabatic errors. the expected square root scaling of the Z-error rates with loss rate over a wide range of loss rates. We do observe that the points corresponding to larger values of loss near (\u03ba 1 /\u03ba 2 ) = 10 -3 tend to lie below the square root best-fit curve. For this reason, we perform our fits over the range of loss from 10 -4 to 10 -5 , which is our range of interest for our error correction simulations. This leads to slightly larger error rate fit parameters than if we fit over the full range of loss. Figure 30 shows the dependence of the Zerror rate coefficients on the mean phonon number of the cat n = \u03b1 2 . These coefficients come from fits of each error rate to c \u221a \u03ba 1 /\u03ba 2 for each value of n. There is variation over the range n = 2, . . . 10, but for n = 8 and n = 10 the variation is quite small. The values quoted in Table II represent this large-n value.",
                "Once the optimal gate time is found using the Z-error rate simulation, we performed tomography for the CNOT gate at several values of loss, dephasing, and n to compute the full noise channel. The noise channel for n = 4, n th = 1/100, and \u03ba \u03c6 = \u03ba 1 = 10 -5 is illustrated in Fig. 31. The noise channel is largely incoherent with small off-diagonal elements. The diamond distance from identity is equal to about 2.5 times the average infidelity of the channel across all values of \u03b1, loss, and dephasing that we simulated. The Hilbert-Schmidt norm of the off-diagonal elements of the operator in the Pauli basis is 10 -2 -10  are not even integers, we must cancel the extra Z 1 rotation by angle \u03c0\u03b1 2 that comes with our implementation of the CNOT gate. In practice this would entail additional error, but we do not include the effect of the noisy Z rotation because we are interested in the error intrinsic to the CNOT gate and we expect to operate with even n as much as possible. Besides the dominant Z-error rates, each of the other Pauli error rates is exponentially small in \u03b1. However, we observe that these exponentially small error rates are divided into two classes-six of them scale like the square root of \u03ba 1 /\u03ba 2 just like the Z-error rates and the remaining six error rates scale linearly with \u03ba 1 /\u03ba 2 . The error rates with square root scaling are plotted for one choice of parameters in Fig. 32. The error rates scaling linearly are much smaller and are shown in Fig. 33. A large dimension is required to accurately recover some of the Pauli error rates. As shown in Fig. 34 when n = 3 the Pauli errors that involve X or Y acting on the control qubit require a much larger value of d than the other error rates. The relative difference between the error rates with d = 8 and d = 9 in this case was as much as 15%.",
                "We used a dimension of d = 9, 10, and 11 for n = 3, 4, and 4.5, respectively, and the total Hilbert-space dimension is 2d in the shifted Fock basis. We did not go to larger values of n because the required Hilbert-space dimension Error rate",
                "CNOT error rates",
                "Log-log plot of the Pauli error rates for the CNOT gate with parameters, n = 4, \u03ba 1 = \u03ba \u03c6 , and n th = 1/100. Each of these error rates scale like",
                "required an unreasonably long time to simulate. Across all values of loss, dephasing, and mean phonon number, the error rates for the largest dimension d that we used and the error rates at d -1 differed by several percent. This provides a sense of the difference we expect between the largest dimension we used and the d \u2192 \u221e limit. Because of this uncertainty of perhaps several percent in certain of the Pauli error rates and for simplicity, we have chosen to report a single fit for each of the two groups of exponentially small error rates. These include both the small error rates that scale with the square root of loss in Fig. 32 and those that scale linearly in Fig. 33. This is why only a single best-fit curve appears over the clusters of small error rates in those plots. We have taken the average within each of the two classes of exponentially small error rates and fit the",
                "Loss (\u03ba 1 /\u03ba 2 )",
                "Error rate CNOT small error rates",
                "Log-log plot of the smallest error rates for the CNOT gate with parameters, n = 4, \u03ba 1 = \u03ba \u03c6 , and n th = 1/100. These error rates are proportional to \u03ba 1 /\u03ba 2 rather than the square root scaling of the other error rates in Fig. 32. Error rate relative to d = 9",
                "CNOT error rates dimensional convergence Another set of Pauli errors with X or Y acting on the control qubit require much higher Hilbert-space dimension to capture accurately. This implies that these error rates include significant contributions from highly excited states.",
                "square root or linear curve to those averages. Correspondingly, in our simulations of error correction we assume that p",
                "and the error probabilities are given by the average fits. Both classes of small error rates exhibit the expected exponential scaling with the mean phonon number n of the cat code as shown in Fig. 35."
            ],
            "subsections": []
        },
        {
            "title": "Toffoli",
            "paragraphs": [
                "We simulate the Toffoli gate using the shifted Fock basis as we did for the CNOT gate. In this case we solve the master equation for three cavities. This leads to a much larger total Hilbert-space dimension, and for this reason we are unable to use the large values of d necessary to resolve all 63 Pauli error probabilities. Instead we focus on the dominant errors, which are the Z-type Pauli errors. These errors do not require a large value of d to calculate with good precision. We used d = 4 for each of the three cavities in these Toffoli simulations, which required a total of about 170 h running on an AWS EC2 c5.18xlarge instance with 72 virtual CPUs. We simulated the noise channel on a complete set of X eigenstates and averaged over the initial states. We simulated a range of gate times, and the optimal gate time is the one that minimizes the total error rate. For loss without gain or dephasing, we found that this gate time matched Mean phonon number (n)",
                "Error rate parameter Linear error rates Square root error rates",
                "CNOT exponentially small error rates The parameters of the exponential fits be found in Table II.",
                "the optimal gate time for the CNOT gate. The Z-error rates in this case are summarized in Table II.",
                "With dephasing noise added we found a small difference in optimal gate time. These error rates are found in Table VIII. As in the case of the CNOT gate, dephasing noise increases the Z-error rates and shortens the optimal gate time. The dominant Z error on the control qubits 1 and 2 increases from 0.58 \u221a \u03ba 1 /\u03ba 2 to 0.91 \u221a \u03ba 1 /\u03ba 2 as the dephasing rate increases from 0 to 10\u03ba 1 . Dephasing noise primarily affects the Z 1 -, Z 2 -, and Z 1 Z 2 -error rates. Many of the other Pauli Z-error rates decrease because of the reduction in optimal gate time. Also, with dephasing noise in addition to loss, the optimal gate time for the Toffoli gate differs from the optimal gate time for the CNOT gate. With large dephasing \u03ba \u03c6 = 10\u03ba 1 the optimal gate time for the Toffoli gate is about 1.18 times the optimal gate time for CNOT. For simplicity, we have chosen to always operate the Toffoli gate using a gate time equal to the CNOT optimal gate time. This has a small effect on the total fidelity of the Toffoli gate and on the relative size of the different Pauli Zerror probabilities. We chose to use the optimal gate times for the CNOT gate throughout the paper. The Toffoli error rates at the true optimal gate time and at the CNOT optimal gate time are shown in Table VIII. The difference in the total fidelity of the Toffoli gate is small, however the relative size of individual Pauli Z-error rates does differ by several percent when \u03ba \u03c6 = 10\u03ba 1 .",
                "Figure 36 shows the seven Z-type error probabilities for the Toffoli gate at optimal gate time as a function of the loss rate with n = 8, \u03ba \u03c6 = \u03ba 1 , and n th = 1/100. We see the expected square root scaling with \u03ba 1 /\u03ba 2 for each of the error rates and perform best fits. We simulate Toffoli with n = 4, 6, 8, and 10 and for four sets of noise parameters: only phonon loss and then phonon loss, gain, and dephasing at three different rates, \u03ba \u03c6 = 1, 2.5, and 10 times \u03ba 1 . Similar to the CNOT example in Fig. 30, the parameters of the square root fits depend on n but reach a plateau around  comparing Toffoli Z Pauli error rates, on the one hand, at the optimal gate time and, on the other hand, using a gate time equal to the optimal gate time for the CNOT gate. The error rates from our numerical simulations were fit to \u221a \u03ba 1 /\u03ba 2 to produce the coefficients that appear in the table. Three different values of dephasing are included. The gate times for CNOT and Toffoli match in the case of no dephasing, and the difference between the two increases as the dephasing rate \u03ba \u03c6 increases. Qubits 1 and 2 are the controls, and qubit 3 is the target."
            ],
            "subsections": []
        },
        {
            "title": "Toffoli at optimal gate times",
            "paragraphs": [
                "Loss (\u03ba 1 /\u03ba 2 )",
                "Error rate",
                "Toffoli Z-error rates",
                "Log-log plot of the various Z-type error rates for the Toffoli gate at optimal gate time with parameters n = 8, \u03ba \u03c6 = \u03ba 1 , and n th = 1/100. These error rates were obtained in a shifted Fock-basis simulation using d = 4 for a total Hilbertspace dimension of 8 for each of the three cavities involved in the Toffoli gate. Qubits 1 and 2 are the controls and 3 is the target. n = 8 or 10. For our error-correction simulations we are most interested in values of n in this regime. To produce the numbers in Table VIII we average the values for n = 8 n = 10. The relative difference between these two is only order 10 -2 or less."
            ],
            "subsections": []
        },
        {
            "title": "Z and CZ",
            "paragraphs": [
                "To implement our CNOT and Toffoli gates with values of \u03b1 such that n = \u03b1 2 is not an even integer, we need to apply an additional Z or CZ rotations on the control cavity or cavities. These rotations can be implemented as described For small values of \u03b1 the scaling differs somewhat from the 1/\u03b1 scaling in the large \u03b1 limit. For this reason the fits were performed over the range n = 6 to 10.",
                "in Sec. III. The dominant error rates are the Z-error rates, and at the optimal gate time the Z-error rates scale with \u221a \u03ba 1 /\u03ba 2 . Unlike the case of CNOT or Toffoli, the error rates decrease with \u03b1 for the Z and CZ rotations. We simulate the Z-error rates for the Z and CZ gates, in other words Z and CZ rotations by angle \u03c0 . Once again we use the shifted Fock basis as described in Appendix C to simulate the Z-error rates using a small Hilbert-space dimension. Figure 37 shows the Z-error rates for both the Z and CZ gates when n = 10 and the noise model is phonon loss. We fit the error rates to \u221a \u03ba 1 /\u03ba 2 for each value of n and for each noise model. Then Fig. 38 shows the scaling of the coefficients of the \u221a \u03ba 1 /\u03ba 2 fits as a function of n when the noise model is phonon loss. We fit these curves to 1/\u03b1. The results of the fits that give the Z-error rates as functions of \u03b1 and \u03ba 1 /\u03ba 2 are summarized in Table IX. We also simulated the Z and CZ gates subject to dephasing noise and confirmed that dephasing noise does not contribute ",
                "significantly to the Z-error rates. Including phonon gain with n th = 1/100 has a small effect as shown in Table IX."
            ],
            "subsections": []
        },
        {
            "title": "APPENDIX F: PHYSICAL IMPLEMENTATION OF CAT-QUBIT GATES",
            "paragraphs": [
                "Here, we discuss physical realization of the cat-qubit gates. Note that engineering static two-phonon dissipations in a multiplexed setting has been extensively discussed in the previous section. Also implementation of the rotating dissipators for the CNOT and Toffoli gates are discussed in detail in Ref. [14]. We thus focus on engineering Hamiltonian interactions needed to implement the cat-qubit gates. In particular, we discuss realization of the linear drive in \u0124Z , beam-splitter coupling in \u0124CZ , selective frequency shift in \u0124X , cubic optomechanical coupling in \u0124CNOT , and the quartic interaction in \u0124TOF in the stated order.",
                "Recall the Hamiltonian of the system consisting of multiple phononic modes \u00e2k coupled to a shared ATS mode b:",
                "Also, \u03d5 k and \u03d5 b quantify zero-point fluctuations of the modes \u00e2k and b. To simplify the discussion, we neglect small frequency shifts due to the flux pump p (t) for the moment and assume that the frequency of a mode is given by its bare frequency (in practice, however, the frequency shifts need to be taken into account; see below for the shift due to pump). Then, in the rotating frame where every mode rotates with its own frequency, we have",
                "Linear drive on a phononic mode, say \u00e2k , can be readily realized by using a flux pump p (t) = p cos(\u03c9 p t) and choosing the pump frequency \u03c9 p to be the frequency of the mode we want to drive, that is, \u03c9 p = \u03c9 k . Then, by taking only the leading-order linear term in the sine potential [i.e., sin(x) x], we get the desired linear drive",
                "i.e., Z = -E J p \u03d5 k , where \u0124 contains fast-oscillating terms such as -E J p (\u03d5 l \u00e2l e -i(\u03c9 l -\u03c9 k )t + h.c.) with l = k and -E J p (\u03d5 b be -i(\u03c9 b -\u03c9 k )t + h.c.) as well as other terms that rotate even faster, e.g., -E J p \u03d5 k (\u00e2 k e -2i\u03c9 k t + h.c.). Since the frequency differences between different modes are on the order of 100 MHz but | Z |/(2\u03c0) is typically not required to be larger than 1 MHz, the fast-oscillating terms can be ignored by using a RWA. For instance, the strength of the linear drive needed for the compensating Hamiltonian for the CNOT gate \u0124CNOT is given by",
                "(F4) at the optimal CNOT gate time",
                "assuming \u03b1 2 = 8 and \u03ba 2 = 10 7 s -1 . Note that the subleading cubic term in the sine potential is also neglected here. These unwanted cubic terms are smaller than the desired linear term by a factor of \u03d5 2 k . We remark that to avoid driving unwanted higher-order terms, one may alternatively drive the phononic mode directly, at the expense of increased hardware complexity, instead of using the pump p (t) at the ATS node.",
                "Let us now consider a beam-splitter interaction between two phononic modes, e.g., ZZ (\u00e2 \u2020 1 \u00e22 + \u00e21 \u00e2 \u2020 2 ), which is needed for implementing a CZ rotation between two cat qubits. It is also used to realize the compensating Hamiltonian for the Toffoli gate \u0124TOF and to realize the SWAP operation for the X readout of a cat qubit. Note that the beam-splitter interaction is quadratic and even. Hence, it cannot be directly driven with a single pump tone since the sine potential has an odd parity. We thus jointly apply one pump tone and another drive tone to off-resonantly drive two odd terms and choose the detunings such that these two odd terms realize a resonant beam-splitter interaction when they are combined together. Since average Hamiltonian theory is useful for the analysis of the above scheme as well as many other schemes we propose below, we briefly state a key result of average Hamiltonian theory [56,109]: given a time-dependent Hamiltonian",
                "with fast-oscillating time-dependent terms, one gets the following effective Hamiltonian by averaging out fastoscillating terms:",
                "To realize the beam-splitter interaction \u00e2 \u2020 1 \u00e22 + h.c., we drive the two terms \u00e2 \u2020 1 \u00e22 b \u2020 and b off resonantly. In particular, we use a pump p (t) = p cos(\u03c9 p t) with a pump frequency \u03c9 p = \u03c9 2 -\u03c9 1 -\u03c9 bto off-resonantly drive the term \u00e2 \u2020 1 \u00e22 b \u2020 and directly drive the b mode via",
                "with a drive frequency \u03c9 d = \u03c9 b + to off-resonantly drive the linear term b \u2020 . Note that the size of the detuning | | must not be larger than half the filter bandwidth 2J so that the drive is not filtered out. Then, by taking up to the third-order terms in the sine potential [i.e., sin(x) x -x3 /6] in Eq. (F2), we find",
                "b \u2020 e -i t + h.c.",
                "where \u0124 contains fast-oscillating terms, which we ignore for the moment. Let",
                "Then, neglecting \u0124 , the average Hamiltonian theory yields",
                "Note that we assumed that the population in the b mode is negligible (i.e., b \u2020 b 1) and dropped the constant energy shift \u03c7 2  2 / in the last line. The first term in the last line is the desired beam-splitter interaction ZZ (\u00e2",
                "where \u03b2 \u2261 \u03c7 2 / = d / can be understood as an effective displacement in the b mode. For the population of the b mode to be negligible, we need |\u03b2| 1. Assuming \u03b2 = 0.1 and noting that E J p,1 \u03d5 1 \u03d5 2 \u03d5 b \u223c g 2 2\u03c0 \u00d7 5 MHz, we find that ZZ \u223c 2\u03c0 \u00d7 500 kHz is achievable. The strength of the beam-splitter interaction in the compensating Hamiltonian for the Toffoli gate \u0124TOF is given by [see Eq. (F16)]",
                "(F11) at the optimal Toffoli gate time",
                "assuming \u03b1 2 = 8 and \u03ba 2 = 10 7 s -1 . We also remark that the second term in the last line of Eq. (F9) gives rise to undesired cross-Kerr interaction and energy shift of the \u00e22 mode. The unwanted cross-Kerr interaction \u00e2 \u2020 1 \u00e21 \u00e2 \u2020 2 \u00e22 can in principle be cancelled by off-resonantly driving the term \u00e21 \u00e22 b \u2020 with a detuning different from . The frequency shift of the mode \u00e22 [i.e., (\u03c7 2  1 / )\u00e2 \u2020 2 \u00e22 ] can either be incorporated into the frequency matching condition or physically cancelled by off-resonantly driving the term \u00e22 b \u2020 (see below for more details). Note that we have so far ignored fast-oscillating terms [i.e., \u0124 in Eq. (F8)]. These fast-oscillating terms include unwanted cubic terms, e.g.,",
                "b \u2020 e i(2\u03c9 2 -\u03c9 1 -\u03c9 3 -)t + h.c., which would give rise to an unwanted beam-splitter interaction \u00e2 \u2020 2 \u00e23 + h.c. If the frequencies of the modes \u00e21 , \u00e22 , and \u00e23 are equally spaced, 2\u03c9 2 -\u03c9 1 -\u03c9 3 vanishes and the unwanted term \u00e2 \u2020 2 \u00e23 b \u2020 interferes with the desired term \u00e2 \u2020 1 \u00e22 b \u2020 as they rotate with the same frequency. However, in practice, equal frequency spacing is avoided in the optimization of the frequencies of the phononic modes. Hence, unwanted beam-splitter interactions are far detuned from the desired beam-splitter interaction. We remark that remaining fast-rotating terms in \u0124 (different from the above beam-splitter type) are of less concern as their rotating frequencies are farther away from the frequencies of the desired terms.",
                "Let us now move on to the selective frequency shift, which is needed, e.g., for removing nonadiabatic errors of the X gate if we were to implement the X gate physically [see Eq. ( 21)]. In practice, the 180 \u2022 rotation e i\u03c0 \u00e2 \u2020 \u00e2 (or \u00e2 \u2192 -\u00e2) for the X gate can be performed via software by adapting the phases of subsequent drives. However, we still discuss the selective frequency shift because it is conceptually useful for understanding our proposal for implementing the compensating Hamiltonians for the CNOT and Toffoli gates.",
                "We first consider frequency shifts due to a pump p (t) = p cos(\u03c9 p t). Note that the terms \u00e2 \u2020 k \u00e2k b \u2020 and b \u2020 in the sine potential are off-resonantly driven by the pump with the same detuning = \u03c9 p -\u03c9 b and with coupling strengths",
                "k \u03d5 b and -E J p \u03d5 b , respectively. Hence, through the average Hamiltonian theory, we find that the frequency of the \u00e2k mode is shifted by",
                "Similarly as in the case of beam-splitter interaction, the frequency shift is accompanied by undesirable quartic terms such as self-Kerr (\u00e2 \u2020 k ) 2 \u00e22 k and cross-Kerr \u00e2 \u2020 k \u00e2k \u00e2 \u2020 l \u00e2l nonlinearities. While we have ignored the frequency shifts due to pump in the discussions so far, they need to be carefully taken into account in practice.",
                "Note that the size of frequency shift can be modulated by changing the pump amplitude p (i.e., |\u03b4\u03c9 k | \u221d 2 p ). However, we cannot engineer the frequency shifts due to Building up on the intuitions gained from the discussion of selective frequency shift, we now discuss implementation of the compensating Hamiltonian for the CNOT gate in Eq. (25). Without loss of generality, we focus on the CNOT gate between the modes \u00e21 (control) and \u00e22 (target). Note that \u0124CNOT consists of an optomechanical coupling [\u03c0/(4\u03b1T)](\u00e2 1 + \u00e2 \u2020 1 )\u00e2 \u2020 2 \u00e22 between two phononic modes, a linear drive on the control mode -[\u03c0\u03b1/(4T)](\u00e2 1 + \u00e2 \u2020 1 ), and a selective frequency shift of the target mode -[\u03c0/(2T)]\u00e2 \u2020 2 \u00e22 . Similarly as the 180 \u2022 rotation for the X gate needs not be implemented physically, the selective frequency shift of the target mode can be taken care of via software. That is, instead of using \u0124CNOT in Eq. ( 25), one may use a different compensating Hamiltonian",
                "as well as an appropriately modified rotating jump operator L 2 (t) such that the cat states |0 |\u03b1 and |1 | -\u03b1 in the target mode are mapped to |i\u03b1 and |i\u03b1 if the control mode is in the state |0 |\u03b1 , and to |i\u03b1 and |i\u03b1 if the control mode is in the trigger state |1 | -\u03b1 . Hence, one may simply redefine the cat-code computational basis states of the target mode as |0 \u2190 |i\u03b1 and |1 \u2190 |i\u03b1 and adjust the phases of subsequent drives accordingly.",
                "Note that the optomechanical coupling and the linear drive on the control mode still need to be implemented physically. Implementation of the linear drive is already discussed above. To realize the optomechanical coupling, one might be tempted to directly drive the cubic term \u00e21 \u00e2 \u2020 2 \u00e22 + h.c. in the sine potential via a pump p (t) = p cos(\u03c9 p t). However, the direct driving scheme is not suitable for a couple of reasons: since the term \u00e21 \u00e2 \u2020 2 \u00e22 rotates with frequency \u03c9 1 , the required pump frequency is given by \u03c9 p = \u03c9 1 , which is the same pump frequency reserved to engineer a linear drive on the \u00e21 mode. Moreover, the term \u00e21 \u00e2 \u2020 2 \u00e22 rotates at the same frequency as those of undesired cubic terms such as \u00e21 \u00e2 \u2020 3 \u00e23 , \u00e21 \u00e2 \u2020 4 \u00e24 , and also \u00e2 \u2020",
                "Hence, even if the linear drive is realized via a direct driving of the phononic mode, one still cannot selectively drive the desired optomechanical coupling by using the pump frequency \u03c9 p = \u03c9 1 due to the frequency collision with other unwanted cubic terms. This issue is analogous to the one we had earlier that the selective frequency shift of the \u00e21 mode is not possible via the synthesis of two terms \u00e2 \u2020 1 \u00e21 b \u2020 and b \u2020 . To circumvent the above frequency-collision issue, we propose to realize the optomechanical coupling (\u00e2 1 + \u00e2 \u2020 1 )\u00e2 \u2020 2 \u00e22 by off-resonantly driving the term",
                "That is, given a Hamiltonian \u0124 = \u03c7(\u00e2 1 + \u03bb)\u00e2 2 b \u2020 e -i t + h.c., we get the following effective Hamiltonian through the time averaging",
                "where we again assumed that the population of the b mode is negligible (i.e., b \u2020 b 1). In particular, by choosing \u03bb = -2\u03b1, we can realize the optomechanical coupling as well as the selective frequency shift of the \u00e22 mode, i.e., \u0124eff \u221d (\u00e2",
                "\u00e2 \u2020 2 \u00e22 /(2\u03b1) (which can in principle be cancelled by off-resonantly driving the term \u00e21 \u00e22 b \u2020 ). Hence, if we realize \u0124CNOT this way, we need not rely on software to keep track of the phase of the target mode as the phase shift is physically realized. We also remark that the",
                "b \u2020 is detuned from other undesired terms such as (\u00e2 1 + \u03bb)\u00e2 k b \u2020 with k \u2265 3 by a frequency difference \u03c9 2 -\u03c9 k . Thus, the unwanted optomechanical coupling (\u00e2 1 + \u00e2 \u2020 1 )\u00e2 \u2020 k \u00e2k can be suppressed by a suitable choice of the detuning similarly as in the case of selective frequency shift.",
                "Note that while the cubic term \u00e21 \u00e22 b \u2020 in (\u00e2 1 + \u03bb)\u00e2 2 b \u2020 can be realized by using the sine potential, the other quadratic term \u00e22 b \u2020 cannot be directly realized from the sine potential, which has an odd parity. The quadratic interaction \u00e22 b \u2020 can in principle be realized by synthesizing (using the average Hamiltonian theory) two odd terms \u00e22 ( b \u2020 ) 2 and b \u2020 . To put everything together and get the desired optomechanical coupling, however, the results of average Hamiltonian theory need to be concatenated. In other words, to analyze the full scheme for the desired optomechanical coupling, a higher-order average Hamiltonian theory is needed. We leave it as a future work to thoroughly analyze such a scheme.",
                "Lastly, let us consider the compensating Hamiltonian \u0124TOF for the Toffoli gate in Eq. (32). \u0124TOF is explicitly given by",
                "Note that the terms in the second and the third lines are in the same form as the compensating Hamiltonian for the CNOT gate. Thus, they can be realized in a similar way as described above. The terms in the first line contain a beam-splitter interaction (\u00e2 \u2020 1 \u00e22 + \u00e21 \u00e2 \u2020 2 ), which we have already discussed above, as well as a quartic term",
                ". Since the sine potential has an odd parity, it is not possible to drive the quartic term directly. The quartic term can nevertheless be realized by off-resonantly driving the term",
                "i.e., the desired quartic interaction and unwanted cross-Kerr interactions between a control and the target modes. The undesired cross-Kerr terms, which are as strong as the desired quartic term, can in principle be cancelled by off-resonantly driving the terms \u00e21 \u00e23 b \u2020 and \u00e22 \u00e23 b \u2020 with detunings 1 and 2 , which are different from each other and also from .",
                "The required coupling strength of the quartic interaction",
                "(F18) at the optimal Toffoli gate time",
                "assuming \u03ba 2 = 10 7 s -1 . Note that the coupling strength of the term \u00e21 2b \u2020 and \u00e21 3b \u2020 are comparable to g 2 2\u03c0 \u00d7 5 MHz. Incorporating the bosonic enhancement factor due to the average excitation number \u03b1 2 , we require the detuning to be much larger than g 2 \u03b1 2 , e.g., = 10g 2 \u03b1 2 . Then the achievable coupling strength of the quartic interaction is given by g 2 2 /(10g"
            ],
            "subsections": []
        },
        {
            "title": "APPENDIX G: MEASUREMENT",
            "paragraphs": [
                "In this Appendix we discuss measurement schemes for high-fidelity readout in both the X and Z basis. Compared to gates where the optimal gate errors can be cleanly described in terms of dimensionless constants like \u03ba 1 /\u03ba 2 , for readout absolute time scales matter more. We enumerate the parameter choices for the different schemes at the end of the corresponding sections."
            ],
            "subsections": []
        },
        {
            "title": "X -basis measurement",
            "paragraphs": [
                "Here we discuss in more detail the X -basis readout scheme used to generate the infidelities used in most of the error-correction simulations. Note that throughout this Appendix, when we refer to measurement infidelities or error probabilities, we are referring to misassignment probabilities",
                "where P(s|s) is the probability of reading out the state s given that the cavity was in state s. X -basis measurement refers to determining the parity of a phononic mode or equivalently readout in the basis of even and odd cat states, i.e., |\u00b1 \u221d |\u03b1 \u00b1 | -\u03b1 . To realize such a measurement with minimal impact on the length of an error correction cycle we utilize an additional phononic mode, which we refer to as the readout mode. This mode is interrogated by a transmon in parallel with the next errorcorrection cycle. As is pictured in Fig. 2, every unit cell contains this additional readout mode connected to a transmon. Pictured in Fig. 39 is the circuit we use for measuring an X stabilizer, which we now walk through in more detail. To perform an X -stabilizer measurement first the ancilla qubit \u00e21 is entangled with the data qubits. Subsequently we Data qubits Ancilla qubit Phononic readout mode FIG. 39. Circuit used for an X -basis measurement in the context of an X -type stabilizer measurement. The first step consists of entangling the ancilla qubit with the data qubits. Afterwords, the ancilla qubit is deflated followed by a SWAP with a readout mode. Lastly, the readout mode is repeatedly measured using a transmon qubit. The durations for the parts of the measurement procedure are labeled at the bottom of the figure below each circuit element. While these repeated parity measurements are occurring, the CNOT gates of the next error-correction cycle can begin. Also included is a diagram of the physical layout of the stabilizer to give context to the measurement circuit.",
                "\"deflate\" the ancilla qubit on a time scale comparable 1/\u03ba 2 , mapping the even parity state to |n = 0 and the odd parity state to |n = 1 [27]. Deflation is achieved under evolution with the two-phonon dissipator,",
                "by taking \u03b1(t) from \u03b1 0 to \u03b1 1 < \u03b1 0 . In our case we rapidly take \u03b1(t) from its initial value to \u03b1 1 = 0 where we evolve for a time on the order of 1/\u03ba 2 . The deflation is not required to be adiabatic since we do not need to maintain phase coherence between the even and odd parity states. The utility of the deflation is that it makes the state of the cavity less susceptible to single-phonon-loss events, which change its parity.",
                "After the deflation we perform a SWAP between the ancilla phononic mode (\u00e2 1 ) and the readout mode (\u00e2 2 ). The SWAP is performed using the Hamiltonian",
                "Evolution under this Hamiltonian for a duration \u03c0/2g r realizes a SWAP gate (there is a rotation of the swapped state by 90 \u2022 ). Physical implementation of this Hamiltonian is discussed in Eq. (F7). An advantage of this readout scheme is that after the exchange has occurred, the next cycle of quantum error correction can continue in parallel with the measurement of the readout mode. With the idling time now set only by the deflation + SWAP steps, we can spend more time measuring the readout mode without compromising on idling error. This simple layout choice could be generally useful in other architectures. In the specific case of this proposal, we perform repeated QND parity measurements, which we majority vote to get our final measurement outcome [64][65][66]. In general, more advanced methods than majority voting will give higher fidelity [65].",
                "Measurement of the readout mode parity is done using a dispersive coupling with a transmon qubit [64] H = -\u03c7 \u03c3z \u00e2 \u2020 \u00e2 where \u00e2 corresponds to a bosonic mode and \u03c3z corresponds to a transmon qubit. Evolution under this Hamiltonian for a time t = \u03c0/\u03c7 realizes the unitary \u00db = I \u2297 |g g| + e i\u00e2 \u2020 2 \u00e22 \u03c0 |e e| in which is a controlled parity gate. As pictured in Fig. 39, when the controlled parity gate is placed between an initialization in |+ and measurement of the transmon in the X -basis this realizes a QND measurement of the readout mode parity. Importantly our use of repeated measurement suppresses the effect of transmon error mechanisms (i.e., transmon readout error, transmon T1 \u2022 \u2022 \u2022 ) on the final readout fidelity. The readout is still QND in the presence of such errors as they commute with the dispersive coupling.",
                "We have performed simulations of this measurement scheme to determine the rough infidelities for different single-phonon-loss rates \u03ba 1 = \u03ba 2 * (\u03ba 1 /\u03ba 2 ). We start by performing master equation evolution under the deflation and swap to determine P(even) [P(odd)], which is the probability that the final state after the deflation and swap steps is even (odd). We include the effects of single phonon loss during the deflation and swap. Then we sample from these probabilities to determine the state of the readout mode after the first measurement. After the measurement the readout mode is in the |n = 0 and |n = 1 manifold, which is a good approximation since after the deflation step the population of the readout mode is very close to 0 or 1 depending on the initial state. Starting from the state the readout mode is projected onto after the first measurement we perform master-equation evolution to include the effects of the single phonon loss, gain, and dephasing on the readout mode during the inter measurement period and during measurement (T entangle + T meas + T reset ). We then repeat this projection and evolution for the remaining number of measurements that are used, giving us one sequence of projections. To include the effect of transmon errors such as loss, dephasing, and incorrect measurement we add additional randomness associated with a fixed transmon error probability ( q ) giving us the final measurement sequence. We have performed Monte Carlo sampling of these measurement sequences to determine the infidelities of this measurement process. A plot of the infidelities are pictured in Fig. 40. The assumed numbers in the simulations are listed at the end of this section.",
                "In other circumstances, such as stabilization of fourcomponent cat codes, decay during entanglement with the transmon is problematic because it induces dephasing of the cavity. In our case since we are only concerned about measuring the parity this dephasing is not important. As a result we are justified in lumping the effect of this transmon decay into our fixed parameter representing the transmon infidelity mechanisms. We also note that recent advances in transmon measurement would allow more aggressive transmon measurement fidelities than what we assume [66]. This would allow us to use fewer measurements to achieve the same fidelities we currently expect to achieve.",
                "We can also get an approximate form for the measurement infidelities to expect with this repeated measurement procedure. Defining N (odd) to be the total number of measurements and k \u2261 (N + 1)/2, to leading order the error probability for the majority voting of the repeated measurements for initial even and odd cat states in the case of no gain are even = (deflate + SWAP)",
                "where T p is the amount of time after the SWAP and before the kth measurement and (deflate + SWAP) is the error from the deflation and SWAP for the given initial state. In the above expressions the first term is the contribution to the error from the deflation and SWAP steps. The second term is due to transmon error where k measurements are incorrect. The last term in the case of an odd initial state is the probability of a T 1 event before the kth measurement, which will lead with high probability to all the remaining measurements X measurement infidelities with even parity initial state X measurement infidelities with odd parity initial state Majority-voting error probability Majority-voting error probability FIG. 40. Simulated (markers) and analytical (curves) error probabilities for X measurement for the cases of both even parity and odd parity initial states. We have taken the parity measurement to be QND and projective. The dependence on \u03ba 1 /\u03ba 2 is stronger for the case of an odd initial state since the cavity is mapped to |1 after the deflation. The plotted curve is the leadingorder analytic model for the case of \u03ba \u03c6 = 0 Eq. (G4). Numerical imprecision predominantly due to the deflation simulation can have about a 10 percent effect on the simulated infidelities for the smaller \u03ba 1 /\u03ba 2 .",
                "giving 0. Note that this is the reason that for an odd initial state and larger \u03ba 1 /\u03ba 2 values majority-voting five measurements underperforms majority-voting three measurements. Using a more advanced procedure than majority voting would mitigate this problem.",
                "Assumptions: The properties of the measurement were chosen to make the error probabilities dependent only on \u03ba 1 /\u03ba 2 and the measurement times scale as 1/\u03ba 2 to follow the gates, which have the same dependence. This is convenient for the error-correction simulations because it means that the logical failure rates are independent of the absolute scale of \u03ba 2 .",
                "The properties that feed into our measurement error probabilities and times are a transmon related error probability ( q ) of 1%, a deflation time of 3/\u03ba 2 , transmon-related times of T entangle = T readout = T reset = 200 ns \u00d7 [1/(100 ns) \u00d7 \u03ba 2 ], \u03b1 2 = 8, and g/2\u03c0 = 1 MHz \u00d7 [(100 ns) \u00d7 \u03ba 2 ] [110,111]. For simplicity, in the error-correction simulations we have used up to three measurements in the repetition code and up to five measurements in the surface code. This choice is well justified in the important regime for REGIME 3. For example, for the surface code the duration of four CNOT gates is approximately 28 \u03bcs, larger than the relevant measurement duration of 5 \u00d7 T entangle + 5 \u00d7 T measure + 5 \u00d7 T reset \u223c 17.05 \u03bcs. In REGIME 1 and REGIME 2 this simplification breaks down and fewer measurements or more time for the measurements would be needed. However, in these regimes fault-tolerant quantum computation is infeasible even with this optimistic measurement error model. In the overhead calculations the idling duration corresponding to the X -basis measurement is 3/\u03ba 2 + \u03c0/2g."
            ],
            "subsections": []
        },
        {
            "title": "Z-basis measurement",
            "paragraphs": [
                "For Z measurement we use a beam-splitter interaction between the buffer mode and a phononic storage mode",
                "where \u00e2 is an annihilation operator on a storage mode and b is an annihilation operator on the buffer mode. By homodyning the output of the buffer mode we determine the state of the storage mode. We perform this readout scheme with the two-phonon dissipation off. A similar scheme has been realized for Kerr-Cat qubits in Ref. [27].",
                "To realize this interaction we drive the two terms \u00e2 \u2020 b2 and b off resonantly. In particular, we use a pump p (t) = p cos(\u03c9 p t) with frequency \u03c9 p = 2\u03c9 b -\u03c9 a + to offresonantly drive the term \u00e2b \u20202 and directly drive the b mode at frequency \u03c9 d = \u03c9 b + to produce the term",
                "Then the complete Hamiltonian in the rotating frame of all of the modes is",
                "where \u0124 contains rapidly rotating terms. Now let \u03c7 1 \u2261 E J p \u03d5 a \u03d5 2 b /2. Then, neglecting \u0124 and constants, average",
                "Hamiltonian theory yields [55,56] ",
                "The coupling constant is given by g = E J p \u03b2\u03d5 a \u03d5 2 b where \u03b2 = d / and there is an energy shift. The strength of the coupling is on the order of g 2 since it depends twice on \u03d5 b > \u03d5 a and \u03b2 < 1 to ensure b \u2020 b < 1.",
                "Next we proceed by finding the measurement SNR for this readout scheme. The coupled Langevin equations governing the evolution of the storage and buffer modes in the interaction picture are",
                "Here \u03ba b is the single-photon-loss rate of the buffer mode and we have neglected the single-phonon-loss rate of the storage mode under the assumption that it is far slower than the readout time scale. These equations can be straightforwardly integrated [112] to give",
                "where",
                "Here we have not included the mean zero terms with bin since they are not relevant for computing the signal. The measurement operator with a uniform readout window is defined to be [113,114] ",
                "Using the input-output boundary condition that bout = bin + \u221a \u03ba b b. We can determine the average of the measurement operator to be",
                "We have also taken the input to be the vacuum with the property bin",
                "There is a weak drive on b to realize the Hamiltonian which we neglect and could be replaced with a flux pump. From the average of the measurement signal M (\u03c4 ) we can determine the measurement SNR using",
                "We take the noise terms to be given by",
                "which we have checked in numerics. Solving for the SNR and optimizing the phase we get",
                "As is expected since this readout scheme is not QND and does not preserve the state of the cavity at long times the readout SNR goes as 1/ \u221a \u03c4 as we are only integrating noise. The readout separation error, which is the dominant source of error for this readout scheme, will be given by sep,\u03b1 (\u03c4 ) =",
                "From these equations we can then determine the fidelity as a function of time for different alpha for our measurement scheme as is shown in the colored line in Fig. 41(a). In Fig. 41(b) we fit the optimal readout error to an exponential decay. We used a more conservative relation = e -1.5-0.9|\u03b1| 2 for the error-correction simulations.",
                "We have simulated trajectories for this measurement procedure using a stochastic master equation for confirmation. The stochastic master-equation simulations include \u03ba 1 /2\u03c0 = 1 KHz. The integrated and classified and measurement results from the stochastic master equation compared to the analytic expression are pictured in Fig. 41(a). The stochastic master-equation simulations were performed with the evolution",
                "Error fit FIG. 41. (a) Measurement error probability for Z-basis readout as a function of time. The colored lines correspond to the analytic formula for the separation error Eq. (G16) for \u03b1 2 = 1, 2, . . . , 10. The black lines correspond to infidelities from simulations of the corresponding stochastic master equation Eq. (G17) (QuTiP) in the interaction picture for a few thousand trajectories with the initial condition |\u03b1 for the cases \u03b1 2 = 1, \u03b1 2 = 3, \u03b1 2 = 5, and \u03b1 2 = 7. The simulated curves, which include \u03ba 1 /2\u03c0 = 1 KHz, and analytic curves agree well indicating the small effect of the additional single-phonon loss. In order to get concrete time numbers, the simulations use 1/\u03ba 2 = 100 ns but as discussed this can be scaled to any \u03ba 2 . (b) Plot of the minimum infidelities versus \u03b1 2 and the fit line. FIG. 42. Distance-5 repetition code, where one round of stabilizer measurements is performed (green measurements) followed by a direct measurement of the data qubits (red measurements). The data qubits are the yellow rectangles, and the ancilla qubits (prepared in |+ ) are the gray rectangles. On the left, a measurement error on the third data qubit occurs during the direct measurement of the data, which is equivalent to having a Z data qubit error immediately before the measurement (shown on the right). Such settings illustrate the importance of the STOP algorithm, where one might have to correct errors prior to applying a non-Clifford gate, and a round of perfect error correction (which in practice is achieved by directly measuring the data) cannot be performed. In such settings, a single measurement error during the last round of stabilizer measurements (green measurements in the figure) can lead to a logical failure if the syndrome measurement is repeated a fixed number of times (say d) rather than using the STOP algorithm.",
                "where the second term on the second line is the detection part of the master equation that is unraveled. We see exponential suppression of the error probability with increasing \u03b1 2 . In the future we expect to be able to improve the performance by optimizing the window function for the readout and using the confidence of the measurement result to feed back and improve the matching. These advances in addition to the robustness of the error correction (EC) to larger measurement errors than those currently assumed would allow us to make looser assumptions.",
                "Assumptions: The chosen parameters for this work are \u03ba b /2\u03c0 = 20 \u00d7 [(100 ns) \u00d7 \u03ba 2 ] MHz and g/2\u03c0 = 4 \u00d7 [(100 ns) \u00d7 \u03ba 2 ] MHz. These rates depend on \u03ba 2 so the readout time will scale as 1/\u03ba 2 . We also include the effect of a nonunity quantum efficiency \u03b7 = 0.5 (\u03b7 is the proportion of the signal detected). For \u03ba 2 = 2\u03c0 \u00d7 280e3 used in the paper the optimal duration of the measurement is roughly 850 ns. Note that \u03ba b can be made larger with the main effect of lengthening the readout time."
            ],
            "subsections": []
        },
        {
            "title": "APPENDIX H: ALTERNATIVE ARCHITECTURE WITH ATS-BASED BASIS READOUT",
            "paragraphs": [
                "In this Appendix, we describe an alternative version of our architecture where the X -basis readout is performed directly using the ATS. As discussed below, this modification favorably impacts practicality and performance across several different levels of our architecture. For example, this modification obviates the need for a transmon in each unit cell, and allows us to reduce the number of modes coupled to each reservoir from five to four, see Fig. 43. As a result, crosstalk is reduced, easing limitations on logical lifetimes posed by correlated errors. Though such benefits are highly desirable, the ATS-based X -basis readout that underlies this alternative architecture may be difficult to perform in practice. Because the practical feasibility of the readout scheme is more speculative, we do not use the ATS-based readout scheme in any of the analyses in the main text. Instead, we describe the ATS-based readout scheme and enumerate its favorable impacts here in this Appendix. The ATS-based readout scheme is presented and analyzed in Appendix H 1, while Appendix H 2 catalogs the beneficial impacts of this modification across different levels of the architecture. FIG. 43. architecture. The -basis is performed directly using the ATS [contained within the reservoir (RESVR)], as opposed to using an ancillary readout mode and transmon qubit, cf. Fig. 2. By eliminating the readout mode, the number of modes per unit cell is reduced from five to four."
            ],
            "subsections": []
        },
        {
            "title": "ATS-based X -basis measurement scheme",
            "paragraphs": [
                "Here we present a modified X -basis readout scheme that can be implemented using only the ATS and the buffer mode. The readout scheme is implemented by engineering a coupling Hamiltonian of the form",
                "Here \u00e2 is the annihilation operator for a storage mode and b is the annihilation operator for the buffer mode. Note that this Hamiltonian is equivalent to the longitudinal readout discussed with transmons [114]. Practically speaking, engineering this Hamiltonian may be challenging because it rotates at the frequency of the buffer mode.",
                "That is, we cannot engineer this Hamiltonian simply by pumping the system at the resonance frequency of the buffer mode, because the same pump would also bring corresponding Hamiltonians for other storage modes on resonance simultaneously [e.g.,",
                "To circumvent this frequency-selectivity problem, we sketch how a Hamiltonian of the form, Eq. (H1), could be engineered via off-resonant pumping. Consider the following Hamiltonian (in the rotating frame),",
                "This Hamiltonian can be realized in a number of ways. For example, the \u00e2b \u20202 term can be realized by pumping the ATS at frequency 2\u03c9 b -\u03c9 a + , while the \u00e2b \u2020 term can be realized by synthesizing two odd terms [as described in the vicinity of Eq. (F7)]. For simplicity, we assume access to Hamiltonians of the form, Eq. (H2), and leave the precise details of how they are to be engineered to future work. For g a,b , evolution generated by the Hamiltonian (H2) is well described by the corresponding time-averaged effective Hamiltonian [56],",
                "where in the last line we have neglected many of the terms due to the small occupation of the buffer mode.",
                "To implement an X -basis readout using this Hamiltonian, we first deflate the storage mode. As described in Appendix G, this deflation is achieved by abruptly setting the two-phonon dissipator for the storage mode equal to D[\u00e2 2 ], as opposed to D[\u00e2 2 -\u03b1 2 ], and waiting for a time scale comparable to 1/\u03ba 2 . When the storage mode begins in an even (odd) parity state, this deflation procedure maps it to the |0 (|1 ) phonon Fock state. Subsequent to this deflation, we perform a homodyne measurement of the buffer mode while the system evolves under the Hamiltonian (H3). In effect, this Hamiltonian drives the buffer mode conditioned on whether the parity of the storage mode was initially even or odd.",
                "We compute the fidelity of this homodyne readout, where we aim to distinguish |n a = 0 from |n a = 1 . We closely follow the derivation of SNR in Ref. [114]. The Langevin equation for the evolution of the buffer mode in the interaction picture is",
                "where bin is the input field and g r \u2261 2g a g b / . In the following calculations we neglect the single-phonon loss of the ancilla mode, which in this simple case will add an average readout error probability of roughly \u03ba a t/4. We integrate this equation to get the expected value of the buffer mode",
                "The measurement operator for integration up to time \u03c4 and with homodyne angle \u03c6 h is defined as [113,114] ",
                "Evaluating the average of this integral with the optimal phase gives",
                "Here we have used the standard input-output condition that bout = bin + \u221a \u03ba b b and the conditions on bin that bin = 0 and bin",
                "There is a drive on b to realize the Hamiltonian, which we neglect and could be replaced by an appropriate pump. Next we compute the SNR, which is defined as",
                "where",
                "The separation error for this readout, which will be in addition to the effect of the single-phonon loss mentioned earlier, will be given by [67] sep (\u03c4 ) =",
                "There will also be an additional contribution to the readout error associated with the deflation procedure (see Appendix G)"
            ],
            "subsections": []
        },
        {
            "title": "Benefits of ATS-based X -basis readout",
            "paragraphs": [
                "The analysis of the previous section demonstrates that, in principle, high-fidelity X -basis readout can be performed directly using the ATS. We now show how this readout scheme can be exploited to improve the practicality and performance of our architecture. The following analysis demonstrates that improved X -basis readout represents one potential path to improved future designs. At the same time, it also illustrates a more general point: improvements at low levels of the architecture can propagate into significant savings at higher levels. These findings thus underscore the importance and utility of comprehensive architectural analyses.",
                "At the hardware level, the modified X -basis readout scheme enables us to simplify the unit cell of our architecture. Specifically, in comparison to the unit cell described in the main text (Fig. 2), the unit cell of Fig. 43 has no transmon and has four phononic modes instead of five. Removing the transmon reduces the number of control lines and is helpful for device layout because the transmon requires significant additional space in comparison to the phononic modes.",
                "Reducing the number of modes per unit cell from five to four significantly reduces crosstalk within each unit cell. We can quantify this reduction following the approach described in Appendix B. To briefly summarize, we optimize the frequencies of the storage modes within each unit cell in order to minimize the effects of crosstalk. More specifically, the frequencies are chosen so that the effects of coherent crosstalk errors are minimized subject to the constraint that all incoherent crosstalk errors must be exponentially suppressed by the filter. The impacts of the residual coherent errors are quantified via two parameters, p double and p triple , that, respectively, describe the probabilities that either two data qubits, or two qubits and an ancilla qubit, suffer correlated Z errors.",
                "In Table X, we compare the results of this modefrequency optimization for four-and five-mode unit cells. There are two important takeaways from these optimization results. The first takeaway is simply that the magnitude of the residual coherent errors is substantially reduced. Indeed, the total correlated error probability, p double + p triple , is over an order of magnitude smaller for the four-mode case than in the five-mode case. As we discuss below, this reduction can significantly impact logical error rates.",
                "The second important takeaway from Table X is that the four-mode unit cell can accommodate a larger filter bandwidth, which ultimately eases requirements on the lifetimes of the phononic resonators to achieve a desired value of \u03ba 1 /\u03ba 2 . As described in Appendix B, the constraint that all incoherent crosstalk errors be suppressed by the filter places an upper bound on the filter bandwidth, and this upper bound decreases as the number of modes in the unit cell increases. Reducing the number of modes from five to four thus enables us to increase the filter bandwidth. In particular, we find that the bandwidth can be increased by nearly a factor of 2 (from 4J = 2\u03c0 \u00d7 100 MHz to 4J = 2\u03c0 \u00d7 180 MHz). As described in Sec. II, the filter bandwidth constrains the achievable value of \u03ba 2 , meaning that an increased bandwidth enables an increased \u03ba 2 . Equivalently, an increased filter bandwidth eases the coherence requirement on the phononic resonators to achieve a desired value of \u03ba 1 /\u03ba 2 . From Fig. 3, we see that the factor of approximately 2 increase in bandwidth correspondingly lowers the T 1 requirement on the phononic resonators by roughly a factor of 2. TABLE X. Frequency optimization results. The parameters 4J and \u03c9 are given in units of 2\u03c0 \u00d7 MHz. The correlated error probabilities in the last three columns are expressed in terms of \u03b1 and g 2 . For realistic choices of |\u03b1| = \u221a 8 and g 2 /2\u03c0 = 2 MHz, the probabilities evaluate to C = 1.05 \u00d7 10 -4 and C = 1.23 \u00d7 10 -3 for the four-and five-mode configurations, respectively. See Appendix B for further details. Logical Z-error rates of the thin rotated surface code with five modes coupled to an ATS (which includes a transmon qubit and an additional readout mode in each unit cell and corresponds to the data in Fig. 8) and four modes coupled to an ATS (which excludes the transmon qubit and performs direct X -basis measurements). We labeled measurements with the transmon qubit as low measurement and the direct X -basis measurement as high measurement. For the direct X -basis measurement, the measurement error rate is fixed at 2 \u00d7 10 -3 for all values of \u03ba 1 /\u03ba 2 . Measurement error rates with the transmon qubit were obtained from Table III with five parity measurements.",
                "Having described the effects of the ATS-based X -basis readout scheme at the hardware level, we now consider effects at the logical level. We begin by quantifying the impact of the increased measurement error rate of the ATS-based readout scheme (see Table III) on the logical error rates. In Fig. 44, we plot the logical Z-error rate of the thin rotated surface code, both for the main-text architecture of (five-mode unit cell, transmon-based readout) and for the alternative architecture of this Appendix (four-mode unit cell, ATS-based readout). For the former architecture, we used the same data as shown in Fig. 8, while for the latter architecture (labeled high measurement), we fixed the measurement error rate to 2 \u00d7 10 -3 . As can be seen, even though the measurement error rate can be more than an order of magnitude larger for the ATS-based readout, the logical Z-error rates increase by a small amount in the low \u03ba 1 /\u03ba 2 regime. The reason the logical failure rate is not greatly affected by the large increase in measurement failure rates is that CNOT failures are the dominant source of noise. As such, we do not expect the overhead results of Sec. VIII to increase when using the alternative architecture of Fig. 43 because the same code distances can be used for implementing the algorithms of interest.",
                "Finally, we consider how the reduction in crosstalk (Table X) impacts logical error rates. Logical Z-error rates of the thin rotated surface code for the main-text architecture and the alternative architecture are plotted in Figs. 45(a) and 45(b), respectively, where correlated errors are simulated with probabilities given in Table X. The  X). The X -basis measurement error rates are obtained from Table III with five parity measurements. We compute the logical Z-error rates for different values of g 2 shown in the legend, and compare such results to the case where the crosstalk errors are not present. The results in (a) [respectively, (b)] are obtained with crosstalk error rates taken from the five-mode (four-mode) row of Table X with |\u03b1| 2 = 8. results reveal that the effects of crosstalk on logical errors are less severe in the alternative architecture. In particular, the main-text architecture can accommodate values of g 2 /(2\u03c0) up to approximately 2 MHz before the impacts of correlated errors become significant, while the alternative architecture can accommodate values twice as large g 2 \u223c 4 MHz before the impacts of correlated errors become significant. This increase in the maximum allowable g 2 can enable larger stabilization rates \u03ba 2 , or equivalently can reduce the requirement on the phonon-mode lifetime required to reach a given \u03ba 1 /\u03ba 2 ."
            ],
            "subsections": []
        },
        {
            "title": "APPENDIX I: STOP ALGORITHM",
            "paragraphs": [
                "When performing physical non-Clifford operations in between rounds of EC, in order to maintain the full effective code distance, it is crucial to use a fault-tolerant error-correction protocol, which satisfies the following definition (taken from Ref. [68,115]). Apart from being useful for proving thresholds of fault-tolerant error-correction schemes based on code concatenation [116], such a definition of fault-tolerant error correction is also relevant when performing physical non-Clifford operations on encoded qubits before directly measuring the data qubits. In particular, if one implements a MWPM decoder (see Ref. [117]) with O(d) rounds of stabilizer measurements (where d is the code distance of the error-correcting code protecting the data), a measurement error in the last round can lead to a logical failure and Definition 1 would not be satisfied. In many faulttolerant implementations, such a problem can be avoided by implementing non-Clifford operations via gate injection and stabilizer operations, followed by direct measurement of the data qubits (hence physical non-Clifford gates are never directly applied to the data qubits). An example of direct measurements of the data qubits after performing one round of stabilizer measurements for a d = 5 repetition code is given in Fig. 42. By measuring the data qubits, measurement errors can be treated as data qubit errors arising prior to performing the measurement [72]. As such, measuring the data directly acts as a round of perfect error correction.",
                "As was shown in Sec. VI, postselection can be avoided when preparing the logical |0 L and |1 L states (used to obtain the state |\u03c8 1 ) if we have a decoder that is robust to measurement errors in the last syndrome measurement round prior to applying the physical Toffoli gates. For the BUTOF protocol, we cannot directly measure the data prior to applying the physical Toffoli gates. Using ideas from Ref. [115], in this section we propose an algorithm, which tells us when to terminate the sequence of error syndrome measurements, which we call the STOP algorithm, and which satisfies Definition 1 when using the syndrome measurement from the last round to correct errors. Further, in Appendix J, we show how the STOP algorithm can be used with gate injection to perform all stabilizer operations of the repetition code. The goal of the STOP algorithm is to track consecutive syndrome outcomes s 1 , s 2 , . . . , s r and to compute the minimum number of faults, which could have caused this sequence of syndromes. In particular, let n diff be a counter, which tracks the minimum number of faults causing changes in syndrome outcomes, and consider the consecutive syndromes s k-1 , s k , and s k+1 . Given that a single fault can lead to two syndrome changes as in the example below, suppose we obtain different syndromes in rounds k and k + 1 (so that s k = s k+1 ). In order to decide whether to increment n diff by one, we must first check whether n diff was incremented after measuring the kth error syndrome. If n diff did not increase after the kth round, then we increment n diff by one. Otherwise, n diff remains unchanged.",
                "As an example, suppose a single fault occurs during the second round of stabilizer measurements of an EC protocol adding a weight-one error to the data qubits while also flipping the measurement outcome of one of the stabilizers (in this case Z \u2297n as shown in Fig. 46). Further, suppose the input error to the second round of the EC protocol E in has the error syndrome s(E in ) = s 1 , and that the error Z n E in has error syndrome s 3 = s 1 (here Z n is the Z error added to the data qubit arising from the two-qubit gate failure). Since the Z error flipped the measurement outcome of Z \u2297n , the syndrome s 2 measured during the second round can differ from both s 1 and s 3 .",
                "With the above example in mind, the STOP algorithm is given by Algorithm 1. To see why a decoding algorithm based on Algorithm 1 satisfies Definition 1, consider the case where the total number of input errors and faults during the EC is t = (d -1)/2 for a distance d errorcorrecting code. If at any time during the EC the same syndrome s j is measured tn diff + 1 times in a row, then it must have been the correct syndrome (with very high probability). The reason is that given the value of n diff , which counts the minimum number of faults compatible with the Algorithm 1. STOP algorithm syndrome history since the beginning of the current cycle of error correction, there would need to be more than t faults to cause all tn diff + 1 consecutive syndromes to be incorrect due to failures resulting in flipped measurement outcomes. As such one could use the syndrome s j to correct errors and terminate the protocol. Doing so, there could only be \u2264 t residual leftover errors that went undetected in the last measurement round.",
                "Similarly, if after measuring the r -1'th syndrome n diff gets incremented to n diff = t, then we know that at least t faults must have occurred during the EC. As such, by repeating the syndrome measurement one more time (resulting in the syndrome s r ) and using that syndrome to decode, there would need to have been more than t faults for s r to be the wrong syndrome (due to faults flipping some of the stabilizer measurement outcomes in the last round). Hence using s r to decode would result in residual errors with weight v \u2264 t (where, as stated at the beginning of the previous paragraph, the total number of input errors and faults during the EC is t).",
                "Given the above, we conclude that when using Algorithm 1, the sequence of syndrome measurements will terminate if one of the following conditions is satisfied:",
                "1. The syndrome s r is repeated tn diff + 1 times in a row. 2. The counter n diff gets incremented to n diff = t. Measure the syndrome one more time resulting in the syndrome s r . Use s r to decode.",
                "Decoding will succeed if the total number of input errors and faults during the EC cycle is \u2264 t.",
                "We now provide a few remarks. Firstly, given a particular error-correcting code and decoder along with the STOP algorithm for repeating the syndrome measurement, one can satisfy Definition 1 by using the last measured syndrome s r to decode while ignoring the entire syndrome history. Hence in such settings, one can use a simple code-capacity-type decoder to decode with s r (i.e., a decoder, which ignores measurement and space-time correlated errors). As an example, one can decode with the surface code using a MWPM or Union Find decoder (see Ref. [118]) on a two-dimensional graph instead of a threedimensional graph tracking the entire syndrome history. Doing so could significantly reduce the overall decoding time. In general however, the approach where the STOP algorithm is used to ignore the entire syndrome history apart the last syndrome s r does not have a threshold [119]. To see this, consider a distance d repetition code and a stochastic noise model where fault locations fail with probability p. After d rounds of repeating the syndrome measurement, there will be approximately pd 2 failures. For large distances d, with high probability the error syndrome will change in every round. Hence the probability of a measurement error in the final round will not depend on the past syndrome history and the decoder will fail to correct the errors with high probability.",
                "On the other hand, tracking the entire syndrome history and using Algorithm 1 to decide when to terminate the rounds of repeated syndrome measurement generally leads to lower failure rates and has a threshold. Indeed, when computing the memory failure rates of the repetition code using Algorithm 1 for deciding when to terminate the syndrome measurements), we found that performing MWPM on the entire syndrome history leads to lower logical failure rates compared to performing MWPM on a one-dimensional graph using only the final syndrome s r (note that the logical Z failure rates for the repetition code in Fig. 6 were computed by applying MWPM to the full syndrome history of the measured syndromes using the STOP algorithm). As such, the EC protocols used in this work when considering repetition codes implement MWPM on the entire syndrome history in conjunction with Algorithm 1 to decide when to stop measuring the error syndrome.",
                "We conclude this section by providing a lower and upper bound on the maximum number of syndrome measurement repetitions that can be performed using the STOP algorithm. For the case where there are no failures, it is straightforward to see that the syndrome measurement will be repeated t + 1 times. To find the upper bound, we consider the worst-case scenario, where (starting with n diff = 0) there are no failures in the first t rounds of syndrome measurement, so that the same syndrome is repeated t times. However, in round t + 1, a measurement error occurs and n diff gets incremented to n diff = 1. Now again, suppose there are no failures in the next t -1 rounds (so the same syndrome is repeated t -1 times) and a measurement error occurs in the t'th round, so that n diff is incremented to n diff = 2. Suppose the same pattern repeats itself until all t faults are exhausted resulting in n diff = t. By the protocol of the STOP algorithm, we must repeat the syndrome measurement one more time. For such a fault pattern, the total number of syndrome measurements s tot is then given by",
                "For low code distances and low-noise-rate regimes, the average number of repetitions will approach t + 1. However ,for large code distances, with high probability, the syndrome measurement outcome will change every round and thus n diff changes every other round. Thus after 2t rounds, n diff = t and the syndrome must be repeated one more time resulting in a total number of 2t + 1 = d rounds.",
                "It should then be expected that for large code distances, the performance of MWPM decoders based on a fixed d rounds will perform similarly to a decoder, which uses the STOP algorithm to terminate while implementing MWPM over the full syndrome history."
            ],
            "subsections": []
        },
        {
            "title": "APPENDIX J: STABILIZER OPERATIONS WITH THE REPETITION CODE",
            "paragraphs": [
                "In this section we describe how to do all stabilizer operations with the repetition code. However, the methods we provide apply to any family of Calderbank-Shor-Steane (CSS) codes."
            ],
            "subsections": []
        },
        {
            "title": "Computational basis states",
            "paragraphs": [
                "We begin by describing how to prepare the logical computational basis states of the repetition code. Doing so, we provide two schemes for preparing |0 L .",
                "Scheme 1: Using the fact that for an n-qubit repetition code |+ L = |+ \u2297n , preparing |+ \u2297n followed by a logical Z L = Z \u2297n measurement (see Fig. 47) projects the state to |0 L given a +1 outcome and |1 L given a -1 outcome. Since a measurement error on the ancilla results FIG. 47. Circuit for preparing logical computational basis states of the repetition code. A measurement error results in a logical X error applied to the data. Fault tolerance is achieved by repeating the measurement using the STOP algorithm. in a logical X L = X 1 error applied to the data, fault tolerance can be achieved by repeating the measurement of Z L using the STOP algorithm (where the syndrome corresponds to the ancilla measurement outcome) and applying the appropriate X L correction given the final measurement outcome. For instance, if |0 L is the desired state and the final measurement outcome at the termination of the STOP algorithm is -1, X 1 would be applied to the data. Lastly, note that only X errors can propagate from the ancilla to the data but these are exponentially suppressed by the cat qubits.",
                "Scheme 2: Here we present a more conventional approach for preparing the computational basis states, which involves only stabilizer measurements (see, for instance, Refs. [120][121][122]). Starting with the state |\u03c8 1 = |0 \u2297n , which is a +1 eigenstate of Z L , measure all stabilizers of the repetition code (each having a random \u00b11 outcome) resulting in the state",
                "If the measurement outcome of X k X k+1 is -1, the correction k j =1 Z j can be applied to the data to flip the sign back to +1. However, given the possibility of measurement errors, the measurement of all stabilizers X 1 X 2 , X 2 X 3 , . . . , X n-1 X n must be repeated. If physical non-Clifford gates are applied prior to measuring the data, then the STOP algorithm can be used to determine when to stop measuring the syndrome. Subsequently, MWPM is applied to the full syndrome history to correct errors and apply the appropriate Z corrections to fix the code space given the initial stabilizer measurements. After performing numerical simulations, we found that scheme 2 achieves lower logical failure rates compared to scheme 1. Further, since physical Toffoli gates are applied to the data qubits in order to prepare a |TOF magic state (see Sec. VI) and given the constraints imposed by our ATS architecture (which make performing global Z measurements very challenging using a single ancilla qubit), we always use scheme 2 along with the STOP algorithm when preparing logical computational basis states.",
                "Lastly, we remark that although the logical component of an uncorrectable error E (z) Z L (where E (z) is correctable) can always be absorbed by |0 L resulting in an output state |\u03c8 out = E (z) |0 L , it is still important to have a faulttolerant preparation scheme for |0 L (and thus to repeat the measurement of all stabilizers enough times). For instance, if a single fault results in a weight-two correctable Z error (assuming n \u2265 5), a second failure adding one or more data qubit errors during a subsequent part of the computation can combine with the weight-two error resulting in an uncorrectable data qubit error. Hence, such a preparation protocol would not be fault tolerant up to the full code distance."
            ],
            "subsections": []
        },
        {
            "title": "Implementation of logical Clifford gates",
            "paragraphs": [
                "Since the CNOT gate is transversal for the repetition code, we focus on implementing a generating set of singlequbit Clifford operations. Recall that the Clifford group is generated by P (2)  n = H i , S i , CNOT ij , where ",
                "In Fig. 48 we provide a circuit for implementing S L , which requires |i L as an input state, a transversal CNOT gate, and a logical Z-basis measurement. If a -1 measurement outcome is obtained, we apply a Z L correction to the data. Note however that a measurement error can result in a logical Z L being applied incorrectly to the data. As such, to guarantee fault tolerance, one can repeat the circuit of Fig. 48 and use the STOP algorithm to decide when to terminate. The final measurement outcome is then used to determine if a Z L correction is necessary. The implementation of S L can thus be summarized as follows.  "
            ],
            "subsections": []
        },
        {
            "title": "S L gate implementation:",
            "paragraphs": [
                "1. Implement the circuit in Fig. 48 and let the measurement outcome be s 1 . 2. Repeat the circuit in Fig. 48 and use the STOP algorithm to decide when to terminate. 3. If the final measurement outcome s r = +1, do nothing, otherwise apply",
                "The circuit for implementing the logical Q = SHS gate is given in Fig. 49. The circuit consists of an injected |i L state, a transversal CNOT gate and a logical X -basis measurement is applied to the input data qubits. If the measurement outcome is -1, Y L is applied to the data. As with the S L gate, we repeat the application of the circuit in Fig. 49 to protect against measurement errors. The full implementation of Q L is given as follows. Q L gate implementation:",
                "1. Implement the circuit in Fig. 49 and let the measurement outcome be s 1 . 2. Repeat the circuit in Fig. 49  and one CNOT gate to obtain a CZ gate, we provide a more efficient circuit in Fig. 50. Lastly, we point out that since the circuits in Figs. 48 and 49 contain only stabilizer operations and injected |i L states, using the STOP algorithm to repeat the measurements is not strictly necessary. For instance, one could repeat the measurement a fixed number of times and majority vote instead of using the STOP algorithm. However, in low-noise-rate regimes, the STOP algorithm can potentially be much more efficient since the average number of repetitions for the measurements can approach t + 1 where t = (d -1)/2."
            ],
            "subsections": []
        },
        {
            "title": "APPENDIX K: GROWING ENCODED DATA QUBITS TO LARGER CODE DISTANCES WITH THE REPETITION CODE",
            "paragraphs": [
                "In this section, we provide a simple protocol for growing a state |\u03c8",
                "in a distance d 2 > d 1 repetition code. We emphasize that the protocol presented in this section is applicable to arbitrary states and will be used for growing |TOF states prepared using the fault-tolerant methods of Sec. VI to larger code distances.",
                "Let",
                "Furthermore, the stabilizer group for the distance d 2 repetition code is given by",
                "In the remainder of this section, we define g  is measured as -1, apply the correction",
                "As a remark, the corrections stated in step 3 and 5 can be postponed to a later time after the growing protocol is completed. The reason is that one can use the entire syndrome history from each step, in addition to the syndromes measured after the states have merged to apply the appropriate corrections. The growing scheme involves two blocks, the first being the state |\u03c8 d 1 , which we want to grow to |\u03c8 d 2 . The second block involves the set of qubits, which are prepared in the state |\u03c8 2 d 1 and stabilized by S d 1 (steps 1-3). The key is to measure the boundary operator X d 1 X d 1 +1 between the two blocks, which effectively merges both blocks into the encoded state |\u03c8 d 2 and constitutes a simple implementation of lattice surgery [76,78,123,124]. To see this, consider the state prior to step 4:",
                "+ \u03b2X 1",
                "where we used",
                "and performing the correction",
                "The rounds of repeated stabilizer measurements in steps 3 and 5 are required due to the random outcomes and measurement errors, which can occur when performing the appropriate projections. A pictorial representation for the growing scheme is shown in Fig. 51."
            ],
            "subsections": []
        },
        {
            "title": "APPENDIX L: TOFFOLI SIMULATION TWIRLING APPROXIMATION",
            "paragraphs": [
                "To simulate the fault-tolerant preparation of the |TOF state taking into account all fault locations, we implement Monte Carlo methods using a Gottesman-Knill-type simulation [125] to avoid running into scalability issues. However, since the circuit in Fig. 14(b) contains physical Toffoli gates, some type of approximation is necessary to perform a Gottesman-Knill-type simulation with such circuits.",
                "In order to determine the most appropriate type of approximation, writing a Toffoli gate as CCX, we first observe that",
                "for some arbitrary state |\u03c8 . In other words, propagating a Z error through the target qubit of the Toffoli gate results in a CZ error on the two control qubits. Recall that we label the three logical qubits by {A, B, C}. In what follows, we consider the transformation of the |TOF state with input data qubit Z errors on the third block when using a single |+ ancilla to measure g A . Note that all conclusions remain unchanged if instead we used the GHZ state of Fig. 14(b).",
                "Let A k be a subset of k qubits and consider k \u2265 1 data qubit errors on the third block expressed as",
                "We have that",
                "After applying g A and propagating the Z errors through the Toffoli gates, |\u03c8 in becomes",
                "where k j =1 Z (A) j are products of Z errors on the first data block, which have identical support with the Z errors on the third block. After measuring the ancilla in the X basis, a \u00b11 measurement outcome results in the state |\u03c8 f given by",
                "From Eq. (L4), we see that when performing one round of error detection of the first block A, the error I \u00b1 k j =1 Z (A) j / \u221a 2 will project either to I or k j =1 Z (A) j with 50% probability each unless k j =1 Z (A)",
                "L in which case the state remains unchanged.",
                "Given the above, when performing our Gottesman-Knill-type simulations when measuring g A , if the input Z errors to the third block are k j =1 Z (C) j , we flip the GHZ ancilla measurement outcome with 50% probability and do the following: if k < d, we add the Z errors k j =1 Z (A) j to the first block with 50% probability. If k = d, we add Z L to the first block with 100% probability.",
                "Note that such a simulation method is exact when k < d and introduces only a discrepancy when k = d. Since such events are rare, our approximation method differs from an exact simulation of the bottom-up |TOF state preparation scheme only by a small amount."
            ],
            "subsections": []
        },
        {
            "title": "APPENDIX M: FITTING PROCEDURE FOR MEMORY AND LATTICE SURGERY",
            "paragraphs": [
                "Here we extend the discussion of lattice surgery presented in Sec. V as well as describe and justify the fitting procedures used in our error-correction simulations. These fits enable us to reliably extrapolate to larger code",
                "Step 1: Prepare",
                "Step 2: Merge",
                "Step 3: Split",
                "FIG. 52. The three stages of lattice surgery corresponding to cross sections (time slices) of the lattice-surgery space-time diagram in Fig. 11.",
                "Step 1 prepare: data qubits between the surface-code blocks are prepared in the |0 state.",
                "Step 2 merge: start measuring the Z and X stabilizers indicated. The product of the X stabilizers (highlighted with white vertices) yields the outcome X L1 X L2 . However, a measurement error on a white vertex will flip the outcome and so these stabilizer measurements must be repeated d m times, with d m chosen sufficiently large to suppress timelike errors to the desired probability.",
                "Step 3 split: The qubits between the initial surface-code blocks are measured in the Z basis. Note that it is not possible to use X -basis measurements to disentangle as this would measure X L1 and X L2 . If the parity of the single-qubit Z measurements is \"-1\" then we must apply a Pauli correction X L1 (or equivalently X L2 ) as a correction. Both the measurement of X L1 X L2 and the estimated Pauli correction must be done fault tolerantly after having decoded the syndrome. In the case of X L1 X L2 , we choose one particular time slice t p and make an initial guess by multiplying all the white vertices at time t p . If the decoder assigns a measurement error to any white vertex at time t p , then we must account by flipping the X L1 X L2 . If the accumulated physical Z errors before time t p anticommute with X L1 X L2 then we flip the outcome. For a similar discussion of lattice surgery see Ref. [124]. Compared to Figs. 2 and 5 we use a similar graphical representation but for simplicity omit the location of the transmon, readout qubit, and ATS.",
                "sizes than simulated, which is required for our analysis of resource costs for large-scale quantum computations (see Sec. VIII).",
                "In addition, to presenting results for memory errors we also consider lattice-surgery errors. Lattice surgery is the primary technique we consider for performing Clifford gates and magic state injection. It is a procedure for measuring multiqubit logical Pauli operators such as X \u2297m L with m \u2265 2. It can be regarded as a code deformation where the m logical qubits are temporally merged into a code of m -1 logical qubits, and then split into their constituent m logical qubits. For the simple m = 2 case, we illustrate the space-time diagram for this process in Fig. 11 of the main text. Here we present a more detailed diagram in Fig. 52.",
                "An incredibly powerful and beautiful feature of lattice surgery is that decoding via matching naturally extends over this 3D space-time structure without being interrupted by lattice surgery. However, some care is needed to correctly account for boundaries and assess different failure modes. For a planar surface code, it is well known that one must allow defects to match with the appropriate boundaries in the space direction. When performing lattice surgery, it is also important to match to appropriate boundaries in the time directions.",
                "To understand boundary effects, consider the more detailed explanation of lattice surgery in Fig. 52. The procedure starts and ends with Z-basis state preparations and measurements. A bit-flipped single-qubit measurement or preparation will yield a pair of Z syndrome defects. That is, the initial and final rounds of Z stabilizer measurements are semi-ideal as they are reconstructed from single-qubit information so that any defects occur in pairs. These short X strings are then easily matched. In contrast, an X syndrome measurement error (at the start and end of lattice surgery) can lead to an isolated defect and is potentially harmful as it flips the outcome of the lattice-surgery operation. However, for such an isolated defect near a time boundary, the best explanation is clearly an isolated measurement error. Therefore, we match these defects to red boundaries in the time direction.",
                "As a warm up to discussing the probability of timelike errors, we first recap the error-scaling properties of memory and logical Z errors. Consider a d x by d z surface-code patch storing a logical qubit for t surface-code cycles. We expect the total logical error probability to scale as [1exp(-\u03bbt)]/2 for some constant rate \u03bb, which for small \u03bb is approximately \u03bbt/2. Furthermore, as d x increases the number of paths across the code increases linearly, so we expect that \u03bb \u221d d x and the total Z-logical probability to scale as For simulation purposes, standard practice is to assume: at time zero, the system is in a \" + 1\" eigenstates of all stabilizers; at time t, the round of stabilizer measurements is ideal. This assumption introduces a finite-size effect error into P Z /(d x t). This is suppressed by taking t large, and community folklore suggests that t = max[d z , d x ] will suffice though one could push higher. The exact form of function F can be quite involved, though we know it will be exponentially suppressed by the relevant distance d z .",
                "Taking our sole experimental parameter to be \u03ba 1 /\u03ba 2 we find good fits of the form",
                "where a z , b z , c z are fitted parameters. For small d x , there will be a finite-size effect so the scaling is not linear in d x . However, we can still use such a fit when d x is held constant provided we do not attempt to extrapolate to larger d x . Note that Eq. (M2) is not necessarily a leading-order fit of the classical form O(p (d-1)/2 ). Since the probability of logical failures has a entropic and combinatorial component, it is dominated by errors with a weight much larger than (d -1)/2. As such, we do not attempt a leading-order fit but rather it is appropriate to fit the scaling exponent c z . We present the result of this fitting procedure in Fig. 53 and observe that it works well over the interval 10 -5 \u2264 \u03ba 1 /\u03ba 2 \u2264 10 -4 . At higher values of \u03ba 1 /\u03ba 2 , higher-order contributions to a logical Z failure become important. Similarly, at lower values of \u03ba 1 /\u03ba 2 , lower-order contributions become important. Even if a more sophisticated fitting function of \u03ba 1 /\u03ba 2 is assumed, we expect a finite range of applicability since there are other relevant experimental parameters in the noise model. Similar reasoning can be applied to timelike errors. The relevant boundary has an area d x , where is the distance between the code blocks. As with Z-logical errors, the exponential decay of timelike errors follows from a percolation theory analysis [126,127] of a string connecting the timelike boundaries. As always in percolation problems, the probability of a percolation event is exponentially suppressed in the distance between the boundaries (whenever below some threshold). The relevant boundaries are separated by a distance d m , which we call the measurement distance, and physically corresponds to the number of repeated rounds of syndrome measurements during the merge step. Therefore, we fit to the ansatz",
                "where a m , b m , c m are fitted parameters. To obtain an estimate of P M we simulate the middle group of qubits in Fig. 52. We wish to isolate the timelike errors and so freeze out Z-logical errors by assuming that the leftmost and rightmost qubits are ideal and error-free. This is analogous to the assumption of ideal measurements in a memory simulation. Furthermore, since the d z distance is temporally extended during lattice surgery, such errors will be rare in comparison. Again, this idealization introduces a finite-size effect that vanishes as grows relative to d m .",
                "We present the result of this fitting procedure for thin surface codes in Fig. 53 and observe that it works well over the interval 10 -5 \u2264 \u03ba 1 /\u03ba 2 \u2264 5 \u00d7 10 -4 . We did not collect data for \u03ba 1 /\u03ba 2 \u2265 5 \u00d7 10 -4 as we had already identified that the surface-code overhead will be prohibitively large in this regime.",
                "To the best of our knowledge, there have not been previous simulations that investigate timelike errors in codes with boundaries and/or using circuit-level noise. For instance, timelike errors were accounted for by Raussendorf and Harrington [128] but using a toy, phenomenological noise model and periodic boundary conditions in both space and time.",
                "Widespread practice is to set d m = d x = d z but there is no a prior reason to believe this is optimal. Indeed, just as physical bias in X and Z noise leads to an asymmetry in our choice of d x and d z , a realistic noise model will influence the optimal choice of d m . In later calculations we find that d m = d z -2 is the most common optimal choice for the main algorithm. Furthermore, in the design of magic state distillation factories, the timelike errors are not critically important (see Table XIV) and so inside the factory d m can be set much smaller (by about a factor 1/2) than one would otherwise expect."
            ],
            "subsections": []
        },
        {
            "title": "APPENDIX N: EDGE WEIGHTS AND DECODING GRAPHS FOR THE REPETITION AND SURFACE CODES",
            "paragraphs": [
                "In this section we provide the decoding graphs used to implement MWPM with the repetition and surface codes considered in this paper. We also provide details for computing the edge weights of all edges in a given graph."
            ],
            "subsections": []
        },
        {
            "title": "Repetition-code decoding graphs",
            "paragraphs": [
                "The circuit for measuring the stabilizer of the d = 5 repetition code is shown in Fig. 54(a) and can straightforwardly be generalized to arbitrary code distances. The corresponding graph for decoding the d = 5 repetition code using MWPM with five rounds of syndrome measurements is shown in Fig. 54(b). The purple vertices correspond to the measurement outcome of each ancilla qubit (prepared in |+ and measured in the X basis), and the horizontal edges correspond to the physical data qubits. A vertex is highlighted if the measurement outcome of the corresponding ancilla is nontrivial. We also add spacelike boundary vertices and edges (shown in red). For a given syndrome measurement round [corresponding to a one-dimensional slice of the graph in Fig. 54 boundary vertex is highlighted if on odd number of bulk vertices in the corresponding one-dimensional slice are highlighted. To deal with measurement errors, dashed gray vertical edges are added and connect vertices of two onedimensional graphs. Lastly, cross-diagonal edges (shown in green) are added to deal with space-time correlated errors arising from failures at CNOT gate locations (see below for explicit examples). More details for implementing graph-based decoding using MWPM can be found in Refs. [82,129,130]. We now describe how to compute the edge weights for each edge type of the graph in Fig. 54(b). For a given edge e, we must first compute the probability P e of all failure events resulting in e being highlighted. The weight w e for the edge e is then given by w e =log(P e ) (see, for instance, Refs. [99,129,131]). Such a prescription ensures that edges arising from more likely failure events are chosen with higher probability when finding the lowest weight path between two highlighted vertices. In what follows, we refer to P e as the edge-weight probability for the edge e.",
                "The first and last data qubits in Fig. 54(a) have an extra idling location compared to all other data qubits, and their edge-weight probabilities are labeled P h 1 and P h 2 , whereas the other data qubits have edge-weight probabilities labeled by P h . The dashed gray vertical edges connecting are labeled P v and the green space-time correlated edges are labeled P d . Next we define P s to be the probability of a |+ state preparation error, P m the probability of a measurement error, P i the probability of an idle error and P Z 1 , P Z 2 , and P Z 1 Z 2 the probability of a Z \u2297 I , I \u2297 Z and Z \u2297 Z CNOT failure (where the first qubit is the control qubit of the CNOT).",
                "We now show how to compute P h and P d to leading order (the other edge-weight probabilities can be obtained using analogous methods). In the case of a single failure, a bulk horizontal edge (say corresponding to an error on the data qubit q j ) can be highlighted if either a Z error occurs at the idle location during the preparation of |+ , a Z \u2297 Z failure on the CNOT gate at the second time step with q j as a target qubit, or an I \u2297 Z failure on the CNOT gate on the third time step occurring in the previous syndrome measurement round. Hence we have",
                "and",
                "where P (t 1 ) h = P h in the first syndrome measurement round, and P (t>t 1 ) h = P h in all subsequent syndrome measurement rounds. Now suppose a Z \u2297 Z error occurs on a CNOT gate in the third time step of the syndrome measurement round t resulting in a Z data qubit error on qubit q j while also flipping the measurement outcome of the ancilla a k . Note that if a Z error had occurred on qubit q j prior to applying the two CNOT gates, both ancillas a k and a k+1 would be measured nontrivially. Hence in round t + 1 (and assuming no other failures), the measurement outcome of a k will not change whereas the measurement outcome of a k+1 will change. To ensure that such an event is treated to leading order, we introduce a green cross-diagonal edge as seen in Fig. 54(b). Also note that a I \u2297 Z error on a CNOT in the second time step also results in such an edge. Hence we have that",
                "A similar analysis results in the following expressions for the remaining edge-weight probabilities:",
                ")",
                "h , (N5)",
                ")",
                "and"
            ],
            "subsections": []
        },
        {
            "title": "Surface-code decoding graphs",
            "paragraphs": [
                "The two-dimensional graphs for decoding the X -and Zstabilizer measurement outcomes of a d x 5 and d z = 7 surface code, along with their corresponding edge-weight probability labels, are shown in Fig. 55. We show below the edges that need to be added when considering measurement errors and space-time correlated errors arising from CNOT gate failures. However, we first provide edge-weight probabilities for the edges of the two-dimensional graphs.",
                "Let G TLBRZ with all other labels in Fig. 55(c) representing boundary edge-weight probabilities. In order to simplify the expressions for the edge-weight probabilities, we define the following function:",
                "In what follows, we define P",
                "CNOT to be the probability that a CNOT gate failure results in a two-qubit Pauli error of the form P i \u2297 P j . We also define P (P i ) id to be the probability that a single-qubit idling location results in a P i Pauli error on that qubit. To further simplify the edgeweight probability polynomials, we define the following probabilities:",
                "P (1)  ZZCX = P (ZZ) CNOT + P  BLTRX = (P (1)  ZZCX , P (1)  IZCX , P (1)  d ; 1, 1, 1), (N17) P (2D) TLBRX = (P (1)  ZZCX , P (1)  IZCX , P (1)  ZICX , P (2)  IZCX , P (1)  d ; 2, 2, 1, 1, 1), (N18) P C1X = (P (3)  IZCX , P (2)  ZICX , P (1)  d ; 1, 1, 1), (N19)",
                "P TB1X = (P (1)  ZZCX , P (1)  IZCX , P (2)  IZCX , P (1)  d ; 2, 1, 1, 1), (N21) P C2X = (P (3)  IZCX , P (2)  IZCX , P (1)  ZZCX , P (1)  d ; 1, 1, 1, 1), (N22) P MRX 1 = (P (3)  IZCX , P (2)  ZICX , P (1)   . We have that P (bulk) d 1 ,X = (P (1)  IZCX , P (1)  ZZCX , P (2)  ZICX ; 1, 1, 2), (N58) and",
                "= (P (1)  IZCX , P (1)  ZZCX , P (2)  ZICX ; 1, 1, 1). (N59)",
                "The edge-weight probability P d 2 ,X [represented by the light green edges in Fig. 56(a)] is given by P d 2 ,X = (P (1)  IZCX , P (1)  ZZCX ; 1, 1). (N60)",
                "Lastly, the edge-weight probability P d 3 ,X [represented by the yellow edges in Fig. 56(a)] is given by",
                "Similarly, for the graph G (3D)",
                ", the edge-weight probability P d 1 ,Z (represented by the light green edges) is given by P d 1 ,Z = (P (1)  XICX , P (1)  XXCX ; 1, 1 = (P (1)  XICX , P (1)  XXCX , P (1)  IXCX ; 1, 1, 1). (N64)",
                "Lastly, the edge-weight probability P d 3 ,Z (represented by the yellow edges) is given by"
            ],
            "subsections": []
        },
        {
            "title": "Adding edges for dealing with correlated errors",
            "paragraphs": [
                "In this section we provide a modified version of the graph G (3D) (d x ) (described in Appendix N 2), which includes extra edges to deal with two-qubit and three-qubit correlated errors arising from the micro oscillations described in Appendix B 5.",
                "For the purposes of the edge-weight analysis, in Fig. 57(a), we illustrate fictitious two-qubit and three-qubit gates, which act as the identity and which are applied immediately prior to the X -basis measurements of the red plaquettes. The two-qubit correlated errors can be viewed as an Z \u2297 I \u2297 Z-type error at a three-qubit gate location, where the Z errors act on the qubits adjacent to the gray squares and green circles of such gates. Such errors occur with probability P cd . Similarly, the three-qubit correlated errors can be viewed as an Z \u2297 Z \u2297 Z-type error at a threequbit gate location. Such errors occur with probability P ct . Additionally, there can be correlated errors occurring between the ancilla and data qubits at the top and bottom boundaries of the lattice in Fig. 57(a). Hence, we add fictitious two-qubit gate locations at such boundaries as shown in the figure . \nIn order to incorporate the different types of correlated errors mentioned above into our MWPM decoding protocol, extra edges are added to the graph G (3D) (d x ) as shown in Fig. 57(b). The first type of extra edges are two-dimensional cross edges shown in orange that deal with two-and three-qubit correlated errors arising at the three-qubit fictitious gate locations of Fig. 57(a). The edgeweight probabilities of such edges are labeled P (bulk)  cross . Due to boundary effects, we also add dashed orange edges with edge-weight probabilities labeled P (bound)  cross . Additionally, extra space-time correlated edges (shown in red) are added at the bottom row of the graph in Fig. 57(b) with edge-weight probabilities labeled by P d,corr . Note that the two-qubit correlated errors arising at the top boundary of Fig. 57 edge-weight probabilities of the added edges in addition to the renormalized edges are given by P (bulk)  cross = (P ct P cd ; 2, 2), (N66) is given by Eq. (N59). Similarly, at the top row of Fig. 57(b), we have",
                "d 2 ,X = (P (1)  IZCX , P (1)  ZZCX , P ct ; 1, 1, 1), (N77) whereas anywhere else in the graph P d 2 ,X is given by Eq. (N60)."
            ],
            "subsections": []
        },
        {
            "title": "Decoding timelike errors",
            "paragraphs": [
                "In this section, we show how the decoding graphs in addition to the MWPM decoding protocols need to be modified for correcting timelike errors discussed in Appendix M. Since visualizing three-dimensional graphs can be challenging, we focus on correcting timelike errors in the context of the repetition code, even though timelike errors occur in surface-code patches when implementing our lattice-surgery schemes. However, the main techniques discussed in the context of the repetition can straightforwardly be applied to the rotated surface code.",
                "An example of a decoding graph for timelike errors occurring in a d = 5 repetition code with d m = 4 is given in Fig. 58. Note that unlike Fig. 54 As explained in Appendix M, we have removed the left and two-dimensional black edges (which correspond to the left and rightmost qubits) to isolate timelike errors. explained in Fig. 11. In particular, we are considering a setting analogous to Fig. 52, where data qubits between two repetition-code patches are initially prepared in the |0 state, and the product of the X stabilizers yields the outcome X L1 X L2 . Note that although the measurement of each X stabilizer in the first round is random, the parity of the product of all measurement outcomes gives the outcome of X L1 X L2 . Due to the possibility of measurement errors, measurements of the X stabilizers are repeated d m times. MWPM is then performed over the entire syndrome history in order to determine if measurement errors occurred during the measurement of X stabilizers in the first round. We thus summarize the decoding protocol as follows:",
                "1. Repeat the measurement of all X stabilizers d m times. 2. Implement MWPM using a timelike decoding graph (such as the one in Fig. 58). If there is an odd number of highlighted vertices (purple vertices in Fig. 58), highlight a boundary vertex (the particular choice is irrelevant). 3. Let v (1)  j correspond to the j th X -stabilizer measurement outcome in the first round (represent by the j th purple vertex, starting from the left, in the first layer of the graph in Fig. 58). If there are highlighted timelike edges (i.e., vertical edges) incident to v (1)  j , flip the measurement outcome of v (1)  j . 4. Let \u1e7d(1) j correspond to the values of v (1)   j after implementing MWPM and performing the appropriate measurement flips described in the previous step. The outcome v f of X L1 X L2 is given by v",
                "In Fig. 59, we provide two examples for the implementation of the timelike decoder. In Fig. 59(a), we consider the case where a single measurement error occurs in the first round when measuring the stabilizer X 2 X 3 . Since the syndrome changes between the first and second round, the second vertex (starting from the left to right) of the second two-dimensional layer is highlighted. A boundary vertex is also highlighted to ensure the total number of highlighted vertices is even. After implementing MWPM, the minimum weight path connecting the two highlighted vertices correctly passes through v (1)  2 in the timelike direction. The 2 whose outcome is correctly flipped (illustrated by the yellow star). (b) Same as in (a) but with an additional measurement error occurring in the second round when measuring X 2 X 3 . In this case, the minimum weight path matches to the top boundary and fails to flip the measurement outcome of v (1)  2 (which is incorrect given the measurement error in the first round) resulting in a logical failure.",
                "decoder then flips the measurement outcome of X 2 X 3 in the first round resulting in the correct parity for the he outcome of X L1 X L2 . In Fig. 59(b), we consider a similar setting but with two consecutive measurement errors of the stabilizer X 2 X 3 occurring in the first and second round. In this case, the syndrome changes only between the second and third round resulting in the red highlighted vertex shown in Fig. 59(b). After implementing MWPM, the minimum weight path connect to the top boundary and so the measurement outcome of X 2 X 3 in the first round is incorrectly left unchanged resulting in a logical failure.",
                "We conclude this section with an important remark. Suppose a measurement error occurs in the first round when measuring the X -type stabilizer S (x) j of a given code. In order to prevent highlighted timelike edges from being incident to the vertex v (1)  j , one requires additional measurement errors such that minimum weight paths are matched in the top timelike portion of the decoding graph [as in Fig. 59(b)]. By increasing d m to d m + 2, one requires an additional measurement error to guarantee that the minimum weight path is not incident to v (1)  j , thus explaining the scaling in Eq. (M3)."
            ],
            "subsections": []
        },
        {
            "title": "APPENDIX O: TOFFOLI STATE DISTILLATION (TDTOF) 1. Prior state of the art",
            "paragraphs": [
                "Here we give a high-level comparison of how our TDTOF protocol compares to the prior state of the art in terms of magic state conversion rates.",
                "Early protocols for fault-tolerant quantum computation focused on TOF state preparation in concatenated codes [132] or they protected against one type of error [133]. However, none of these protocols are suitable for protecting against generic noise in topological (e.g., repetition or surface) codes.",
                "A more modern approach to magic state distillation uses a supply of low-fidelity T magic states. There are many protocols for distillation of noisy T states to purer T states [37,38,40,[134][135][136]. One can also use T states as input to protocols that output other types of magic states, including TOF states [137][138][139][140][141][142]. For instance, there were parallel discoveries of protocols [137,138] that distill one TOF state from eight noisy T states, which we write as 8T \u2192 1TOF. This was later generalized using synthillation [140,141] to a family of protocols (6k + 2)T \u2192 kTOF for any integer k. However, in some settings, the supply of noisy TOF states can be prepared with better fidelities than the noisy T states. For instance, in this paper we have shown that in system with highly biased noise we can use a repetition encoding and the BUTOF protocol to realize TOF state at better fidelities than physical TOF gates, with only a mild additional resource cost.",
                "It has been previously noted [143] that triorthogonal codes enabling (6k + 8)T \u2192 (2k)T state distillation can also be lifted to perform (6k + 8)TOF \u2192 (2k)TOF. The conversion rate of these protocols is 2k/(6k + 8), which is poor when k is small (starting at 1/7 for k = 1) but improving when k is larger (approaching 1/3 for k \u2192 \u221e). However, the ratio of inputs to outputs is not the sole metric of importance; also crucial is the space-time complexity of the Clifford circuit implementing the distillation protocol. Previous analysis has found that the space-time complexity of Clifford distillation circuits tends to be more favorable for simpler protocols using smaller block sizes [79,90,135] and that this effect can outweigh the improvement of conversion rate in the asymptotic regime. In other words, the desiderata for distillation protocols converting n \u2192 k magic states, are that the protocol has a good rate, so k/n is large; the protocol is compact so n is as small as possible. These desiderata are in tension since rates tends to improve asymptotically as block size n is increased. A protocol satisfying these desiderata, will likely have a small space-time footprint when compiled down to physical qubits and gates. In this work, we present a 8TOF \u2192 2TOF protocol that protects against any single location fault (of X , Y, or Z type), so it has a relatively high conversion rate of 1/4 without needing to scale to large blocks. In contrast, to achieve the same conversion rate using the ideas of Ref. [143] would require a much larger 32TOF \u2192 8TOF protocol."
            ],
            "subsections": []
        },
        {
            "title": "Transversality proofs",
            "paragraphs": [
                "Here we prove that the trio of [[8, 2, 2]] codes introduced in Sec. VII have the required CCZ tranversality properties. Recall that CCZ is a three-qubit gate that adds a \"-1\" phase to the state |111 and \"+1\" to all other computational basis states. The corresponding magic state |CCZ differs from |TOF by a single Hadamard gate. For reasons of mathematical elegance, it is simpler to work mostly in terms of |CCZ state distillation, but our final description of the distillation protocol will be presented in terms of |TOF states.",
                "For our trio of codes, each block encodes k = 2 logical qubits into n = 8 physical qubits and can detect an error on any single qubit. In the main text, we define the code using Fig. 16 and for completeness we give an algebraic definition here. All three code blocks one X stabilizer X \u22978 but different logical X operators",
                "where the index {A, B, C} labels the three different code blocks and the numerical index labels the two logical qubits in this code block. We write (. . .) D=A,B,C to emphasize that the operator acts nontrivially on code block D and trivially on other code blocks. While the code blocks share the same X stabilizer, they will have different Z stabilizers as a consequence of having different logical X operators.",
                "We say a set of [[n, k, d]] codes is CCZ transversal whenever CCZ \u2297n performs a logical CCZ \u2297k gate. Note that if we take three copies of a CSS code that has a transversal T gate (so that T \u2297n = T L or similar, then it must also be CCZ transversal). This is simply because CSS codes have transversal CNOT gates and we can synthesize CCZ gates from CNOT and T gates. Essentially, this is the observation exploited to construct (6k + 8)TOF \u2192 (2k)TOF protocols [143]. However, it is possible for a trio of codes to be CCZ transversal, but not be T transversal. To the best of our knowledge, this was first shown for the 3D surface codes by showing an equivalence (via unfolding) to 3D color codes [144]. Later, Vasmer and Brown gave a more direct proof that the 3D surface codes are CCZ transversal [145].",
                "Here, we use similar proof techniques to Vasmer and Brown [145], though generalized (to k > 1), and with a new code construction so that the code does not appear to be a surface code. From just the X stabilizer and logical operator information, we prove that our trio of codes are CCZ transversal. The key element of the proof is a lemma relating tranversality to the support of logical X operators and X stabilizers. The lemma requires that for j = 1, 2, the operators X LjA , X LjB , and X LjC share support on an odd number of qubit indices. Furthermore, we need that for any other choice of three X operators (either logical X or X stabilizer) with one selected from each code block, they must share support on an even number of qubit indices. It is easy to verify the operators provided above have this property.",
                "We define codes here using slightly different notation from the main text. Given an n-qubit bit string s = (s 1 , s 2 , . . . , s n ), we use X [s] := \u2297 j X s j . For example, if",
                "With this notation we can define an [[n, k, d]] CSS code using a binary G-matrix representation as follows.",
                "Let G be a binary matrix that is row-wise linearly independent and partitioned as follows:",
                "where G has n columns and G 1 has k rows. Letting m denote the number of rows in G 0 , then for a nontrivial (d \u2265 2) code we know m \u2265 1. Here, we review the relevant facts for G matrices, but for additional details and proofs refer the reader to Refs. [89,[140][141][142]. This allows us to define a CSS code with all-zero logical state",
                "Note we use bold font for row vectors. The notation uG 0 represents left multiplication of matrix G 0 by the row vector u, performed modulo 2, which will produce a length n row vector describing a physical, computational basis state. The set of all uG 0 corresponds to the row span of G 0 and form a group under addition modulo 2. Furthermore, logical computation basis states can be represented by a k-bit string x = (x 1 , . . . , x k ) as follows:",
                "where xG 1 is again obtained by matrix multiplication (modulo 2) and is a constant shift identifying a coset of the group generated by addition (modulo 2) of rows of G 0 . We can compress this notation slightly by noting",
                "where (x, u) is the row vector resulting from joining u and x. Again, note that Eq. (O7) should be read as modulo 2 and this will be the convention for such expressions throughout the remainder of this Appendix. The j th logical X operator, denoted X Lj , ought to flip the |0 L state to |(\u00f4 j ) L state, where \u00f4j is a unit vector with a single \"1\" entry at the j th location. It is straightforward to verify that X Lj = X [\u00f4 j G 1 ] performs the required flip and that \u00f4j G 1 is equal to the j th row of G 1 . Therefore, the logical operators of the code are given by the row vectors of G 1 . Furthermore, for every g in the row span of G 0 , the operator X [g] is an X stabilizer of the code space, and this enumerates all the X stabilizers.",
                "As a final notational preliminary, we make use of a triple dot product between triples of vectors. If a, b, and c are binary vectors of equal length, we define",
                "which we again evaluate modulo 2. It is useful to note that this counts the parity of the number of locations where operators X [a], X [b], and X [c] all act nontrivially. This G-matrix representation was also used for triorthogonal codes [37] and quasitriorthogonal codes [140,141] except we are interested in different transversality properties and so we require different constraints on the weight of rows in G 0 and G 1 . The additional constraints determine the transversality properties that we summarize with the following result, which is a slight generalization (beyond k = 1) of the proof techniques used by Vasmer and Browne [145]. [[n, k, d]] codes. Additionally, assume the following triple dot product conditions [recall Eq. (O8)]:",
                "where \u00f4p is a binary unit vector with 1 in location p and 0 everywhere else. Then it follows that a physical CCZ \u2297n realizes a transversal, logical CCZ \u2297k .",
                "Let us remark on what Eq. (O9) means in terms of operators. Observe that when p \u2264 k, the operator X [\u00f4 p G D ] is the pth logical operator for code block D \u2208 {A, B, C}. Therefore, the condition of Eq. (O9) tells us that the X Lp logical operators must share an odd number of qubit indices where they all act nontrivially. All other combinations of logical operators and stabilizers have an even number of such locations.",
                "Proof. To determine the phase acquired from acting on the code space with CCZ \u2297n , we first ask how this operator acts on an arbitrary computational basis state. Recall that CCZ \u2297n = n j =1 CCZ j where CCZ j acts on qubit j in each block. Given a triple of n-qubit binary vectors a, b, and c we have ",
                "To determine the phase acquired from acting on |x L |y L |z L with CCZ \u2297n , we consider its action on each term in the superposition using Eq. (O11). Each term acquires a phase",
                "where the phase exponent is",
                "Using linearity of the triple dot product and expanding the vectors in terms of unit vectors, e.g., (x, u) = p \u00f4p (x, u) p , we have",
                "Next, using the assumption of Eq. (O9), we see almost all these terms vanish except a few when p",
                "where in the last line we have noted that the summation is exactly the triple dot product between these vectors. Substituting this back into Eq. (O13) we have",
                "Since the dependence on u, v, and w has vanished, CCZ \u2297n acts identically on every term in the superposition comprising the logical computation basis states so we have",
                "This is precisely the phase expected from CCZ \u2297k = j CCZ Lj since each CCZ Lj contributes one term x j y j z j to the phase exponent.",
                "We remark that the above proof closely follows previous work on 3D surface codes [145] but generalized to arbitrary k. This approach could be further extended using a proof technique similar to Refs. [140,141] to cover cases where the logical unitary is not CCZ \u2297k but some other non-Clifford unitary; and/or the full code space is not necessarily divisible into three equal sized blocks. However, this more sophisticated approach is not required for our present purposes.",
                "Rather, we are interested in the special case."
            ],
            "subsections": []
        },
        {
            "title": "Lemma 2. Consider a trio of G matrices as follows:",
            "paragraphs": [
                ")",
                "Then the corresponding codes are [[n, 2, 2]] codes with a tranversal logical CCZ \u2297n = CCZ \u22972 L . For instance, these conditions are met by setting",
                "to produce a trio of [[8, 2, 2]] codes with CCZ transversality as above.",
                "The above lemma provides an example trio of [[8, 2, 2]] codes with the desired transversality property. To be more concrete, by combining Eq. (O20) and Eqs. (O21) to (O23) the trio of codes have G-matrix representation",
                ")",
                "By translating these matrices into X stabilizers (all have the X [1] = X \u22978 stabilizer) and logical X operators (which differ), we verify that these are the same codes as specified by the operators given the main text [see, e.g., Eq. (O1)]. However, the lemma provides some general conditions under which transversality is satisfied to provide a better insight into the proof technique.",
                "Proof. The proof of Lemma 2 follows quickly from Lemma 1 by simply verifying all the cases. For instance, for p = q = r we have",
                "In the second line, we have used that the triple dot product is invariant under permutation of vectors, for instance, |a \u2227 b \u2227 c| = |b \u2227 c \u2227 a|. The last equality in each line comes from the assumptions in Lemma 2. Since k = 2, we see that we indeed get unity when p = q = r \u2264 k and zero for p = q = r > 2 [as required by Eq. (O9)]. Let us consider a case when p, q, r \u2264 k but p = q, such as",
                "We have used the simple identity that in F 2 we have a 2 b = ab and the natural extension to vectors that |a \u2227 a \u2227 b| = |a \u2227 b|. The last equality comes from the assumptions in Lemma 2 and gives the result required by Eq. (O9). By inspecting Eq. (O20), we find that for any triple of rows (except for the special case when p = q = r) from the upper block G 1 , two of the selected rows will be equal and so the triple dot product will again give zero, therefore satisfying Eq. (O9). Next, let us consider a case when one row comes from G 0 , for instance, q = 3 and so",
                "In the second line, we have use that a \u2022 1 = a extends to vectors so that in general |a \u2227 b \u2227 1| = |a \u2227 b|. The last line uses assumption 2 of Lemma 2. Indeed, whenever one (or more) of the rows is 1, we are able to deploy assumption 1 (or 2) of Lemma 2. This enumerates all possible cases and confirms that Eq. (O9) always holds, therefore proving the main transversality statement of Lemma 2. Lastly, that Eqs. (O21) to (O23) satisfy assumptions 1-3 of Lemma 2 is easily verified. For example,",
                "where in the first line we split off the j = 1 case from the rest of the summation to highlight that this is the only nonzero term. A deeper explanation is provided by noticing that the example vectors u t correspond to generators of a Reed-Muller code for which these properties are well known [146]."
            ],
            "subsections": []
        },
        {
            "title": "Trading space and time",
            "paragraphs": [
                "Here we construct a magic state distillation protocol from the G-matrix representation of Appendix O 2 that minimizes space requirements. The intuition is that one never encodes into the full code space but rather converts the CCZ \u2297n gate into a product of n conjugated CCZ gates that we can think of as being conjugated by some partial encoding unitary.",
                "In particular, consider some G D matrix representing an [[n, k, d]] code and a unitary V D such that",
                "where x is a length k bit string and u is length m (recall m the number of rows in G D 0 ). Furthermore, it is known that such a unitary V D can be found that is Clifford and composed solely of CNOT gates [141]. It follows that where in the last line we have slightly abused qubit ordering to collect together the physical |CCZ state output.",
                "In the case of a detectable error, at least one of the |+ \u22973m qubits will be phase flipped and detected by an X measurement.",
                "To reduce space overhead, we observe that the |0 \u22973 qubits effectively play no role here. Furthermore, the unitary V \u2020 CCZ \u2297n V acts nontrivially only on the first 3(k + m) qubits, so that the |0 \u22973 qubits [a total of 3(nmk) qubits] are truly surplus to requirement. Using our earlier notation V \u2020 CCZ \u2297n V = j V \u2020 CCZ j V where CCZ j acts on qubit j of each block, one then has that",
                "where [. . .] j denotes the j th element of the vector inside or the j th column of a matrix. Notice, we have suppressed the presence of the redundant |0 qubits.",
                "In Appendix O 4 we describe two concrete implementations of the VCCZV \u2020 gates. Of course, it is crucial that the space reduction and VCCZV \u2020 implementation does not distort the way errors propagate and that error-correction properties are retained, which is proven from first principles in Appendix O 5."
            ],
            "subsections": []
        },
        {
            "title": "Implementing conjugated-CCZ gates",
            "paragraphs": [
                "Here we give explicit implementations for the eight conjugated-CCZ gates described in Eq. (O37). Any such gate can be realized using a single CCZ magic state and we give further details for two different implementations: the first implementation uses CNOT gates and single-qubit measurements (Appendix O 4 a); the second implementation uses only multiqubit Pauli measurements via lattice surgery (Appendix O 4 b).",
                "Herein, we label qubits as follows. Notice that the qubit labels assume we have made a space-time trade-off, so the factory qubits refer to the 3(m + k) qubits prepared in a |+ state. In the case of a m = (0, 0, 0) projection, we get the phase f (0, 0, 0) = [aG A ] j [bG B ] j [cG C ] j , (O47) so that after switching notation by using Eq. (O38) we get the desired phase in Eq. (O37). However, for nonzero measurement outcomes we have f (m) = f (0, 0, 0) + g(m), (O48)",
                "where g(m) represents the remaining terms in the expansions of Eq. (O46). We can see that these remaining terms will be quadratic in the variables {a, b, c} and so represent Clifford corrections: the quadratic terms correspond to a circuit of CZ gates, the linear terms correspond to a circuit of Z gates, and the constant term gives a global phase. For example, consider the case when m = (1, 0, 0) so",
                "This is corrected by a CZ between qubits (B, p) f and (C, q) f for every {p, q} such that G B p,j = G C q,j = 1. This correction precisely matches the rule given in items 1(b) and 1(c) of Algorithm 2. It is straightforward but tedious to verify that the corrections of Algorithm 2 always give the desired phase needed to cancel (-1) g(m) ."
            ],
            "subsections": []
        },
        {
            "title": "b. Injection using lattice surgery",
            "paragraphs": [
                "Here we provide an alternative formulation of the conjugated CCZ injection from that presented in Appendix O 4 a. Instead of using a CNOT circuit, the injection procedure will be described entirely in terms of multiqubit Pauli operator measurements, as this is the natural set of operations in lattice-surgery implementations. We have already discussed the key ideas of this mapping in Appendix M and Sec. V. Here we wish to allow for the option of performing a lattice-surgery operation between a repetition-code clock (really just a d x = 1 surface code) and thin surface codes, and we present an example lattice-surgery diagram in Fig. 61.",
                "In general, imagine a circuit that performs the following: (i) do n CNOT gates targeted on qubit 0 and controlled on qubits 1 to n; (ii) measure Z 0 ; (iii) discard qubit zero. This is equivalent to the following measurement driven procedure: (i') measure multiqubit Pauli n j =0 Z j ; (ii') measure single-qubit Pauli X 0 and discard; (iii') if second step gives \" -1\" outcome perform a n j =1 Z j correction. In the bottom diagram of Fig. 12, we prove equivalence of these approaches through a series of circuit identities (illustrated for the n = 3 case). Applying this equivalence to Algorithm 2 we obtain Algorithm 3. Note that in a Pauli measurement scheme, we never perform the Clifford corrections. Rather whenever there is a subsequent Pauli measurement P, if the Clifford correction register contains C, we instead measure CPC \u2020 . The corrections in Algorithm 3 commute with all the measurements here, and so can be postponed until later."
            ],
            "subsections": []
        },
        {
            "title": "Error propagation and detection",
            "paragraphs": [
                "Here we discuss the effect of noisy |CCZ states used in the TDTOF protocol. For now, we assume all encoded Clifford gates are ideal, but later we relax this assumption.",
                "To be precise regarding error propagation we introduce the following language. Given n such states, for each j \u2208 [1, n] we use e j = (e A j , e B j , e C j ) to denote the error for the j th |CCZ state, so",
                "Step 1: Prepare Lattice surgery to measure a multipatch Pauli measurement between three code blocks: one repetition-code logical qubit and two thin surface-code logical qubits. See Fig. 52 for comparison. This provides the principle building block for the execution of item 1(a). In TDTOF, a multipatch Pauli measurement is always followed by a single-qubit measurement of the repetition code and here we combine this with the third (split) step of lattice surgery. The gradient colored squares represent where an X \u2297 X \u2297 Z \u2297 Z stabilizer measurement called a domain wall. Multiplying the outcome of the stabilizers labeled with a white dot, gives the outcome of the Z L \u2297 Z L \u2297 Z L multipatch Pauli measurement [this is how we obtain the outcomes labeled \u03c9 D j in item 1(a) of Algorithm 3]. To ensure fault tolerance of this measurement outcome, we repeat these stabilizer measurements d m times as discussed in Appendix N3. Afterwards all qubits are measured in Z basis, with their product determining the operator Z L \u2297 1 \u2297 1 [this is how we obtain the outcomes labeled m D j in item 1(a) of Algorithm 3]. Since an error during a Z measurement is physically indistinguishable from a bit-flip error prior to the measurement, to fully exploit noise bias we need these failures to be similarly unlikely. However, in practice, in our noise model we find Z measurement errors are much more likely than bit flips. However, since the qubits are idle for a long time after the Z measurement, we can boost their effective fidelity by using an ancilla qubit to perform a nondestructive Z measurement and repeat until the fidelity is suitably high. As such, here the single-qubit Z measurements should be interrupted as repeated nondestructive Z measurements. We discuss in Appendix O 8 the effect of errors in lattice surgery due to using finite-size code blocks. If we wish to instead measure X L \u2297 Z L \u2297 Z L then we do not use the domain wall on the repetition-code block.",
                "we have the rigorous bound where (1 -F t max ) is a estimate counting up to t max fault locations and the additional summation is our bound on the truncation error. In all subsequent numerical calculations we have confirmed the possible truncation error is many orders of magnitude smaller than the estimated error. For instance, using t max = 3 then for \u2264 10 -4 the truncation error is no more than 3 \u00d7 10 -16 and therefore negligible.",
                "In practice, the error distribution from BUTOF is far from depolarizing and this is further skewed when we account for Clifford noise (see Appendix O 8). However, truncation error can be estimated of any noise model and controlled in the above manner. Furthermore, one can also tailor the protocol to the noise profile (see Appendix O 6)."
            ],
            "subsections": []
        },
        {
            "title": "b. Generic noise",
            "paragraphs": [
                "We have shown Algorithm 4 tolerates Z-error noise. Next, we show it also tolerates X noise on the noisy states. Abstracting away the details of Claim 2, the protocol maps pure states as follows: If the state suffered stochastic Z noise then it would be diagonal with respect to this basis, so A e,f = 0 whenever e = f. If there are off-diagonal elements A e,f = 0 these could be eliminated by applying a random twirl using the Clifford operators that stabilize |CCZ . However, this would add unnecessary Clifford gates as these off diagonals are unimportant, as we now show.",
                "By Eq. (O70) and linearity, we have Because any physical process does not increase the trace of any terms, there is no way for off-diagonal elements (with e = f) to be mapped to on-diagonal elements [with \u03bd(e) = \u03bd(f)]. Since the success probability and fidelity depend only on the output diagonal elements, we conclude that our figures of merit only depend on the diagonal A e,e elements. In other words, the success probability and output fidelity are unchanged whether or not we twirl the initial state. In all numerics presented, whenever the input magic states suffer a mix of Z and X noise, we have calculated the exact \u03c1 matrix, extracted the diagonal elements and used them to build an equivalent stochastic Z noise model. Consequently, any error on a single |CCZ state appears as a stochastic mixture of Z errors at one fault location. After the protocol is complete, we can twirl the output states to ensure that the infidelity matches the trace-norm error of the output states. Though again, this twirl is never actually performed but included into the Clifford record to modify Pauli measurements used to inject the magic state into the algorithm."
            ],
            "subsections": []
        },
        {
            "title": "Noise tailoring through Clifford symmetries",
            "paragraphs": [
                "There is some freedom in how injections are scheduled and whether to include certain Clifford gates in the TDTOF protocol. A |CCZ gate is invariant under permutation of qubits A, B, and C. More generally, there are Clifford symmetries C such that C|CCZ = |CCZ . A permutation is a sort of Clifford symmetry, but one that can be realized at no further gate count.",
                "As such, we can add Cliffords or freely permute some of the indices in Algorithm 3. In the ideal case, with no errors, these symmetry operations have no effect. However, they can change the noise model. For qubits with depolarizing noise, the noisy state is invariant under all these symmetries. However, for BUTOF the output noise model is very asymmetric and highly skewed towards a Z error on qubit A and so applying symmetry operations can change the protocol's performance. Here we explain the idea of noise tailoring through symmetries and find that the change can be dramatic. Indeed, while the protocol usually quadratically suppresses errors, we can tailor the noise for cubic suppression of one error type. To make a clean statement we consider a toy noise model. where 2 1 . Directly applying Claim 2 leads to an output infidelity of O( 21 ) + O( 22 ) + O( 1 2 ). However, there exists a set of Clifford symmetries {C j } such that C j |CCZ = |CCZ and if applied at the start of the protocol lead to an output infidelity of O( 31 ) + O( 1 2 ) + O( 22 ).",
                "Consider a set of Clifford symmetries such that",
                "where M j is an invertible 3 \u00d7 3 binary matrix and e j M j represents matrix multiplication. The \u00b1 phase will depend on Z[e j ] but is irrelevant to our analysis. For example, if C j permutes qubits in Hilbert space then M j represents the permutation of the indices. Then applying C j to the input magic states generates a new probability distribution for Z errors P j (e j M j ) := P j (e j ).",
                "(O76)",
                "Using that M must be invertible, we equivalently have P j (e j ) := P j (e j M -1 j ). (O77)",
                "Only errors with two fault locations give secondorder contributions to the output infidelity. Recall from Appendix O 5 that for such an error to go undetected, we must have that e i = e j =: e = 0 for some distinct pair {i, j }. We introduce the shorthand e for whatever nonzero error type is under consideration. This occurs with probability P i (eM i )P j (eM j )P j (0) 6 = P i (eM -1 i )P j (eM -1 j )P j (0) 6  (O80)",
                "It follows that to achieve O( 3 1 ) scaling of output infidelity, we require that for every {i, j } pair either (1 ) (1, 0, 0)M i = (1, 0, 0)M j ;",
                "(2 ) or if (1, 0, 0)M i = (1, 0, 0)M j then fault e = (1, 0, 0)M j corresponds to one of the harmless errors listed in Table XI.",
                "There are seven different possible values of (1, 0, 0)M j but eight different j indices, so it is (narrowly) not possible to use condition 1 alone. However, it is possible to find a set of Clifford symmetries such that some pairs {i, j } are covered by condition 1 and some pairs {i, j } are covered by condition 2 .",
                "We provide such an {M j } set in Table XII, which suffices to prove Claim 3. Furthermore, this set can be implemented especially easily. Consulting Table XII we find that the Clifford symmetries for indices {1, 2, 3, 4, 7, 8} all correspond to permutations of indices and so can all be performed in software. The only exceptions are indices {5, 6} that correspond to a W = CNOT B,A X A gate followed by an index permutation. In other words, W bit flips qubit A if qubit B is in the |0 state. Consequently, the state |1, 1, 1 is invariant under W and other computational basis states are permuted. Therefore, W is a Clifford symmetry of the |CCZ state since all terms except |1, 1, 1 carry the same amplitude and phase. Since |TOF = H C |CCZ and TABLE XII. Set of transformation matrices M j that represent Clifford symmetries as defined in Eq. (O75). For every distinct pair of indices {i, j } they satisfy either condition 1 or condition 2 as stated in the proof of Claim 3. In particular, the only pairs for which condition 1 does not hold are {1, 2},{3, 7} and {4, 8}. However, for these three cases the fault pattern is one of the harmless cases listed in Table XI.  Implementing W on repetition encoded qubits A and B is straightforward because W is transversal and the code blocks are adjacent to each other in the proposed layout."
            ],
            "subsections": []
        },
        {
            "title": "Factory layout and scheduling",
            "paragraphs": [
                "We see from Fig. 61 that lattice surgery require some additional workspace to connect the various code blocks. Figure 62 presents a 2D layout to realize TDTOF using lattice surgery, including all necessary workspace. If bit flips are sufficiently small, then the factory can be realized completely with repetition codes. In the regime where bit flips are rare but not completely negligible, we use a mix of repetition-code blocks (for the BU qubits) and d x = 3 thin surface codes (for the factory qubits) to tolerate a single physical bit flip anywhere in the factory. Additional bit-flip protection could be achieved by increasing the X distance of all code blocks and/or performing two rounds of TDTOF. Here we describe only a single round and primarily focus on the version using d x = 3 surface-code blocks.",
                "For now, we assume a supply of TOF states generated from BUTOF. Then we can schedule the main TDTOF steps as listed in Table XIII. The required eight input |TOF are divided into two batches of four. How quickly can a batch of four input |TOF magic states be injected? Each |TOF state comprises three qubits, so there are a total of 12 = 3 \u00d7 4 multipatch Pauli measurements needed per batch. These can be partly parallelized. Figure 62 shows four horizontal empty regions that we call access corridors labeled {A, AB, BC, C}. This allows us to perform four multipatch Pauli measurement in parallel. There are some constraints on which multipatch Pauli measurements are performed (further discussion in the caption of Fig. 62). The first batch is injected in factory clock steps 1-3. The second batch is injected in factory clock steps 4-6. Factory clock step 7 performs the measurement of the check qubits, and starts the process of exiting some factory qubits out of the factory. Factory clock step 8 completes the process of exiting the factory qubits. Each factory clock step takes a time (d m + 1)T surf , where T surf is the duration of one surfacecode cycle and d m is the number of surface-code cycle used per multiqubit Pauli measurement. The \" + 1\" in (d m + 1) provides time to perform high-fidelity single-qubit measurements and reset between rounds of multiqubit Pauli measurement. Roughly, a single execution of TDTOF takes time 8(d m + 1)T surf , though small extra additive time costs may be incurred to execute BUTOF, which we discuss next.",
                "The BUTOF protocol can have a fairly high failure probability, labeled here by F BU . This failure probability depends on the repetition-code distance d BU used in BUTOF. To boost the probability of having ample supply of states from BUTOF, we add redundancy in both time and space. Our illustrations show M = 20 modules for BUTOF, Additional space between code blocks is provided for lattice surgery and routing between code blocks (see Appendix M and Fig. 61). We give explicit locations for the nine factory qubits with labels (D, i) f following Definition 2. The modules labeled BU consists of three repetition codes and provide space to attempt a noisy |TOF preparation using the BUTOF protocol. Note that BUTOF is executed with a distance d BU repetition code (typically we set d BU = 5, 7) and then immediately grow to distance d z > d BU .",
                "For instance, executing BUTOF at distance 5 and using d m = 15 surface-code cycles per lattice-surgery operation we have R = 3 attempts at BUTOF (assuming \u03ba 1 /\u03ba 2 = 10 -5 and |\u03b1| 2 = 8). If F BU = 0.447 then the temporal redundancy reduces this to FBU = F 3 BU = 0.089. Providing M = 10 modules in total, there is (M -1)/2 = 3 available spatial redundancy on each side, which further suppresses the failure probability to F side = 0.023. This is already TABLE XIII. The final form of our TDTOF protocol for one full cycle of the factory. It executes a variant of Algorithm 4 that has been modified according to the qubit permutations required for noise tailoring (see Appendix O 6) and embedded within the 2D layout of Fig. 62. Each cell for factory clocks 1-6 has the form A then B. Instruction A specifies a multiqubit Pauli operator using the qubit notation of Definition 2. For example, X (C, 4) BU , Z(A, 3) f means measure the operators X \u2297 Z, where the X acts on magic input labeled (C, 4) BU and the Z acts on factory qubit (A, 3) f . Instruction B specifies a single-qubit measurement of a magic input qubit. The B instructions can be realized with physical single-qubit measurements that take a single surface-code cycle. As such, B instructions require negligible time compared to the A instructions, so we present both a and B within a single factory clock step that has duration d m + 1. In factory clock steps 1 and 4, the role of Z and X are swapped on the magic state qubits to account for the Hadamard difference between |CCZ and |TOF . The column headers \"Corridor\" indicate which corridor from Fig. 62 is used to realize the multiqubit Pauli measurement since lattice surgery requires some workspace to operate. Note that \"Corridor AB\" can only be used to access factory qubit with labels of the form (A, i) f or (B, i) f . The column headers also list which factory blocks {A, B, C} the corridor can be used to access and this constraint it respected in this schedule. Notice that multiqubit measurements of the form X (C, 4) BU , Z(A, 3) f involve different capital letter indices on the factory and magic qubits. In contrast, item 1(a) of Algorithm 3 describes multiqubit Pauli measurements with matching capital letter indices. This is due to the permutation operations required for noise tailoring (see Appendix O 6). In particular, when performing measurements with the j = 4 index, the matrix M 4 of Table XII instructs us to swap the A and C indices for the magic state qubit. In the cases of M 6 and M 7 , these are decomposed into a single Clifford gate W and a permutation. The above table accounts only for the permutation, with the Clifford performed on the input magic state qubits prior to injection into TDTOF. Factory clock times 1-3 correspond to batch 1, so that measurements involve only magic state qubits of the form (D, i) BU with i \u2208 [1,4]. Factory clock times 4-6 correspond to batch 2, so that measurements involve only magic state qubits of the form (D, i) BU with i \u2208 [5,8]. The importance of batching and the related issue of BUTOF scheduling is discussed in Appendix O 7. \"Exit\" refers to factory qubits moving out of the factory.  propagated errors we simply replace w \u2192 w + w to add the effect of the forwarded propagated errors and follow this modification through the analysis of Claim 2. As we did earlier, it will be useful to split w = (v, u) to distinguish errors on check qubits and output qubits. If the forwarded propagated error w on each block occurs with some probability F( w) then the results of Claim 2 modify to Calculating the expressions for P j , F, performing the summation and adding the stuck error events is too involved to perform by hand. But it is relatively straightforward for a symbolic mathematics package such as Mathematica. Optimizing over various error suppressing parameters, we find the factory designs that achieve a certain target error per Toffoli at the minimum qubit and ATS cost (without making significant sacrifices to acceptance probabilities) and present results in Table XV."
            ],
            "subsections": []
        },
        {
            "title": "The fidelity bottleneck in TDTOF",
            "paragraphs": [
                "There are many contributing sources of error to the results presented in Tables IV and XV. In the main text summary of Table IV, the lowest reported Toffoli error probability was 2.3 \u00d7 10 -9 . Here we discuss which error sources are the bottleneck factor that limit us from reaching higher fidelities with TDTOF protocol. We conclude with a discussion how the presented TDTOF protocol can be adapted to pass this bottleneck.",
                "Let us consider the process of bit-flip errors on noisy input TOF states encoded in repetition codes. For hardware parameters \u03ba 1 /\u03ba 2 = 10 -5 , \u03ba \u03c6 = 0, and |\u03b1 2 | = 8, the lowest total error rate is \u03b4 := 2.7 \u00d7 10 -8 per repetition-code cycle (recall Fig. 7). If a single TOF state is stored for r repetitioncode cycles, then roughly the accumulated error on qubits B and C is \u03b4r and this gives an additional contribution of 2\u03b4r to the nondominate noise contributions 2 . Returning to our benchmark example, the output error is (roughly) lower bounded by",
                "= C(2 \u00d7 10 -5 ) 7.5 \u00d7 10 -9 + 2 \u00d7 2.7 \u00d7 10 -8 r , (O88) . Of course, this is a rough estimation of one error source, just to provide the reader with some intuition. Rather, for a precise accounting of all error sources the lowest observed infidelity was 2.5 \u00d7 10 -9 . However, there are several straightforward routes to reaching even lower infidelities. By converting immediately after BUTOF from repetition code to thin surface code we would reduce the time exposed to bit-flip errors. For our benchmark example, encoding directly into surface codes should enable us to get much closer to 1.2 \u00d7 10 -12 infidelity (the ideal Clifford limit for noise tailored TDTOF).",
                "Ultimately, arbitrarily high fidelities can be reached by concatenating TDTOF, though resource costs jump substantially with each level of concatenation. Alternatively, better fidelities could be reached it hardware parameters could be improved by either further suppressing bit flips by increasing |\u03b1| 2 or decreasing \u03ba 1 /\u03ba 2 ."
            ],
            "subsections": []
        },
        {
            "title": "ACKNOWLEDGMENTS",
            "paragraphs": [
                "We thank Qian Xu for helping with the displaced Fockbasis calculation and Alex Retzker for discussions. C.C. thanks Yunong Shi and Pierre-Yves Aquilanti for their help in setting up the AWS clusters where most of the error-correction simulations were performed. We thank all the members of the AWS Center of Quantum Computing for our collaboration on building more powerful quantum technologies. We thank Richard Moulds, Nadia Carlsten, Eric Kessler, and all the members of the Amazon Braket and Quantum Solutions Lab teams. We thank Simone Severini for creating an environment where this research was possible in the first place. We thank Bill Vass, James Hamilton, and Charlie Bell for their support and guidance throughout this project."
            ],
            "subsections": []
        },
        {
            "title": "APPENDIX A: ENGINEERING TWO-PHONON DISSIPATION WITH PIEZOELECTRIC NANOSTRUCTURES",
            "paragraphs": [
                "In this Appendix we calculate the dimensionless loss parameter \u03ba 1 /\u03ba 2 -the ratio of the single-phonon and twophonon dissipation rates-and show how to minimize it to the lowest level allowable by the intrinsic loss of the hardware and the crosstalk constraints derived in Appendix B. This Appendix is divided into four parts. First, in Appendix A 1 we revisit an existing method to engineer two-photon (or in this case two-phonon) dissipation using an ATS device. [28]. Next we show in Appendix A 2 how to calculate the interaction rate g 2 when the storage resonator is an arbitrary piezoelectric nanostructure, and explicitly calculate g 2 for the specific case of a one-dimensional PCDR [32]. Then in Appendix A 3 we derive, using a classical description of the underlying superconducting circuits, a general expression for \u03ba 2 when a bandpass filter is placed in between the output port of the buffer resonator and the external 50 environment and show how to design the filter to optimize \u03ba 2 . We include a filter in our analysis because filtering the output-or engineering the density of states of the system's reservoir-is crucial to the multiplexed stabilization protocol described in Appendix B. Finally, in Appendix A 5 we show that the loss \u03ba 1 /\u03ba 2 can be minimized by utilizing a high-impedance buffer resonator and calculate a lower bound for this loss.",
                "P MRX 2 = (P (3)  IZCX , P (1)  IZCX , P (1)  ZICX , P (2)  IZCX , P (1)  d ; 1, 2, 1, 1, 1), (N24) P C3X = (P (3)  IZCX , P (1)  IZCX , P (1)  ZICX , P (1)  d ; 1, 1, 1, 1), (N25) P BB2X = P (2D) BLTRX , (N26) P BB1X = (P (1)  IZCX , P (1)  ZZCX , P (1)  ZICX , P (1)  d ; 2, 1, 1, 1), (N27) P C4X = P C3X , (N28)",
                "P MLX 1 = (P (3)  IZCX , P (1)  IZCX , P (2)  ZICX , P (1)  ZICX , P (1)  d ; 1, 1, 1, 1, 1), (N29) and",
                "For the graph G (2D)",
                ", we first define the following probabilities: ",
                "Using Eqs. (N31) to (N37), the leading-order edge-weight probabilities for the graph G (2D)",
                "are given by P (2D) BLTRZ = (P (1)  XXCX , P (1)  XICX , P (2)  d ; 1, 1, 1), (N38)",
                "TLBRZ = (P (1)  XXCX , P (1)  XICX , P (2)  IXCX , P (3)  IXCX , P (2)  d ; 2, 2, 1, 1, 1), (N39) P C1Z = (P (2)  XICX , P (1)  IXCX , P (2)  d ; 1, 1, 1), (N40) P TB1Z = (P (2)  XICX , P (1)  XICX , P (2)  IXCX , P (3)  IXCX , P (1)  XXCX , P (2)  d ; 1, 1, 1, 1, 1, 1), (N41) P TB2Z = (P (2)  XICX , P (1)  IXCX , P (2)  d ; 1, 2, 1), (N42)",
                "P MRZ1 = (P (1)  XXCX , P (1)  XICX , P (3)  IXCX , P (2)  d ; 1, 2, 1, 1), (N44)",
                ")",
                "P BB1Z = (P (2)  XICX , P (1)  IXCX , P (2)  IXCX , P (1)  XICX , P (2)  d ; 1, 1, 1, 1, 1), (N47)",
                "P C4Z = (P (2)  XICX , P (1)  XICX , P (2)  IXCX , P (2)  d ; 1, 1, 1, 1), (N49) P MLZ1 = (P (1)  XXCX , P (1)  XICX , P (2)  IXCX , P (2)  d ; 1, 2, 1, 1), (N50) and",
                "(N51)",
                "We now consider the three-dimensional version of the graphs in Figs. 55(b) and 55(c) (which we label",
                "and G (3D)",
                ") to deal with measurement errors in addition to space-time correlated errors arising from CNOT gate failures. As an example, consider an I \u2297 Z error arising from a CNOT gate failure in the second time step of an X -type (red) plaquette during the kth syndrome measurement round. Such a failure adds a Z data-qubit error, which propagates through the CNOT in the fifth time step of the top right red X -type plaquette. Let v j and v k be the vertices corresponding to the measurement outcomes of the two ancilla qubits, which would detect the Z error. Assuming there were no other failures, only one of the two vertices (say v j ) changes from rounds k -1 to round k. In the next syndrome measurement round, both X -type plaquettes will detect the Z data qubit error the ancilla qubits in both X -type plaquettes will be highlighted. Hence only the vertex v k changes from round k to k + 1. In order to ensure that the highlighted ancillas arising from failures as in the example considered here can be reached by a single edge when implementing MWPM, the dark green edges in the graph of Fig. 56(a) (labeled P (bulk) d 1 ,X ) are added to the graph of Fig. 55(b). The other types of space-time correlated edges are distinguished by their color and associated label (all edges of the same color have identical edge-weight probabilities). Similarly, we add the dashed gray vertical edges in Figs. 56(a) and 56(b) connecting identical vertices from two consecutive syndrome measurement rounds to deal with measurement errors. The edge-weight probabilities of such edges are labeled P X V and P Z V . Note that there are also solid dark vertical edges at some of the boundaries of the graphs where weight-two X -type and Z-type stabilizers occur in Fig. 55(a). These vertical edges have different edge-weight probabilities, which are labeled P X ,bound V and P Z,bound V . In order to avoid making the visualization of the three-dimensional graphs too cumbersome, in Figs. 56(a"
            ],
            "subsections": []
        },
        {
            "title": "Error detect and postselect",
            "paragraphs": [
                "A magic state distillation protocol for 8CCZ \u2192 2CCZ with the eight CCZ injections performed using Algorithm 2. Qubit labels of form (D, i) f and (D, j ) BU follow notation of Definition 2. For each j , the triple of qubits (A, 1) BU , (B, 2) BU , and (C, 3) BU are prepared in a noisy CCZ states (e.g., using BUTOF) but this preparation is not shown. We show explicitly the CNOT gates for the first two steps and the last step, but omit the middle steps for brevity. The full circuit is reproducible using Eqs. (O24) to (O26) to specify the CNOT pattern as outlined in Algorithm 2.",
                "qubits described earlier as being in the |0 state are omitted as they are surplus to requirement. For the code of interest [recall Eqs. (O24) to (O26)], there are nine factory qubits and 24 BU qubits, though the BU qubits do not all need to be prepared at the same time and can be encoded in smaller distance code blocks. A circuit using this labeling appears later in Fig. 60."
            ],
            "subsections": []
        },
        {
            "title": "a. Injection with CNOT gates and single-qubit measurements",
            "paragraphs": [
                "To perform the required sequence of n conjugated-CCZ gates from Eq. (O37), we may implement Algorithm 2. In items 1(b) and 1(c) of Algorithm 2, the indices (D, D , D ) should be read as distinct triples from the set {A, B, C}. For example, if D = A and D = C then one infers D = B. Furthermore, these adaptive Clifford corrections commute with the rest of the circuits and so can all be postponed until later. We illustrate some of the steps in Fig. 60.",
                "Next, we calculate the action of the circuit described by Algorithm 2 for one particular j value. With respect to the factory qubit basis states, we have",
                "where we have broken the state up into three blocks corresponding to indices A, B, and C. For example, qubit Therefore, for D = A the target (A, j ) BU qubit is flipped precisely when",
                "where the summation has been changed to matrix multiplication. Recall [aG A ] j just means the j th element of vector aG A . Similar expressions hold for D = B, C. The CCZ magic state is given by ",
                "We follow these CNOTs by measurement of the BU qubits in the Z basis, which are afterwards discarded. Assuming measurement outcomes |m A j |m B j |m C j then the only nonvanishing terms have m D j = y D , so",
                ")",
                "Discarding the BU qubits, we get",
                "where the phase exponent depends on the measurement outcomes m = (m A j , m B j , m C j ) as follows:",
                "The value of this phase exponent was originally y A y B y C but with the substitutions determined by Eqs. (O42) to (O44) we get Eq. (O46).",
                "that",
                "We say an error has w fault locations if there are w nonzero e j . Furthermore, for D \u2208 {A, B, C} we define",
                "The distinction between our notion of fault locations and the usual Hamming weight of the concatenated string (e 1 , . . . , e n ) is important because many methods of preparing a noisy |CCZ state will lead to errors such as Z \u2297 Z \u2297 Z that could have a comparable probability to a singlequbit error Z \u2297 1 \u2297 1. Indeed, we are typically interested in knowing how many |CCZ states are affected by an arbitrary error, though we assume errors are uncorrelated between different |CCZ states. Errors propagate as follows.",
                "Claim 1 ((How errors propagate)). Consider an implementation of Algorithm 3 using noisy CCZ states with Pauli Z error described by {e A , e B , e C } as in Definition 3. For each D \u2208 {A, B, C}, let",
                "The output of Algorithm 3 differs from the ideal case by an error Z",
                "] on the factory qubits and where the tensor product represents the three different code blocks. Identifying the last m qubits of each block as check qubits, we can partition the w D into two parts as follows:",
                "Claim 1 tells us that Z errors propagate through Algorithm 3 in a manner that is isomorphic to their propagation through error-correction codes represented by the corresponding G matrices.",
                "We can prove Claim 1 by considering how a single Z error on a BU qubit propagates onto a factory qubit under Algorithm 3. Since an error on a factory qubit propagates to the end of the circuit, they compose independently. Consult the last circuit of Fig. 12 and consider a Z error on the top qubit. It commutes with the multiqubit Pauli Z measurement but flips the final single-qubit X measurement. The outcome for this X measurement decides whether to apply Z to the qubits below. In other words, a Z on the top qubit propagates to all the qubits below. In Algorithm 3, when operating on qubit (D, j ) BU we apply the circuit of Fig. 12 to sets of factory qubits identified by (D, i) f whenever G D i,j = 1. Therefore, a Z error on (D, j ) BU occurs whenever e D j = 1 and will propagate to every (D, i) f for which G D i,j = 1. Summing over all j \u2208 [1, n] magic state injections, factory qubit (D, i) f will have a Z error if",
                "Since the ith qubit is Z flipped according to the ith element of vector w D := e D G D , this vector describes the Z-error distribution on factory block D. Splitting G D into its block matrix components G D 1 and G D 0 gives Eq. (O55). We have already described the main components of the magic state distillation routine, but for completeness we recap how they fit together in Algorithm 4. Combining our previous results, we have the following. then the probability of passing the error detection test is"
            ],
            "subsections": []
        },
        {
            "title": "Claim 2 ((Distillation)). Consider an implementation of Algorithm 4 using G D matrices of size n \u00d7 (m + k) satisfying Lemma 2 and using n noisy CCZ states with Pauli Z error described by {e",
            "paragraphs": [
                "and the output fidelity is",
                "First consider when there are no Z errors. From Appendix O4b we see that Algorithm 2 will (when there is no Z noise) apply CCZ \u2297k to the 3k qubits labeled (D, i) f with i \u2264 k. The check qubits with i > k are unaffected. Therefore, the check qubits should still be in the |+ state and give \"+1\" in response to an X measurement. This confirms that the protocol acts correctly in the ideal case.",
                "When there are one or more Z errors, Claim 1 shows that the check qubits remain unflipped if and only if u D = e D G 0 = 0 for all D. Furthermore, if v D = e D G 1 = 0 then Claim 1 tells us whether there are no Z errors propagated onto the factory qubits forming the output |CCZ \u2297k state. The formulae for P acc and F follow by simply summing over the probabilities of these events.",
                "For the remainder of this subsection, we consider the special case when G D 0 = (1, 1, . . . , 1) as we have in Eqs. (O24) to (O26). Then, the state will pass the errordetection test whenever",
                "If there are no fault locations so e j = 0 for all j , then the protocol will ACCEPT. If there is a single fault location, so a single j for which e j = (e A j , e B j , e C j ) = (0, 0, 0) then the error must be detected as there is no chance for cancellation. If there are two fault locations for which e j = 0 and e i = 0 then the errors will go undetected only if they cancel exactly, so e j = e i . Therefore, to leading order",
                "For instance, let us consider an independent identically distributed depolarizing noise model such that P j (0) = 1and P j (e = 0) = /7. There are seven types of fault e = 0 and 28 pairs of possible locations, making 196 different undetected two fault-location errors, so that",
                "To leading order, the infidelity 1 -F is upper bounded by the probability of an undetected two fault-location error,",
                "However, some undetected two fault-location errors will not lead to an output error (i.e., when [e D G D 1 = 0]\u2200D). For the G D matrices of interest [Eqs. (O24) to (O26)], by brute-force counting we find that 184 of the undetected 196 two fault-location errors will to an error. The 12 harmless faults are listed in Table XI and will to play an important role in noise tailoring of Appendix O 6. Therefore, we can tighten (O65) to",
                "Therefore, have quadratic error suppression with quite a small constant factor for depolarizing noise. In the main text, we quote the error per TOF state and since the protocol outputs two TOF we have TD := (1/2)(1 -F). For the depolarizing noise model this leads to"
            ],
            "subsections": []
        },
        {
            "title": "a. Truncation errors",
            "paragraphs": [
                "While we give expressions up to second order, these summations can be easily performed to higher order and any truncation error can be controlled. If we perform calculations up to t max fault locations, then the truncation error can be easily upper bounded by assuming that every error above the cutoff leads to an undetected output error so that TABLE XI. List of the errors with two fault locations that are undetected but do not cause a logical fault when executing Algorithm 4 with G D matrices as in Eqs. (O24) to (O26). The errors follow the notation of Definition 3. For example, e = (1, 0, 0) corresponds to Z \u2297 1 \u2297 1 and is undetected yet harmless when it acts on BU qubits (A, 1) BU and (A, 2) BU . This is a direct consequence of (1, 1, 0, 0, 0, 0, 0, 0)G A 1 = (0, 0) that can be confirmed by inspection of Eq. (O24). Notice that only unit vector e appears in this list of fault types.",
                "Fault type e i = e j = e = (1, 0, 0) ( 0, 1, 0) ( 0, 0, 1)",
                "quite low. We can further reduce the failure probability by either increasing space cost M or inserting a small number Q additional rounds of BUTOF between steps 3 and 4. In the latter case, the runtime of TDTOF is extended to",
                "where we have assumed QT BU \u2264 2(d m + 1). This further reduces F side . A coarse bound is obtained by replacing R \u2192 R + Q in Eq. (O84), though actually the suppression is slightly better as there are now M /2 modules available for the Q attempts. We do not wish to set Q too high, as the additional delay leads to logical error accumulation due to finite distance choices. Whenever BUTOF fails to proceed the required |TOF states, we count this as a failure of the whole TDTOF protocol. However, we use sufficient redundancy that such occurrences are very rare. Typically, we set Q = 1 or Q = 2, and we use M = 10 when d BU = 5 and M = 20 when d BU = 7.",
                "An additional consideration is that a lattice dislocation is used when performing a multiqubit Pauli measurement including a Z L on a repetition encoded logical qubit (see Fig. 61). This dislocation uses a small amount of additional space. However, when using |TOF input states (instead of |CCZ ) the third qubit differs by a Hadamard and so the protocol is adjusted to measure X L and a dislocation is not required. For this reason, we inject the qubits in reverse order: (C, j ) BU , (B, j ) BU then (A, j ) BU . After (C, j ) BU is injected (without needing a dislocation) some space is freed up for dislocations to be used, enabling (B, j ) BU and (A, j ) BU to be injected."
            ],
            "subsections": []
        },
        {
            "title": "Clifford noise",
            "paragraphs": [
                "Perhaps one of the most important aspects of magic state factory design is the choice of distance for various code blocks. It is possible to use much smaller code distances within the factory than used inside the main algorithm. Using finite code distances leads to noisy Clifford gates, noisy lattice-surgery operations and non-negligible memory noise. This needs to be accounted for in addition to the error estimated by Claim 2 under the assumption of ideal Cliffords. Indeed, typically Clifford noise is the dominate source of errors and the error of Claim 2 should instead be regarded as the minimum achievable error (with one round of TDTOF) in the limit of infinite code distances. Some of the relevant spatial code-distance parameters are shown in Fig. 62. An important additional quantity is the \"measurement distance\" d m that is increased to suppress the effect of timelike errors during lattice surgery (see Appendix M for further details). A common choice in the literature is to set d m = max[d z , d x ], but this is by no means necessary or optimal.",
                "Rather than a Monte Carlo simulation of Clifford noise, we perform a computer-assisted analytical analysis. It is helpful to distinguish critical and noncritical faults. We say a Clifford fault is a critical risk if (assuming no other errors occur) it leads to an undetected fault on the output magic states. Conversely, a fault is a noncritical risk if it will be detected (assuming no other errors). All sources of Clifford noise can be grouped into one of four classes 1. Backwards propagating and not critical: these are errors that can be commuted towards the start of the circuit, so that they act on a single noisy input |TOF state. If \u03c1 is the density matrix with only noise from BUTOF, the backwards propagating noise is applied so \u03c1 \u2192 \u03c1 . Then the effective Z logical error distribution is determined from \u03c1 using the procedure of Appendix O 5 b. 2. Forwards propagating and not critical: these errors can be commuted to the end of the circuit, so that they act on the check qubits in the factory just before they are measured. 3. Forwards propagating and critical: these errors can be commuted to the end of the circuit, so that they act on the output magic state qubits. 4. Stuck errors and potentially critical: these are errors that are difficult to commute forwards or backwards through the circuit. We sum the probability of these events and add it to the error rate on the output magic states.",
                "Our treatment of stuck errors means that we obtain an upper bound on the performance. One might be concerned that this bound is loose, but in practice the stuck errors are very rare and not, therefore, of major importance. Indeed, if we instead attempted a Monte Carlo simulation, the statistical variance in the error estimate would exceed that of the total stuck error probability. Therefore, our computerassisted analytical analysis leads to more accurate results than Monte Carlo methods. We further remark that while a mild amount of truncation of higher-order processes is employed, we use the procedure of Appendix O 5 a to monitor this truncation error and verify that it is negligible. We list all the source of imperfections in Table XIV and describe the propagation type and risk level. Let us assume that backwards propagation has been performed and we have accounted for the effect of noise tailoring (recall Appendix O 6) on the error distribution. Following earlier notation of Definition 3 and Appendix O 6, we say j th noisy TOF state suffers fault Z[e j ] with probability P j (e j ) that we precompute. Then, without any other noise sources, Claim 2 would describe the acceptance probability and output infidelity. However, the factory qubits may be affected by some forwarded propagated error Z[( wA , wB , wC )] where the labels {A, B, C} refer to the three different blocks of factory qubits. We used similar notation, without the tilde, in Claim 1 to describe how errors due to input magic states impact the protocol. To combine with the forwarded"
            ],
            "subsections": []
        }
    ]
}