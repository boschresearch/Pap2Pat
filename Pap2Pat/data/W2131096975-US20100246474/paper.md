# I. INTRODUCTION

Long term evolution (LTE)-advanced is the latest 4G wireless communication standardization effort in 3GPP with many ambitious technical goals [1]. A very challenge requirement, among others, is the uplink peak spectrum efficiency of 15 bps/Hz and throughput as high as possible in the cell edge. Among the enabling techniques being brought to the table [2], a consensus from different companies is the use of relay stations where the cooperative communications can be applied to improve the link performance.

In cooperative communications, two groups of links including MS-BS and MS-RS-BS are used to create a virtual MIMO system. The popular approach in current work is that the cooperation, though considering multiple paths, is for one user at a time. Recently, there were a few work being proposed to consider data aggregation for two users. In [3], a scenario shown in Fig. 1 was studied where the RS with decode-andforward (DF) ability relays "a ⊕ b" instead of symbols "a" and "b" individually, where ⊕ is the operation of "XOR". It was shown that the performance can be improved given the same spectrum efficiency. An extension considering noisy MS-RS links is studied in [4] where the soft information was relayed with analog modulation. Discussion on equivalent BSC channels with the same setup was presented in [5]. Basically, these work were part of the effort shifting the application of network coding [6] in wired network into wireless communications. Despite interesting results reported in these papers, it is also recognized that further research effort is demanded for a broad range of issues. For example, the assumption of same quality in RS-BS and MS-BS links in some work might not be appropriate for a practical system. Comparison with a reference system equipped with full optimal maximal ratio combining (MRC) diversity has not been considered in [3]- [5]. In addition, it might be also desired that the source data of different users should be completely recovered from the relayed data in the case where the RS-BS link is good enough but the MS-BS links do not function well. This is evidenced in the uplink of IEEE 802.16j where the MS-BS links have not been exploited yet. This self-recovery feature is not held in existing systems. Furthermore, under the assumption of mobiles being uniformly distributed in a cell, there are in fact many mobiles near the cell edge. Therefore, it can be conceived that multiple users (i.e., MSs) may communicate with one Relay simultaneously and the number of such MSs may also vary time to time.

Taking the above issues into account, we present a new relay-based multi-user cooperative communication design for uplink in 4G systems. First, in section II, the type of relay coding matrices is presented with the requirements of full rank in the finite field and maximum information spreading. In section III, symbol detection based on log-likelihood ratio (LLR) is then compared between the proposed system and a reference system with the MRC diversity. In section IV, a decoding process with turbo principle is developed that alternates between a multi-user decoder and a group of singleuser decoders. Simulation results are presented in section V to illustrate the performance improvement. Section VI concludes the paper and point out some potentials of this design.  

# II. PROPOSED SYSTEM AND RELAY CODING MATRIX

Without loss of generality, the propose system was shown in Fig. 2 where there are four users (MSs) joining the cooperation. Instead of transmitting original information a, b, c, d, we transmit their combinations p 1 , p 2 , p 3 , p 4 shown in the lower part of Fig. 2. For example, p 1 = a⊕b⊕c.Whenever the MSs to be coded at the relay have the same modulation constellation, this coding operation can be the "addition" operation in an appropriate finite field. If MSs are using different types of modulation, the coding at the relay can always be reduced to operations in the binary finite field F 2 . For simplicity, we assume the BPSK modulation for all MSs in this paper.

It can be noted that many ways, such as random network coding and linear block codes, can be employed for the coding at RS. In our system, we consider this coding based on the requirements in rank and information spreading. First, we require that the relay output should be linearly independent. Therefore, these coded data, if perfectly decoded at the BS, can recover the original information of different users completely, without information from the MS-BS links such as in the case of current uplink in IEEE802.16j. As a result, a coding matrix should be of full rank in the finite field. Second, we expect to secure a spreading gain by spreading information of one user to multiple output streams in RS. Therefore, in a general case when any additional data are received from the direct MS-BS links, they can work together with those relay-coded data to provide a decoding gain.

Let D T = {d t 1 , d t 2 , . . . , d t K } be symbols from K MSs simultaneously obtained at RS at time t. The relay output will be P = AD, where A = {a i,j } is a K × K coding matrix and a i,j ∈ {0, 1}. First, to give the maximum spreading, we can set each row of A with all "1"s except one "0", which results in K K -1 = K different rows. The typical format is as follows

Second, "A" needs to be invertible (i.e., of full rank) in the finite field. From mathematical induction, it can be easily seen that A designed in equation ( 1) is in full rank when K is an even number. To make A invertible for odd values of K, we can simply set one row, such as the 1st row, to be all "1"'s. Verification, again, can be readily obtained from the mathematical induction. It is interesting to recognize that the above design for k = 4 used in Fig. 2 is exactly the extended-Hamming (8,4,4) code. That K = 2 is a special case which has two "1"s in one row and one "1" in the other, in order to have both information spreading and full rank.

In this work, although we assume that the relay correctly decodes the data from MSs, the correctly decoding of a specific MS is not required. As soon as the relay has correctly decoded data from a number of MSs (such as 4 here), we put them into cooperation through the coding in the RS. The MSs in the next packet or time slot can be different from the MSs in the current packet, as long as the indexes of cooperated MSs are included in the head of packet and received at the BS. As assumed in the research in this area, direct links and relay links are separated in either time slots or channel frequency so that synchronization is not considered as an issue here.

# III. INFORMATION SPREADING AND DIVERSITY

We set the reference system as a typical DF-based relay system that the relay decodes data for each MS and then re-encoded with the same code and send to the BS. In such scenario, there are two copies of data at the BS for each user, one from MS-BS link directly and the other from the RS. The optimal symbol detection is clearly the diversity technique with MRC. For the proposed system shown in Fig. 2 with four MSs using the RS simultaneously, the data from multiple MSs are coded in the relay using the extended-Hamming (8,4,4) code, i.e., simple multiplication through the matrix A with K = 4. It still has the same spectrum efficiency with the reference system so that we can focus on the performance only. It is also possible to code different number of MSs with different linear codes and transmit either all or part of the coded data if necessary, so as to obtain various trade-off between the performance and bandwidth.

For the example system considered here, intuitively, each symbol of one particular MS will be transmitted four times (in different forms) instead of twice in the reference system. For example, "a" is embedded in p 1 , p 3 , p 4 in addition to the one through direction link. However, data from some different users are "mixed" together in the relay to use the same transmission power which is used by a single user symbol in the reference system. Clearly the former feature is beneficial in terms of information spreading but the latter characteristics appears a minus due to the share of transmit power. Therefore, the first issue to be clarified is whether the net gain is positive for the proposed multi-user cooperative communication. We consider this through the log-likelihood ratio of each symbol conditioned on received data.

## A. LLR of the Reference System

For a transmitted BPSK symbol u k from the k-th MS, the Log-likelihood ratio is defined as

which is often termed as the a priori information of u k , k = 1, . . . , K. In the reference system, each u k will be sent to the BS through two paths experiencing different fading. Suppose that we have received two copies y k,i = a k,i u k + n k,i , i = 1, 2, where a k,i is the independent fading factor and n k,i ∼ N (0, σ 2 k,i ) determines the average SNR at BS from each link. Then, we calculate the conditional LLR

0 when the a priori information of u k is not available at the BS. It should be noted that equation (3) when L(u k ) = 0 is exactly the MRC which is the optimal diversity process with two receiving copies.

## B. LLR of the Proposed System

This is in fact to find the LLR values of the systematic bits in a block code but with different fading for different bits. Let C be the set of all possible codewords generated in the relay and x is a specific codeword with u k at position k. (N, K) is the code used in the relay. y is the received data. Similar to the derivation in AWGN in [7], we can obtain

where

In this example, K = 4 and N = 8 consisting of

= 2a j /σ 2 j , j = 1, . . . , N. Compared to equation (3), clearly the difference lies in the last term which contains information constrained by the code used in the RS.

As a result, we can simply compare the reference system and the proposed system by calculating the LLR of each information symbol based on equations ( 3),( 4) and then conduct the threshold detection. For simplicity, we set all direct links from MSs to BS with the same SNR (SN R d ) and vary the SNR between the RS and BS (SN R r ) within a range. Fig. 5 and Fig. 6 show the simulation results for both BER and frame error rate (FER).

From these figures, first we can observe that when the direct link quality (MSs-BS) is moderate or high, such as SN R d =2 dB and above, the proposed system has consistent performance improvement over the reference system. The higher the SN R d , the larger the improvement is. Be noted that this performance gain is obtained with a higher computational cost in equation (4) which, however, is considered practical due to its operating at the BS. Second, when the SN R d is low, such as 0dB, both systems perform very similarly, due to the weak systematic part not being able to help enough in the LLR calculation.

Although we have the similar results by directly comparing the LLR values for two systems when SN R d is small, the benefit of the proposed method has not been fully exploited yet. In fact, the proposed method also gives a mechanism to build up a turbo decoding process which could further provide large gain even at the low SN R d cases.

# IV. TURBO DECODING PRINCIPLE

## A. Multi-user Decoding and Single-user Decoding

It is known that the channel coding is always employed in wireless communications. That it, symbols to be transmitted from a MS to BS have already been coded. When the additional coding is introduced in the relay, the overall coding structure is shown in Fig. 3. This is in fact a product coding system. In the horizontal direction, coding is along each individual user. The codes can be in any type defined in the standard specifications. In the vertical direction (i.e., in the RS), it is a block code or a network code across multiple users. The final objective of the maximum likelihood decoding is to find an estimate of the information data which, after coding in both directions, have the shortest distance from the received data at the BS. This problem can be near-optimally solved by applying the turbo decoding principle. Similar to equation ( 4), it can be verified that the LLR decoding output of one symbol in any code can be decomposed into three terms that include the a priori information (L(u k )), the channel reliability information ( 2a k σ 2 k y k ) and the extrinsic information (i.e., the last term of equation ( 4)). Each source symbol joins two independent coding in two directions and can hence be decoded independently. Therefore, for each symbol, starting from the zero a-priori information, we can generate the extrinsic information from one decoder and use that as the new a-priori information in the other decoder. This information exchange can continue with several iterations until no more improvement is observed. The decoding structure is illustrated in Fig. 4. This process bears the decoding principle of turbo codes but it needs to be noted that the information is exchanged between the decoding of a group of single users and the decoding of multiple users. Different codes with different rates can be used for different users (i.e., different MSs). The codes and rates can also change in different time slots (or packets) in the relay for multiple users. Similarly, the number of users joining the cooperation can also change from time to time.

Equation (4) shows the calculate of extrinsic information. The calculation complexity may be tolerable for a small number of cooperative MSs in the relay but increases exponentially when more MSs join in. For large K values, the Chase-II algorithm in [8] can be applied as a good approximation method in the vertical directional decoding with reduced complexity.

## B. Extrinsic Information for Parity Symbols

Since the relay coding is applied to all data in the horizontal direction in Fig. 3 including the systematic information and parity information of each participating user, the extrinsic information of the parity symbols, in addition to that of the systematic symbols, can also be exploited in the single user decoding. Although any codes can be applied for each user, current industry standards in cellular communications still have a favor of convolutional codes and convolutional codesbased turbo codes. Therefore, we proceed with convolutional codes without loss of generality to show the modification of the conventional BCJR maximum a posteriori probability (MAP) algorithm [9] for the calculation of LLR of the parity symbols. The general idea of providing extrinsic information for all coded data was first presented in [10] but without any implementation details. A specific example was presented in [11]. Actually, we can simply modify the existing "textbook" MAP algorithm based on the trellis for the same purpose.

We illustrate with a recursive systematic convolutional (RSC) code with rate of 1/2. Input to this single user decoder includes the a priori information of both systematic and parity bits generated from the multi-user decoder. For any trellis transition (s k-1 , s k ), there are two output bits (u s k and u p k ). The conditional LLR for u p k , k = 1, . . . , M where M is the length of the information symbols in a packet, given the received data packet y, is

α k (•) and β k (•) can be obtained recursively as

The term we need to modify is γ k (s k-1 , s k ) which was calculated as,

where

is the distance measurement between the received symbols y k and the symbols associated with the transition from s k-1 to s k . In conventional BCJR algorithm P (s k |s k-1 ) is the probability P (u s k ) coming from the a priori information and P (u p k ) is always set to 1/2. In our scenario, since P (u p k ) can be obtained from the multi-user decoder, we need to take this term into account. Therefore, the unnormalized probability can be simply set as P (u s k )P (u p k ) due to the independent additive noise on symbols. Normalization is automatically completed with the same scaling factor in both numerator and denominator. When putting this back to equation ( 6), we can get

where the last term is the extrinsic information generated for the parity bits in the single user decoding. Be noted that the codewords summed in the numerator(or denominator) are those with bit "1" (or "-1") in the considered parity bit position.

V. SIMULATION RESULTS  For simplicity, we use RSC code with generator (7,5) oct and rate 1/2 as the code for each MS. Each link experiences different block fading which is equivalent to using different SNRs in AWGN channels. Operation at RS is the (8,4,4) extended Hamming code. We first show in Figs. 5 and6 the direct comparison for the results of threshold detection after LLR calculation. For SN R d = 5dB, it clearly shows more than 2dB improvement at BER=10 -4 . However, when SN R d = 0dB, the two systems perform almost the same. Then, we consider the involvement of channel decoding and focus on the particularly severe case of SN R d =0 dB where there is no improvement by comparing the LLR directly. The reference system carries out convolutional decoding after the MRC diversity, while the turbo decoding principle is able to be used for the proposed system. Fig. 7 shows the decoding performance of the proposed cooperative communication compared with the reference system. It demonstrates consistent  improvement about 1.5 dB at BER=10 -4 compared with the reference system in such case with severe MS-BS links. Apparently, for other cases where information spread already outperforms MRC, the decoding gain should be even higher. In Fig. 8, we show the performance when SN R d = 1dB. Now the performance starts to improve from the first iteration. At BER=10 -4 , more than 3 dB improvement has been observed compared with the reference system. It can also be observed that only a few iterations (3 or 4 in general) is good enough to secure a high decoding performance. More iterations do not help much. This is because the coding in the vertical direction (i.e., at the relay) is for a small value of K. Hence the correlation between the extrinsic information in this direction occurs quickly, which is unlike the conventional turbo channel coding where each component code is applied to all source information symbols. As a result, improvement may depends on the number of MSs joining the cooperation. In Fig. 9, we also tested the case of K = 3 (i.e., three users in cooperation) for SN R d = 0dB. It also shows large improvement which, however, is less than the case of K = 4. 

# VI. DISCUSSIONS AND CONCLUSIONS

In this paper, a new design for the Relay-based cooperative communication is presented, which is specifically appropriate for future uplink LTE-advanced 4G systems. It uses the information spreading so that a type of "multiple user coding/diversity" gain can be obtained with a turbo-like decoding which alternates between the single-user decoders and the multi-user decoder. A type of coding matrices at the relay, some analysis and simulations results have been provided. The proposed system has shown significant performance improvement over the system without multi-user cooperation. Furthermore, within this framework, we can also note some further interesting research issues. One is the design of optimal matrix A, though it has also been shown [7] that even very simple and week codes might be good component codes in the setting of turbo decoding. Another interesting potential is for Hybrid ARQ. A feature of (8,4,4) code is that when two symbols from different users are wrong, correctly retransmission of one may correct both errors because the 1error-correction capability of the code. Therefore, this system may lead to a new HARQ strategy that retransmission of one user's data could correct the errors in the data of other users in a previous transmission.

