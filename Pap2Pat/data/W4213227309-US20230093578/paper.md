# Experimental Setup

The YVO 4 crystal used in this project was cut and polished from an undoped boule (Gamdan Optics) with a residual total171 Yb concentration of 140 ppb. Nanophotonic cavities were fabricated from this material using focused ion beam milling, see [41,42] for more detail on this process. The cavity used in this work has a Qfactor of ≈ 10, 000 leading to Purcell enhancement and consequent reduction of the 171 Yb excited state lifetime from 267 µs to 2.3 µs as described and measured in [15] and > 99% of ion emission coupling to the cavity mode. The reduced optical lifetime enables detection of single 171 Yb ions. The cavity is undercoupled with κ in /κ ≈ 0.14 leading to 14% of emitted light entering the waveguide mode. Waveguide-free-space coupling is achieved via angled couplers with an efficiency of ≈ 25% and the end-toend system efficiency (probability of detecting an emitted photon) is ≈ 1%.

The device sits on the still-plate of a 3 He cryostat (Bluefors LD-He250) with base temperature of 460 mK. Optical signals are fed into the fridge through optical fibre and focused onto the device with an aspheric lens doublet mounted on a stack of x-y-z piezo nanopositioners (Attocube). The device is tuned on-resonance with the 171 Yb optical transitions via nitrogen condensation. Residual magnetic fields are cancelled along the crystal c ≡ z axis with a set of home-built superconducting magnet coils.

The various optical transitions of a single 171 Yb qubit are employed for state readout and initialisation (Extended Data Fig. 1a). Optical addressing of the A transition for readout is established with a continuous-wave (CW) titanium sapphire (Ti:Sapph) laser (M 2 Solstis) which is frequency-stabilised to a high-finesse reference cavity (Stable Laser Systems) using Pound-Drever-Hall locking [43]. The laser double-passes through two freespace acousto-optic-modulator (AOM) setups leading to single-photon level extinction of the input beam, and pulse generation with ≈ 10 ns rise times. A second CW external cavity diode laser (Toptica DL-Pro) is used to address the F transition during initialisation. The laser passes through an identical AOM setup and is frequency stabilised via offset-frequency locking to the Ti:Sapph.

The light output from the cavity is separated from the input with a 99:1 fibre beamsplitter, and passed through a single AOM which provides time-resolved gating of the light to prevent reflected laser pulses from saturating the detector. The light is then sent to a tungsten-silicide superconducting nanowire single photon detector (SNSPD) (Photonspot) which also sits on the still-plate of the cryostat. Photon detection events are subsequently timetagged and histogrammed (Swabian Timetagger 20).

Microwave pulses to control the ground-state qubit transition (675 MHz) and square-wave RF to generate the 171 Yb-51 V interaction (100-300 kHz) are di-rectly synthesised with an arbitrary waveform generator (Tektronix 5204AWG) and amplified (Amplifier Research 10U1000). A second microwave path is used for the excited state microwave control (3.4 GHz) necessary for qubit initialisation. The control pulses are generated by switching the output of a signal generator (SRS SG386) and amplifying (Minicircuits ZHL-16W-43-S+). The two microwave signal paths are combined with a diplexer (Marki DPXN2) and sent into the fridge to the device. A gold coplanar waveguide fabricated on the YVO 4 surface enables microwave driving of the ions.

See Extended Data Fig. 1 for a schematic of the complete experimental setup.

At the 500 mK experiment operating temperature and at zero magnetic field, the equilibrium 171 Yb population is distributed between the |aux g , |0 g and |1 g states (Extended Data Fig. 1a). All experiments start by initialising the single 171 Yb ion into |0 g via a two-stage protocol [15]. Firstly the |aux g state is emptied with a series of 3 µs pulses applied to the optical F transition each followed by a 3 µs wait period. When the 171 Yb ion is successfully excited from |aux g to |1 e , the population in |1 e will preferentially decay to |0 g during the wait time via the cavity-enhanced E transition. Subsequently, the |1 g state is also emptied by applying an optical π pulse to the A transition followed by a microwave π pulse to the f e transition in rapid succession, which similarly leads to excitation from |1 g to |1 e and decay into |0 g . This process is repeated several times for improved fidelity.

Readout of the 171 Yb |1 g state is performed by applying a series of 100 π pulses to the A transition, each of which is followed by a 10 µs photon detection window. This process is enabled by the cyclic nature of the A transition. To read out the |0 g population we apply an additional π pulse to swap the |0 g ↔ |1 g populations before performing the same optical readout procedure.

Extended Data Fig. 1c shows an exemplary pulse sequence used to store and retrieve a superposition state from the register consisting of four 51 V lattice ions. The sequence starts with initialisation of the 171 Yb qubit into |0 g and the spin-7/2 51 V register into |0 v = |±7/2 ⊗4 . A series of ZenPol polarisation operations are interleaved with 171 Yb re-initialisation sequences and alternate between ω b and ω c transition control to sequentially polarize the 51 V register towards the |±7/2 level. After the initialization sequence, a single π/2 pulse is applied to the 171 Yb qubit to prepare a superposition state. Subsequently, the state is transferred to the 51 V register using a swap operation resonant with the ω c transition as detailed in the main text. After a variable wait time, the superposition state is retrieved with a second swap gate and measured in the x-basis via a π/2 pulse followed by optical readout on the A transition as detailed above.

# ZenPol Sequence

We consider a system of a single 171 Yb qubit coupled to four neighbouring nuclear spin-7/2 51 V ions. This hybrid spin system is described by the effective Hamiltonian (setting = 1):

where

2 /2ω 01 is the effective energy shift due to both z-directed nuclear Overhauser (B OH z ) and external RF (B RF (t)) magnetic fields, ω 01 /2π = 675 MHz is the 171 Yb qubit transition frequency, γ z /2π = 8.5 MHz/G is the 171 Yb ground-state longitudinal gyromagnetic ratio, Q/2π = 165 kHz is the 51 V register nuclear quadrupole splitting, Ŝz is the 171 Yb qubit operator along the z-axis, Îx,z are the 51 V spin-7/2 operators along the x-and z-axis, and a x,z are the effective coupling strengths between 171 Yb and 51 V along the x-and z-axes. See Supplementary Information for a detailed derivation of this effective Hamiltonian.

As discussed in the main text, polarisation of the 51 V register and preparation of collective spin-wave states relies on induced polarisation transfer from the 171 Yb to 51 V and is achieved via periodic driving of the 171 Yb qubit. Specifically, periodic pulsed control can dynamically engineer the original Hamiltonian (equation ( 7)) to realize effective spin-exchange interaction between 171 Yb and 51 V ions of the form, Ŝ+ Î-+ Ŝ-Î+ , in the average Hamiltonian picture [36], [44]. One example of such a protocol is the recently developed PulsePol sequence [35], however, it relies on states with a constant, nonzero magnetic dipole moment and therefore cannot be used in our system since the 171 Yb qubit has no intrinsic magnetic dipole moment. Motivated by this approach, we have developed a variant of the PulsePol sequence that accompanies a square-wave RF field synchronized with the sequence (Extended Data Fig. 4a). The base sequence has a total of 8 free-evolution intervals with equal duration (τ /4) defined by periodically spaced short pulses and is repeatedly applied to 171 Yb. Following the sequence design framework presented in Ref. [36], we judiciously choose the phase and ordering of the constituent π/2 and π pulses such that the resulting effective interaction has spin-exchange form with strength proportional to the RF magnetic field amplitude (B RF ), whilst decoupling from interactions induced by the Overhauser field (B OH z ). We also design the sequence to cancel detuning induced by both of these fields and to retain robustness against pulse rotation errors to leading order. We term this new sequence 'ZenPol' for 'zero first-order Zeeman nuclear-spin polarisation'.

To understand how the ZenPol sequence works, one can consider a toggling-frame transformation of the 171 Yb spin operator along the quantisation axis ( Ŝz,tog (t)): we keep track of how this operator is transformed after each preceding pulse. For example, the first π/2 pulse around the y-axis transforms Ŝz into -Ŝx and the subsequent π pulse around the y-axis transforms -Ŝx into + Ŝx . Over one sequence period, the togglingframe transformation generates a time-dependent Hamiltonian Ĥtog (t) that is piecewise constant for each of 8 free-evolution intervals, which can be expressed as

Here, f OH x,y (t) describes the time-dependent modulation of the 171 Yb qubit operator along the z axis ( Ŝz,tog (t) = f OH x (t) Ŝx + f OH y (t) Ŝy ) (Extended Data Fig. 4a). Note that f OH z (t) = 0 for all intervals. Since the externallyapplied square-wave RF field is constant for each halfsequence period, we can replace B RF (t) with the amplitude B RF and transfer the time dependence to f OH x,y by applying sign flips, thus leading to redefined modulation functions f RF

x,y (Extended Data Fig. 4a). The spin-7/2 51 V ion exhibits three distinct transitions at frequencies ω a,b,c (Fig. 1b). In the following, we consider an effective spin-1/2 system for the 51 V ions using the ω c manifold,

In a rotating frame with respect to the target frequency ω c , the nuclear spin operators become Îx → Îx cos(ω c t) + Îy sin(ω c t) and Îz → Îz . Thus, the leading-order average Hamiltonian, Ĥavg = 1 2τ 2τ 0 dt Ĥtog (t), in the rotating frame is given by:

Here, various terms are excluded as they time average to zero (rotating-wave approximation). The √ 7 prefactor comes from mapping the original spin-7/2 operators to the effective spin-1/2 ones. Additionally, the energy shift induced by B OH z and time-dependent B RF is cancelled since we are using square-wave RF. The Fourier transforms of the modulation functions f x,y (t), termed the filter functions [45], directly reveal resonance frequencies at which equation ( 9) yields non-zero contributions (Extended Data Fig. 4b). Resonant interactions with strength proportional to the nuclear Overhauser field are achieved at sequence periods 2τ which satisfy 1 2τ = ωc 2π×2 , ωc 2π×4 , ωc 2π×6 , • • • ; interactions proportional to the RF field occur at sequence periods satisfy-

Critically, these two sets of resonances occur at different values of 2τ , hence we can preferentially utilise the coherent, RF-induced interactions whilst decoupling from those induced by the randomised Overhauser field. This is experimentally demonstrated in Fig. 2b where the RF-induced resonances are spectrally resolved. In this measurement the linewidth of the register resonances are limited by that of the filter function. We also note that the ω a transition cannot be independently addressed by the ZenPol sequence due to the multiplicity of the three 51 V transitions determined by the quadratic Hamiltonian (ω a = ω b /2 = ω c /3).

We use the RF-driven resonance identified at 1 2τ = ωc 2π×5 by setting the free-evolution interval to τ 4 = 5π 4ωc . Under this resonance condition, the average Hamiltonian (equation ( 9)) is simplified to

Here, going from the first to the second line, we change the local 171 Yb basis by rotating 45 degrees around the z-

and from the second to the third line, Ŝ ± = Ŝ x ± i Ŝ y and Î± = Îx ± i Îy are used. We define the coefficient b (k,ωj ) which determines the interaction strength for the k th resonance addressing transition ω j (for example, b (5,ωc) = -√ 7( √ 2 + 2)a x /10π). In the main text, we omit the primes on the 171 Yb qubit operators for the sake of notational simplicity. The same analysis can be performed for other transitions, yielding a similar spinexchange Hamiltonian, albeit with different interaction strength.

Direct Drive Gates for 51 V Register Performing dynamical decoupling on the register requires selective driving of the froze-core 51 V nuclear spins without perturbing the bath and is achieved through a two-fold mechanism. Firstly we initialise the 171 Yb qubit into |0 g and apply a sinusoidal z-directed RF magnetic field at ω c /2π = 991 kHz through the coplanar waveguide to induce an oscillating 171 Yb magnetic dipole moment (Extended Data Fig. 7a). This generates an x-directed field component at each 51 V spin, where the driving Hamiltonian is given by Ĥdrive = µ N g vx A x B osc z sin(ω c t) Îx with A x = -3lnµ 0 γ 2 z /8πr 3 ω 01 . Here, µ N is the nuclear magneton, g vx is the 51 V xdirected g-factor, B osc z is the sinusoidal RF magnetic field amplitude, Îx is the nuclear spin-7/2 operator along the x-axis, {l, n} are the {x, z} directional cosines of the 171 Yb-51 V displacement vector, µ 0 is the vacuum permittivity, and r is the 171 Yb-51 V ion distance (Supplementary Information). The lattice symmetry of the host leads to equidistant spacing of the four proximal 51 V spins from the central 171 Yb qubit allowing homogeneous coherent driving of all register spins.

In this direct driving scheme, we note that the effect of B osc z is amplified by a factor of A x ≈ 6.7 for the frozencore register spins at a distance of r = 3.9 Å (Supplementary Information). Crucially, the amplification factor scales as A x ∝ 1/r 3 with distance r from the 171 Yb qubit, leading to a reduced driving strength for distant 51 V bath spins. Moreover, the transition frequency of the bath, ω bath c /2π = 1028 kHz, is detuned by 37 kHz from that of the register, ω c /2π = 991 kHz, further weakening the bath interaction due to off-resonant driving provided that the Rabi frequency is less than the detuning.

In a rotating frame at frequency ω c , the driving Hamiltonian Ĥdrive gives rise to Rabi oscillation dynamics of the register spins within the ω c manifold, {|↑ = |±5/2 , |↓ = |±7/2 }. To calibrate 51 V π pulse times, we initialise the register into |0 v = |↓↓↓↓ , drive the register for variable time, and read out the |0 v population by preparing the 171 Yb qubit in |1 g and applying a swap gate to the ω c transition. If the final 51 V spin state is in |↓ (|↑ ) the swap will be successful (unsuccessful) and the 171 Yb qubit will end up in |0 g (|1 g ). Using this method, we induce resonant Rabi oscillations of the register at a Rabi frequency of 2π × (7.65 ± 0.05) kHz (blue markers, Extended Data Fig. 7c) which exhibit exponential decay on a 280 ± 30 µs timescale, limited by dephasing caused by the fluctuating 171 Yb Knight field. This can be decoupled using motional narrowing techniques whereby we periodically apply π pulses to the 171 Yb every 6 µs during the drive period. In order to drive the 51 V spins in a phase-continuous manner, we compensate for the inversion of the 171 Yb magnetic dipole moment after each π pulse by applying a π phase shift to the sinusoidal driving field (Extended Data Fig. 7b). This leads to an extended 1/e Gaussian decay time of 1040 ± 70 µs (red markers, Extended Data Fig. 7c).

The arrow in Extended Data Fig. 7c indicates the 69 µs 51 V π pulse time used for dynamical decoupling. In contrast to the spin-preserving exchange interaction, this direct drive protocol provides independent, local control of the four 171 V spins with no constraints on the number of excitations, thereby coupling the 51 V register to states outside the two-level manifold spanned by |0 v and |W v . For example, at odd multiple π times, we find

both of which contain more than a single excitation. For this reason, we use an even number of 51 V π pulses in our decoupling sequences to always return the 51 V register to the memory manifold prior to state retrieval.

# Population Basis Measurements

We develop a sequential tomography protocol [39] to read out the populations of the joint 171 Yb-51 V density matrix ρ in the effective four-state basis,

. This is achieved using two separate sequences: Readout sequence 1 and Readout sequence 2, applied alternately, which measure the {|0 g 0 v , |0 g W v } and {|1 g 0 v , |1 g W v } populations respectively. As shown in Extended Data Fig. 9a, these sequences are distinguished by the presence (absence) of a single π pulse applied to the 171 Yb qubit at the start of the sequence. This is followed by a single optical readout cycle on the A transition; results are post-selected on detection of a single optical photon during this period. Hence the presence (absence) of the first π pulse results in |0 g (|1 g ) state readout after post selection. Furthermore, in all post-selected cases the 171 Yb qubit is initialised to |1 g by taking into account this conditional measurement outcome. Subsequently, an unconditional π pulse is applied to the 171 Yb, preparing it in |0 g and a swap gate is applied, thereby transferring the 51 V state to the 171 Yb. Finally, we perform single-shot readout of the 171 Yb state according to the protocol developed in [15]. Specifically, we apply two sets of 100 readout cycles to the A transition separated by a single π pulse which inverts the 171 Yb qubit population. The 51 V state is ascribed to |W v (|0 v ) if ≥ 1 (0) photons are detected in the second readout period and 0 (≥ 1) photons are detected in the third. We summarise the possible photon detection events and state attributions in Extended Data Fig. 9b.

We demonstrate this protocol by characterizing the state preparation fidelities of the four basis states. The measured histograms are presented in Extended Data Fig. 9c alongside the respective gate sequences used for state preparation. The resulting uncorrected (corrected) preparation fidelities for these four basis states are: F |0g0v = 0.79 ± 0.01 (0.82 ± 0.02), F |0gWv = 0.50 ± 0.02 (0.64 ± 0.02), F |1g0v = 0.79 ± 0.01 (0.82 ± 0.02), F |1gWv = 0.50 ± 0.02 (0.64 ± 0.02).

We note that the reduced fidelity of |0 g W v and |1 g W v relative to |0 g 0 v and |1 g 0 v arises from the swap gate used for the |W v state preparation. Finally, we also characterize the fidelity of the maximally entangled 171 Yb-

, prepared using a single √ swap gate as described in the main text (Extended Data Fig. 9d). The corresponding uncorrected (corrected) populations for the four basis states, denoted p ij (c ij ) are:

0.12 ± 0.01 (c 11 = 0.11 ± 0.01).

# Swap Gate Fidelity Correction

Since 171 Yb readout fidelity is > 95% [15], the dominant error introduced during the population basis measurements arises from the swap gate. We measure its fidelity in the population basis by preparing either the |0 g 0 v state (zero spin excitations) or the |1 g 0 v state (single spin excitation) and applying two consecutive swap gates such that the system is returned to the initial state. By comparing the 171 Yb population before (p pre ) and after (p post ) the two gates are applied, we can extract fidelity estimates independently from the 51 V state initialisation. Assuming the swap and swapback processes are symmetric, we obtain a gate fidelity F sw = (1 -2p post )/(1 -2p pre ). This quantity is measured for zero spin excitations leading to F sw,0 = 0.83 and with a single spin excitation leading to F sw,1 = 0.52.

When measuring the joint 171 Yb-51 V populations {p 00 , p 01 , p 10 , p 11 } we can use these fidelities to extract a set of corrected populations {c 00 , c 01 , c 10 , c 11 } according to the method described in [46,47] using

where

We use a similar approach to correct the √ swap gate used to read out the Bell state coherence (Supplementary Information).

The 171 Yb 3+ ion substitutes for yttrium in a single site of the YVO 4 crystal, furthermore naturally abundant V and Y contain 99.8% 51 V and 100% 89 Y isotopes, respectively. Hence each 171 Yb ion experiences a near-identical nuclear spin environment. The 51 V ions have nuclear spin-7/2 leading to electric quadrupole interactions that cause a zero-field splitting. The resulting zero-field energy level structure of the 51 V spins is given by:

where Q/2π = 171 kHz measured using nuclear magnetic resonance (NMR) on bulk YVO 4 crystals [32] and Îz is the 51 V nuclear spin-7/2 spin operator along the c ≡ z axis. Note that the local 51 V register ions surrounding the 171 Yb qubit experience a frozen-core detuning as discussed in the main text, leading to a smaller quadrupolar splitting with Q/2π = 165 kHz. The energy level structure of these register ions is shown in Fig. 1b. The 89 Y ion, on the other hand, has no zero-field structure.

The positions of the six nearest 51 V ions are tabulated below, where r = [x y z] is the 171 Yb-51 V position vector with magnitude r and direction cosines {l, m, n}.

2 nd 3.9 0 -3.6 1.6 0 -0.91 0.40 4 2 nd 3.9 0 3.6 1.6 0 0.91 0.40 5 2 nd 3.9 -3.6 0 -1.6 -0.91 0 -0.40 6 2 nd 3.9 3.6 0 -1.6 0.91 0 -0.40

Note that the two nearest 51 V ions (1 and 2) are located directly above and below the 171 Yb qubit along the z-axis, due to their positions they cannot be driven by the induced 171 Yb magnetic dipole moment and thus belong to the bath (Supplementary Information Section A 4). In contrast, ions 3-6 are symmetrically positioned in the lattice with non-zero x/y and z coordinates, forming the frozen-core register spins utilized as a quantum memory.

The 51 V ions have a uniaxial g-tensor with form [48]:

See Supplementary Information Section D for an experimental estimation of these tensor components.

3. 171 Yb-51 V Interactions

The magnetic dipole-dipole interaction between the 171 Yb qubit and a single 51 V ion can be described by the following Hamiltonian:

where

(note that Ŝ and Î are vectors of 171 Yb and 51 V spin operators, respectively), µ B is the Bohr magneton, µ N is the nuclear magneton, µ 0 is the vacuum permeability and r is the 171 Yb-51 V displacement vector with magnitude r. Due to the highly off-resonant nature of the 171 Yb-51 V interaction, a secular approximation would be appropriate. To first order, however, all secular terms involving the 171 Yb qubit basis are zero, i.e., 0 g | Ĥdd |0 g = 0, 1 g | Ĥdd |1 g = 0.

To proceed, we consider second-order effects which generally scale as ∼g 2 /∆E, where ∆E is the energy separation between a pair of unperturbed eigenstates. By taking into account the fact that g z is roughly 7 times larger than g x , g y and Ŝz terms in Ĥdd mix |0 g and |1 g with small ∆E whereas Ŝx and Ŝy mix the 171 Yb qubit states and |aux g with large ∆E, we restrict our consideration to the Ŝz terms in Ĥdd :

where {l, m, n} are direction cosines of the 171 Yb-51 V displacement vector. Note that the Ŝz operator is the electron spin-1/2 operator defined as Ŝz = 1/2(|0 g 1 g |+|1 g 0 g |) in the basis of the hybridised eigenstates of the 171 Yb qubit.

# Nuclear Overhauser Field

As discussed in the main text, we can divide the 51 V spins into two ensembles: register spins and bath spins. The bath spins comprise 51 V ions which are not driven by the 171 Yb qubit for the following two reasons:

1. Ions which aren't driven due to position: certain ions (such as 1 and 2 in the above table) only interact via an Ising-type Ŝz Îz Hamiltonian. Hence the 171 Yb qubit cannot be used to drive transitions between the 51 V z-quantised quadrupole levels.

2. Ions which aren't driven due to detuning: As observed in the ZenPol spectra (Fig. 2b in the main text), more distant spins are spectrally separated from the nearby ions comprising the register.

We assume that the bath spins are in an infinite-temperature mixed state: ρ V = 1 V /T r{1 V }, where 1 v is the identity matrix in the Hilbert space for the bath spins. In the mean field picture, their effect on the 171 Yb can be approximated as a classical fluctuating magnetic field, commonly termed the nuclear Overhauser field. As mentioned previously, since g 2 z g 2 x,y , the z-component of the Overhauser field is dominant, given by

where r (i) and n (i) are the distance and z-direction cosine between the 171 Yb and i th bath spin, and m (i) I ∈ {-7/2, -5/2, ..., 5/2, 7/2} is the nuclear spin projection at site i. Note that B OH z is randomly fluctuating due to the stochastic occupation of the 8 possible |m I states, however, it is quasi-static on the timescale of our control sequences, hence we do not label the time dependence.

3. 171 Yb-enhanced register spin-spin interactions: These terms are derived by considering second-order perturbations using the Schrieffer-Wolff transformation [49,50]. For example, the dominant Ising-type terms take the form

where r and n are the magnitude and z-direction cosine of the 171 Yb-51 V register ion displacement vector. However, we note that the ZenPol sequence cancels these interactions to first order.

By simulating 171 Yb Ramsey coherence times we extract g vz ≈ 1.6. We note that estimation of the bare 51 V coherence time indicates a potential discrepancy in this value by up to 25%, discussed further in Supplementary Information Section I, however, this has a negligible impact on the ZenPol sequence simulations. We obtain an estimate for g vx ≈ 0.6 by calibrating the RF field amplitude and comparing with the experimental results of direct 51 V spin driving in Extended Data Fig. 7.

We compute the nuclear Overhauser field B OH z according to equation (S8) by randomly sampling the bath states for each Monte-Carlo simulation repetition. We include a simple model of the bath dynamics by incorporating stochastic jumps of the bath spins on magnetic-dipole allowed transitions.

We simulate the register spin dynamics in a reduced Hilbert space by considering only the ω c manifold. This enables fast simulation of all four register spins plus the 171 Yb qubit transition (Hilbert space with dimension 32). Imperfect polarisation of the 51 V register into |↓ = |±7/2 is categorised into two distinct types:

1. Imperfect polarisation within the ω c transition i.e. a small residual population 1 in |↑ = |±5/2 . 2. Imperfect polarisation outside the ω c manifold i.e. a small residual population 2 in |±1/2 and |±3/2 . This leads to a |↓ population of 1 -1 -2 . We incorporate incomplete polarisation by sampling different register initial states for each Monte-Carlo repetition. For case 1, this involves occasionally initialising a given 51 V ion into |↑ , while for case 2 this involves reducing the Hilbert space dimension by removing the 51 V ion from the simulation. We also take into account finite pulse duration effects by modeling the ZenPol sequence using 25 ns π/2 and 50 ns π pulses (Extended Data Fig. 6a).

As shown in Extended Data Fig. 6d, the spin-exchange oscillations from numerical simulation (red dashed line) exhibit slower decay than the measured experimental results (red markers). We add a phenomenological exponential decay envelope, ce -M/τ M , to the simulation results where c and τ M are free parameters, and M is the ZenPol sequence period. The additional decay could be caused by heating due to the RF field, excess 171 Yb dephasing or additional register spin interactions which we haven't considered here. We fit this model by optimising multiple parameters: 1 , 2 , B RF , c and τ M . The resulting values of 1 and 2 are 0.12 and 0.04, respectively, indicating ≈ 84% polarisation into |↓ ; the RF magnetic field amplitude is B RF ≈ 1.6 G and the phenomenological exponential decay parameters are c = 0.8 and τ M = 90 leading to a close fit with the experimental results (red solid line, Fig. 2c and Extended Data Fig. 6d). Additional simulation results following this methodology with varying B RF and τ are presented in Extended Data Fig. 6.

Finally, we model the results with a single-spin excitation in the ω c -manifold by including the |±3/2 level in the simulation (Fig. 2d and Supplementary Information Section H). The initial state used in this simulation is partially polarised between the |±3/2 level with population 1 -and the |±1/2 level with population . We use the same value of B RF = 1.6 G as in Fig. 2c, and optimise the polarisation level leading to 1-= 0.8. The close correspondence between the measured and simulated oscillation profiles suggests that the register consists of the second shell of four homogeneously coupled 51 V ions.

# E. Hartmann Hahn Spectroscopy

In addition to the ZenPol spectra discussed in the main text, we use Hartmann-Hahn (HH) double resonance [34] to perform spectroscopy of the nuclear spin environment. This method enables spin exchange between two systems with different transition frequencies by resonantly driving a qubit with a Rabi frequency that matches the energy level splitting of the environmental nuclear spins. In our case, we resonantly drive the 171 Yb at 675 MHz to generate a pair of dressed states |± = 1 √ 2 (|0 g ± i |1 g ) with splitting Ω which we sweep over a range ≈ 2π×(0-2.3) MHz (Extended Data Fig. 3). The 171 Yb qubit is initialised into the |-dressed state by a π/2 pulse preceding the driving period. If resonant with a nuclear spin transition, the 171 Yb qubit undergoes spin exchange at a rate dictated by the interaction strength. Finally we read out the 171 Yb |+ dressed state population to determine whether spin exchange has occurred.

Extended Data Fig. 3b shows experimental results of HH spectroscopy where we vary both the HH drive Rabi frequency (Ω) and also the HH pulse duration (t). The counts plotted on the colour-bar are proportional to the |+ dressed state population. We find three clear resonances at evenly spaced pulse amplitudes 0.15, 0.30 and 0.45 corresponding to the ω a , ω b and ω c 51 V transitions; notably, unlike ZenPol, the HH sequence only has one harmonic leading to a single resonant interaction per transition. Also note the lack of oscillations when varying the pulse duration, t, on resonance with either of the three transitions: this is because the spin exchange is driven by the randomised, Overhauser field induced 171 Yb dipole moment. For this reason, the HH sequence cannot be used to generate the coherent exchange interaction necessary to realise a swap gate for our system. In the case of no driving (Ω = 0), the signal rapidly saturates as t increases as a result of Ramsey dephasing of the initial state. However, as Ω exceeds the 171 Yb spin linewidth (∼ 50 kHz [15]), this effect diminishes due to the emergence of spin-locking effects and consequently leads to an increased saturation timescale when not resonant with the 51 V transitions. The resolution of this measurement is also limited by the 171 Yb spin linewidth, and we therefore cannot resolve the splitresonance structure observed in the ZenPol spectra. The results agree well with simulations (Extended Data Fig. 3c) indicating that interactions with the 51 V quadrupolar structure dominate these measurements.

# F. Polarisation of multi-level register nuclear spins

Polarisation dynamics are explored using the PROPI method (polarisation readout by polarisation inversion) [52]. This sequence uses the back-action of the 51 V spins on the 171 Yb to measure the register polarisation after successive ZenPol polarisation cycles. For instance, when polarising into |↑ = |±5/2 on the ω c transition, the 171 Yb is initialised into |1 g and undergoes spin exchange with any 51 V population in |↓ = |±7/2 . The 171 Yb |0 g population after interaction is therefore related to the residual 51 V |↓ population. As presented in Extended Data Fig. 5a, we measure the 171 Yb population after each of 20 consecutive polarisation cycles and observe a saturation after 10 cycles, indicating that the 171 Yb polarisation has been transferred to the 51 V register. The high-contrast signal obtained in this measurement is enabled by alternating the 51 V polarisation direction, i.e. periods of polarisation into |↑ are interleaved with periods of polarisation into |↓ . This mitigates the need to wait for slow register thermalisation (T (0) 1 = 0.54 s, see Supplementary Information Section J) between consecutive experiment repetitions. These measurements are repeated with ZenPol sequences on the ω b transition, demonstrating similar levels of polarisation saturation after approximately 10 cycles (Extended Data Fig. 5b).

We also demonstrate the effect of incomplete register polarisation on the spin-exchange oscillation by varying the number of polarisation cycles on the ω b and ω c transitions before each experiment (Extended Data Fig. 5c). As expected, we see that coherent spin-exchange oscillations emerge as an increasing number of polarisation cycles are applied.

These results inform the design of polarisation sequences used in subsequent single-spin excitation experiments where 40 polarisation cycles interleaved between the ω b and ω c transitions are sufficient to polarise the register into |0 v = |↓↓↓↓ . Based on simulations discussed in Supplementary Information Section D we estimate this protocol achieves ≈ 84% polarisation into the |0 v state. Note that we don't use the ZenPol sequence to directly polarise the ω a transition due to spectral overlap with ω b and ω c (Fig. 2b). We postulate that the high degree of polarisation can still be achieved even in the absence of direct ω a transition control due to two factors:

1. The thermalisation timescale of the ω a transition is significantly shorter than the interrogation time. Specifically, our experiments typically run for several minutes whereas the ω a thermalisation rate is likely similar to T (0) 1 = 0.54 s. Thus, undesired population in the |±1/2 level can still pumped to |±7/2 once it relaxes to |±3/2 . 2. Once successfully initialised into the ω c manifold the probability of shelving into the |±1/2 level is small as it necessitates two consecutive decays on the ω b and ω a transitions, both of which are considerably slower than our experiment/polarisation repetition rate (20 ms).

We tried to improve the polarisation fidelity by incorporating direct driving on the ω a transition using the method in Extended Data Fig. 7 during the polarisation protocol, thus leading to fast population exchange between |±1/2 and |±3/2 . However, there was no improvement to the contrast of the resulting spin exchange oscillations thereby indicating that shelving into |±1/2 is not a limiting factor in our experiments.

# G. Analysis of Spin Exchange Dynamics

In this section we present an analysis of the spin exchange dynamics on the ω c register transition. The spin-exchange measurements in Fig. 2c are measured at a fixed ZenPol period of 2τ = 5.048 µs leading to resonant interactions with

# ACKNOWLEDGEMENTS

This work was funded by the Institute of Quantum Information and Matter, an NSF Physics Frontiers Center (PHY-1733907) with support from the Moore Foundation, NSF 1820790, Office of Naval Research Award No. N00014-19-1-2182, Air Force Office of Scientific Research Grant No. FA9550-18-1-0374 and No. FA9550-21-1-0055, Northrop Grumman, General Atomics, and Weston Havens Foundation. The device nanofabrication was performed in the Kavli Nanoscience Institute at the California Institute of Technology. J.R. acknowledges the support from the Natural Sciences and Engineering Research Council of Canada (NSERC) (PGSD3-502844-2017). A.R. acknowledges the support from the Eddleman Graduate Fellowship. J.C. acknowledges support from the IQIM postdoctoral fellowship. We thank J. Kindem, J. G. Bartholomew, N. Yao, A. Sipahigil, M. Lei and T. Xie for useful discussion, and M. Shaw for help with superconducting photon detectors.

# SUPPLEMENTARY INFORMATION

A. 171 Yb-51 V Interactions

# Ground State 171 Yb Hamiltonian

The effective spin-1/2 Hamiltonian for the 2 F 7/2 (0) 171 Yb 3+ ground state is given by [31]:

where B is the magnetic field, Ŝ and ÎYb are vectors of 171 Yb electron and nuclear spin-1/2 operators respectively and we neglect the nuclear Zeeman term. The ground state g tensor is given by:

which is a uniaxial tensor with the extraordinary axis parallel to the c-axis of the crystal and the two ordinary axes aligned with the crystal a-axes. The ground state A tensor is given by:

Extended Data Fig. 1a shows the zero magnetic field energy level structure with hybridised 171 Yb electron-nuclear spin eigenstates. Note that the zero-field 171 Yb qubit states, |0 g and |1 g , have no magnetic dipole moment. See [31] for more details. Throughout this work we adopt an = 1 convention.

Crucially, the nuclear Overhauser field generates some weak mixing between |0 g and |1 g leading to perturbed eigenstates | 0g and | 1g which have a small, induced, z-directed dipole moment. These states have the form

where γ z = g z µ B is the longitudinal gyromagnetic ratio of the 171 Yb qubit and ω 01 /2π = 675 MHz is the unperturbed 171 Yb |0 g ↔ |1 g transition frequency. Here we have added the effect of an externally applied, z-directed, squarewave RF magnetic field B RF (t) with amplitude B RF used in the ZenPol sequence (see main text for details); note that this field is piecewise constant for each half-sequence period, hence the time dependence corresponds to periodic flips between ±B RF . In addition, these fields induce a detuning of the 171 Yb |0 g ↔ |1 g transition, which can be calculated using second-order perturbation theory as ∆(t) = γ 2 z (B OH z + B RF (t)) 2 /2ω 01 .

# Interaction with Register Ions

We postulate that the second nearest shell of four 51 V ions (ions 3-6 in the table above) comprise the register. These four ions are equidistant from the 171 Yb and interact via both an Ŝz Îz term and Ŝz Îx or Ŝz Îy terms. To identify an effective interaction Hamiltonian in the perturbed basis {| 0g , | 1g }, we consider only secular matrix elements of Ĥdd (equation (S7)):

Hence the effective interaction between the 171 Yb qubit and the four register spins, Ĥint = i∈register Ĥ(i) dd , can be described by

Finally, we perform local basis transformations of each 51 V ion to further simplify the Hamiltonian form. Specifically, we apply the following unitary rotation:

where θ (j) = tan -1 (m (j) /l (j) ), which leads to

z . Note that the coupling coefficients a x and a z are homogeneous (i.e. independent of site index i) since the four register spins are equidistant from the central 171 Yb and have directional cosine factors with equal magnitude.

The same result can also be derived using the Schrieffer-Wolff transformation [49,50], where the interaction Hamiltonian obtained here corresponds to the dominant second-order perturbation terms. Hereafter we simplify our notation and use |0 g and |1 g without tildes to represent the weakly perturbed eigenstates in the presence of any small magnetic field.

# Full System Hamiltonian

Combining the various energy and interaction terms, the full system Hamiltonian (in a 171 Yb frame rotating at ω 01 /2π = 675 MHz) becomes: High fidelity control of the 171 Yb |0 g ↔ |1 g transition is essential for implementing the ZenPol sequence and enabling coherent 171 Yb-51 V interactions. For example, a single swap operation realised by the ZenPol sequence contains 120 local 171 Yb gates. We characterise our single qubit gate fidelity using randomised benchmarking [51], which provides a value independent from state preparation or measurement (SPAM) errors. We apply randomly sampled single qubit Clifford gates constructed using π and π/2 rotations around the x and y directions followed by the single-gate inverse operation (Extended Data Fig. 2a). When the number of gates, M gate , increases, the sequence error accumulates and the probability of returning to the initial |0 g state reduces according to an exponential decay:

When ensemble-averaged over a sufficiently large number of random gate sets (in our case 100), f = 1 2 (1+d) becomes a reliable estimate of the average single-qubit gate fidelity. Measurement results are presented in Extended Data Fig. 2a, leading to an extracted average single qubit gate fidelity of f = 0.99975 ± 0.00004.

We also measure the T 2 coherence time of the qubit transition using an XY-8 dynamical decoupling sequence [38]. Specifically, we work with a fixed inter-pulse separation of 5.6 µs and measure the coherence time by varying the number of decoupling periods, M (Extended Data Fig. 2b). We measure an exponential decay with 1/e time constant T 2 = 16 ± 2 ms. We note that this measurement uses the same method as in [15], however, we observe a factor of three improvement in coherence due to the improved microwave setup leading to correspondingly increased π gate fidelities.

# C. Extra Register Detail

In this section we provide additional technical details related to the single excitation states used to store quantum information on the 51 V spins.

The general form for the engineered spin-exchange interaction is:

where, B RF is the square-wave RF magnetic field amplitude, b

(k,ωj ) is the k th resonance prefactor for transition ω j of the i th register spin, Î+ = |↑ ↓|, Î-= |↓ ↑|, are raising and lowering operators in an effective nuclear spin-1/2 manifold and Ŝ+ = |1 g 0 g |, Ŝ-= |0 g 1 g | are raising and lowering operators for the 171 Yb qubit. Note, unlike the main text, we do not assume homogeneous coupling to the register spins, hence the b (i) (k,ωj ) coefficients depend on the register site index i. In addition, we consider an arbitrary number of register spins, N , that are spectrally indistinguishable.

When the 171 Yb is initialised in |1 g and the 51 V register spins are polarised in |0 v = |↓ ⊗N , this interaction leads to the following spin-exchange evolution [14]:

where the spin-exchange frequency is given by:

and the resulting single-spin excited state generated by this interaction is:

Based on the results presented in Fig. 2d and Supplementary Information Section H we postulate that for our system the register consists of the second nearest shell of four homogeneously coupled 51 V ions. In this case we recover the expressions presented in the main text, namely, the single-spin excitation in the register realises an entangled four-body W-state, |W v , as depicted in Fig. 1c:

and the spin-exchange rate is given by J ex = 4B RF b (k,ωj ) . In general, for N homogeneously coupled register spins, we expect that the spin-exchange rate is enhanced by a factor of √ N , leading to faster swap gate operation. We note that in this protocol it is possible to transfer a second spin excitation to the register. More specifically, the spin-preserving exchange interaction, Ŝ-Î+ + Ŝ+ Î-, couples the state 51 V state with two spins in |↑ . To avoid undesired excitation to states outside of the effective {|0 v , |W v } manifold, we always prepare the 171 Yb qubit in |0 g before retrieving stored states from the 51 V register. Hence the swap gate realised by this interaction operates on a limited basis of states.

We stress that utilising the dense, lattice nuclear spins ensures near identical registers for all 171 Yb ions. Extended Data Figure 10 shows ZenPol spectra near the ω c transition, collectively enhanced spin-exchange oscillations and motionally-narrowed T * 2 times for three 51 V registers coupled to three different 171 Yb ions. The 171 Yb optical and microwave frequencies were re-calibrated for each ion, however, all aspects of the experimental sequences related to register control and readout were identical.

# D. Simulation

We simulate our coupled spin system using the effective Hamiltonian derived in Supplementary Information Section A 6, however we add three additional terms:

1. Nuclear Zeeman interactions of the 51 V register spins with the Overhauser field from the bath:

Since the energy levels are quantised along the z-axis, magnetic fluctuations along the z-direction dominate, which can be captured by the following Hamiltonian

where B OH z (r i ) is the z-component of the Overhauser field evaluated at the position of the i th register ion, r i .

2. Nuclear magnetic dipole-dipole interactions of the register spins:

with r ij the displacement vector between 51 V register spins at sites i and j.

the 991 kHz ω c transition. However, analogous to the Rabi oscillations in a two-level system, the oscillation frequency and contrast of these spin transfer oscillations also depend on the detuning of the ZenPol sequence relative to the 51 V transition. Specifically, we expect the following relations:

Here J ex and C are the spin-exchange frequency and oscillation contrast, respectively, and δ is the detuning of the ZenPol sequence resonance relative to a target nuclear spin transition. We polarise the register into |0 v and measure the frequency detuning dependence of the spin-exchange oscillations in Extended Data Fig. 6c. These results agree well with the corresponding simulations shown in Extended Data Fig. 6b.

We also demonstrate control of the spin exchange frequency by varying the RF magnetic field amplitude (B RF ). Extended Data Figure 6d shows the spin-exchange dynamics for four different values of B RF = 0.8 G, 1.2 G, 1.6 G and 2.0 G. The inset in Fig. 2c plots extracted spin exchange frequencies J ex for a range of different B RF demonstrating linear dependence as expected and leading to accurate control of the engineered interaction strength (see main text for details).

# H. Single Excitation in ωc Manifold

The ability to shelve populations in different quadrupole levels enables the operation of the 51 V register with an alternative set of many-body states: |0 v and |1 v . For this experiment we polarise the 51 V spins down the energy ladder on the ω b and ω c transitions leading to polarisation primarily into the |±3/2 level, with a small residual population in |±1/2 . For the purpose of this analysis we will assume perfect polarisation into |±3/2 , however we note that ω a transition polarisation would be required for this.

We prepare the register |1 v state by injecting a single spin excitation on the ω b transition (i.e. from |±3/2 → |↑ = |±5/2 ), this is achieved using the corresponding ZenPol resonance at ω b , k = 3:

Here we omit the ± sign in the state label for simplicity. Subsequently, we prepare the 171 Yb in |0 g and induce a spin exchange oscillation between |↑ and |↓ = |±7/2 via a ZenPol sequence resonant with the ω c transition. The resulting time evolution is given by

where

and J ex = 2b (5,ωc) B RF . Notice that the spin-exchange oscillation rate, J ex , no longer has a √ N rate enhancement, this is because every ket in the |1 v and |0 v states contains only a single spin in the ω c -transition manifold. Using this manifold for information storage would have several benefits. For instance, direct microwave driving of the register ω c transition would lead to Rabi oscillation between |0 v and |1 v and could therefore be used to realise local gates in this basis. Additionally, a second spin excitation is not allowed in this scheme, therefore the ZenPol sequence reproduces a complete two-qubit swap gate regardless of the 171 Yb state. For these reasons, we believe that there may be some advantages to working with the {|0 v , |1 v } manifold if the state initialisation fidelity into |±3/2 can be improved via direct ω a transition polarisation. We leave this for future work.

# I. T * 2 Coherence Discussion

Here we provide detailed discussions regarding the 51 V register coherence decay processes described in the main text. There are two magnetic interactions which limit the T * 2 dephasing timescale: (1) the direct nuclear Zeeman interaction of each register spin with the Overhauser field (equation (S20)) and ( 2) a contribution from the 171 Yb Knight field [53]. In the latter case, the bath-induced 171 Yb dipole moment generates a randomly fluctuating magnetic field at each 51 V ion, the Knight field, which is described by

with

Here, the -and + cases in equation (S28) correspond to 171 Yb in |1 g and |0 g , respectively. The constants are defined in Supplementary Information Section A. We note that A z corresponds to an effective local field amplification factor with value A z ≈ 3.1 for the register spins. We define the 171 Yb Knight field to be ∓A z B OH z . By applying periodic π pulses to the 171 Yb, we flip its state between |0 g and |1 g , thereby switching the sign of the Knight field. This leads to the cancellation of 51 V phase accumulation between successive free evolution periods, resulting in a longer coherence time. We numerically simulate the register coherence times using the method outlined in Supplementary Information Section D. When limited by the 171 Yb Knight field, simulation yields a Gaussian decay with a 1/e coherence time of 33 µs (equivalent to experimental results in Fig. 3a). We also predict an upper bound for the coherence time when decoupled from the 171 Yb Knight field by turning off Hamiltonian terms associated with equation (S28), yielding an extended Gaussian decay of 417 µs (equivalent to experimental results in Fig. 3b). These simulated values are consistent with the corresponding experimental results (58 ± 4 µs and 225 ± 9 µs respectively) to within a factor of two. We note that this could indicate an error in our estimation of g vz by up to 25%, potentially caused by a small discrepancy in the position of the two 51 V bath spins closest to 171 Yb. Further analysis of these parameters is left for future work.

# J. T1 Lifetime Discussion

We measure the population decay of both the |0 v and |W v states (timescales T (0) 1 and T (W ) 1 respectively) by preparing the 51 V register in the appropriate state and waiting for a variable time, t, before swapping to the 171 Yb for readout.

The |0 v state exhibits slow exponential decay with 1/e time constant T (0) 1 = 0.54 ± 0.08 s (Extended Data Fig. 8b). There are two contributions which could be limiting this decay:

1. Resonant population exchange between the register spins and unpolarised frozen-core 'dark spins'. For instance, the two nearest 51 V ions (ions 1 and 2 in the table in Supplementary Information Section A 2) may interact resonantly with the neighbouring register spins. However, we cannot detect or polarise these dark spins since they only interact with the 171 Yb via Ising-like Ŝz Îz terms.

2. Off-resonant population exchange between the register and detuned unpolarised bath spins.

As for the |W v state, it exhibits a Gaussian decay with a much faster 1/e time constant of T (W ) 1 = 39.5 ± 1.3 µs (Extended Data Fig. 8a). This can be explained by considering the effect of dephasing on the register spins. Specifically, the |W v state which our 171 Yb qubit interacts with is given as

Crucially, there are three additional orthogonal states required to span the 51 V register single excitation subspace:

We assume uncorrelated noise at each of the four 51 V spins and apply a pure-dephasing master equation model. In the single excitation subspace, this becomes:

where the dephasing channel (Lindbladian) is given by

and Γ is the dephasing rate on the ω c transition of a single 51 V spin. We solve this equation for different initial states ρ(0). When ρ(0) = |0 v 0 v |, dephasing does not contribute to T (0) 1 , i.e. ρ(t) = ρ(0). However, when ρ(0) = |W v W v | the state evolves according to

where 1 (SEM) is the single excitation manifold identity operator:

i.e. dephasing leads to decay of |W v into 1 (SEM) at rate 2Γ. For completeness we also consider the decay of the off-diagonal coherence term ρ 01 = 0 v | ρ |W v and find that

Essentially, the pure dephasing model predicts T * 2 = 2T

(W ) 1

for our system. We verify that dephasing is the main source of |W v population decay by demonstrating lifetime extension using the same motional narrowing approach employed to improve the coherence time (Supplementary Information Section I). Specifically, during the wait time, we apply a series of π pulses to the 171 Yb separated by 6 µs leading to an extended lifetime of T (W ) 1 = 127±8 µs (Extended Data Fig. 8a). We note that both the bare and motionally-narrowed T lifetime to 640 ± 20 µs using two 51 V π pulses applied during the wait time, thereby achieving dynamical decoupling from the nuclear Overhauser field (equivalent to the results in Fig. 3c).

Finally we note that if

is limited by the 171 Yb Knight field as a common noise source, there may be some discrepancy in the predictions of this model due to a high degree of noise correlation between the four 51 V register spins arising from lattice symmetry. However, when performing motional narrowing we decouple the 171 Yb Knight field and are likely limited by the, considerably less correlated, local Overhauser field. Further exploration of these correlated/uncorrelated fields is left for future work.

# K. Parity Oscillations and Coherence

Here we derive an expression for the 171 Yb-51 V Bell-state coherence ρ 01 = 1 g 0 v | ρ |0 g W v in terms of the parity oscillation contrast with a correction factor. In particular, when reading out this coherence, we apply a √ swap gate

Note that reading out the 171 Yb state is sufficient to distinguish the |Ψ + and |Ψ -states in this measurement. We can account for the readout fidelity of the |Ψ ± states by using a F sw,1 factor (Methods), i.e. if the state |Ψ + (|Ψ -) is perfectly prepared, 171 Yb will be measured in state |0 g (|1 g ) with probability 1  2 (1 + F sw,1 ). To span the 171 Yb-51 V Hilbert space, we also need to consider the effect of the readout √ swap gate when the system is initialised into the other two states: |1 g W v or |0 g 0 v . To this end, we assign imperfect readout probabilities of q 11 and q 00 for |1 g W v and |0 g 0 v , respectively. Specifically, we can represent the dependence of the parity readout on the input state using the following matrix relation:

Here p To extract the Bell state fidelity and uncertainty, we perform a maximum likelihood analysis of the population and parity oscillation measurements, adopting a similar approach as in [46] We extract a likelihood function for the coherence by considering the following model:

where {t i , y i } are the parity oscillation data at the i th point, ρ 01 is the corrected coherence, F sw,1 is the parity oscillation correction factor associated with the swap gate infidelity, and i is the experimental error assumed to be normally distributed with µ = 0 and unknown σ. The likelihood function is given by L (ρ 01 , σ|{t i , y i }) = i 1 √ 2πσ exp -y i -0.5 -F sw,1 ρ 01 cos(ω c t i )

We obtain a likelihood for the corrected coherence, L (ρ 01 |{t i , y i }) by marginalising over σ.

The likelihood function for the fidelity is obtained by taking a product of the likelihood function for the populations with the likelihood function for the coherence and evaluating a contour integral at constant F, given by

The Bell state fidelity is extracted by maximising this likelihood and the error is evaluated as a symmetric 68% confidence interval.

