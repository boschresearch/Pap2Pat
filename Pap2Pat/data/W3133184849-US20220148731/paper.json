{
    "id": "https://semopenalex.org/work/W3133184849",
    "authors": [
        "Jing Li",
        "Kris A. Smith",
        "Junwen Wang",
        "Bernard R. Bendok",
        "Panwen Wang",
        "Alyx Porter",
        "Kristin R. Swanson",
        "Nhan L. Tran",
        "Sen Peng",
        "Maciej M. Mrugala",
        "Kamala Clark-Swanson",
        "Kyle Singleton",
        "Lujia Wang",
        "Andrea Hawkins-Daarud",
        "Leland Hu",
        "Teresa Wu",
        "Ashley M. Stokes",
        "Richard S. Zimmerman",
        "Leslie C. Baxter",
        "Jennifer Eschbacher",
        "Chandan Krishna",
        "Chris Sereduk",
        "Pamela Jackson",
        "Gina L. Mazza",
        "Joseph M. Hoxworth"
    ],
    "title": "Uncertainty quantification in the radiogenomics modeling of EGFR amplification in glioblastoma",
    "date": "2021-02-16",
    "abstract": "Radiogenomics uses machine-learning (ML) to directly connect the morphologic and physiological appearance of tumors on clinical imaging with underlying genomic features. Despite extensive growth in the area of radiogenomics across many cancers, and its potential role in advancing clinical decision making, no published studies have directly addressed uncertainty in these model predictions. We developed a radiogenomics ML model to quantify uncertainty using transductive Gaussian Processes (GP) and a unique dataset of 95 image-localized biopsies with spatially matched MRI from 25 untreated Glioblastoma (GBM) patients. The model generated predictions for regional EGFR amplification status (a common and important target in GBM) to resolve the intratumoral genetic heterogeneity across each individual tumor-a key factor for future personalized therapeutic paradigms. The model used probability distributions for each sample prediction to quantify uncertainty, and used transductive learning to reduce the overall uncertainty. We compared predictive accuracy and uncertainty of the transductive learning GP model against a standard GP model using leave-one-patient-out cross validation. Additionally, we used a separate dataset containing 24 image-localized biopsies from 7 high-grade glioma patients to validate the model. Predictive uncertainty informed the likelihood of achieving an accurate sample prediction. When stratifying predictions based on uncertainty, we observed substantially higher performance in the group cohort (75% accuracy, n = 95) and amongst sample predictions with the lowest uncertainty (83% accuracy, n = 72) compared to predictions with higher uncertainty (48% accuracy, n = 23), due largely to data interpolation (rather than extrapolation). On the separate validation set, our model achieved 78% accuracy amongst the sample predictions with lowest uncertainty. We present a novel approach to quantify radiogenomics uncertainty to enhance model performance and clinical interpretability. This should help integrate more reliable radiogenomics models for improved medical decision-making.",
    "sections": [
        {
            "title": "Introduction",
            "paragraphs": [
                "The field of machine-learning (ML) has exploded in recent years, thanks to advances in computing power and the increasing availability of digital data. Some of the most exciting developments in ML have centered on computer vision and image recognition, with broad applications ranging from e-commerce to self-driving cars. But these advances have also naturally dovetailed with applications in healthcare, and in particular, the study of medical images1. The ability for computer algorithms to discriminate subtle imaging patterns has led to myriad ML tools aimed at improving diagnostic accuracy and clinical efficiency2. But arguably, the most transformative application relates to the development of radiogenomics modeling, and its integration with the evolving paradigm of individualized oncology1\u20133.",
                "Radiogenomics integrates non-invasive imaging (typically Magnetic Resonance Imaging, or MRI) with genetic profiles as data inputs to train ML algorithms. These algorithms identify the correlations within the training data to predict genetic aberrations on new unseen cases, using the MRI images alone. In the context of individualized oncology, radiogenomics non-invasively diagnoses the unique genetic drug sensitivities for each patient\u2019s tumor, which can inform personalized targeted treatment decisions that potentially improve clinical outcome. Foundational work in radiogenomics coincided with the first Cancer Genome Atlas (TCGA) initiative over a decade ago4, which focused on patients with Glioblastoma (GBM)\u2014the most common and aggressive primary brain tumor. Since then, radiogenomics has extended to all major tumor types throughout the body5\u20138, underscoring the broad scope and potential impact on cancer care in general.",
                "But as clinicians begin to assimilate radiogenomics predictions into clinical decision-making, it will become increasingly important to consider the uncertainty associated with each of those predictions. In the context of radiogenomics, predictive uncertainty stems largely from sparsity of training data, which is true of all clinical models that rely on typically limited sources of patient data. This sparsity becomes an even greater challenge when evaluating heterogeneous tumors like GBM, which necessitate image-localized biopsies and spatially matched MRI measurements to resolve the regional genetic subpopulations that comprise each tumor. And as with any data driven approach, the scope of training data establishes the upper and lower bounds of the model domain, which guides the predictions for all new unseen test cases (i.e., new prospective patients). In the ideal scenario, the new test data will fall within the distribution of the training domain, which allows for interpolation of model predictions, and the lowest degree of predictive uncertainty. If the test data fall outside of the training domain, then the model must extrapolate predictions, at the cost of greater model uncertainty. Unfortunately, without knowledge of this uncertainty, it is difficult to ascertain the degree to which the new prospective patient case falls within the training scope of the model. This could limit user confidence in potentially valuable model outputs.",
                "While predictive accuracy remains the most important measure of model performance, many non-medical ML-based applications (e.g.,weather forecasting, hydrologic forecasting) also estimate predictive uncertainty\u2014usually through probabilistic approaches\u2014to enhance the credibility of model outputs and to facilitate subsequent decision-making9. In this respect, research in radiogenomics has lagged. Past studies have focused on accuracy (e.g., sensitivity/specificity) and covariance (e.g., standard error, 95% confidence intervals) in group analyses, but have not yet addressed the uncertainty for individual predictions10. Again, such individual predictions (e.g. a new prospective patient) represent the \u201creal world\u201d scenarios for applying previously trained radiogenomics models. Quantifying these uncertainties will help to understand the conditions of optimal model performance, which will in turn help define how to effectively integrate radiogenomics models into routine clinical practice.",
                "To address this critical gap, we present a probabilistic method to quantify the uncertainty in radiogenomics modeling, based on Gaussian Process (GP) and transductive learning9,11\u201313.",
                "GP can flexibly model the nonlinear relationship between input and output variables. The prediction by GP is a probabilistic distribution where the predictive variance reflects the uncertainty related to the extrapolation risk when applying a trained model to a new sample. This enables clear understanding of the uncertainty. Different from the standard GP, our proposed transductive learning GP model includes both labeled (biopsy) samples and unlabeled samples taken from regions without biopsy in order to train a robust model under limited sample sizes. Also, our model integrated feature selection to identify a small subset from the high-dimensional image features to minimize prediction uncertainty.",
                "As a case study, we develop our model in the setting of GBM, which presents particular challenges for individualized oncology due to its profound intratumoral heterogeneity and likelihood for tissue sampling errors. We address the confounds of intratumoral heterogeneity by utilizing a unique and carefully annotated dataset of image-localized biopsies with spatially matched MRI measurements from a cohort of untreated GBM patients. As proof of concept, we focus on predictions of EGFR amplification status, as this serves as a common therapeutic target for many clinically available drugs. We demonstrate a progression of optimization steps that not only quantify, but also minimize predictive uncertainty, and we investigate how this relates to confidence and accuracy of model predictions. Our overarching goal is to provide a pathway to clinically integrating reliable radiogenomics predictions as part of decision support within the paradigm of individualized oncology."
            ],
            "subsections": []
        },
        {
            "title": "Results",
            "paragraphs": [],
            "subsections": [
                {
                    "title": "Radiogenomics Can Resolve The Regional Heterogeneity Of Egfr Amplification Status In Gbm",
                    "paragraphs": [
                        "For our model training set, we collected a dataset of 95 image-localized biopsies from a cohort of 25 primary GBM patients, with demographics summarized in supplemental Table S1. We quantified and compared the EGFR amplification status for each biopsy sample with spatially matched image features from corresponding multi-parametric MRI, which included conventional and advanced (diffusion, tensor, perfusion) MRI techniques. We used these spatially matched datasets to construct a transductive learning GP model to classify EGFR amplification status. This model quantified predictive uncertainty for each sample, by measuring predictive variance and the distribution mean for each predicted sample, relative to the training model domain. We used these features to test the hypothesis that the sample belongs to the class predicted by the distribution mean (H1) versus not (H0), based on a standard one-sided z test. This generated a p value for each sample, which reflected the uncertainty of the prediction, such that smaller p values corresponded with lower predictive uncertainty (i.e., higher certainty). We integrated these uncertainty estimates using transductive learning to optimize model training and predictive performance. In leave-one-patient-out cross validation, the model achieved an overall accuracy of 75% (77% sensitivity, 74% specificity) across the entire pooled cohort (n\u2009=\u200995), without stratifying based on the certainty of the predictions. Figure\u00a01 illustrates how the spatially resolved predictive maps correspond with stereotactic biopsies from the regionally distinct genetic subpopulations that can co-exist within a single patient\u2019s GBM tumor.Figure 1Radiogenomics maps resolve the regional intratumoral heterogeneity of EGFR amplification status in GBM. Shown are two different image-localized biopsies (Biopsy #1, Biopsy #2) from the same GBM tumor in a single patient. For each biopsy, T1+C images (left) demonstrate the enhancing tumor segment (dark green outline, T1W+Contrast) and the peripheral non-enhancing tumor segment (light green outline, T2W lesion). Radiogenomics color maps for each biopsy (right) also show regions of predicted EGFR amplification (amp, red) and EGFR wildtype (wt, blue) status overlaid on the T1+C images. For biopsy #1 (green square), the radiogenomics map correctly predicted low EGFR copy number variant (CNV) and wildtype status with high predictive certainty (p\u2009<\u20090.05). Conversely for biopsy #2 (green circle), the maps correctly predicted high EGFR CNV and amplification status, also with high predictive certainty (p\u2009<\u20090.05). Note that both biopsies originated from the non-enhancing tumor segment, suggesting the feasibility for quantifying EGFR drug target status for residual subpopulations that are typically left unresected followed gross total resection."
                    ],
                    "subsections": []
                },
                {
                    "title": "Interpolation Corresponds With Lower Predictive Uncertainty And Higher Model Performance",
                    "paragraphs": [
                        "For data-driven approaches like ML, predictions can be either interpolated between known observations (i.e., training data) within the model domain, or extrapolated by extending model trends beyond the known observations. Generally speaking, extrapolation carries greater risk of uncertainty, while interpolation is considered more reliable. Our data suggest that prioritizing interpolation (over extrapolation) during model training can reduce the uncertainty of radiogenomics predictions while improving overall model performance.",
                        "As a baseline representation of current methodology, we trained a standard GP model without the transductive learning capability to prioritize maximal predictive accuracy for distinguishing EGFR amplification status, irrespective of the type of prediction (e.g., interpolation vs extrapolation). We applied this standard model to quantify which sample predictions in our cohort (n\u2009=\u200995) were interpolated (p\u2009<\u20090.05) versus extrapolated (p\u2009>\u20090.05, standard deviation\u2009>\u20090.4). When comparing with the standard GP model as the representative baseline, the transductive learning GP model shifted the type of prediction from extrapolation to interpolation in 11.6% (11/95) of biopsy cases. Amongst these sample predictions, classification accuracy increased from 63.6% with extrapolation (7/11 correctly classified) to 100% with interpolation (11/11 correctly classified).",
                        "The transductive learning GP model also reduced the number of sample predictions that suffered from uncertainty due to inherent imperfections of model classification. This specifically applied to those predictions with distributions that fell in close proximity to the classification threshold (so called border uncertainty), which associated with large p values (p\u2009>\u20090.05) and low standard deviation (<\u20090.40) (Fig.\u00a02). When comparing with the standard GP model as the representative baseline, the transductive learning GP model shifted the type of prediction, from border uncertainty to interpolation, in 15.8% (15/95) of biopsy cases. Amongst these sample predictions, classification accuracy dramatically increased from 40% in the setting of border uncertainty (6/15 correctly classified) to 93.3% with interpolation (14/15 correctly classified). Figure\u00a03 shows the overall shift in sample predictions when comparing the standard GP and transductive learning GP models, including the increase in interpolated predictions.Figure 2Transductive learning GP increases the number of interpolated sample predictions compared to standard GP. Shown are scatter plots of standard deviation (S.D.) (y-axis) versus log-transform of p value (x-axis) for all 95 sample predictions by the (A) Standard GP and (B) Transductive Learning GP models. The blue region demarcates those samples with p\u2009<\u20090.05 (log transform\u2009<\u2009\u2212 3) corresponding to interpolated predictions. The red region demarcates extrapolated predictions (p\u2009>\u20090.05, SD\u2009>\u20090.40), while the green region demarcates predictions with border uncertainty (p\u2009>\u20090.05, SD\u2009<\u20090.40). The green circles denote those samples that shifted from border uncertainty to interpolated predictions with transductive learning. Similarly, the red circles denote those samples that shifted from extrapolated to interpolated predictions with transductive learning. Transductive GP produced 72/95 interpolated sample predictions, compared with 58/95 for Standard GP. Note the substantial decrease in extrapolated predictions with the transductive learning GP model.Figure 3Model performance increases with lower predictive uncertainty. Shown are the area-under-the-curve (AUC) measures for receiver operator characteristics (ROC) analysis of sample predictions stratified by predictive uncertainty. The sample predictions with lowest uncertainty (p\u2009<\u20090.05) (blue curve, n\u2009=\u200972) achieved the highest performance (AUC\u2009=\u20090.86) compared to the entire grouped cohort irrespective of uncertainty (AUC\u2009=\u20090.83) (black curve, n\u2009=\u200995). Meanwhile, the sample predictions with greatest uncertainty (i.e., least certain predictions) showed the lowest classification accuracy (AUC\u2009=\u20090.5) (red curve, n\u2009=\u200923).",
                        "We observed substantially different sizes in feature sets and overall model complexity when comparing the standard GP and transductive GP models, as summarized in Table 1. While the standard GP model selected 17 image features (across 5 different MRI contrasts), the transductive GP model selected only 4 features (across 2 MRI contrasts). The lower complexity of the transductive GP model likely stemmed from a key difference in model training: the transductive learning GP model first prioritized feature selection that minimized average predictive uncertainty (i.e., lowest sum of p values), which helped to narrow candidate features to a relevant and focused subset. Only then did the model prioritize predictive accuracy, within this smaller feature subset. Meanwhile, the standard GP model selected from the entire original feature set to maximize predictive accuracy, without constraints on predictive uncertainty. Although the accuracy was optimized on training data, the standard GP model could not achieve the same level of cross validated model performance (60% accuracy, 31% sensitivity, 71% specificity) compared to the transductive learning GP model, due largely to lack of control of extrapolation risks. Additionally, we used the same features selected by transductive learning GP to train the standard GP model to interrogate the additional advantage of transductive learning GP beyond feature selection. This model performed better than standard GP (71% accuracy, 69% sensitivity, 71% specificity), but worse than transductive learning GP. Also, this model predicted only 51 samples with certainty (p\u2009<\u20090.05) and among these samples the accuracy was 78%. In comparison, transductive learning GP predicted 72 samples with certainty (p\u2009<\u20090.05) and among these samples the accuracy was 83% (Table 2). These results suggest that transductive learning GP not only identified more robust features, but also reduced prediction uncertainty, which further improved predictive accuracy.Table 1Differences in image features and model complexity when comparing standard GP and transductive learning GP models.Transductive Learning GP modelStandard GP modelSelected image texture features1. T2.Information.Measure.of.Correlation.2_Avg_12. T2.Angular.Second.Moment_Avg_13. T2.Kurtosis4. rCBV.Contrast_Avg_11. T2.Difference.Entropy_Avg_32. T2.Contrast_Avg_13. T2.Entropy_Avg_14. SPGRC.Sum.Variance_Avg_35. SPGRC.Gabor_Std_0.4_0.16. rCBV.Angular.Second.Moment_Avg_17. rCBV.Difference.Variance_Avg_18. rCBV.Kurtosis9. EPI.Gabor_Mean_0.4_0.110. EPI.Angular.Second.Moment_Avg_111. FA.Angular.Second.Moment_Avg_112. FA.Skewness13. FA.Difference.Variance_Avg_314. FA.Entropy_Avg_115. FA.Sum.Variance_Avg_116. FA.Information.Measure.of.Correlation.1_Avg_117. FA.Range\"The transductive learning model, which prioritized model uncertainty during the training process, comprised fewer image features and lower complexity compared with the standard GP model.Table 2Differences in predictive accuracy related to certain versus uncertain sample predictions in the training set (95 biopsy samples, 25 patients).Uncertainty thresholdNumber of samples (n)Overall accuracySensitivity/specificity (%/%)Entire pooled cohort9575%77/74p\u2009<\u20090.05 (certain)7283%83/83p\u2009>\u20090.05 (uncertain)2348%63/40p\u2009<\u20090.10 (certain)7879%83/78p\u2009>\u20090.10 (uncertain)1753%63/44p\u2009<\u20090.15 (certain)8179%84/77p\u2009>\u20090.15 (uncertain)1450%57/43Shown are the differences in predictive performance of the transductive learning GP model for the entire pooled training cohort and also when stratifying the sample predictions with high certainty (low p values) versus low certainty (high p values) at various p value thresholds."
                    ],
                    "subsections": []
                },
                {
                    "title": "Predictive Uncertainty Can Inform The Likelihood Of Achieving An Accurate Sample Prediction, Which Enhances Clinical Interpretability",
                    "paragraphs": [
                        "Existing published studies have used predictive accuracy to report model performance, but have not yet addressed model uncertainty. Our data suggest that leveraging both accuracy and uncertainty can further optimize model performance and applicability. When stratifying transductive learning GP sample predictions based on predictive uncertainty, we observed a striking difference in model performance. The subgroup of sample predictions with the lowest uncertainty (i.e., the most certain predictions) (p\u2009<\u20090.05) (n\u2009=\u200972) achieved the highest predictive performance (83% accuracy, 83% sensitivity, 83% specificity) compared to the entire cohort as a whole (75% accuracy, n\u2009=\u200995). This could be explained by the substantially lower performance (48% accuracy, 63% sensitivity, 40% specificity) observed amongst the subgroup of highly uncertain sample predictions (p\u2009>\u20090.05) (n\u2009=\u200923). Figure\u00a03 shows the differences in model performance on ROC analysis when comparing sample predictions based on uncertainty. These discrepancies in model performance persisted even when stratifying with less stringent uncertainty thresholds (e.g., p\u2009<\u20090.10, p\u2009<\u20090.15), which we summarize in Table 2. Together, these results suggest that predictive uncertainty can inform the likelihood of achieving an accurate sample prediction, which can help discriminate radiogenomics outputs, not only across patients, but at the regional level within the same patient tumor (Fig.\u00a04).Figure 4Model uncertainty can inform the likelihood of achieving an accurate radiogenomics prediction for EGFR amplification status. We obtained two separate biopsies (#1 and #2) from the same tumor in a patient with primary GBM. The (A) T2W and (B) T1+C images demonstrate the enhancing (dark green outline, T1W+Contrast) and peripheral non-enhancing tumor segments (light green outline, T2W lesion). The (C) radiogenomics color map shows regions of predicted EGFR amplification (amp, red) and EGFR wildtype (wt, blue) status overlaid on the T1+C images. For biopsy #1 (green circle), the radiogenomics model predicted EGFR wildtype status (blue) with high certainty, which was concordant with biopsy results (green box). For biopsy #2 (yellow circle), the radiogenomics model showed poor certainty (i.e., high uncertainty), with resulting discordance between predicted (red) and actual EGFR status (yellow box)."
                    ],
                    "subsections": []
                },
                {
                    "title": "Model Validation On An Independent Cohort Of High-Grade Glioma Patients With Image-Localized Biopsies",
                    "paragraphs": [
                        "We collected a\u00a0separate dataset of 24 image-localized biopsies from a cohort of 7 primary high-grade glioma patients (Supplemental Table S2). The validation set employed the\u00a0same MRI techniques and processing pipeline as the training set. We applied the transductive learning GP model developed on the training set to validate model performance\u00a0in this separate cohort. The transductive learning model achieved an overall accuracy of 67% across the entire pooled cohort (n\u2009=\u200924), without stratifying based on the predictive certainty. When stratifying transductive learning GP sample predictions based on predictive uncertainty, we observed an increase in model performance, which was the same trend observed in the training cohort. Specifically, the subgroup of sample predictions with the lowest uncertainty (i.e., the most certain predictions) (p\u2009<\u20090.05) (n\u2009=\u200918) achieved the highest predictive performance (78% accuracy, 75% sensitivity, 79% specificity) compared to samples with high uncertainty (p\u2009>\u20090.05) (33% accuracy, n\u2009=\u20096) and the entire cohort as a whole (67% accuracy, n\u2009=\u200924) (Table 3).Table 3Differences in predictive accuracy related to certain versus uncertain sample predictions in the validation set (24 biopsy samples, 7 patients).Uncertainty thresholdNumber of samples (n)Overall accuracySensitivity/specificity (%/%)Entire pooled cohort2467%43/76p\u2009<\u20090.05 (certain)1878%75/79p\u2009>\u20090.05 (uncertain)633%0/67Shown are the differences in predictive performance of the transductive learning GP model for the entire pooled validation cohort and also when stratifying the sample predictions with high certainty (low p values) versus low certainty (high p values) at various p value thresholds."
                    ],
                    "subsections": []
                }
            ]
        },
        {
            "title": "Discussion",
            "paragraphs": [
                "The era of genomic profiling has ushered new strategies for improving cancer care and patient outcomes through more personalized therapeutic approaches14. In particular, the paradigm of individualized oncology can optimize targeted treatments to match the genetic aberrations and drug sensitivities for each tumor15. This holds particular relevance for many aggressive tumors that may not be amenable to complete surgical resection, such as GBM or pancreatic adenocarcinoma, or other cancers that have widely metastasized. In these cases, the targeted drug therapies represent the primary lines of defense in combating the residual, unresected tumor populations that inevitably recur and lead to patient demise. Yet, a fundamental challenge for individualized oncology lies in our inability to resolve the internal genetic heterogeneity of these tumors. Taking GBM as an example, each patient tumor actually comprises multiple genetically distinct subpopulations, such that the genetic drug targets from one biopsy location may not accurately reflect those from other parts of the same tumor16. Tissue sampling errors are magnified by the fact that surgical targeting favors MRI enhancing tumor components but leaves behind the residual subpopulations within the non-enhancing tumor segment17\u201319. Ironically, while these uncharacterized residual subpopulations represent the primary targets of adjuvant therapy, their genetic drug targets remain \u201cunknown\u201d, even after gross total resection20,21.",
                "The radiogenomics model presented here offers a promising and clinically feasible solution to bridge the challenges of intratumoral heterogeneity. Building upon our prior work18, we demonstrate that the leveraging of image-localized biopsies can help train and validate predictive models that spatially resolve the regional intratumoral variations of key GBM driver genes such as EGFR amplification, at the image voxel level throughout different regions of the same tumor. Within this framework, we present a new methodology that integrates the uncertainty estimates with each spatially-resolved model prediction, which to our knowledge, has not been published previously. In general, our approach to predictive modeling has fundamentally differed from the large body of published radiogenomics studies, which have been limited by the use of non-localizing tissue material and the potential confounds of intratumoral heterogeneity22\u201329. Non-localizing correlations must assume a homogeneous tumoral microenvironment, if a single genetic profile is to be used to represent the entire tumor. Unfortunately, this technique fails to characterize intratumoral heterogeneity as a whole, since the genetic profiles from one biopsy location may not accurately reflect those from other subregions of the same tumor18,21. As proof of concept for uncertainty quantification, the transductive GP model presented here focuses on the mapping of regional EGFR amplification, which occurs in 30\u201345% of GBM tumors and represents a highly relevant drug target for many clinically tested and commercially available inhibitors. Besides our previously published work18, no other studies have developed or validated EGFR predictive models that resolve intratumoral heterogeneity using spatially resolved MRI-tissue correlations. Nor have any prior studies provided estimates of predictive uncertainty in the context of radiogenomics. Out of the panel of image-based features, the transductive learning model prioritized T2W and rCBV texture features (Table 1). This remains consistent with our prior work18 in the context of image-localized biopsies, and also aligns with Aghi et al.29 that found high performance of EGFR prediction based on T2W image features, albeit with non-localizing biopsies. There has been discordance among past reports regarding the utility of rCBV for predicting EGFR amplification, which could potentially be explained by sampling errors from non-localizing biopsies23,25,27,28.",
                "As the data available to train machine learning models is never fully representative of the predictive cases, model predictions always carry\u00a0some degree of\u00a0inherent uncertainty in their predictions. To translate these models into clinical practice, the radiogenomics predictions need to not only be accurate, but must also inform the clinician of the confidence or certainty of each individual prediction. This underscores the importance of quantifying predictive uncertainty, but also highlights the major gaps that currently exist in this field. To date, no published studies have addressed predictive uncertainty in the context of radiogenomics. And yet, uncertainty represents a fundamental aspect of these data-driven approaches. In large part, this uncertainty stems from the inherent sparsity of training data, which limits the scope of the model domain. As such, there exists a certain degree of probability that any new unseen case may fall outside of the model domain, which would require the model to generalize or extrapolate beyond the domain to arrive at a prediction. We must recognize that all clinical models suffer from this sparsity of data, particularly when relying on spatially resolved biopsy specimens in the setting of intratumoral heterogeneity. But knowledge of which predicted cases fall within or outside of the model domain will help clinicians make informed decisions on whether to rely upon or disregard these model predictions on an individualized patient-by-patient basis.",
                "The transductive learning GP model presented here addresses the challenges of predictive uncertainty at various levels. First, the model training incorporates the minimization of uncertainty as part of feature selection, which inherently optimizes the model domain to prioritize interpolation rather than extrapolation. Our data show that interpolated predictions generally correspond with higher predictive accuracy compared with extrapolated ones. Thus, by shifting the model domain towards interpolation, model performance rises. Second, along these same lines, the GP model can inform the likelihood of achieving an accurate prediction, by quantifying the level of uncertainty for each sample prediction. We observed a dramatic increase in classification accuracy among those sample predictions with low uncertainty (p\u2009<\u20090.05), which corresponded with interpolated predictions. This was observed in both training and validation cohorts. This allows the clinician to accept the reality that not all model predictions are correct. But by qualifying each sample prediction, the model can inform of which patient cases should be trusted over others. Third, the transductive learning process also appeared to impact the sample predictions suffering from border uncertainty, where the predicted distribution fell in close proximity to the classification threshold. Compared to the standard GP baseline model, the transductive learning model shifted the domain, such that most of these sample predictions could be interpolated, which further improved model performance. Finally, we noted that the incorporation of uncertainty in the training of the transductive learning model resulted in a substantial reduction in selected features and model complexity, compared with the standard GP approach to model training. While lower model complexity would suggest greater generalizability, further studies are likely needed to confirm this assertion.",
                "We recognize various limitations to our study. First, despite our relatively small sample size, we were able to separate our cohort into both training and validation sets. However, to achieve reasonable sample sizes in the validation set, we included both anaplastic astrocytomas as well as GBM tumors, all of which were IDH-wild type. In the context of IDH wild-type high-grade astrocytomas, it is unclear how tumor grade (i.e., grade III vs. grade IV) may influence imaging correlations with genetic status, if there is any effect at all. Despite this, we observed comparable predictive accuracy in our validation cohort amongst samples with low predictive uncertainty (p\u2009<\u20090.05), and importantly that this trend was similar to that observed in the training set. Nonetheless, we may expect even higher predictive performance in future validation cohorts that are restricted to GBM tumors only. We also acknowledge that there are various types of uncertainty that contribute to model performance that were not directly tested in this study. We focused on the most recognized source of uncertainty that impacts data-driven approaches like radiogenomics, which is data sparsity and the limitations of the model domain. But at the same time, we also designed patient recruitment, MRI scanning acquisition and post-processing methodology, surgical biopsy collection, and tissue treatment to minimize potential noise of data inputs. With that said, we understand that future work is needed to evaluate these potential sources of model uncertainty. Further, while neurosurgeons tried to minimize effects of brain shift by using small craniotomy sizes and by visually validating stereotactic biopsy locations, brain shift could have led to possible misregistration errors. Rigid-body coregistration of stereotactic imaging with the advanced MR-imaging was employed to also try to reduce possible geometric distortions30,31. However, our previous experience suggests that these potential contributions to misregistration results in about 1\u20132\u00a0mm of error, which is similar to previous studies using stereotactic needle biopsies32. But as a potential source of uncertainty, future work can study these factors in a directed manner."
            ],
            "subsections": []
        },
        {
            "title": "Conclusion",
            "paragraphs": [
                "In this study, we highlight the challenges of predictive uncertainty in radiogenomics and present a novel approach that not only quantifies model uncertainty, but also leverages it to enhance model performance and interpretability. This work offers a pathway to clinically integrating reliable radiogenomics predictions as part of decision support within the paradigm of individualized oncology."
            ],
            "subsections": []
        },
        {
            "title": "Methods",
            "paragraphs": [],
            "subsections": [
                {
                    "title": "Acquisition And Processing Of Clinical Mri And Histologic Data",
                    "paragraphs": [],
                    "subsections": [
                        {
                            "title": "Patient Recruitment And Surgical Biopsies",
                            "paragraphs": [
                                "We recruited patients with clinically suspected GBM undergoing preoperative stereotactic MRI for surgical resection as previously described18. we confirmed histologic diagnosis of GBM in all cases. Patients were recruited to this study, \u201cImproving diagnostic Accuracy in Brain Patients Using Perfusion MRI\u201d, under the protocol procedures approved by the Barrow Neurological Institute (BNI) institutional review board. Informed consent from each subject was obtained prior to enrollment. All data collection and protocol procedures were carried out following the approved guidelines and regulations outlined in the BNI IRB. Neurosurgeons used pre-operative conventional MRI, including T1-Weighted contrast-enhanced (T1+C) and T2-Weighted sequences (T2W), to guide multiple stereotactic biopsies as previously described18,33. In short, each neurosurgeon collected an average of 3\u20134 tissue specimens from each tumor using stereotactic surgical localization, following the smallest possible diameter craniotomies to minimize brain shift. Neurosurgeons selected targets separated by at least 1\u00a0cm from both enhancing core (ENH) and non-enhancing T2/FLAIR abnormality in pseudorandom fashion, and recorded biopsy locations via screen capture to allow subsequent coregistration with multiparametric MRI datasets."
                            ],
                            "subsections": []
                        },
                        {
                            "title": "Histologic Analysis And Tissue Treatment",
                            "paragraphs": [
                                "Tissue specimens (target volume of 125\u00a0mg) were flash frozen in liquid nitrogen within 1\u20132\u00a0min from collection in the operating suite and stored in \u2212 80\u00a0\u00b0C freezer until subsequent processing. Tissue was retrieved from the freezer and embedded frozen in optimal cutting temperature (OCT) compound. Tissue was cut at 4 um sections in a -20 degree C cryostat (Microm-HM-550) utilizing microtome blade18,33. Tissue sections were stained with hematoxylin and eosin (H&E) for neuropathology review to ensure adequate tumor content (\u2265\u200950%)."
                            ],
                            "subsections": []
                        }
                    ]
                },
                {
                    "title": "Whole Exome Sequencing And Alignment And Variant Calling",
                    "paragraphs": [
                        "We performed DNA isolation and determined copy number variant (CNV) for all tissue samples using array comparative genomic hybridization (aCGH) and exome sequencing as previously published18,34\u201336. This included application of previously described CNV detection to whole genome long insert sequencing data and exome sequencing18,34\u201336. Briefly, tumor-normal whole exome sequencing was performed as previously described37. DNA from fresh frozen tumor tissue and whole blood (for constitutional DNA analysis) samples were extracted and QC using DNAeasy Blood and Tissue Kit (Qiagen#69504). Tumor-normal whole exome sequencing was performed with the Agilent Library Prep Kit RNA libraries. Sequencing was performed using the Illumina HiSeq 4000 with 100\u00a0bp paired-end reads. Fastq files were aligned with BWA 0.6.2 to GRCh37.62 and the SAM output were converted to a sorted BAM file using SAMtools 0.1.18. Lane level samples BAMs were then merged with Picard 1.65 if they were sequence across multiple lanes. Comparative variant calling for exome data was conducted with Seurat. For copy number detection was applied to the whole exome sequence as described (PMID 27932423). Briefly, copy number detection was based on a log2 comparison of normalized physical coverage (or clonal coverage) across tumor and normal whole exome sequencing data. Normal and tumor physical coverage was then normalized, smoothed and filtered for highly repetitive regions prior to calculating the log2 comparison. To quantify the copy number aberrations, CNV score was calculated based on the intensity of copy number change (log ratio)."
                    ],
                    "subsections": []
                },
                {
                    "title": "Mri Protocol, Parametric Maps, And Image Coregistration",
                    "paragraphs": [],
                    "subsections": [
                        {
                            "title": "Conventional Mri And General Acquisition Conditions",
                            "paragraphs": [
                                "We performed all imaging at 3\u00a0T field strength (Sigma HDx; GE-Healthcare Waukesha Milwaukee; Ingenia, Philips Healthcare, Best, Netherlands; Magnetome Skyra; Siemens Healthcare, Erlangen Germany) within 1\u00a0day prior to stereotactic surgery. Conventional MRI included standard pre- and post-contrast T1-Weighted (T1-C, T1+C, respectively) and pre-contrast T2-Weighted (T2W) sequences. T1W images were acquired using spoiled gradient recalled-echo inversion-recovery prepped (SPGR-IR prepped) (TI/TR/TE\u2009=\u2009300/6.8/2.8\u00a0ms; matrix\u2009=\u2009320\u2009\u00d7\u2009224; FOV\u2009=\u200926\u00a0cm; thickness\u2009=\u20092\u00a0mm). T2W images were acquired using fast-spin-echo (FSE) (TR/TE\u2009=\u20095133/78\u00a0ms; matrix\u2009=\u2009320\u2009\u00d7\u2009192; FOV\u2009=\u200926\u00a0cm; thickness\u2009=\u20092\u00a0mm). T1\u2009+\u2009C images were acquired after completion of Dynamic Susceptibility-weighted Contrast-enhanced (DSC) Perfusion MRI (pMRI) following total Gd-DTPA (gadobenate dimeglumine) dosage of 0.15\u00a0mmol/kg as described below18,33,38. Diffusion Tensor (DTI): DTI imaging was performed using Spin-Echo Echo-planar imaging (EPI) [TR/TE 10,000/85.2\u00a0ms, matrix 256\u2009\u00d7\u2009256; FOV 30\u00a0cm, 3\u00a0mm slice, 30 directions, ASSET, B\u2009=\u20090,1000]. The original DTI image DICOM files were converted to a FSL recognized NIfTI file format, using MRIConvert (http://lcni.uoregon.edu/downloads/mriconvert), before processing in FSL from semi-automated script. DTI parametric maps were calculated using FSL (http://fsl.fmrib.ox.ac.uk/fsl/fslwiki/), to generate whole-brain maps of mean diffusivity (MD) and fractional anisotrophy (FA) based on previously published methods20. DSC-pMRI: prior to DSC acquisition, preload dose (PLD) of 0.1\u00a0mmol/kg was administered to minimize T1W leakage errors. After PLD, we employed Gradient-echo (GE) EPI [TR/TE/flip angle\u2009=\u20091500\u00a0ms/20\u00a0ms/60\u00b0, matrix 128\u2009\u00d7\u2009128, thickness 5\u00a0mm] for 3\u00a0min. At 45\u00a0s after the start of the DSC sequence, we administered another 0.05\u00a0mmol/kg i.v. bolus Gd-DTPA18,33,38. The initial source volume of images from the GE-EPI scan contained negative contrast enhancement (i.e., susceptibility effects from the PLD administration) and provided the MRI contrast labeled EPI+C. At approximately 6\u00a0min after the time of contrast injection, the T2*W signal loss on EPI+C provides information about tissue cell density from contrast distribution within the extravascular, extracellular space33,39. We performed leakage correction and calculated relative cerebral blood (rCBV) based on the entire DSC acquisition using IB Neuro (Imaging Biometrics, LLC) as referenced40,41. We also normalized rCBV values to contralateral normal appearing white matter as previously described33,38. Image coregistration: for image coregistration, we employed tools from ITK (www.itk.org) and IB Suite (Imaging Biometrics, LLC) as previously described18,33,38. All datasets were coregistered to the relatively high quality DTI B0 anatomical image volume. This offered the additional advantage of minimizing potential distortion errors (from data resampling) that could preferentially impact the mathematically sensitive DTI metrics. Ultimately, the coregistered data exhibited in plane voxel resolution of\u2009~\u20091.17\u00a0mm (256\u2009\u00d7\u2009256 matrix) and slice thickness of 3\u00a0mm."
                            ],
                            "subsections": []
                        },
                        {
                            "title": "Roi Segmentation, Image Feature Extraction And Texture Analysis Pipeline",
                            "paragraphs": [
                                "We generated regions of interest (ROIs) measuring 8\u2009\u00d7\u20098\u2009\u00d7\u20091 voxels (9.6\u2009\u00d7\u20099.6\u2009\u00d7\u20093\u00a0mm) for each corresponding biopsy location. A board-certified neuroradiologist (L.S.H.) visually inspected all ROIs to ensure accuracy18,33. From each ROI, we employed our in-house texture analysis pipeline to extract a total of 336 texture features from each sliding window. This pipeline, based on previous iterations18,33, included measurements of first-order statistics from raw image signals (18 features): mean (M) and standard deviation (SD) of gray-level intensities, Energy, Total Energy, Entropy, Minimum, 10th percentile, 90th percentile, Maximum, Median, Interquartile Range, Range, Mean Absolute Deviation (MAD), Robust Mean Absolute Deviation (rMAD), Root Mean Squared (RMS), Skewness, Kurtosis, Uniformity42. We mapped intensity values within each window onto the range of 0\u2013255. This step helped standardize intensities and reduced effects of intensity nonuniformity on features extracted during subsequent texture analysis. Texture analysis consisted of two separate but complementary texture algorithms: gray level co-occurrence matrix (GLCM)43,44, and Gabor Filters (GF)45, based on previous work showing high relevance to regional molecular and histologic characteristics18,33. The output from the pipeline comprised a feature vector from each sliding window, composed of 56 features across each of the 6 MRI contrasts, for a total of 336 (6*56) features."
                            ],
                            "subsections": []
                        }
                    ]
                },
                {
                    "title": "Radiogenomics Modeling And Quantification Of Predictive Uncertainty",
                    "paragraphs": [],
                    "subsections": [
                        {
                            "title": "Gaussian Process (Gp) Model (Standard)",
                            "paragraphs": [
                                "A GP model was chosen to predict EGFR status using MRI features. A GP model offers the flexibility of identifying nonlinear relationships between input and output variables9,11\u201313. More importantly, it generates a probability distribution for each prediction, which quantifies the uncertainty of the prediction. This capability is important for using the prediction result to guide clinical decision making. We applied this GP framework to our spatially matched MRI and image-localized genetic data to build a predictive model for the probability distributions of EGFR amplification for each biopsy specimen. Because the GP model generates probability distributions (rather than point estimates), this allows for direct quantification of both predictive uncertainty and predictive accuracy by using the predictive variance or standard deviation of the distribution and the predictive mean in comparison with the true EGFR status, respectively. The standard GP model measures but does not explicitly incorporate predictive uncertainties for model optimization during the training phase of development (as detailed below with Transductive Learning). In other words, the standard GP model can measure but is built without considering the predictive uncertainty.",
                                "Next we illustrate how GP works. Let \\(\\left\\{ {\\mathbf{x}_{1},,,\\cdots,,,\\mathbf{x}_{N}} \\right\\}\\)  be the input variables (i.e., texture features) corresponding to \\(N\\)  samples. GP assumes a set of random functions corresponding to these samples, \\(\\left\\{ {f,\\left( \\mathbf{x}_{1} \\right),,,\\cdots,,,f,\\left( \\mathbf{x}_{N} \\right)} \\right\\}\\) . This is called a Gaussian Process because any subset of \\(\\left\\{ {f,\\left( \\mathbf{x}_{1} \\right),,,\\cdots,,,f,\\left( \\mathbf{x}_{N} \\right)} \\right\\}\\)  follows a joint Gaussian distribution with zero mean and the covariance between two samples \\(\\mathbf{x}_{i}\\)  and \\(\\mathbf{x}_{j}\\)  computed by a kernel function \\(K\\left( {\\mathbf{x}_{i},,,\\mathbf{x}_{j}} \\right)\\) . There are different choices for the kernel function. We used the commonly used radial basis function in this paper. There are more complex kernels such as non-stationary kernels and combination of kernels, which provide more flexibility and are worthy of future investigation with more training data.",
                                "Furthermore, the input variables are linked with the output (i.e., the transformed CNV) by \\(y_{i} = f{(\\mathbf{x}_{i})} + \\epsilon_{i}\\) , where \\(\\epsilon_{i} \\sim N{(0,\\sigma^{2})}\\)  is a Gaussian noise.",
                                "Given a training dataset \\(\\left\\{ {\\mathbf{X},,,\\mathbf{Y}} \\right\\}\\)  where \\(\\mathbf{X}\\)  is a matrix containing the input variables of all training samples and \\(\\mathbf{Y}\\)  is a vector containing the output variables of these samples, the predictive distribution for a new test sample \\(\\mathbf{x}^{\\ast}\\)  is\\[f\\left( \\mathbf{x}^{\\ast} \\right) \\sim N\\left( {\\mu^{\\ast},,,{\\sigma^{\\ast}}^{2}} \\right),\\] where\\[\\mu^{\\ast} = K\\left( {\\mathbf{x}^{\\ast},,,\\mathbf{X}} \\right)\\left( {K,\\left( {\\mathbf{X},,,\\mathbf{X}} \\right), + ,\\sigma^{2},\\mathbf{I}} \\right)^{- 1}\\mathbf{Y},\\] \\[{\\sigma^{\\ast}}^{2} = K\\left( {\\mathbf{x}^{\\ast},,,\\mathbf{x}^{\\ast}} \\right) - K\\left( {\\mathbf{x}^{\\ast},,,\\mathbf{X}} \\right)\\left( {K,\\left( {\\mathbf{X},,,\\mathbf{X}} \\right), + ,\\sigma^{2},\\mathbf{I}} \\right)^{- 1}{K\\left( {\\mathbf{x}^{\\ast},,,\\mathbf{X}} \\right)}^{T}.\\]"
                            ],
                            "subsections": []
                        },
                        {
                            "title": "Uncertainty Quantification",
                            "paragraphs": [
                                "While the predictive mean can be used as a point estimate of the prediction, the variance provides additional information about the uncertainty of the prediction. Furthermore, using this predictive distribution, one can test the hypothesis that a prediction is greater or less than a cutoff of interest. For example, in our case, we are interested in knowing if the prediction of the CNV of a sample is greater than 3.5 (considered as amplification). A small p value (e.g.,\u2009<\u20090.05) of the hypothesis testing implies prediction with certainty."
                            ],
                            "subsections": []
                        },
                        {
                            "title": "Feature Selection",
                            "paragraphs": [
                                "When the input variables are high-dimensional, including all of them in training a GP model has the risk of overfitting. Therefore, feature selection is needed. We used forward stepwise selection46, which started with an empty feature set and added one feature at each step that maximally improves a pre-defined criterion until no more improvement can be achieved. To avoid overfitting, a commonly used criterion is the accuracy computed on a validation set; when the sample size is limited, cross-validation accuracy can be adopted. In our case, we adopt leave-one-patient-out cross validation accuracy to be consistent with the natural grouping of samples. The accuracy is computed by comparing the true and predicted CNVs; a match is counted when both are on the same side of 3.5 (i.e., both being amplified or non-amplified)."
                            ],
                            "subsections": []
                        }
                    ]
                },
                {
                    "title": "Transductive Learning Gp Model",
                    "paragraphs": [
                        "We sought to develop a radiogenomics model that would not only maximize predictive accuracy but also minimize the predictive uncertainty. To this end, we added a Transductive Learning component to the standard GP model (described above), which quantifies predictive uncertainty, and uses that information during the model training process to minimize uncertainty on subsequent predictions. Briefly, this model employs Transductive Learning to perform feature selection in an iterative, stepwise fashion to prioritize the minimization of average predictive uncertainty during model training. We applied this GP model with Transductive Learning to our spatially matched MRI and image-localized genetic data to predict the probability distribution of EGFR amplification for each biopsy specimen.",
                        "Although a typical supervised learning model is trained using labeled samples, i.e., samples with both input and output variables available, some machine learning algorithms have been developed to additionally incorporate unlabeled samples, i.e., samples with only input variables available. These algorithms belong to a machine learning subfield called transductive learning or semi-supervised learning47. Transductive learning is beneficial when sample labeling is costly or labor-intensive, which results in a limited sample size. This is the case for our problem.",
                        "While the standard GP model described in the previous section can only utilize labeled samples, a transductive GP model was developed by Wang et al.48 Specifically, let \\(\\left\\{ {\\mathbf{X}_{L},,,\\mathbf{Y}_{L}} \\right\\}\\)  and \\(\\left\\{ \\mathbf{X}_{U} \\right\\}\\)  be the sets of labeled and unlabeled samples used in training, respectively. A transductive GP first generates predictions for the unlabeled samples by applying the standard GP to the labeled samples, \\({\\hat{\\mathbf{Y}}}_{U}\\) . Here \\({\\hat{\\mathbf{Y}}}_{U}\\)  contains the means of the predictive distributions. Then, a combined dataset \\(\\left\\{ {\\mathbf{X}_{L},,,\\mathbf{Y}_{L}} \\right\\} \\cup \\left\\{ {\\mathbf{X}_{U},,,{\\hat{\\mathbf{Y}}}_{U}} \\right\\}\\)  was used as the training dataset to generate a predictive distribution for each new test sample \\(\\mathbf{x}^{\\ast}\\) , i.e.,\\[f_{\\mathit{tran}}{(\\mathbf{x}^{\\ast})} \\sim N\\left( {\\mu_{\\mathit{tran}}^{\\ast},,,{\\sigma_{\\mathit{tran}}^{\\ast}}^{2}} \\right),{with}\\] \\[\\mu_{\\mathit{tran}}^{\\ast} = K_{\\mathit{tran}}\\left( {K,\\left( {\\mathbf{X}_{L},,,\\mathbf{X}_{L}} \\right), + ,\\sigma^{2},\\mathbf{I}} \\right)^{- 1}\\mathbf{Y}_{L},\\] \\[{\\sigma_{\\mathit{tran}}^{\\ast}}^{2} = K\\left( {\\mathbf{x}^{\\ast},,,\\mathbf{x}^{\\ast}} \\right) - \\begin{pmatrix} {K\\left( {\\mathbf{x}^{\\ast},,,\\mathbf{X}_{L}} \\right)} \\\\ {K\\left( {\\mathbf{x}^{\\ast},,,\\mathbf{X}_{U}} \\right)} \\end{pmatrix}^{T}\\begin{pmatrix} {K\\left( {\\mathbf{X}_{L},,,\\mathbf{X}_{L}} \\right) + \\sigma^{2}IK\\left( {\\mathbf{X}_{L},,,\\mathbf{X}_{U}} \\right)} \\\\ {K\\left( {\\mathbf{X}_{L},,,\\mathbf{X}_{U}} \\right)^{T}K\\left( {\\mathbf{X}_{U},,,\\mathbf{X}_{U}} \\right) + \\sigma^{2}I} \\end{pmatrix}^{- 1}\\begin{pmatrix} {K\\left( {\\mathbf{x}^{\\ast},,,\\mathbf{X}_{L}} \\right)} \\\\ {K\\left( {\\mathbf{x}^{\\ast},,,\\mathbf{X}_{U}} \\right)} \\end{pmatrix},\\] where\\[K_{\\mathit{tran}} = K\\left( {\\mathbf{x}^{\\ast},,,\\mathbf{X}_{L}} \\right) + K\\left( {\\mathbf{x}^{\\ast},,,\\mathbf{X}_{U}} \\right)\\left( {K,\\left( {\\mathbf{X}_{U},,,\\mathbf{X}_{U}} \\right), + ,\\sigma^{2},\\mathbf{I}} \\right)^{- 1}K\\left( {\\mathbf{X}_{U},,,\\mathbf{X}_{L}} \\right).\\]",
                        "To decide which unlabeled samples to include in transductive GP, Wang et al.48 points out the importance of \u201cself-similarity\u201d, meaning the similarity between the unlabeled and test samples. Based on this consideration, we included the eight neighbors of the test sample on the image as the unlabeled samples. The labeled samples are those from other patients (i.e., other than the patient where the test sample is from), which are the same as the samples used in GP."
                    ],
                    "subsections": [
                        {
                            "title": "Uncertainty Quantification",
                            "paragraphs": [
                                "Because transductive GP also generates a predictive distribution, the same approach as that described for GP can be used to quantify the uncertainty of the prediction."
                            ],
                            "subsections": []
                        },
                        {
                            "title": "Feature Selection",
                            "paragraphs": [
                                "The same forward stepwise selection procedure as GP was adopted to select features for transductive GP. Because transductive GP significantly reduces the prediction variance, we found that feature selection could benefit from minimizing leave-one-patient-out cross validation uncertainty as the criterion instead of maximizing the accuracy. Specifically, we computed the p value for each prediction that reflects the uncertainty (the smaller the p, the more certain of the prediction) and selected features to minimize the leave-one-patient-out cross validation p value."
                            ],
                            "subsections": []
                        }
                    ]
                },
                {
                    "title": "Model Comparison By Theoretical Analysis",
                    "paragraphs": [
                        "The original paper that proposed transductive GP showed empirical evidence that it outperformed GP but not theoretical justification. In this paper, we derived several theorems to reveal the underlying reasons. The proofs are skipped but available upon request."
                    ],
                    "subsections": [
                        {
                            "title": "Theorem 1",
                            "paragraphs": [
                                "When applying both GP and transductive GP to predict a test sample \\(\\mathbf{x}^{\\ast}\\) , the predictive variance of transductive GP is no greater than GP, i.e., \\({\\sigma_{\\mathit{tran}}^{\\ast}}^{2} \\leq {\\sigma^{\\ast}}^{2}\\) ."
                            ],
                            "subsections": []
                        },
                        {
                            "title": "Theorem 2",
                            "paragraphs": [
                                "Consider a test sample \\(\\mathbf{x}^{\\ast}\\) . Let \\(\\left\\{ {\\mathbf{X}_{L},,,\\mathbf{Y}_{L}} \\right\\}\\)  be the set of labeled samples used in training by GP. Let \\(\\left\\{ \\mathbf{X}_{U} \\right\\}\\)  be the set of unlabeled samples used in training by transductive GP in addition to the labeled set. If \\(K^{- 1}\\left( {\\mathbf{X}_{U},,,\\mathbf{X}_{L}} \\right)\\rightarrow 0\\)  and \\(K^{- 1}(\\mathbf{X}_{U},\\mathbf{x}^{\\ast}\\) )\\(\\rightarrow 0\\) , i.e., the distances of the unlabeled samples with respect to the labeled and test samples go to infinity, then the predictive distribution for \\(\\mathbf{x}^{\\ast}\\)  by transductive GP, \\(f_{\\mathit{tran}}{(\\mathbf{x}^{\\ast})}\\) , converges to that by GP, \\(f(\\mathbf{x}^{\\ast})\\) , with respect to Kullback\u2013Leibler divergence , i.e., \\(f^{\\mathit{tran}}\\overset{D}{\\rightarrow}f\\) ."
                            ],
                            "subsections": []
                        }
                    ]
                },
                {
                    "title": "Model Comparison On Prediction Accuracy And Uncertainty",
                    "paragraphs": [
                        "Using the selected features from each model (GP and transductive GP), we computed the prediction accuracy and uncertainty under leave-one-patient-out cross validation (LopoCV). The output from each GP model comprised a predictive distribution including a predictive mean and a predictive variance. We used the predictive mean as the point estimator for the CNV on the transformed scale, and used this to classify each biopsy sample as either EGFR amplified (CNV\u2009>\u20093.5) or EGFR non-amplified (CNV\u2009\u2264\u20093.5). This process was iterated until every patient served as the test case (all other patients as training). Note that LopoCV in theory provides greater rigor compared to k-fold cross validation or leave-one-out cross validation (LOOCV), which leaves out a single biopsy sample as the test case. LopoCV would likely better simulate clinical practice (i.e., the model is used on a per-patient basis, rather than on a per-sample basis). In addition to predictive mean, each GP model output also includes predictive variance for each sample, which allows for quantification of predictive uncertainty. Specifically, for each prediction on each biopsy, we tested the hypothesis that the sample belongs to the class predicted by the mean (H1) versus not (H0), using a standard one-sided z test. The p value of this test reflects the certainty of the prediction, such that smaller p values correspond with lower predictive uncertainty (i.e., greater certainty) for each sample classified by the model."
                    ],
                    "subsections": [
                        {
                            "title": "Classification Of Egfr Status And Cnv Data Transformation",
                            "paragraphs": [
                                "We employed the CNV threshold of 3.5 to classify each biopsy sample as EGFR normal (CNV\u2009\u2264\u20093.5) vs EGFR amplified (CNV\u2009>\u20093.5) as a statistically conservative approach to differentiating amplified samples from diploidy and triploidy samples49. As shown in prior work, the log-scale CNV data for EGFR status can also exhibit heavily skewed distributions across a population of biopsy samples, which can manifest as a long tail with extremely large values (up to 22-fold log scale increase) in a relative minority of EGFR amplified samples50. Such skewed distributions can present challenges for ML training, which we addressed using data transformation51,52. This transformation maintained identical biopsy sample ordering between transformed and original scales, but condensed the spacing between samples with extreme values on the transformed scale, such that the distribution width of samples with CNV\u2009>\u20093.5 approximated that of the samples with CNV\u2009\u2264\u20093.5."
                            ],
                            "subsections": []
                        },
                        {
                            "title": "Leave-One-Patient-Out-Cross-Validation (Lopocv) And Quantification Of Predictive Uncertainty",
                            "paragraphs": [
                                "To determine predictive accuracies for each GP model (without vs with Transductive Learning), we employed LopoCV. In this scheme, one randomly selected patient (and all of their respective biopsy samples) served as the test case, while the other remaining patients (and their biopsy data) served to train the model. Training consisted of fitting a GP regression to the entire training data set, and then using the trained GP regression model to predict all of the samples from the test patient case. The output from each GP model comprised a predictive distribution on each biopsy sample of the test patient, including a predictive mean and a predictive variance. We used the predictive mean as the point estimator for the CNV on the transformed scale, and used this to classify each biopsy sample as either EGFR amplified (CNV\u2009>\u20093.5) or EGFR non-amplified (CNV\u2009\u2264\u20093.5). This process was iterated until every patient served as the test case. Note that LopoCV in theory provides greater rigor compared to k-fold cross validation or leave-one-out cross validation (LOOCV), which leaves out a single biopsy sample as the test case. LopoCV would likely better simulate clinical practice (i.e., the model is used on a per-patient basis, rather than on a per-sample basis). In addition to predictive mean, each GP model output also includes predictive variance for each sample, which allows for quantification of predictive uncertainty. Specifically, for each prediction on each biopsy, we tested the hypothesis that the sample belongs to the class predicted by the mean (H1) versus not (H0), using a standard one-sided z test. The p value of this test reflects the certainty of the prediction, such that smaller p values correspond with lower predictive uncertainty (i.e., greater certainty) for each sample classified by the model. We prioritized the lowest predictive uncertainty as those predictions with the lowest range of p values (p\u2009<\u20090.05). We also evaluated incremental ranges of p values (e.g.,\u2009<\u20090.10;\u2009<\u20090.15, etc.) as gradations of progressively decreasing predictive uncertainty."
                            ],
                            "subsections": []
                        },
                        {
                            "title": "Subject Population, Clinical Data, And Genomic Analysis",
                            "paragraphs": [
                                "We recruited a total of 25 untreated GBM patients and collected 95 image-localized biopsy samples for analysis. Patient demographics and clinical data are summarized in Supplemental Table S1. The number of biopsies ranged from 1 to 6 per patient. Measured log-scale CNV status of EGFR amplification ranged from 1.876 to 82.43 across all 95 biopsy samples. Additionally, we used a separate cohort of 24 samples from 7 high-grade glioma patients to test the model, with demographics summarized in Supplemental Table S2."
                            ],
                            "subsections": []
                        },
                        {
                            "title": "Data Sharing Plan",
                            "paragraphs": [
                                "As detailed in our manuscript, we utilize a combination of either array-based comparative genomic hybridization (aCGH) or whole exome sequencing (WES) to specifically determine EGFR amplification status for each biopsy sample. Our model proposed here focusses on prediction of EGFR amplification status. To this end, we will release all image-based features and all genetic source data for the patients with aCGH, as well as the WES data used to determine EGFR amplification status at the time of initial publication. We will subsequently release the entire WES genomic data set 1\u00a0year from publication. We will upload the anonymized genetic outputs for each biopsy sample to the NCBI gene expression and hybridization array data repository (GEO) for public availability. We have also included the extracted spatially matched MRI texture features in Supplemental Materials (SM_MRI_textures.xls) that were used in the study to build and validate the standard GP and transductive learning GP models."
                            ],
                            "subsections": []
                        }
                    ]
                }
            ]
        },
        {
            "title": "Supplementary Information",
            "paragraphs": [],
            "subsections": [
                {
                    "title": "",
                    "paragraphs": [
                        ""
                    ],
                    "subsections": []
                }
            ]
        }
    ]
}