# I. INTRODUCTION

Over the last few decades, a variety of non-invasive optical schemes have been developed to study the cerebral blood flow (CBF) dynamics in human brains, [1][2][3][4] including near-infrared spectroscopy (NIRS), 1 diffuse correlation spectroscopy (DCS), 2,3 and diffuse optical tomography (DOT). 4 The 650 nm-950 nm optical window has relatively low optical absorption and, therefore, enables light to penetrate through the skin, scalp, and skull and interact with the brain. Returning photons carry information about the CBF and can be used to infer the brain activity via neurovascular coupling. 5,6 In short, neurovascular coupling describes the connection between brain activity and CBF since adequate CBF ensures that sufficient oxygen is delivered to the tissue. 2 In recent years, there has been a renewed effort to use DCS for such measurements. DCS uses coherent red or near-infrared lasers as light sources and high-bandwidth single-photon counting modules (SPCMs) as detectors. Compared to NIRS and DOT that measure reflected light intensity, DCS analyzes the dynamic scattering by monitoring intensity fluctuations. Therefore, DCS measures the flow dynamics rather than the hemoglobin concentration. Compared to the existing functional brain activity detection approaches, such as functional magnetic resonance imaging (fMRI) and electroencephalography (EEG), DCS offers an additional capability with some advantages. In terms of refresh rate, the work from Refs. 7 and 8 showed a refresh rate of tens of hertz, which is able to well sample the pulsatile effect in CBF. Since the sampling bandwidth of fast fMRI is in the order of 1 Hz 9 and common human cardiac signals (heartbeat) usually have a period of 1 Hz-3 Hz, the cardiac signals are not well sampled, which significantly contributes to the noise in fMRI. 10 Typical DCS systems are able to provide a spatial resolution of ∼1 cm. 3,11 Non-invasive EEG, the gold standard technique for monitoring brain activity in terms of speed, provides signals from a mixture of multiple underlying brain sources. This results in a low spatial resolution of 5 cm-9 cm. 12 Therefore, DCS lies in the niche between fMRI and EEG, where fMRI has high spatial resolution (∼2 mm) 3 but relatively low temporal resolution (∼1 Hz) and EEG has high temporal resolution (>1 kHz) 13 but low spatial resolution (5 cm-9 cm).

The performance of DCS is ultimately constrained by the total collected photon budget required for a reasonable signal-to-noise ratio (SNR). To have sufficient brain blood flow sensitivity, a large source-detector separation is required, which significantly lowers down the signal light intensity at the detector due to tissue absorption and scattering. Since DCS exploits only a few speckle grains from the scattered light, in order to get a sufficient number of signal photons for a relatively accurate measure on the blood flow dynamics, the required measurement time of the detector for one data point (one measurement of CBF) is typically no less than 10 ms. 8 There is therefore a trade-off between the measurement time and the sensitivity of the system: a high SNR measurement requires relatively long measurement time, which results in a relatively low sampling rate. This trade-off is fundamentally caused by the limitation of photon budgets and can be mitigated by multi-channel DCS, which, in turn, scales up the costs of the system. 8 Furthermore, the multi-channel DCS also scales up the requirement of data throughputs, which also brings technical issues in practical implementations.

To tackle the limitation of the shortage of signal photons, a camera sensor with thousands to millions of pixels can be used as the detector in place of the SPCM. [14][15][16] By using a camera sensor, the system can collect more photons with the same measurement time compared to DCS or collect the same number of photons within a shorter measurement time. Because the number of pixels is large while the data throughput is limited, the temporal sampling speed is typically not sufficient to well sample the temporal intensity fluctuation. Instead, we can infer the temporal dynamics of blood flows from the speckle statistics of the captured frame. This method is termed speckle visibility spectroscopy (SVS), 14,15 or speckle contrast spectroscopy, 16 and laser speckle contrast imaging. [17][18][19] In the SVSbased approach, a whole speckle pattern containing many speckle grains is captured using a detector array (e.g., a CCD camera), and the statistics of the blurred speckle pattern is used to calculate the speckle decorrelation time. With a given camera integration time that is longer than the speckle decorrelation time, different speckle decorrelation times result in speckle frames with different extents of blurring. Since a speckle pattern recorded by using a detector array can contain thousands to millions of speckle grains, the photon budget limitation is mitigated. In this case, a single decorrelation time measurement does not require tens of millisecond as compared to DCS, therefore resulting in a higher refresh rate. It is worth noting that the principle of SVS has been used for different purposes. In Refs. 14-16, SVS is used to detect diffused photons. The illumination area is relatively small and has a distance from the detection area. The goal in this scenario is to increase the measurement sensitivity of deeply diffused light. In Refs. 17-19, SVS is used for wide field illumination and imaging. An imaging system is used to image the target, such as a superficial layer of cortex, and local speckle visibility is used to build a blood flow map. In this case, the depth sensitivity is limited.

While SVS relaxes the requirements for temporal fidelity, it suffers from camera noise as commercial camera sensors are generally noisier than SPCMs when the signal light intensity is low. The camera noise can overwhelm the signal if the signal light only yields a few photoelectron counts per pixel within the exposure time. The direct way to overcome this problem would be to increase the camera exposure time. Similar to the aforementioned trade-off between SNR and measurement time, the increase in exposure time will result in a decrease in the refresh rate.

Here, we propose and demonstrate the idea of interferometric SVS, or ISVS, which circumvents the camera noise problem and is able to measure the blood flow dynamics even when the number of available signal photons is limited (below 1 photoelectron per pixel). Interferometric detection is able to overcome camera noise by boosting the weak signal term in the heterodyne cross term, and as such, the ISVS system is able to achieve a reasonable SNR even when the mean pixel value number from the signal light is smaller than 1. This allows ISVS to perform measurements within a short acquisition time and a high rate at which CBF estimates are generated in a low-light condition where DCS fails to do so. A novel interference speckle spatial statistics analysis is derived to quantify the speckle decorrelation time. Another advantage brought by ISVS is that the interferometric measurement provides the information of complex field decorrelation time; therefore, the Siegert relation 20 as well as the corresponding Gaussian statistics assumptions required in typical DCS calculations are not required in ISVS. This makes ISVS valid even when the conventional speckle statistical property is no longer valid due to static scattering or unexpected background light received by using the camera sensor.

While interferometric detection is a widely used approach in biomedical imaging, [21][22][23][24] there are some differences between ISVS and the previous works that also use interferometric detection for blood flow measurements. The works by Höhler et al. 21 and Robinson et al. 22 use similar intensity of the reference beam and sample beam, and the work by Zhou et al. 23 uses a strong reference beam to boost the signal. The above-mentioned three works sample the temporal fluctuation of the interferometric signal, while ISVS uses a strong reference beam to boost the signal and samples the spatial speckles. The work by Atlan et al. 24 implements a wide field imaging modality to image the superficial blood vessels and uses a frequency-shifted reference beam to tease out the dynamic vessel image at different frequencies, while ISVS sets a distance between the illumination and detection and uses interferometric detection to detect light that interacts with deep blood flow based on light diffusion. 3 By using ISVS, we demonstrated high speed (100 Hz) noninvasive in vivo cerebral blood flow monitoring on the human forehead, under the condition where the number of signal photoelectrons per pixel was ∼0.95. In this case, the camera sensor noise was ∼1.2 photoelectrons per pixel. The direct measurement will yield an SNR of ∼0.61 for each pixel due to the photoelectron shot noise and the detector noise. The overall SNR with ∼2 × 10 5 pixels is an expected value of √ 0.61 × 2 × 10 5 ≈ 349. By using ISVS, the detector noise effect can be mitigated, and the single pixel measurement SNR is dominant by shot noise. Therefore, in the interferometric detection regime, the single pixel SNR should be √ 0.95 ≈ 0.97 due to shot noise, and the use of ∼2 × 10 5 camera pixels provides an expected SNR of 436. While the SNR improvement by using interferometric detection is modest for this camera, this SNR improvement is, nevertheless, desirable. We expect that this ability of interferometric detection to provide shot noise limited detection SNR would be even more desirable in future ISVS experiments where near-infrared cameras with noisier characteristics are used in tandem with longer wavelengths. We also designed a breathholding task for a human subject and implemented ISVS to monitor the CBF, showing that the relative CBF (rCBF) changes in accordance to brain stimulation caused by the task could be revealed by ISVS.

# II. RESULTS

## A. Principle

The ISVS principle is based on an interferometer, where the weak diffused light containing the information is boosted by using a reference beam and recorded by using the camera [see Fig. 1(a)]. The image sequence recorded on the camera can be reconstructed to provide a sequence that contains blood flow information, where each camera frame corresponds to one data point in the reconstructed sequence. Assuming that the diffused light has a limited spatial bandwidth, the complex field of the diffused light is obtained via an off-axis holography configuration, 25 by directly reconstructing the measured output intensity of the interferometer. In this configuration, the total instantaneous interference pattern It at the position r = (x, y) in the observation plane is

where ER is the complex field of the plane wave reference beam, ES(r) is the complex field of the diffused light, ϕS(r) is the phase difference between the reference beam and the diffused light field, k 0 is the wave-vector in free space, and θ is the tilt angle of the oblique reference beam. Due to off-axis holography, the Fourier transform of It(r) in Eq. ( 1) provides three separate lobes [see Fig. When the diffused optical field is decorrelating, the camera integration sums the independent holograms and results in a low fringe visibility hologram; when the diffused optical field is static, the same hologram lasts during the whole camera integration time and results in a high fringe visibility hologram.

of the heterodyne terms by a less-than-unity "equivalent visibility factor."

We now move forward to quantitatively demonstrate how ISVS is able to distinguish between decorrelation events of different timescales. The analysis is dependent on interference speckle spatial statistics, which is exploited for the first time in CBF measurements. In Fig. 1, the interference pattern recorded by using the camera is

where t = 0 defines the beginning of the exposure and T is the exposure time. Since the third interference term in the integral has a different location on Fourier space, one can filter it out to get the complex field information. Let us define the interference signal as

It can be rewritten as t) dt. We can then pick the first one of the phase conjugated pairs and define the ISVS signal S(r) as

The second moment of S(r) will contain the field decorrelation function g 

where ⟨•⟩t 0 denotes the expected value over t 0 , ⟨•⟩ denotes the expected value over space, IR is the intensity of the reference beam, and ĪS is the mean intensity of the signal beam. Both of IR and ĪS can be calibrated before the experiment. We then define the equivalent visibility factor as F,

which ranges from 0 to 1 for different g 1 (t).

As we can see from Eq. ( 5), F is a function of g 1 (t) and the camera exposure time T. If the sample is static [i.e., g 1 (t) = 1 for 0 < t < T], F = 1, indicating that the interference fringes have high contrast. If the complex field of the diffuse light decorrelates very quickly compared to T, [i.e., g 1 (t) = 1 for 0 < t < τ and g 1 (t) = 0 for τ < t < T, where τ ≪ T], F = 2τ T , indicating that the interference fringes have low contrast. This matches with the intuition that multiple decorrelation events happening within the camera exposure time blur out the interference fringes and yield a low fringe visibility. The ISVS equivalent visibility factor shares some similarities with the visibility factor in conventional SVS [Eq. (8) in Ref. 15]. Given a camera exposure time, as the speckle decorrelation time decreases, both ISVS the equivalent visibility factor and the conventional SVS visibility factor will decrease. Furthermore, both of them range from 0 to 1. However, they have different physical meanings. The ISVS equivalent visibility factor describes the strength of the interference term, while the SVS visibility factor describes the overall speckle contrast.

Figure 1(b) intuitively shows the relation between the equivalent visibility factor and the decorrelation time scale. Let us consider two cases: a decorrelating optical field [top row in Fig. 1(b)] and a static optical field [bottom row in Fig. 1(b)]. If the optical field is static, the amplitude and phase of one speckle grain are fixed within the camera exposure time T, and thus, the interference fringes have high visibility. If the optical field is decorrelating within the camera exposure time, the pattern recorded on the camera will be the summation of different interference patterns with different amplitudes and phases. The summation of the patterns from uncorrelated sample fields will cause low fringe visibility. As the decorrelation time shrinks relative to the camera exposure time T, the number of decorrelating events within T grows, therefore leading to lower fringe visibility.

## B. System characterization and measurement fidelity improvements

To verify and characterize the performance of the system, we used two ground glass diffusers (Thorlabs, DG20 Series) as the samples. The schematic is shown in Fig. 2(a) [for more details, see Fig. 2(A) of the supplementary material]. We controlled the rotating speed of the first one and kept the other one static. A laser beam illuminated the rotating diffuser, and a range of rotation speeds were applied. The scattered light from the first rotating diffuser illuminated the second static diffuser and was collected by using the optical system. The static diffuser was used to eliminate the speckle pattern "smearing" effect that is present when using a single rotating diffuser (see Fig. 5 of the supplementary material for examples). The decorrelation times were computed by measuring the time traces of the intensity fluctuations using a singlephoton counting module (SPCM) in the optical setup. Then, by mapping rotation speed to the measured decorrelation time, we were able to simulate a dynamic sample with configurable decorrelation times.

First, we verified the mathematical model of the ISVS equivalent visibility factor by experimental results. The blue curve in Fig. 2(b) depicts the measured ISVS equivalent visibility factor under different camera exposure time (T) to decorrelation time (τ) ratios, T/τ, where the decorrelation time τ of the scattering light was measured by analyzing the autocorrelation of the time traces captured by using the SPCM in parallel to the ISVS measurement. In the experiment, the exposure time T was set as 1 ms. The error bars on the vertical axis were calculated from 10 ISVS measurements, and the error bars on the horizontal axis were calculated from 10 DCS measurements. The red curve represents the theoretical model calculation [see the supplementary material, Eq. ( 5)], showing good correspondence with the experimental results.

Using the theoretical model, we then mapped the measured equivalent visibility factors to decorrelation times [Fig. 2(c  Finally, we showed that the signal boost from the interferometric detection scheme resulted in a measurement with higher fidelity compared to direct detection, when the number of signal photons from the sample was low. In this experiment, we performed direct SVS measurements and used the model from Ref. 15 to calculate the scattered light decorrelation time. As shown in [Fig. 2(d)], when the number of photo-electrons excited by the signal beam was large (>5 e -/pixel), both SVS and ISVS provided results comparable to the results from the DCS measurement, which served as the ground truth. As the signal beam became weaker, SVS measured decorrelation times deviated from the ground truth and got larger. In the low photon budget regime (e.g., <1 e -/pixel) where mean intensity on the camera was low, the detector noise dominated the spatial speckle fluctuation, resulting in a high contrast, i.e., the ratio between the standard deviation and the mean value of the frame is high. For SVS, this camera-noise caused high contrast pattern may have a similar contrast to a frame with high contrast speckles. In this case, the model will inaccurately provide a long decorrelation time that is close to a static speckle pattern. In comparison, the interference term of ISVS is not significantly impacted by the camera noise, and ISVS should provide an accurate measurement even when the detected signal photon count is low. However, due to the reference beam intensity fluctuation in ISVS, the standard deviation of measured decorrelation time τ is larger than that from direct measurements such as SVS and DCS. To mitigate this issue, one can use a separate detector to monitor the reference beam intensity fluctuation and use the measured intensity fluctuation to correct IR in Eq. (4).

## C. System operation on rats

We implemented an ISVS system to monitor blood flow in rats. This monitoring was performed in the dorsal skin and the brain in a reflection-mode configuration. A nude rat was first anesthetized, and then its dorsal skin was shaved and mounted on a clip device. A collimated laser beam illuminated the skin, and the light diffused by the skin was detected by using the ISVS system. The pulsatile effect of the blood flow from the dorsal skin flap measured by using the ISVS system is presented in Fig. 3(A) of the supplementary material. Additionally, another nude rat was anesthetized, and a portion of its scalp was removed. A collimated laser beam illuminated the skull, and the light diffused from the skull and the brain was detected by using the ISVS system. The pulsatile CBF results from the ISVS measurement are shown in Fig. 3(B) of the supplementary material. In the rat brain experiment, the bregma area was imaged by using the system [see Fig. 3(C) of the supplementary material], and the central part of the imaging area was ∼1 cm from the laser illumination spot. In both the dorsal skin and brain blood flow measurements, a customized pulse monitor was synchronized with the optical system and used to monitor the blood flow in the tail, confirming that the detected pulsatile ISVS signals indeed originate from the pulsatile nature of beating of the heart. A schematic of the experimental setup is shown in Fig. 2(B) of the supplementary material, and the details of the anesthesia and surgery are in note B of the supplementary material. All procedures and the dosage of chemicals followed the protocols of the Institutional Animal Care and Use Committee at California Institute of Technology. Animal husbandry and all experimental procedures involving animal subjects were approved by the Institutional Animal Care and Use Committee (IACUC) and by the Office of Laboratory Animal Resources at California Institute of Technology under IACUC protocol 1770-18.

## D. Human experiment design and operation

To demonstrate the performance of ISVS for in vivo measurements of CBF dynamics, we implemented an ISVS system on human subjects, as depicted in Fig. 3(a). The schematic of a more detailed optical setup can be found in note A and Fig. 2C of the supplementary material. A beam splitter was added to split the light onto a single photon counting module (SPCM) as a reference for photon count rates, as well as a DCS measurement. A healthy adult human subject sat on a medical chair with his head placed inside a head immobilizer. Non-contact source and detector fibers were mounted above the subject's forehead over the prefrontal cortex area. To have a sufficient number of illumination photons for this measurement, the laser beam from the 671-nm source was coupled to a multimode fiber (Thorlabs M31L02, ∼3000 modes). The collimated 56 mW laser beam with a 6-mm spot size resulted in a <2 mW/mm 2 irradiance for skin exposure-within the limit stipulated by American National Standard Institute (ANSI). The diffused light at various source-detector (S-D) separations (S-D = 1.5 cm and 0.75 cm) was then collected via a large core multimode fiber (Thorlabs M107L02, core diameter 1.5 mm) containing ∼6 × 10 6 modes. We used tapes to mount the fiber onto the optical table to avoid the optical field decorrelation caused by fiber vibration. The output of this fiber was channeled through the sample arm of the interferometer. About 2 × 10 5 camera pixels were used to capture the photons. A human protocol comprising of all detailed experimental procedures were reviewed and approved by the Caltech Institutional Review Board (IRB) under IRB protocol 19-0941, informed consent was obtained in all cases, and safety precautions were implemented to avoid accidental eye exposure.

We first demonstrated that the ISVS system was able to monitor the blood flow in humans when the reflected light signal was low. When the S-D separation was 1.5 cm, the photon count rate read by using the SPCM was ∼1500 counts/s, while the dark count rate of the SPCM was ∼180 counts/s. This photon rate is ∼100 fold less than the light budget in conventional DCS experiments. 8 For this experiment, we used a laser wavelength of 671 nm, at which biological tissue has a higher absorption coefficient than wavelength 785 nm in common DCS settings. Even though the photon rate of DCS is low, our DCS and ISVS comparison was done on an equal basis-the photon count rate at the SPCM and each camera pixel is the same. We set such a low photon rate purposely for demonstrating that ISVS is able to retrieve the signal under this low-light condition. In reality, the photon rate for both DCS and ISVS can be optimized to improve performance. The intensity decorrelation curve g 2 (t) is shown in Fig. 3(b) after a DCS measurement by using the SPCM with a measurement time of 50 s. To obtain the pulsatile signal from the DCS measurement, the SPCM trace is divided into subtraces with the time duration of 10 ms for each subtrace. First, decorrelation time is calculated for each subtrace, and then, the blood flow index (BFI) is calculated from the calculated decorrelation time based on the tissue scattering parameters used in Ref. 27. As shown in Fig. 3(c), there is no obvious pulsatile signal retrieved from the DCS measurement. Therefore, under this experimental condition, the photon count rate was not sufficient for DCS to monitor the pulsatile signal with a reasonable SNR. The ISVS system with a camera exposure time of 2 ms and an FPS of 100 Hz yielded a pulsatile signal trace, shown by the blue color line in Fig. 3(d). The filtered signal trace is shown as the red color line in Fig. 3(d). The measured ISVS equivalent visibility factor was used to calculate the decorrelation time from the model in Fig. 2(b), and the decorrelation time was related to the BFI by using the correlation diffusion equation. 27 The raw and filtered BFI traces are presented in blue and red curves in Fig. 3(e), respectively. The Fourier transform of the raw BFI trace is shown in Fig. 3(f), and the heart-beat frequency of ∼1.1 Hz and its harmonics are highlighted. In this experimental configuration, the average photoelectron number of the signal beam on each camera pixel was ∼0.95, where the detector noise was ∼1.2 photoelectrons. In this case, the SNR for each pixel was ∼ 0.95/ √ 0.95 + 1.22 = 0.61 with a direct measurement. With a shot noise dominant interferometric measurement, the single pixel SNR can achieve 0.97. By using ∼2 × 10 5 camera pixels, the overall SNR can be scaled up by √ 2 × 10 5 ≈ 447 times to 436. It is worth mentioning that, due to the dynamic scattering interaction between the light and the blood flow, the contrast of the speckle pattern was much lower than unity, predicted by the static speckle statistics. This, in fact, makes SVS-the direct measurement method-even harder to retrieve the contrast of the pattern and the information of the blood flow.

In order to demonstrate the capability of ISVS for human brain activity detection, we established a straightforward brain stimulation experiment (breath-holding task) for a healthy human subject. This experiment was based on the fact that the stoppage of the subject's breathing increases the CBF due to vasomotor reactivity from rising pCO 2 . 28,29 CO 2 pressure will rise during breath holding 29 due to metabolism, and the rising CO 2 pressure can cause the increase in blood flow. 28 In the experiment, the subject first breathed normally for ∼2 min, then did an exhalation breath holding for ∼15 s, and finally started to recover by having normal breathing again.

The S-D separations in the breath-holding task were set to be 1.5 cm and 0.75 cm. Since the ∼1 Hz pulsatile blood flow change is naturally presented in the measurement, we set the sampling rate as 12 Hz. At this sampling rate, the pulsatile signal was observable, where data processing could filter it. The system recorded the ∼10 s before the breath holding, the entire ∼15 s of breath holding, and the ∼16 s after the breath holding. We performed ISVS measurements in three cases: (i) An S-D separation of d 1 = 1.5 cm while the subject went through a breath-holding task, (ii) an S-D separation of d 1 = 0.75 cm while the subject went through a breath-holding task, and (iii) an S-D separation of d 2 = 1.5 cm while the subject breathed normally. The representative recorded traces for case (i)-(iii) are shown in Figs. 3(g) and 3(h), respectively. For each case, five repetitive experiments were conducted to avoid a single experiment outlier.

To see the rCBF change due to the breath-holding task, the mean values and standard deviations of rCBF during 2 s-4 s (phase 1), 10 s-12 s (phase 2, first several seconds of breath holding), 22 s-24 s (phase 3, last several seconds of breath holding), and 37 s-39 s (phase 4) were calculated and plotted, as shown in Fig. 3(i). The increase in rCBF values in phase 3 at the S-D separation of 15 mm [case (i)] is clearly shown by the blue line in Fig. 3(i). In this case (an S-D separation of 1.5 cm), some of light interacted with the cerebral blood flow, as the previous research from Selb et al. 30 showed that the blood flow change could be seen at an S-D separation larger than 1 cm. The increase in rCBF values in phase 3 at the S-D separation of 7.5 mm [case (iii)] was not as clear as that in case (i), as shown by the red line in Fig. 3(i). In this case (an S-D separation of 0.75 cm), most of light interacted with the forehead skin and the skull rather than the brain; hence, the breath-holding task did not have the same significant impacts on the signal. The normal breathing measurements at the S-D separation of 1.5 cm [case (iii)] as a reference did not have a significant change in rCBF, as shown by the yellow line in Fig. 3(i).

# III. DISCUSSION

Here, we demonstrated the concept of ISVS, characterized the performance of ISVS, and implemented it in human cerebral blood monitoring. The interferometric detection and camera parallel measurement of multiple speckles allowed us to sample the weak signal light with high fidelity and a high frame rate. By using the sensitive ISVS system, we monitored the pulsatile blood flow in the brain as well as the cerebral blood flow change during a breath-holding task. The photon rate in our demonstration was ∼100 fold less than the photon rate in conventional DCS measurements.

From a more general perspective, diffusing correlation spectroscopy-based methods can, in general, be categorized as temporal sampling (DCS and interferometric DCS 23 ) or spatial ensemble (SVS and ISVS) methods. Both of them use corresponding mathematical models to describe the light-tissue interaction and speckle statistics to infer the temporal dynamics of signals of interest, such as cerebral blood flow. Temporal sampling methods (e.g., DCS, interferometric DCS) directly sample one or several dynamical speckles temporally using high speed detectors, while spatial ensemble methods, including ISVS, sample speckles spatially using detector arrays. Since the SNR of the decorrelation time measurement is tied to the number of signal photons, getting a higher SNR usually requires more signal photons. The more signal photons in temporal sampling methods inevitably lead to longer measurement time, while those in spatial ensemble methods require more camera pixels. Therefore, in spatial ensemble methods, scaling up of the number of camera pixels will scale up the SNR of signal data points without increasing the measurement time, given high enough data throughputs.

Another property of ISVS is that it does analysis on complex fields directly. As shown in Eq. ( 3), the off-axis holography scheme allows us to reconstruct the complex field and incorporate the field correlation function g 1 (t) directly into the equivalent visibility factor. In conventional methods such as temporal sampling DCS or spatial ensemble SVS, it is usually necessary to measure the intensity and use the Siegert relation 20 to get the information of the field correlation function g 1 (t). There are several conditions required for the Siegert relation to be valid, such as the Gaussian statistics and ergodicity requirements for the speckle field. 31 When light interacts with static parts in tissue and diffuses to the detection plane, such as surface reflection or shallow skin diffusion, there will be a static speckle field adding on the dynamic speckle field. This static speckle field breaks the Gaussian statistics and ergodicity requirements, and the Siegert relation in this case does not hold. ISVS circumvents the Siegert relation and is able to directly retrieve the information of the field correlation function g 1 (t).

One of the goals for future development of ISVS is to improve the stability of the light collection part in the system. As we use a large core multimode fiber to collect the signal light, it is highly sensitive to environmental perturbation, such as vibration. The perturbation can cause significant changes in mode mixing in the fiber and results in a decorrelating speckle pattern at the output of the fiber even if the input optical field of the fiber is static. If the speckle decorrelation time caused by environmental perturbation is comparable to the signal light decorrelation time, the contribution from environments can overwhelm the signal itself. One viable solution to this problem is to use a fiber bundle to replace the large core multimode fiber. The mode mixing between the individual fibers in the bundle is less than that in the large core multimode fiber; thus, it is less sensitive to environmental perturbation.

In the future application of ISVS, a wavelength with lower absorption such as 785 nm can be implemented to increase the light penetration depth and improve the measurement SNR. In addition, since the simultaneous measurement of ISVS and DCS in our demonstration is for a comparative study, 50/50 beam splitter 1 in Fig. 3 can be removed in real applications to increase the photon flux by a factor of 2. By optimizing the aforementioned experimental aspects, a larger S-D separation is expected to be demonstrated by ISVS.

In addition, the idea of multi-exposure SVS can also be adopted in ISVS to improve the performance of ISVS decorrelation time quantification. Previous research in SVS has demonstrated that the use of multi-exposure 32,33 can provide a more robust measure of flow when the experimental condition is not ideal, such as the presence of static scattering. The work in Ref. 34 has theoretically proven that multi-exposure SVS has similarities to DCS, indicating that multi-exposure SVS is able quantify the shape of the decorrelation curve. By developing the theoretical models accordingly, multi-exposure ISVS has the potential to provide more robust and informative decorrelation measurements. On the other hand, ultrasound-modulated optical tomography (UOT) can be adopted to improve the spatial resolution of ISVS. The work in Ref. 35  Before concluding the discussion section, we would like to speculate on the potential role of ISVS within the currently used clinical methods of accessing the information of CBF. Table I, which is adapted from Refs. 3 and 36, outlines the features of the various non-invasive CBF measurement modalities, including ISVS. Since ISVS shares the similar light illumination and collection architectures with DCS, it inherits multiple advantages brought from DCS, such as bedside availability, endogenous contrast, radiation free, short data acquisition time, and low cost. Due to the multi-channel property brought by using the camera, the data acquisition time for each measurement is significantly shortened compared to DCS. The shortened data acquisition time Tacq could help improve the sampling bandwidth up to 1/Tacq, which can be up to hundreds or even thousands of hertz. The higher rate at which CBF estimates are generated can provide more options for data processing, such as the low pass filter or high frequency contrast extraction. In some cognitive tasks, such as cerebral blood flow signals during walking, 37 high sampling speeds are required to record the quickly changing signals for data analysis.

# SUPPLEMENTARY MATERIAL

See the supplementary material for more details on the supplementary note and supplementary figures. AUTHORS' CONTRIBUTIONS J.X., A.K.J., and J.B. contributed equally to this work.

# ACKNOWLEDGMENTS

The authors would like to thank Professor John O'Doherty, Professor Adoph Ralphs, Dr. Yan Liu, Dr. Haowen Ruan, and Dr. Haojiang Zhou for their helpful discussions. This research was supported by Kernel-Brain Research and Technologies-Grant No. FS 13520230.

# DATA AVAILABILITY

The data that support the findings of this study are available from the corresponding author upon reasonable request.

