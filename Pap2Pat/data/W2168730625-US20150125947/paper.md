# Introduction

Droplet microfluidics offer an attractive set of techniques to minimize volumes of chemical reactions and for the incubation of microorganisms. [1][2][3] Precise protocols of operation on the reaction or incubation mixtures require correspondingly precise handling of liquids, either by setting the rates of flow, 4 by using integrated micro-valves [5][6][7][8][9][10] or external control devices. 11 The requirement for precise control of flow is inconvenient in multiple applications, especially point-of-care or simple laboratory testing. As well as in many other spheres of life and technology, diagnostics in emergency-, screening-and in-fieldtesting often call for protocols to be flexible for the sake of simplicity and robustness of use. A prime example is the wellknown strip test that performs only a single prescribed function (assay). This clear functional limitation is rewarded with robustness-the system is very simple to operate and it is very difficult to accidentally cause its malfunction. The development of systems that would be similarly simple to operate yet could allow a wider range of liquid handling protocols to be incorporated into the chips has been one of the significant motivations for the development of microfluidics. Many successful approaches exist, e.g. paper based microfluidics 12,13 that expand on strip test technology, slip chips 14 which allow one or two sets of operations to be performed in parallel on small portions of liquids, or geometric modules for select operations on microdroplets. [15][16][17][18][19][20][21][22][23][24][25][26][27][28] However the chal-lenge of building a platform that would allow all elementary operations to be performed on micro aliquots of liquids and for integration of the modules that perform these operations into functional, hard-wired networks is still to be explored.

From an engineering perspective, it is possible to construct devices that are insensitive to a set of parameters by designing processes in which the parameters to be disregarded are dominated by forces which enforce a well defined state (either static or dynamic). In the strip test this goal is achieved by a gradation of forces: the capillary forces that are stronger than the viscous dissipation guaranteeing filling of the strip up to its volumetric capacity, while viscous resistance to flow dominates inertia and gravity to protect the liquid from random displacement on the strip. In droplet microfluidics such an opportunity is given by the typically small values of the capillary number (Ca) that represents the large mismatch between the large Laplace pressure and small shear, and by the strong dependence of pressure gradients on the crosssection of the microfluidic channels. As both of these effects are strongly dependent on the geometry of the channels and because the geometry of the devices can be very well controlled at the stage of fabrication, the dominating effects of interfacial tension can be used to yield reproducibly area-minimizing shapes of the interface, largely irrespective of the (comparitively small) magnitude of shear stresses. Here we show that it is possible to construct devices operating at low values of Ca for precise operation on droplets, largely irrespective of the parameters that typically need to be precisely controlled, such as: i) the rate of flow, ii) time of switching the flow, or iii) synchronization of inputs.

We use droplets suspended in a continuous liquid that preferentially wets the walls of the microchannels. The channels confine the droplets: drops larger than the largest sphere inscribed into the lumen of the channel are squeezed; the tightness of the channel sets the curvature of the interface and the pressure jump across the interface. Proper design of the geometry of the channel can be thus used to determine the pressure drop along the droplet needed to drive it through a constriction. Second, droplets flowing in channels experience a non-trivial flow of the continuous liquid around them. 29 In rectangular channels, small drops (of length comparable to the width of the channel) flow faster than the mean speed of the carrier liquid. [30][31][32] Larger droplets confine the flow of continuous liquid to thin films on the faces of the walls and to gutters in the corners of the lumen. As a result, these longer drops may flow at speeds different than the mean speed of the continuous liquid which may pass by the droplet. As we show below, appropriate design of 'gutters' (or 'bypasses') allow the effect to be enhanced and to deliberately lock a desired droplet in place while allowing the continuous liquid to pass by.

# Results and discussion

We demonstrate a number of microfluidic modules (traps) that we designed to perform simple operations on the droplets. These operations include: metering of small volumes of liquid and splitting droplets, merging droplets, locking the droplet in place and moderating the speed of the droplet. Such functions can be performed also by the ''droplet-on-demand'' (DOD) technique, 11 that enables precise control over the size of droplets and the time of their appearance. The DOD technique, however, requires computer controlled valves or pumps for the active administration of liquid aliquots. Here we demonstrate that this active control can be effectively replaced by a combination of traps: by the metering traps for precise metering of the volume of the droplet, by the merging traps that lock and fuse droplets, by the lock&shift traps that immobilize the drops and finally by the delay traps that modify the speed of flow of the droplets.

Below we first introduce the design and operation of the traps and then we show how these traps can be integrated into systems of increasing complexity. As a model application we use the challenge of generating a geometric series of concentrations of a sample in well defined micro-aliquots of liquid without the need to exercise precise control over the flow on the chip.

## A. Metering trap

Fig. 1. presents a metering trap. The length of the trap is defined by the length of the two side bypasses that are milled to 1/4 of the depth of the main rectangular channel. At the terminus of the trap we placed a barrier in the main channel that extends upwards to 3/4 of the height i.e. of equal height to the floor of the bypasses. A droplet shorter than the length of the trap flows into the module and is locked because passing through the barrier increases the Laplace back-pressure. The continuous liquid passes the droplet via the bypasses. When a droplet longer than the trap arrives at the barrier, the rear of the droplet blocks the entrance to the bypass, the continuous liquid cannot pass by the droplet efficiently and pushes it forward until the rear of the droplet aligns with the entrance to the trap. At that moment the droplet stops, the Rayleigh-Plateau instability breaks the liquid neck at the front barrier, leaving a precisely metered volume locked in the trap.

The metering trap can also be used to generate a sequence of serial dilutions in a procedure very similar to the one presented first by Niu et al. 15 Once a droplet with the sample is locked, passing a drop of solvent will i) merge it with the sample, and ii) push out an equal volume of the sample out (Fig. 1d). The flow of the continuous liquid through the bypasses stirs the content of the trapped droplet and speeds up mixing of its content. Passing a sequence of droplets of buffer through the metering trap initially containing a droplet of the sample, generates a sequence of dilutions. If the time between two consecutive titrations is longer than the time required for homogenizing the solution in the trap, the sequence presents an exponential (serial dilution) sequence of concentrations (see Fig. 2).

## B. Merging trap

Generation of serial dilutions with the metering trap relies on mixing the content of the droplet inside the dilutor and thus requires a sufficient delay between consecutive droplets of solvent entering the trap. As we show below this requirement can be alleviated with the use of a merging trap. The merging trap performs an important function: it allows two drops to be merged and released for further processing, a feature that will be useful in diverse applications. The merging trap (Fig. 3) comprises of the same bypasses as the metering trap and a set of side intrusions on both of its termini. These intrusions create an obstacle which increases the Laplace back pressure as in the case of the barrier in the metering trap. The difference between these two types of obstacles is that the neck of droplet squeezed through intrusions is less deformed and is more stable against an Rayleigh-Plateau type of instability. As a result the droplet does not break when pushed out of the trap. The operation of the merging trap can be described as follows. A droplet longer than the trap (Fig. 3b) passes through it because it continues to block the inlets to the bypasses when its front meets the intrusions at the outlet of the trap. A droplet shorter than the trap (Fig. 3c) is locked once its front approaches the side intrusions at the outlet of the trap because the continuous liquid flows by via the bypasses. When a second droplet flows into the trap, it flows all the way down to the first drop because the continuous liquid can be expelled from in-between the two drops via the bypasses. This allows the drops to merge. If the merged droplet is shorter than the trap it will remain trapped. If it is longer than the trap its rear blocks the entrance to the bypasses which leads to a build-up of pressure drop along the droplet and pushes it through the front barrier. This, in turn, blocks the outlet of the bypasses, and causes a complete release of the merged droplet from the trap (Fig. 3).

Importantly, as the merged droplet contains different solutions at its front and rear (and not side by side), the flow even in a straight channel mixes the two liquids rapidly. This provides for the efficient homogenization of liquids, and the extent of homogenization is controlled more by the distance travelled by the droplet than by the time elapsed from the event of merging. This feature is in line with the idea of encoding the processes into the geometry of the microfluidic device and leaving flexibility on the execution of the flow protocol (e.g. at only loosely controlled speed of flow and timing of events).

The merging trap shown in Fig. 3 has intrusions both at its inlet and outlet. This provides for bi-directional symmetry: the trap will perform the same function irrespective of the direction of flow. It is also possible to merge droplets with intrusions located only at one terminus of the trap. In such a case, upon reversal of flow, the module will be inactive for long droplets and for short ones will act as delay trap.

## C. ''Lock&shift'' trap

It is often of interest to array samples contained in microdroplets and to hold the droplets in well specified positions with the possibility of replacing the trapped droplets without the risk of any cross-contamination between the samples. These tasks can be successfully realized by the lock&shift trap (Fig. 4).

The main difference between the metering trap and the lock&shift trap is that in the latter the bypasses are connected   with the main channel only at the entrance and at the exit of the trap, while being separated from the main channel along the length of the trap. The lock&shift module can be design with two different types of the obstacle at the end of the trap: one (shown in Fig. 4) with a barrier similar to the one used in the metering trap or second, with two side intrusions, as in the merging trap (See Fig. S2, ESI3 and Fig. 5).

The trap locks short droplets: when a droplet flows into the trap, it is pushed towards the barrier and is stopped there by the increased back-acting Laplace pressure. The continuous liquid bypasses the droplet through the parallel channels, decreasing the pressure drop along the droplet. A similar functionality has been shown before by Zagnoni and Cooper, 16 the lock&shift trap differs from the shift register unit in that i) it traps a single droplet and releases it upon approach of a consecutive drop, and ii) consecutive droplets never touch each other. We will demonstrate the use of both of these distinct features below.

## D. Delay trap

We have also constructed a delay trap (see ESI 3 for details) that reduces the speed of the droplet while it is in the trap. The geometry of the delay trap is similar to the metering trap yet it does not have any barriers at its termini. The parallel slits facilitate bypassing of the droplet by the continuous liquid. This decreases the pressure drop along the droplet and slows down its forward motion. We tested traps that allowed up to a 2-fold reduction in the speed of the droplet while maintaining the same rate of flow of the continuous liquid.

## E. Integrated serial dilutor I

The formation of a sequence presenting a serial dilution using solely the metering traps-as presented in section A-is very similar to the first demonstration of serial dilution from a trapped droplet. 15 It allows a wide range of dilutions, however it is not completely passive as it requires the user to generate a finite stream of uniformly sized and spaced droplets of buffer. This task is not possible without active and precise control of flow: in our experiment (section A) we used a droplet-ondemand (DOD) system. 11 In the following we demonstrate that such an active control can be effectively replaced in integrated trap systems which use combinations of the metering trap and other trap modules. Fig. 5. shows an illustrative system that uses the metering, delay and lock&shift traps to transform an input of a sample and of a stream of buffer into an array of droplets presenting serial dilutions of the input solution. The device consists of three main parts (see Fig. 5a): (1) the part that transforms a continuous stream of the buffer into 10 precisely metered drops locked in the metering traps. Between the metering traps we placed the delay traps to increase the time of passage, (2) a metering trap for trapping the sample and later to release dilutions and (3) an array of 10 lock & shift traps to array the dilutions.

The execution of the protocol comprises three steps illustrated in Fig. 5b-d. First we flow the continuous liquid from inlet in1 to outlet out1 together with an amount of solvent from inlet inSol. The continuous phase pushes a portion of the solvent through the array of metering traps leaving precisely metered aliquots of volume V in them (Fig. 5e). Then we flow the continuous liquid from inlet in1 to outlet outSam and introduce a portion of sample from inSam to meter and lock a precisely metered volume of sample in the metering trap. At this stage all required droplets are metered. In the third step the flow of the continuous liquid from inlet in2 to outlet out2 pushes the drops of buffer into the metering trap containing the sample, just as in the device operated with active droplet-on-demand control. 11 The drops, in sequence, merge with the droplet in the sample trap and release an equal volume of the current concentration. While the content of the droplet homogenizes the released droplet travels to the array of the lock&shift traps. Running the whole sequence of droplets through (Fig. 5f) results in a generation of an array of well positioned, metered droplets presenting an exponential decay of the concentration of the sample (Fig. 5g).

See also the supplementary video (ESI 3 mov1). 

## F. Integrated serial dilutor II -the DOMINO system

The use of the flow of droplets to mix their content can be expoited to form a system generating a sequence of serial dilutions without any stringent requirements on the speed of flow of the liquids. Fig. 6. shows one segment of such a device: a pair of a metering and a merging trap. The merging trap (positioned on the right side of the micrograph) is first filled with a droplet of solvent of volume V by passing this droplet from right to left (from a metering trap outside the micrograph). Then a droplet of the sample (here: a solution of dye) of volume 2V is passed from left to right through the metering trap. The metering trap locks a droplet of volume V of the sample and passes the remaining volume (here also V) into the merging trap. The droplet coalesces with the drop of solvent and is released to mix by convection inside the droplet. Note that the concentration of the output droplet is decreased after mixing with the droplet of solvent and the resulting concentration depends only on the ratio of volumes of both mixed droplets which is fixed by the design of the device. The volume of the input droplet (of sample) and output droplet (of the mixture) is the same. This allows it to pass through a copy of the same module downstream to repeat the operation.

We use the above module in an integrated DOMINO system (Fig. 7) to generate an array of precise aliquots of the diluted sample without any requirement for precise control of the rates of flow of the liquids. All the operations are performed simply by switching the direction of flow through the system.

The device is operated in 3 steps shown in Fig. 7f-h. In the first step (Fig. 7f) we introduce the flow of the carrier liquid from inlet in1 to outlet out1 and we inject a sufficiently large (.1.375 mL) aliquot of solvent from inlet inSol (all the other inlets/outlets are closed). The continuous liquid pushes the droplet of solvent through the array of traps leaving precisely metered aliquots of volume V = 275 nL in the metering traps (1). In the second step (Fig. 7g) the flow of the continuous liquid is switched on from inlet in2 to outlet out2. This pushes the drops of solvent from the metering traps to the merging traps where they are locked. During this phase, the sample is introduced from inlet inSam and the flow of the continuous liquid locks the precisely metered volume (2V) of sample (of concentration C 0 ) in the metering trap (3). At this stage all required droplets are metered and locked in place (see Fig. 7b).

In the last, third, step (Fig. 7h) we start the flow from the inlet in1 to the outlet out1. This drives the droplet of the sample through the array of traps (see Fig. 7c). In the first metering trap a drop (of volume V) of sample is trapped, passing the remaining (V) to the merging trap where it coalesces with the drop (V) of solvent. The merged droplet is carried (and simultaneously mixed to a homogeneous concentration C 1 = C 0 ?V/(V + V) = C 0 /2) to the next metering trap. Passing through each subsequent set of a metering and merging trap creates a two-fold dilution locked in the metering trap. As a result, after the whole protocol is completed, the device presents an array of precisely metered dilutions (Fig. 7d-e). Importantly the precise operations of i) metering the liquids, ii) merging them in a predetermined sequence, iii) mixing their content, and iv) locking the resulting sequence of droplets at well defined positions was achieved with the control of only the sequence of directions of flow. The exact timing of flow and its rate did not need to be controlled precisely and can be executed e.g. manually. See also supplementary video mov2 (ESI3).

We also used this system to check the standard deviation of the volume of the droplets locked in the metering traps (for details see ESI 3 ). We measured that at a fixed rate of flow the normalized standard deviation of the trapped volumes does not exceed 3%. In addition, within an approximately 3-fold  range of rates of flow (e.g. between 100 and 300 mL h 21 or 300 and 750 mL h 21 ), the same parameter does not exceed 5%. These results confirm that even a very loose control of the rate of inflow of liquids results in precise execution of the protocols hard-wired into the geometry of the chip. This feature distinguishes trap based devices from classical microfluidics geometries, e.g. T-junctions, where even small fluctuations of the rates of flow lead to significant fluctuations in the size of droplets. 17 

# Conclusions

The idea of constructing systems that will perform complex liquid handling and chemical protocols in a small and user friendly format is one of the more important motivations of interest in microfluidics. This goal of designing devices that can be operated as simply as possible, at the same time performing precise operations prompted the development of a range of techniques. Illustrative examples include paper based microfluidics 12,13 -systems that extend on the well known strip-tests to split, dilute and deliver the samples into multiple areas on chip with specific assay chemistry-or slipchips 14 systems comprising of plates with complementary channels and structures that form microfluidic networks and can be reconfigured by shifting the plates with respect to each other. These systems offer simplicity in the execution of select functions.

Here, we demonstrated that it is possible to construct systems that can passively perform multiple hard-wired operations on liquid microdroplets. Depending on their design, the individual modules perform a range of elementary operations on micro-aliquots of liquid, including metering, trapping, merging, delaying and releasing droplets. Importantly, these operations can be executed precisely without the requirement for precise control of the rate of flow or the timing of switching the flow on and off. These functions are achieved by a set of hard-wired geometric modules that perform elementary operations on portions of liquids and that can be integrated into networks designed to perform long sequences of operations.

The modules that we describe take advantage of the large imbalance between the interfacial tension forces and the shear stresses, typical of many microfluidic systems. Within this approach, narrower ranges of functions have been demonstrated before. Most of these reports describe geometries acquired via planar fabrication (i.e. with channels of uniform height). For example, a set of pillars was demonstrated to form a merging trap [18][19][20] or a shift register. 16 Niu et al. 15 used a pillar trap to form a serial dilutor operated with conventionally formed uniform droplets. Bai et al. 21 and Xu et al. 22 showed an array of microfluidic traps for clustering of large number of droplets. There are also interesting examples of the use of a sequence of traps that allow for the partial exchange of mass with the flow in the main channel, either with the aid of an electric field 23 or passively 24 without the fully 'digital' control of the exchange of mass between the continuous stream and the droplets. Recently, Dangla et al. 25 introduced the interesting concept of capillary anchoring that also uses geometry to co-control the flow field in the device via capillary interactions. Van Steijn et al. 26 used bypass around a T-junction droplet generator to produce droplets of fixed volume independently of the flow rates of both phases. The interplay between capillary forces and shear stress was also used to construct microfluidic logical gates. 27,28 The modules that we present are simple in their fabrication. All of them can be made within a common fabrication scheme (either via milling, embossing, injection moulding or two-layer lithography) that requires structuring of only one of two plates which constitute the microfluidic device. The single coherent approach that we propose can be used to construct modules for all elementary operations on portions of liquids, and show that these modules can be freely arranged into functional networks. As the modules share common design principles of the use of barriers and bypasses, they can be rationally designed, optimized and expanded for a combinatorial number of functions. For example the metering trap can be made symmetric by the introduction of the barriers on both ends. A metering-merging trap can be made by combining the cutting barrier on one side with the merging barrier on the other, etc.

Most importantly, we show that the modules can be arranged into functional systems. We used the model challenge of generation of a sequence of micro-droplets presenting a serial dilution of a sample to demonstrate the ability to integrate the simple modules and to lift the requirements of external control over volumes of droplets issued into the systems, and of the rate of flow of liquids through the chip. We believe that the platform that we report here opens the way for the construction of a broad range of systems that could be operated in passive manner, potentially requiring only deposition of samples onto the chip and the use of gravity to drive the liquids through the traps. As an extension we also believe that it should be possible to design systems that autonomously switch the direction of flow with the use of capillary valves.

The systems that we presented should be useful in both automated and passive droplet microfluidic systems. For example, individual passive modules can be integrated into automated droplet systems to introduce the ability to dilute in screening experiments, to contain drops with microorganisms, while allowing a portion of the liquid to be replaced periodically to sustain long-term growth, or to lock a droplet in place for long-term microscopic observation while allowing a facile replacement of the microscopic sample without crosscontamination. Ultimately, we also hope that the passive modules and the approach that we demonstrated here will be helpful in building a range of microfluidic devices for point-ofcare analyses including colorimetric assays of blood with portions of reagents trapped on the chip and the sample processed, aliquoted and delivered to the reagents. Other applications may be for assays in microbiology and molecular biology including the polymerase chain reaction and immu-noassays where a sequence of liquid handling operations must be performed on the sample and reaction mixture.

# Materials and methods

We fabricated the polycarbonate microfluidic chips in plates of polycarbonate (Macroclear, Bayer, Germany) using a CNC milling machine (MSG4025, Ergwind, Poland). The milled pieces of polycarbonate were thermally bonded to neat 2-mm plates by compressing them together (30 min, 130 uC). We created the world-to-device interface using 21 gauge needles (y4 cm, O.D. 0.82 mm, I.D. 0.65 mm, Fishman Corporation, USA). We connected the device inlets to syringes driven by syringe pumps via PE tubing. We used hexadecane as a continuous phase and clear distilled water or distilled water dyed by ink (Parker, UK) as a droplet phase.

# Acknowledgements

This project operated within the Foundation for Polish Science Team Programme co-financed by the EU European Regional Development Fund and within the European Research Council Starting Grant 279647. PK acknowledges Marie Curie International Outgoing Fellowship within the 7th European Community Framework Programme for the support of this research.

